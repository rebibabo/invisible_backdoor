<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/409.c" pos:tabs="8"><function pos:start="1:1" pos:end="75:1"><type pos:start="1:1" pos:end="1:11"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:11">void</name></type> <name pos:start="1:13" pos:end="1:27">tftp_send_error</name><parameter_list pos:start="1:28" pos:end="5:51">(<parameter pos:start="1:29" pos:end="1:52"><decl pos:start="1:29" pos:end="1:52"><type pos:start="1:29" pos:end="1:52"><name pos:start="1:29" pos:end="1:47"><name pos:start="1:29" pos:end="1:34">struct</name> <name pos:start="1:36" pos:end="1:47">tftp_session</name></name> <modifier pos:start="1:49" pos:end="1:49">*</modifier></type><name pos:start="1:50" pos:end="1:52">spt</name></decl></parameter>,

                            <parameter pos:start="3:29" pos:end="3:46"><decl pos:start="3:29" pos:end="3:46"><type pos:start="3:29" pos:end="3:46"><name pos:start="3:29" pos:end="3:36">uint16_t</name></type> <name pos:start="3:38" pos:end="3:46">errorcode</name></decl></parameter>, <parameter pos:start="3:49" pos:end="3:63"><decl pos:start="3:49" pos:end="3:63"><type pos:start="3:49" pos:end="3:63"><specifier pos:start="3:49" pos:end="3:53">const</specifier> <name pos:start="3:55" pos:end="3:58">char</name> <modifier pos:start="3:60" pos:end="3:60">*</modifier></type><name pos:start="3:61" pos:end="3:63">msg</name></decl></parameter>,

                            <parameter pos:start="5:29" pos:end="5:50"><decl pos:start="5:29" pos:end="5:50"><type pos:start="5:29" pos:end="5:50"><name pos:start="5:29" pos:end="5:41"><name pos:start="5:29" pos:end="5:34">struct</name> <name pos:start="5:36" pos:end="5:41">tftp_t</name></name> <modifier pos:start="5:43" pos:end="5:43">*</modifier></type><name pos:start="5:44" pos:end="5:50">recv_tp</name></decl></parameter>)</parameter_list>

<block pos:start="7:1" pos:end="75:1">{<block_content pos:start="9:3" pos:end="73:30">

  <decl_stmt pos:start="9:3" pos:end="9:34"><decl pos:start="9:3" pos:end="9:26"><type pos:start="9:3" pos:end="9:20"><name pos:start="9:3" pos:end="9:20"><name pos:start="9:3" pos:end="9:8">struct</name> <name pos:start="9:10" pos:end="9:20">sockaddr_in</name></name></type> <name pos:start="9:22" pos:end="9:26">saddr</name></decl>, <decl pos:start="9:29" pos:end="9:33"><type ref="prev" pos:start="9:3" pos:end="9:20"/><name pos:start="9:29" pos:end="9:33">daddr</name></decl>;</decl_stmt>

  <decl_stmt pos:start="11:3" pos:end="11:17"><decl pos:start="11:3" pos:end="11:16"><type pos:start="11:3" pos:end="11:15"><name pos:start="11:3" pos:end="11:13"><name pos:start="11:3" pos:end="11:8">struct</name> <name pos:start="11:10" pos:end="11:13">mbuf</name></name> <modifier pos:start="11:15" pos:end="11:15">*</modifier></type><name pos:start="11:16" pos:end="11:16">m</name></decl>;</decl_stmt>

  <decl_stmt pos:start="13:3" pos:end="13:20"><decl pos:start="13:3" pos:end="13:19"><type pos:start="13:3" pos:end="13:17"><name pos:start="13:3" pos:end="13:15"><name pos:start="13:3" pos:end="13:8">struct</name> <name pos:start="13:10" pos:end="13:15">tftp_t</name></name> <modifier pos:start="13:17" pos:end="13:17">*</modifier></type><name pos:start="13:18" pos:end="13:19">tp</name></decl>;</decl_stmt>



  <expr_stmt pos:start="17:3" pos:end="17:24"><expr pos:start="17:3" pos:end="17:23"><name pos:start="17:3" pos:end="17:3">m</name> <operator pos:start="17:5" pos:end="17:5">=</operator> <call pos:start="17:7" pos:end="17:23"><name pos:start="17:7" pos:end="17:11">m_get</name><argument_list pos:start="17:12" pos:end="17:23">(<argument pos:start="17:13" pos:end="17:22"><expr pos:start="17:13" pos:end="17:22"><name pos:start="17:13" pos:end="17:22"><name pos:start="17:13" pos:end="17:15">spt</name><operator pos:start="17:16" pos:end="17:17">-&gt;</operator><name pos:start="17:18" pos:end="17:22">slirp</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



  <if_stmt pos:start="21:3" pos:end="25:3"><if pos:start="21:3" pos:end="25:3">if <condition pos:start="21:6" pos:end="21:9">(<expr pos:start="21:7" pos:end="21:8"><operator pos:start="21:7" pos:end="21:7">!</operator><name pos:start="21:8" pos:end="21:8">m</name></expr>)</condition> <block pos:start="21:11" pos:end="25:3">{<block_content pos:start="23:5" pos:end="23:13">

    <goto pos:start="23:5" pos:end="23:13">goto <name pos:start="23:10" pos:end="23:12">out</name>;</goto>

  </block_content>}</block></if></if_stmt>



  <expr_stmt pos:start="29:3" pos:end="29:34"><expr pos:start="29:3" pos:end="29:33"><call pos:start="29:3" pos:end="29:33"><name pos:start="29:3" pos:end="29:8">memset</name><argument_list pos:start="29:9" pos:end="29:33">(<argument pos:start="29:10" pos:end="29:18"><expr pos:start="29:10" pos:end="29:18"><name pos:start="29:10" pos:end="29:18"><name pos:start="29:10" pos:end="29:10">m</name><operator pos:start="29:11" pos:end="29:12">-&gt;</operator><name pos:start="29:13" pos:end="29:18">m_data</name></name></expr></argument>, <argument pos:start="29:21" pos:end="29:21"><expr pos:start="29:21" pos:end="29:21"><literal type="number" pos:start="29:21" pos:end="29:21">0</literal></expr></argument>, <argument pos:start="29:24" pos:end="29:32"><expr pos:start="29:24" pos:end="29:32"><name pos:start="29:24" pos:end="29:32"><name pos:start="29:24" pos:end="29:24">m</name><operator pos:start="29:25" pos:end="29:26">-&gt;</operator><name pos:start="29:27" pos:end="29:32">m_size</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



  <expr_stmt pos:start="33:3" pos:end="33:29"><expr pos:start="33:3" pos:end="33:28"><name pos:start="33:3" pos:end="33:11"><name pos:start="33:3" pos:end="33:3">m</name><operator pos:start="33:4" pos:end="33:5">-&gt;</operator><name pos:start="33:6" pos:end="33:11">m_data</name></name> <operator pos:start="33:13" pos:end="33:14">+=</operator> <name pos:start="33:16" pos:end="33:28">IF_MAXLINKHDR</name></expr>;</expr_stmt>

  <expr_stmt pos:start="35:3" pos:end="35:25"><expr pos:start="35:3" pos:end="35:24"><name pos:start="35:3" pos:end="35:4">tp</name> <operator pos:start="35:6" pos:end="35:6">=</operator> <operator pos:start="35:8" pos:end="35:8">(</operator><name pos:start="35:9" pos:end="35:12">void</name> <operator pos:start="35:14" pos:end="35:14">*</operator><operator pos:start="35:15" pos:end="35:15">)</operator><name pos:start="35:16" pos:end="35:24"><name pos:start="35:16" pos:end="35:16">m</name><operator pos:start="35:17" pos:end="35:18">-&gt;</operator><name pos:start="35:19" pos:end="35:24">m_data</name></name></expr>;</expr_stmt>

  <expr_stmt pos:start="37:3" pos:end="37:39"><expr pos:start="37:3" pos:end="37:38"><name pos:start="37:3" pos:end="37:11"><name pos:start="37:3" pos:end="37:3">m</name><operator pos:start="37:4" pos:end="37:5">-&gt;</operator><name pos:start="37:6" pos:end="37:11">m_data</name></name> <operator pos:start="37:13" pos:end="37:14">+=</operator> <sizeof pos:start="37:16" pos:end="37:38">sizeof<argument_list pos:start="37:22" pos:end="37:38">(<argument pos:start="37:23" pos:end="37:37"><expr pos:start="37:23" pos:end="37:37">struct <name pos:start="37:30" pos:end="37:37">udpiphdr</name></expr></argument>)</argument_list></sizeof></expr>;</expr_stmt>



  <expr_stmt pos:start="41:3" pos:end="41:32"><expr pos:start="41:3" pos:end="41:31"><name pos:start="41:3" pos:end="41:11"><name pos:start="41:3" pos:end="41:4">tp</name><operator pos:start="41:5" pos:end="41:6">-&gt;</operator><name pos:start="41:7" pos:end="41:11">tp_op</name></name> <operator pos:start="41:13" pos:end="41:13">=</operator> <call pos:start="41:15" pos:end="41:31"><name pos:start="41:15" pos:end="41:19">htons</name><argument_list pos:start="41:20" pos:end="41:31">(<argument pos:start="41:21" pos:end="41:30"><expr pos:start="41:21" pos:end="41:30"><name pos:start="41:21" pos:end="41:30">TFTP_ERROR</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

  <expr_stmt pos:start="43:3" pos:end="43:50"><expr pos:start="43:3" pos:end="43:49"><name pos:start="43:3" pos:end="43:30"><name pos:start="43:3" pos:end="43:4">tp</name><operator pos:start="43:5" pos:end="43:6">-&gt;</operator><name pos:start="43:7" pos:end="43:7">x</name><operator pos:start="43:8" pos:end="43:8">.</operator><name pos:start="43:9" pos:end="43:16">tp_error</name><operator pos:start="43:17" pos:end="43:17">.</operator><name pos:start="43:18" pos:end="43:30">tp_error_code</name></name> <operator pos:start="43:32" pos:end="43:32">=</operator> <call pos:start="43:34" pos:end="43:49"><name pos:start="43:34" pos:end="43:38">htons</name><argument_list pos:start="43:39" pos:end="43:49">(<argument pos:start="43:40" pos:end="43:48"><expr pos:start="43:40" pos:end="43:48"><name pos:start="43:40" pos:end="43:48">errorcode</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

  <expr_stmt pos:start="45:3" pos:end="45:77"><expr pos:start="45:3" pos:end="45:76"><call pos:start="45:3" pos:end="45:76"><name pos:start="45:3" pos:end="45:9">pstrcpy</name><argument_list pos:start="45:10" pos:end="45:76">(<argument pos:start="45:11" pos:end="45:39"><expr pos:start="45:11" pos:end="45:39"><operator pos:start="45:11" pos:end="45:11">(</operator><name pos:start="45:12" pos:end="45:15">char</name> <operator pos:start="45:17" pos:end="45:17">*</operator><operator pos:start="45:18" pos:end="45:18">)</operator><name pos:start="45:19" pos:end="45:39"><name pos:start="45:19" pos:end="45:20">tp</name><operator pos:start="45:21" pos:end="45:22">-&gt;</operator><name pos:start="45:23" pos:end="45:23">x</name><operator pos:start="45:24" pos:end="45:24">.</operator><name pos:start="45:25" pos:end="45:32">tp_error</name><operator pos:start="45:33" pos:end="45:33">.</operator><name pos:start="45:34" pos:end="45:39">tp_msg</name></name></expr></argument>, <argument pos:start="45:42" pos:end="45:70"><expr pos:start="45:42" pos:end="45:70"><sizeof pos:start="45:42" pos:end="45:70">sizeof<argument_list pos:start="45:48" pos:end="45:70">(<argument pos:start="45:49" pos:end="45:69"><expr pos:start="45:49" pos:end="45:69"><name pos:start="45:49" pos:end="45:69"><name pos:start="45:49" pos:end="45:50">tp</name><operator pos:start="45:51" pos:end="45:52">-&gt;</operator><name pos:start="45:53" pos:end="45:53">x</name><operator pos:start="45:54" pos:end="45:54">.</operator><name pos:start="45:55" pos:end="45:62">tp_error</name><operator pos:start="45:63" pos:end="45:63">.</operator><name pos:start="45:64" pos:end="45:69">tp_msg</name></name></expr></argument>)</argument_list></sizeof></expr></argument>, <argument pos:start="45:73" pos:end="45:75"><expr pos:start="45:73" pos:end="45:75"><name pos:start="45:73" pos:end="45:75">msg</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



  <expr_stmt pos:start="49:3" pos:end="49:38"><expr pos:start="49:3" pos:end="49:37"><name pos:start="49:3" pos:end="49:16"><name pos:start="49:3" pos:end="49:7">saddr</name><operator pos:start="49:8" pos:end="49:8">.</operator><name pos:start="49:9" pos:end="49:16">sin_addr</name></name> <operator pos:start="49:18" pos:end="49:18">=</operator> <name pos:start="49:20" pos:end="49:37"><name pos:start="49:20" pos:end="49:26">recv_tp</name><operator pos:start="49:27" pos:end="49:28">-&gt;</operator><name pos:start="49:29" pos:end="49:30">ip</name><operator pos:start="49:31" pos:end="49:31">.</operator><name pos:start="49:32" pos:end="49:37">ip_dst</name></name></expr>;</expr_stmt>

  <expr_stmt pos:start="51:3" pos:end="51:41"><expr pos:start="51:3" pos:end="51:40"><name pos:start="51:3" pos:end="51:16"><name pos:start="51:3" pos:end="51:7">saddr</name><operator pos:start="51:8" pos:end="51:8">.</operator><name pos:start="51:9" pos:end="51:16">sin_port</name></name> <operator pos:start="51:18" pos:end="51:18">=</operator> <name pos:start="51:20" pos:end="51:40"><name pos:start="51:20" pos:end="51:26">recv_tp</name><operator pos:start="51:27" pos:end="51:28">-&gt;</operator><name pos:start="51:29" pos:end="51:31">udp</name><operator pos:start="51:32" pos:end="51:32">.</operator><name pos:start="51:33" pos:end="51:40">uh_dport</name></name></expr>;</expr_stmt>



  <expr_stmt pos:start="55:3" pos:end="55:34"><expr pos:start="55:3" pos:end="55:33"><name pos:start="55:3" pos:end="55:16"><name pos:start="55:3" pos:end="55:7">daddr</name><operator pos:start="55:8" pos:end="55:8">.</operator><name pos:start="55:9" pos:end="55:16">sin_addr</name></name> <operator pos:start="55:18" pos:end="55:18">=</operator> <name pos:start="55:20" pos:end="55:33"><name pos:start="55:20" pos:end="55:22">spt</name><operator pos:start="55:23" pos:end="55:24">-&gt;</operator><name pos:start="55:25" pos:end="55:33">client_ip</name></name></expr>;</expr_stmt>

  <expr_stmt pos:start="57:3" pos:end="57:36"><expr pos:start="57:3" pos:end="57:35"><name pos:start="57:3" pos:end="57:16"><name pos:start="57:3" pos:end="57:7">daddr</name><operator pos:start="57:8" pos:end="57:8">.</operator><name pos:start="57:9" pos:end="57:16">sin_port</name></name> <operator pos:start="57:18" pos:end="57:18">=</operator> <name pos:start="57:20" pos:end="57:35"><name pos:start="57:20" pos:end="57:22">spt</name><operator pos:start="57:23" pos:end="57:24">-&gt;</operator><name pos:start="57:25" pos:end="57:35">client_port</name></name></expr>;</expr_stmt>



  <expr_stmt pos:start="61:3" pos:end="63:50"><expr pos:start="61:3" pos:end="63:49"><name pos:start="61:3" pos:end="61:10"><name pos:start="61:3" pos:end="61:3">m</name><operator pos:start="61:4" pos:end="61:5">-&gt;</operator><name pos:start="61:6" pos:end="61:10">m_len</name></name> <operator pos:start="61:12" pos:end="61:12">=</operator> <sizeof pos:start="61:14" pos:end="61:34">sizeof<argument_list pos:start="61:20" pos:end="61:34">(<argument pos:start="61:21" pos:end="61:33"><expr pos:start="61:21" pos:end="61:33">struct <name pos:start="61:28" pos:end="61:33">tftp_t</name></expr></argument>)</argument_list></sizeof> <operator pos:start="61:36" pos:end="61:36">-</operator> <literal type="number" pos:start="61:38" pos:end="61:42">514</literal> <operator pos:start="61:42" pos:end="61:42">+</operator> <literal type="number" pos:start="61:44" pos:end="61:46">3</literal> <operator pos:start="61:46" pos:end="61:46">+</operator> <call pos:start="61:48" pos:end="61:58"><name pos:start="61:48" pos:end="61:53">strlen</name><argument_list pos:start="61:54" pos:end="61:58">(<argument pos:start="61:55" pos:end="61:57"><expr pos:start="61:55" pos:end="61:57"><name pos:start="61:55" pos:end="61:57">msg</name></expr></argument>)</argument_list></call> <operator pos:start="61:60" pos:end="61:60">-</operator>

        <sizeof pos:start="63:9" pos:end="63:25">sizeof<argument_list pos:start="63:15" pos:end="63:25">(<argument pos:start="63:16" pos:end="63:24"><expr pos:start="63:16" pos:end="63:24">struct <name pos:start="63:23" pos:end="63:24">ip</name></expr></argument>)</argument_list></sizeof> <operator pos:start="63:27" pos:end="63:27">-</operator> <sizeof pos:start="63:29" pos:end="63:49">sizeof<argument_list pos:start="63:35" pos:end="63:49">(<argument pos:start="63:36" pos:end="63:48"><expr pos:start="63:36" pos:end="63:48">struct <name pos:start="63:43" pos:end="63:48">udphdr</name></expr></argument>)</argument_list></sizeof></expr>;</expr_stmt>



  <expr_stmt pos:start="67:3" pos:end="67:55"><expr pos:start="67:3" pos:end="67:54"><call pos:start="67:3" pos:end="67:54"><name pos:start="67:3" pos:end="67:13">udp_output2</name><argument_list pos:start="67:14" pos:end="67:54">(<argument pos:start="67:15" pos:end="67:18"><expr pos:start="67:15" pos:end="67:18"><name pos:start="67:15" pos:end="67:18">NULL</name></expr></argument>, <argument pos:start="67:21" pos:end="67:21"><expr pos:start="67:21" pos:end="67:21"><name pos:start="67:21" pos:end="67:21">m</name></expr></argument>, <argument pos:start="67:24" pos:end="67:29"><expr pos:start="67:24" pos:end="67:29"><operator pos:start="67:24" pos:end="67:24">&amp;</operator><name pos:start="67:25" pos:end="67:29">saddr</name></expr></argument>, <argument pos:start="67:32" pos:end="67:37"><expr pos:start="67:32" pos:end="67:37"><operator pos:start="67:32" pos:end="67:32">&amp;</operator><name pos:start="67:33" pos:end="67:37">daddr</name></expr></argument>, <argument pos:start="67:40" pos:end="67:53"><expr pos:start="67:40" pos:end="67:53"><name pos:start="67:40" pos:end="67:53">IPTOS_LOWDELAY</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



<label pos:start="71:1" pos:end="71:4"><name pos:start="71:1" pos:end="71:3">out</name>:</label>

  <expr_stmt pos:start="73:3" pos:end="73:30"><expr pos:start="73:3" pos:end="73:29"><call pos:start="73:3" pos:end="73:29"><name pos:start="73:3" pos:end="73:24">tftp_session_terminate</name><argument_list pos:start="73:25" pos:end="73:29">(<argument pos:start="73:26" pos:end="73:28"><expr pos:start="73:26" pos:end="73:28"><name pos:start="73:26" pos:end="73:28">spt</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

</block_content>}</block></function>
</unit>
