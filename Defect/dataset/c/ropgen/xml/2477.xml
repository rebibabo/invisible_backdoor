<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:cpp="http://www.srcML.org/srcML/cpp" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/2477.c" pos:tabs="8"><function pos:start="1:1" pos:end="559:1"><type pos:start="1:1" pos:end="1:3"><name pos:start="1:1" pos:end="1:3">int</name></type> <name pos:start="1:5" pos:end="1:28">cpu_x86_handle_mmu_fault</name><parameter_list pos:start="1:29" pos:end="3:72">(<parameter pos:start="1:30" pos:end="1:45"><decl pos:start="1:30" pos:end="1:45"><type pos:start="1:30" pos:end="1:45"><name pos:start="1:30" pos:end="1:40">CPUX86State</name> <modifier pos:start="1:42" pos:end="1:42">*</modifier></type><name pos:start="1:43" pos:end="1:45">env</name></decl></parameter>, <parameter pos:start="1:48" pos:end="1:64"><decl pos:start="1:48" pos:end="1:64"><type pos:start="1:48" pos:end="1:64"><name pos:start="1:48" pos:end="1:59">target_ulong</name></type> <name pos:start="1:61" pos:end="1:64">addr</name></decl></parameter>, 

                             <parameter pos:start="3:30" pos:end="3:42"><decl pos:start="3:30" pos:end="3:42"><type pos:start="3:30" pos:end="3:42"><name pos:start="3:30" pos:end="3:32">int</name></type> <name pos:start="3:34" pos:end="3:42">is_write1</name></decl></parameter>, <parameter pos:start="3:45" pos:end="3:55"><decl pos:start="3:45" pos:end="3:55"><type pos:start="3:45" pos:end="3:55"><name pos:start="3:45" pos:end="3:47">int</name></type> <name pos:start="3:49" pos:end="3:55">is_user</name></decl></parameter>, <parameter pos:start="3:58" pos:end="3:71"><decl pos:start="3:58" pos:end="3:71"><type pos:start="3:58" pos:end="3:71"><name pos:start="3:58" pos:end="3:60">int</name></type> <name pos:start="3:62" pos:end="3:71">is_softmmu</name></decl></parameter>)</parameter_list>

<block pos:start="5:1" pos:end="559:1">{<block_content pos:start="7:5" pos:end="557:13">

    <decl_stmt pos:start="7:5" pos:end="7:23"><decl pos:start="7:5" pos:end="7:17"><type pos:start="7:5" pos:end="7:12"><name pos:start="7:5" pos:end="7:12">uint64_t</name></type> <name pos:start="7:14" pos:end="7:17">ptep</name></decl>, <decl pos:start="7:20" pos:end="7:22"><type ref="prev" pos:start="7:5" pos:end="7:12"/><name pos:start="7:20" pos:end="7:22">pte</name></decl>;</decl_stmt>

    <decl_stmt pos:start="9:5" pos:end="9:43"><decl pos:start="9:5" pos:end="9:22"><type pos:start="9:5" pos:end="9:12"><name pos:start="9:5" pos:end="9:12">uint32_t</name></type> <name pos:start="9:14" pos:end="9:22">pdpe_addr</name></decl>, <decl pos:start="9:25" pos:end="9:32"><type ref="prev" pos:start="9:5" pos:end="9:12"/><name pos:start="9:25" pos:end="9:32">pde_addr</name></decl>, <decl pos:start="9:35" pos:end="9:42"><type ref="prev" pos:start="9:5" pos:end="9:12"/><name pos:start="9:35" pos:end="9:42">pte_addr</name></decl>;</decl_stmt>

    <decl_stmt pos:start="11:5" pos:end="11:61"><decl pos:start="11:5" pos:end="11:18"><type pos:start="11:5" pos:end="11:7"><name pos:start="11:5" pos:end="11:7">int</name></type> <name pos:start="11:9" pos:end="11:18">error_code</name></decl>, <decl pos:start="11:21" pos:end="11:28"><type ref="prev" pos:start="11:5" pos:end="11:7"/><name pos:start="11:21" pos:end="11:28">is_dirty</name></decl>, <decl pos:start="11:31" pos:end="11:34"><type ref="prev" pos:start="11:5" pos:end="11:7"/><name pos:start="11:31" pos:end="11:34">prot</name></decl>, <decl pos:start="11:37" pos:end="11:45"><type ref="prev" pos:start="11:5" pos:end="11:7"/><name pos:start="11:37" pos:end="11:45">page_size</name></decl>, <decl pos:start="11:48" pos:end="11:50"><type ref="prev" pos:start="11:5" pos:end="11:7"/><name pos:start="11:48" pos:end="11:50">ret</name></decl>, <decl pos:start="11:53" pos:end="11:60"><type ref="prev" pos:start="11:5" pos:end="11:7"/><name pos:start="11:53" pos:end="11:60">is_write</name></decl>;</decl_stmt>

    <decl_stmt pos:start="13:5" pos:end="13:37"><decl pos:start="13:5" pos:end="13:23"><type pos:start="13:5" pos:end="13:17"><name pos:start="13:5" pos:end="13:12">unsigned</name> <name pos:start="13:14" pos:end="13:17">long</name></type> <name pos:start="13:19" pos:end="13:23">paddr</name></decl>, <decl pos:start="13:26" pos:end="13:36"><type ref="prev" pos:start="13:5" pos:end="13:17"/><name pos:start="13:26" pos:end="13:36">page_offset</name></decl>;</decl_stmt>

    <decl_stmt pos:start="15:5" pos:end="20:0"><decl pos:start="15:5" pos:end="15:22"><type pos:start="15:5" pos:end="15:16"><name pos:start="15:5" pos:end="15:16">target_ulong</name></type> <name pos:start="15:18" pos:end="15:22">vaddr</name></decl>, <decl pos:start="15:25" pos:end="15:33"><type ref="prev" pos:start="15:5" pos:end="15:16"/><name pos:start="15:25" pos:end="15:33">virt_addr</name></decl>;</decl_stmt>

    

<cpp:if pos:start="19:1" pos:end="19:22">#<cpp:directive pos:start="19:2" pos:end="19:3">if</cpp:directive> <expr pos:start="19:5" pos:end="19:22"><call pos:start="19:5" pos:end="19:22"><name pos:start="19:5" pos:end="19:11">defined</name><argument_list pos:start="19:12" pos:end="19:22">(<argument pos:start="19:13" pos:end="19:21"><expr pos:start="19:13" pos:end="19:21"><name pos:start="19:13" pos:end="19:21">DEBUG_MMU</name></expr></argument>)</argument_list></call></expr></cpp:if>

    <expr_stmt pos:start="21:5" pos:end="26:0"><expr pos:start="21:5" pos:end="23:46"><call pos:start="21:5" pos:end="23:46"><name pos:start="21:5" pos:end="21:10">printf</name><argument_list pos:start="21:11" pos:end="23:46">(<argument pos:start="21:12" pos:end="21:80"><expr pos:start="21:12" pos:end="21:80"><literal type="string" pos:start="21:12" pos:end="21:29">"MMU fault: addr="</literal> <name pos:start="21:31" pos:end="21:43">TARGET_FMT_lx</name> <literal type="string" pos:start="21:45" pos:end="21:61">" w=%d u=%d eip="</literal> <name pos:start="21:63" pos:end="21:75">TARGET_FMT_lx</name> <literal type="string" pos:start="21:77" pos:end="21:80">"\n"</literal></expr></argument>, 

           <argument pos:start="23:12" pos:end="23:15"><expr pos:start="23:12" pos:end="23:15"><name pos:start="23:12" pos:end="23:15">addr</name></expr></argument>, <argument pos:start="23:18" pos:end="23:26"><expr pos:start="23:18" pos:end="23:26"><name pos:start="23:18" pos:end="23:26">is_write1</name></expr></argument>, <argument pos:start="23:29" pos:end="23:35"><expr pos:start="23:29" pos:end="23:35"><name pos:start="23:29" pos:end="23:35">is_user</name></expr></argument>, <argument pos:start="23:38" pos:end="23:45"><expr pos:start="23:38" pos:end="23:45"><name pos:start="23:38" pos:end="23:45"><name pos:start="23:38" pos:end="23:40">env</name><operator pos:start="23:41" pos:end="23:42">-&gt;</operator><name pos:start="23:43" pos:end="23:45">eip</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

<cpp:endif pos:start="25:1" pos:end="25:6">#<cpp:directive pos:start="25:2" pos:end="25:6">endif</cpp:directive></cpp:endif>

    <expr_stmt pos:start="27:5" pos:end="27:29"><expr pos:start="27:5" pos:end="27:28"><name pos:start="27:5" pos:end="27:12">is_write</name> <operator pos:start="27:14" pos:end="27:14">=</operator> <name pos:start="27:16" pos:end="27:24">is_write1</name> <operator pos:start="27:26" pos:end="27:26">&amp;</operator> <literal type="number" pos:start="27:28" pos:end="27:28">1</literal></expr>;</expr_stmt>

    

    <if_stmt pos:start="31:5" pos:end="43:5"><if pos:start="31:5" pos:end="43:5">if <condition pos:start="31:8" pos:end="31:36">(<expr pos:start="31:9" pos:end="31:35"><operator pos:start="31:9" pos:end="31:9">!</operator><operator pos:start="31:10" pos:end="31:10">(</operator><name pos:start="31:11" pos:end="31:20"><name pos:start="31:11" pos:end="31:13">env</name><operator pos:start="31:14" pos:end="31:15">-&gt;</operator><name pos:start="31:16" pos:end="31:17">cr</name><index pos:start="31:18" pos:end="31:20">[<expr pos:start="31:19" pos:end="31:19"><literal type="number" pos:start="31:19" pos:end="31:19">0</literal></expr>]</index></name> <operator pos:start="31:22" pos:end="31:22">&amp;</operator> <name pos:start="31:24" pos:end="31:34">CR0_PG_MASK</name><operator pos:start="31:35" pos:end="31:35">)</operator></expr>)</condition> <block pos:start="31:38" pos:end="43:5">{<block_content pos:start="33:9" pos:end="41:24">

        <expr_stmt pos:start="33:9" pos:end="33:19"><expr pos:start="33:9" pos:end="33:18"><name pos:start="33:9" pos:end="33:11">pte</name> <operator pos:start="33:13" pos:end="33:13">=</operator> <name pos:start="33:15" pos:end="33:18">addr</name></expr>;</expr_stmt>

        <expr_stmt pos:start="35:9" pos:end="35:44"><expr pos:start="35:9" pos:end="35:43"><name pos:start="35:9" pos:end="35:17">virt_addr</name> <operator pos:start="35:19" pos:end="35:19">=</operator> <name pos:start="35:21" pos:end="35:24">addr</name> <operator pos:start="35:26" pos:end="35:26">&amp;</operator> <name pos:start="35:28" pos:end="35:43">TARGET_PAGE_MASK</name></expr>;</expr_stmt>

        <expr_stmt pos:start="37:9" pos:end="37:50"><expr pos:start="37:9" pos:end="37:49"><name pos:start="37:9" pos:end="37:12">prot</name> <operator pos:start="37:14" pos:end="37:14">=</operator> <name pos:start="37:16" pos:end="37:24">PAGE_READ</name> <operator pos:start="37:26" pos:end="37:26">|</operator> <name pos:start="37:28" pos:end="37:37">PAGE_WRITE</name> <operator pos:start="37:39" pos:end="37:39">|</operator> <name pos:start="37:41" pos:end="37:49">PAGE_EXEC</name></expr>;</expr_stmt>

        <expr_stmt pos:start="39:9" pos:end="39:25"><expr pos:start="39:9" pos:end="39:24"><name pos:start="39:9" pos:end="39:17">page_size</name> <operator pos:start="39:19" pos:end="39:19">=</operator> <literal type="number" pos:start="39:21" pos:end="39:24">4096</literal></expr>;</expr_stmt>

        <goto pos:start="41:9" pos:end="41:24">goto <name pos:start="41:14" pos:end="41:23">do_mapping</name>;</goto>

    </block_content>}</block></if></if_stmt>



    <if_stmt pos:start="47:5" pos:end="477:5"><if pos:start="47:5" pos:end="335:5">if <condition pos:start="47:8" pos:end="47:34">(<expr pos:start="47:9" pos:end="47:33"><name pos:start="47:9" pos:end="47:18"><name pos:start="47:9" pos:end="47:11">env</name><operator pos:start="47:12" pos:end="47:13">-&gt;</operator><name pos:start="47:14" pos:end="47:15">cr</name><index pos:start="47:16" pos:end="47:18">[<expr pos:start="47:17" pos:end="47:17"><literal type="number" pos:start="47:17" pos:end="47:17">4</literal></expr>]</index></name> <operator pos:start="47:20" pos:end="47:20">&amp;</operator> <name pos:start="47:22" pos:end="47:33">CR4_PAE_MASK</name></expr>)</condition> <block pos:start="47:36" pos:end="335:5">{<block_content pos:start="49:9" pos:end="333:9">

        <decl_stmt pos:start="49:9" pos:end="56:0"><decl pos:start="49:9" pos:end="49:20"><type pos:start="49:9" pos:end="49:16"><name pos:start="49:9" pos:end="49:16">uint64_t</name></type> <name pos:start="49:18" pos:end="49:20">pde</name></decl>, <decl pos:start="49:23" pos:end="49:26"><type ref="prev" pos:start="49:9" pos:end="49:16"/><name pos:start="49:23" pos:end="49:26">pdpe</name></decl>;</decl_stmt>



        <comment type="block" pos:start="53:9" pos:end="53:56">/* XXX: we only use 32 bit physical addresses */</comment>

<cpp:ifdef pos:start="55:1" pos:end="55:20">#<cpp:directive pos:start="55:2" pos:end="55:6">ifdef</cpp:directive> <name pos:start="55:8" pos:end="55:20">TARGET_X86_64</name></cpp:ifdef>

        <if_stmt pos:start="57:9" pos:end="169:9"><if pos:start="57:9" pos:end="145:9">if <condition pos:start="57:12" pos:end="57:38">(<expr pos:start="57:13" pos:end="57:37"><name pos:start="57:13" pos:end="57:23"><name pos:start="57:13" pos:end="57:15">env</name><operator pos:start="57:16" pos:end="57:17">-&gt;</operator><name pos:start="57:18" pos:end="57:23">hflags</name></name> <operator pos:start="57:25" pos:end="57:25">&amp;</operator> <name pos:start="57:27" pos:end="57:37">HF_LMA_MASK</name></expr>)</condition> <block pos:start="57:40" pos:end="145:9">{<block_content pos:start="59:13" pos:end="143:13">

            <decl_stmt pos:start="59:13" pos:end="59:32"><decl pos:start="59:13" pos:end="59:31"><type pos:start="59:13" pos:end="59:20"><name pos:start="59:13" pos:end="59:20">uint32_t</name></type> <name pos:start="59:22" pos:end="59:31">pml4e_addr</name></decl>;</decl_stmt>

            <decl_stmt pos:start="61:13" pos:end="61:27"><decl pos:start="61:13" pos:end="61:26"><type pos:start="61:13" pos:end="61:20"><name pos:start="61:13" pos:end="61:20">uint64_t</name></type> <name pos:start="61:22" pos:end="61:26">pml4e</name></decl>;</decl_stmt>

            <decl_stmt pos:start="63:13" pos:end="63:25"><decl pos:start="63:13" pos:end="63:24"><type pos:start="63:13" pos:end="63:19"><name pos:start="63:13" pos:end="63:19">int32_t</name></type> <name pos:start="63:21" pos:end="63:24">sext</name></decl>;</decl_stmt>



            <comment type="block" pos:start="67:13" pos:end="67:53">/* test virtual address sign extension */</comment>

            <expr_stmt pos:start="69:13" pos:end="69:39"><expr pos:start="69:13" pos:end="69:38"><name pos:start="69:13" pos:end="69:16">sext</name> <operator pos:start="69:18" pos:end="69:18">=</operator> <operator pos:start="69:20" pos:end="69:20">(</operator><name pos:start="69:21" pos:end="69:27">int64_t</name><operator pos:start="69:28" pos:end="69:28">)</operator><name pos:start="69:29" pos:end="69:32">addr</name> <operator pos:start="69:34" pos:end="69:35">&gt;&gt;</operator> <literal type="number" pos:start="69:37" pos:end="69:38">47</literal></expr>;</expr_stmt>

            <if_stmt pos:start="71:13" pos:end="77:13"><if pos:start="71:13" pos:end="77:13">if <condition pos:start="71:16" pos:end="71:40">(<expr pos:start="71:17" pos:end="71:39"><name pos:start="71:17" pos:end="71:20">sext</name> <operator pos:start="71:22" pos:end="71:23">!=</operator> <literal type="number" pos:start="71:25" pos:end="71:25">0</literal> <operator pos:start="71:27" pos:end="71:28">&amp;&amp;</operator> <name pos:start="71:30" pos:end="71:33">sext</name> <operator pos:start="71:35" pos:end="71:36">!=</operator> <operator pos:start="71:38" pos:end="71:38">-</operator><literal type="number" pos:start="71:39" pos:end="71:39">1</literal></expr>)</condition> <block pos:start="71:42" pos:end="77:13">{<block_content pos:start="73:17" pos:end="75:30">

                <expr_stmt pos:start="73:17" pos:end="73:31"><expr pos:start="73:17" pos:end="73:30"><name pos:start="73:17" pos:end="73:26">error_code</name> <operator pos:start="73:28" pos:end="73:28">=</operator> <literal type="number" pos:start="73:30" pos:end="73:30">0</literal></expr>;</expr_stmt>

                <goto pos:start="75:17" pos:end="75:30">goto <name pos:start="75:22" pos:end="75:29">do_fault</name>;</goto>

            </block_content>}</block></if></if_stmt>

            

            <expr_stmt pos:start="81:13" pos:end="83:30"><expr pos:start="81:13" pos:end="83:29"><name pos:start="81:13" pos:end="81:22">pml4e_addr</name> <operator pos:start="81:24" pos:end="81:24">=</operator> <operator pos:start="81:26" pos:end="81:26">(</operator><operator pos:start="81:27" pos:end="81:27">(</operator><name pos:start="81:28" pos:end="81:37"><name pos:start="81:28" pos:end="81:30">env</name><operator pos:start="81:31" pos:end="81:32">-&gt;</operator><name pos:start="81:33" pos:end="81:34">cr</name><index pos:start="81:35" pos:end="81:37">[<expr pos:start="81:36" pos:end="81:36"><literal type="number" pos:start="81:36" pos:end="81:36">3</literal></expr>]</index></name> <operator pos:start="81:39" pos:end="81:39">&amp;</operator> <operator pos:start="81:41" pos:end="81:41">~</operator><literal type="number" pos:start="81:42" pos:end="81:46">0xfff</literal><operator pos:start="81:47" pos:end="81:47">)</operator> <operator pos:start="81:49" pos:end="81:49">+</operator> <operator pos:start="81:51" pos:end="81:51">(</operator><operator pos:start="81:52" pos:end="81:52">(</operator><operator pos:start="81:53" pos:end="81:53">(</operator><name pos:start="81:54" pos:end="81:57">addr</name> <operator pos:start="81:59" pos:end="81:60">&gt;&gt;</operator> <literal type="number" pos:start="81:62" pos:end="81:63">39</literal><operator pos:start="81:64" pos:end="81:64">)</operator> <operator pos:start="81:66" pos:end="81:66">&amp;</operator> <literal type="number" pos:start="81:68" pos:end="81:72">0x1ff</literal><operator pos:start="81:73" pos:end="81:73">)</operator> <operator pos:start="81:75" pos:end="81:76">&lt;&lt;</operator> <literal type="number" pos:start="81:78" pos:end="81:78">3</literal><operator pos:start="81:79" pos:end="81:79">)</operator><operator pos:start="81:80" pos:end="81:80">)</operator> <operator pos:start="81:82" pos:end="81:82">&amp;</operator> 

                <name pos:start="83:17" pos:end="83:29"><name pos:start="83:17" pos:end="83:19">env</name><operator pos:start="83:20" pos:end="83:21">-&gt;</operator><name pos:start="83:22" pos:end="83:29">a20_mask</name></name></expr>;</expr_stmt>

            <expr_stmt pos:start="85:13" pos:end="85:41"><expr pos:start="85:13" pos:end="85:40"><name pos:start="85:13" pos:end="85:17">pml4e</name> <operator pos:start="85:19" pos:end="85:19">=</operator> <call pos:start="85:21" pos:end="85:40"><name pos:start="85:21" pos:end="85:28">ldq_phys</name><argument_list pos:start="85:29" pos:end="85:40">(<argument pos:start="85:30" pos:end="85:39"><expr pos:start="85:30" pos:end="85:39"><name pos:start="85:30" pos:end="85:39">pml4e_addr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <if_stmt pos:start="87:13" pos:end="93:13"><if pos:start="87:13" pos:end="93:13">if <condition pos:start="87:16" pos:end="87:43">(<expr pos:start="87:17" pos:end="87:42"><operator pos:start="87:17" pos:end="87:17">!</operator><operator pos:start="87:18" pos:end="87:18">(</operator><name pos:start="87:19" pos:end="87:23">pml4e</name> <operator pos:start="87:25" pos:end="87:25">&amp;</operator> <name pos:start="87:27" pos:end="87:41">PG_PRESENT_MASK</name><operator pos:start="87:42" pos:end="87:42">)</operator></expr>)</condition> <block pos:start="87:45" pos:end="93:13">{<block_content pos:start="89:17" pos:end="91:30">

                <expr_stmt pos:start="89:17" pos:end="89:31"><expr pos:start="89:17" pos:end="89:30"><name pos:start="89:17" pos:end="89:26">error_code</name> <operator pos:start="89:28" pos:end="89:28">=</operator> <literal type="number" pos:start="89:30" pos:end="89:30">0</literal></expr>;</expr_stmt>

                <goto pos:start="91:17" pos:end="91:30">goto <name pos:start="91:22" pos:end="91:29">do_fault</name>;</goto>

            </block_content>}</block></if></if_stmt>

            <if_stmt pos:start="95:13" pos:end="101:13"><if pos:start="95:13" pos:end="101:13">if <condition pos:start="95:16" pos:end="95:68">(<expr pos:start="95:17" pos:end="95:67"><operator pos:start="95:17" pos:end="95:17">!</operator><operator pos:start="95:18" pos:end="95:18">(</operator><name pos:start="95:19" pos:end="95:27"><name pos:start="95:19" pos:end="95:21">env</name><operator pos:start="95:22" pos:end="95:23">-&gt;</operator><name pos:start="95:24" pos:end="95:27">efer</name></name> <operator pos:start="95:29" pos:end="95:29">&amp;</operator> <name pos:start="95:31" pos:end="95:42">MSR_EFER_NXE</name><operator pos:start="95:43" pos:end="95:43">)</operator> <operator pos:start="95:45" pos:end="95:46">&amp;&amp;</operator> <operator pos:start="95:48" pos:end="95:48">(</operator><name pos:start="95:49" pos:end="95:53">pml4e</name> <operator pos:start="95:55" pos:end="95:55">&amp;</operator> <name pos:start="95:57" pos:end="95:66">PG_NX_MASK</name><operator pos:start="95:67" pos:end="95:67">)</operator></expr>)</condition> <block pos:start="95:70" pos:end="101:13">{<block_content pos:start="97:17" pos:end="99:30">

                <expr_stmt pos:start="97:17" pos:end="97:48"><expr pos:start="97:17" pos:end="97:47"><name pos:start="97:17" pos:end="97:26">error_code</name> <operator pos:start="97:28" pos:end="97:28">=</operator> <name pos:start="97:30" pos:end="97:47">PG_ERROR_RSVD_MASK</name></expr>;</expr_stmt>

                <goto pos:start="99:17" pos:end="99:30">goto <name pos:start="99:22" pos:end="99:29">do_fault</name>;</goto>

            </block_content>}</block></if></if_stmt>

            <if_stmt pos:start="103:13" pos:end="109:13"><if pos:start="103:13" pos:end="109:13">if <condition pos:start="103:16" pos:end="103:44">(<expr pos:start="103:17" pos:end="103:43"><operator pos:start="103:17" pos:end="103:17">!</operator><operator pos:start="103:18" pos:end="103:18">(</operator><name pos:start="103:19" pos:end="103:23">pml4e</name> <operator pos:start="103:25" pos:end="103:25">&amp;</operator> <name pos:start="103:27" pos:end="103:42">PG_ACCESSED_MASK</name><operator pos:start="103:43" pos:end="103:43">)</operator></expr>)</condition> <block pos:start="103:46" pos:end="109:13">{<block_content pos:start="105:17" pos:end="107:53">

                <expr_stmt pos:start="105:17" pos:end="105:42"><expr pos:start="105:17" pos:end="105:41"><name pos:start="105:17" pos:end="105:21">pml4e</name> <operator pos:start="105:23" pos:end="105:24">|=</operator> <name pos:start="105:26" pos:end="105:41">PG_ACCESSED_MASK</name></expr>;</expr_stmt>

                <expr_stmt pos:start="107:17" pos:end="107:53"><expr pos:start="107:17" pos:end="107:52"><call pos:start="107:17" pos:end="107:52"><name pos:start="107:17" pos:end="107:33">stl_phys_notdirty</name><argument_list pos:start="107:34" pos:end="107:52">(<argument pos:start="107:35" pos:end="107:44"><expr pos:start="107:35" pos:end="107:44"><name pos:start="107:35" pos:end="107:44">pml4e_addr</name></expr></argument>, <argument pos:start="107:47" pos:end="107:51"><expr pos:start="107:47" pos:end="107:51"><name pos:start="107:47" pos:end="107:51">pml4e</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            </block_content>}</block></if></if_stmt>

            <expr_stmt pos:start="111:13" pos:end="111:38"><expr pos:start="111:13" pos:end="111:37"><name pos:start="111:13" pos:end="111:16">ptep</name> <operator pos:start="111:18" pos:end="111:18">=</operator> <name pos:start="111:20" pos:end="111:24">pml4e</name> <operator pos:start="111:26" pos:end="111:26">^</operator> <name pos:start="111:28" pos:end="111:37">PG_NX_MASK</name></expr>;</expr_stmt>

            <expr_stmt pos:start="113:13" pos:end="115:30"><expr pos:start="113:13" pos:end="115:29"><name pos:start="113:13" pos:end="113:21">pdpe_addr</name> <operator pos:start="113:23" pos:end="113:23">=</operator> <operator pos:start="113:25" pos:end="113:25">(</operator><operator pos:start="113:26" pos:end="113:26">(</operator><name pos:start="113:27" pos:end="113:31">pml4e</name> <operator pos:start="113:33" pos:end="113:33">&amp;</operator> <name pos:start="113:35" pos:end="113:48">PHYS_ADDR_MASK</name><operator pos:start="113:49" pos:end="113:49">)</operator> <operator pos:start="113:51" pos:end="113:51">+</operator> <operator pos:start="113:53" pos:end="113:53">(</operator><operator pos:start="113:54" pos:end="113:54">(</operator><operator pos:start="113:55" pos:end="113:55">(</operator><name pos:start="113:56" pos:end="113:59">addr</name> <operator pos:start="113:61" pos:end="113:62">&gt;&gt;</operator> <literal type="number" pos:start="113:64" pos:end="113:65">30</literal><operator pos:start="113:66" pos:end="113:66">)</operator> <operator pos:start="113:68" pos:end="113:68">&amp;</operator> <literal type="number" pos:start="113:70" pos:end="113:74">0x1ff</literal><operator pos:start="113:75" pos:end="113:75">)</operator> <operator pos:start="113:77" pos:end="113:78">&lt;&lt;</operator> <literal type="number" pos:start="113:80" pos:end="113:80">3</literal><operator pos:start="113:81" pos:end="113:81">)</operator><operator pos:start="113:82" pos:end="113:82">)</operator> <operator pos:start="113:84" pos:end="113:84">&amp;</operator> 

                <name pos:start="115:17" pos:end="115:29"><name pos:start="115:17" pos:end="115:19">env</name><operator pos:start="115:20" pos:end="115:21">-&gt;</operator><name pos:start="115:22" pos:end="115:29">a20_mask</name></name></expr>;</expr_stmt>

            <expr_stmt pos:start="117:13" pos:end="117:39"><expr pos:start="117:13" pos:end="117:38"><name pos:start="117:13" pos:end="117:16">pdpe</name> <operator pos:start="117:18" pos:end="117:18">=</operator> <call pos:start="117:20" pos:end="117:38"><name pos:start="117:20" pos:end="117:27">ldq_phys</name><argument_list pos:start="117:28" pos:end="117:38">(<argument pos:start="117:29" pos:end="117:37"><expr pos:start="117:29" pos:end="117:37"><name pos:start="117:29" pos:end="117:37">pdpe_addr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <if_stmt pos:start="119:13" pos:end="125:13"><if pos:start="119:13" pos:end="125:13">if <condition pos:start="119:16" pos:end="119:42">(<expr pos:start="119:17" pos:end="119:41"><operator pos:start="119:17" pos:end="119:17">!</operator><operator pos:start="119:18" pos:end="119:18">(</operator><name pos:start="119:19" pos:end="119:22">pdpe</name> <operator pos:start="119:24" pos:end="119:24">&amp;</operator> <name pos:start="119:26" pos:end="119:40">PG_PRESENT_MASK</name><operator pos:start="119:41" pos:end="119:41">)</operator></expr>)</condition> <block pos:start="119:44" pos:end="125:13">{<block_content pos:start="121:17" pos:end="123:30">

                <expr_stmt pos:start="121:17" pos:end="121:31"><expr pos:start="121:17" pos:end="121:30"><name pos:start="121:17" pos:end="121:26">error_code</name> <operator pos:start="121:28" pos:end="121:28">=</operator> <literal type="number" pos:start="121:30" pos:end="121:30">0</literal></expr>;</expr_stmt>

                <goto pos:start="123:17" pos:end="123:30">goto <name pos:start="123:22" pos:end="123:29">do_fault</name>;</goto>

            </block_content>}</block></if></if_stmt>

            <if_stmt pos:start="127:13" pos:end="133:13"><if pos:start="127:13" pos:end="133:13">if <condition pos:start="127:16" pos:end="127:67">(<expr pos:start="127:17" pos:end="127:66"><operator pos:start="127:17" pos:end="127:17">!</operator><operator pos:start="127:18" pos:end="127:18">(</operator><name pos:start="127:19" pos:end="127:27"><name pos:start="127:19" pos:end="127:21">env</name><operator pos:start="127:22" pos:end="127:23">-&gt;</operator><name pos:start="127:24" pos:end="127:27">efer</name></name> <operator pos:start="127:29" pos:end="127:29">&amp;</operator> <name pos:start="127:31" pos:end="127:42">MSR_EFER_NXE</name><operator pos:start="127:43" pos:end="127:43">)</operator> <operator pos:start="127:45" pos:end="127:46">&amp;&amp;</operator> <operator pos:start="127:48" pos:end="127:48">(</operator><name pos:start="127:49" pos:end="127:52">pdpe</name> <operator pos:start="127:54" pos:end="127:54">&amp;</operator> <name pos:start="127:56" pos:end="127:65">PG_NX_MASK</name><operator pos:start="127:66" pos:end="127:66">)</operator></expr>)</condition> <block pos:start="127:69" pos:end="133:13">{<block_content pos:start="129:17" pos:end="131:30">

                <expr_stmt pos:start="129:17" pos:end="129:48"><expr pos:start="129:17" pos:end="129:47"><name pos:start="129:17" pos:end="129:26">error_code</name> <operator pos:start="129:28" pos:end="129:28">=</operator> <name pos:start="129:30" pos:end="129:47">PG_ERROR_RSVD_MASK</name></expr>;</expr_stmt>

                <goto pos:start="131:17" pos:end="131:30">goto <name pos:start="131:22" pos:end="131:29">do_fault</name>;</goto>

            </block_content>}</block></if></if_stmt>

            <expr_stmt pos:start="135:13" pos:end="135:38"><expr pos:start="135:13" pos:end="135:37"><name pos:start="135:13" pos:end="135:16">ptep</name> <operator pos:start="135:18" pos:end="135:19">&amp;=</operator> <name pos:start="135:21" pos:end="135:24">pdpe</name> <operator pos:start="135:26" pos:end="135:26">^</operator> <name pos:start="135:28" pos:end="135:37">PG_NX_MASK</name></expr>;</expr_stmt>

            <if_stmt pos:start="137:13" pos:end="143:13"><if pos:start="137:13" pos:end="143:13">if <condition pos:start="137:16" pos:end="137:43">(<expr pos:start="137:17" pos:end="137:42"><operator pos:start="137:17" pos:end="137:17">!</operator><operator pos:start="137:18" pos:end="137:18">(</operator><name pos:start="137:19" pos:end="137:22">pdpe</name> <operator pos:start="137:24" pos:end="137:24">&amp;</operator> <name pos:start="137:26" pos:end="137:41">PG_ACCESSED_MASK</name><operator pos:start="137:42" pos:end="137:42">)</operator></expr>)</condition> <block pos:start="137:45" pos:end="143:13">{<block_content pos:start="139:17" pos:end="141:51">

                <expr_stmt pos:start="139:17" pos:end="139:41"><expr pos:start="139:17" pos:end="139:40"><name pos:start="139:17" pos:end="139:20">pdpe</name> <operator pos:start="139:22" pos:end="139:23">|=</operator> <name pos:start="139:25" pos:end="139:40">PG_ACCESSED_MASK</name></expr>;</expr_stmt>

                <expr_stmt pos:start="141:17" pos:end="141:51"><expr pos:start="141:17" pos:end="141:50"><call pos:start="141:17" pos:end="141:50"><name pos:start="141:17" pos:end="141:33">stl_phys_notdirty</name><argument_list pos:start="141:34" pos:end="141:50">(<argument pos:start="141:35" pos:end="141:43"><expr pos:start="141:35" pos:end="141:43"><name pos:start="141:35" pos:end="141:43">pdpe_addr</name></expr></argument>, <argument pos:start="141:46" pos:end="141:49"><expr pos:start="141:46" pos:end="141:49"><name pos:start="141:46" pos:end="141:49">pdpe</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            </block_content>}</block></if></if_stmt>

        </block_content>}</block></if> <else pos:start="145:11" pos:end="169:9">else

<cpp:endif pos:start="147:1" pos:end="147:6">#<cpp:directive pos:start="147:2" pos:end="147:6">endif</cpp:directive></cpp:endif>

        <block pos:start="149:9" pos:end="169:9">{<block_content pos:start="153:13" pos:end="167:58">

            <comment type="block" pos:start="151:13" pos:end="151:53">/* XXX: load them when cr3 is loaded ? */</comment>

            <expr_stmt pos:start="153:13" pos:end="155:30"><expr pos:start="153:13" pos:end="155:29"><name pos:start="153:13" pos:end="153:21">pdpe_addr</name> <operator pos:start="153:23" pos:end="153:23">=</operator> <operator pos:start="153:25" pos:end="153:25">(</operator><operator pos:start="153:26" pos:end="153:26">(</operator><name pos:start="153:27" pos:end="153:36"><name pos:start="153:27" pos:end="153:29">env</name><operator pos:start="153:30" pos:end="153:31">-&gt;</operator><name pos:start="153:32" pos:end="153:33">cr</name><index pos:start="153:34" pos:end="153:36">[<expr pos:start="153:35" pos:end="153:35"><literal type="number" pos:start="153:35" pos:end="153:35">3</literal></expr>]</index></name> <operator pos:start="153:38" pos:end="153:38">&amp;</operator> <operator pos:start="153:40" pos:end="153:40">~</operator><literal type="number" pos:start="153:41" pos:end="153:44">0x1f</literal><operator pos:start="153:45" pos:end="153:45">)</operator> <operator pos:start="153:47" pos:end="153:47">+</operator> <operator pos:start="153:49" pos:end="153:49">(</operator><operator pos:start="153:50" pos:end="153:50">(</operator><name pos:start="153:51" pos:end="153:54">addr</name> <operator pos:start="153:56" pos:end="153:57">&gt;&gt;</operator> <literal type="number" pos:start="153:59" pos:end="153:60">30</literal><operator pos:start="153:61" pos:end="153:61">)</operator> <operator pos:start="153:63" pos:end="153:64">&lt;&lt;</operator> <literal type="number" pos:start="153:66" pos:end="153:66">3</literal><operator pos:start="153:67" pos:end="153:67">)</operator><operator pos:start="153:68" pos:end="153:68">)</operator> <operator pos:start="153:70" pos:end="153:70">&amp;</operator> 

                <name pos:start="155:17" pos:end="155:29"><name pos:start="155:17" pos:end="155:19">env</name><operator pos:start="155:20" pos:end="155:21">-&gt;</operator><name pos:start="155:22" pos:end="155:29">a20_mask</name></name></expr>;</expr_stmt>

            <expr_stmt pos:start="157:13" pos:end="157:39"><expr pos:start="157:13" pos:end="157:38"><name pos:start="157:13" pos:end="157:16">pdpe</name> <operator pos:start="157:18" pos:end="157:18">=</operator> <call pos:start="157:20" pos:end="157:38"><name pos:start="157:20" pos:end="157:27">ldq_phys</name><argument_list pos:start="157:28" pos:end="157:38">(<argument pos:start="157:29" pos:end="157:37"><expr pos:start="157:29" pos:end="157:37"><name pos:start="157:29" pos:end="157:37">pdpe_addr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <if_stmt pos:start="159:13" pos:end="165:13"><if pos:start="159:13" pos:end="165:13">if <condition pos:start="159:16" pos:end="159:42">(<expr pos:start="159:17" pos:end="159:41"><operator pos:start="159:17" pos:end="159:17">!</operator><operator pos:start="159:18" pos:end="159:18">(</operator><name pos:start="159:19" pos:end="159:22">pdpe</name> <operator pos:start="159:24" pos:end="159:24">&amp;</operator> <name pos:start="159:26" pos:end="159:40">PG_PRESENT_MASK</name><operator pos:start="159:41" pos:end="159:41">)</operator></expr>)</condition> <block pos:start="159:44" pos:end="165:13">{<block_content pos:start="161:17" pos:end="163:30">

                <expr_stmt pos:start="161:17" pos:end="161:31"><expr pos:start="161:17" pos:end="161:30"><name pos:start="161:17" pos:end="161:26">error_code</name> <operator pos:start="161:28" pos:end="161:28">=</operator> <literal type="number" pos:start="161:30" pos:end="161:30">0</literal></expr>;</expr_stmt>

                <goto pos:start="163:17" pos:end="163:30">goto <name pos:start="163:22" pos:end="163:29">do_fault</name>;</goto>

            </block_content>}</block></if></if_stmt>

            <expr_stmt pos:start="167:13" pos:end="167:58"><expr pos:start="167:13" pos:end="167:57"><name pos:start="167:13" pos:end="167:16">ptep</name> <operator pos:start="167:18" pos:end="167:18">=</operator> <name pos:start="167:20" pos:end="167:29">PG_NX_MASK</name> <operator pos:start="167:31" pos:end="167:31">|</operator> <name pos:start="167:33" pos:end="167:44">PG_USER_MASK</name> <operator pos:start="167:46" pos:end="167:46">|</operator> <name pos:start="167:48" pos:end="167:57">PG_RW_MASK</name></expr>;</expr_stmt>

        </block_content>}</block></else></if_stmt>



        <expr_stmt pos:start="173:9" pos:end="175:26"><expr pos:start="173:9" pos:end="175:25"><name pos:start="173:9" pos:end="173:16">pde_addr</name> <operator pos:start="173:18" pos:end="173:18">=</operator> <operator pos:start="173:20" pos:end="173:20">(</operator><operator pos:start="173:21" pos:end="173:21">(</operator><name pos:start="173:22" pos:end="173:25">pdpe</name> <operator pos:start="173:27" pos:end="173:27">&amp;</operator> <name pos:start="173:29" pos:end="173:42">PHYS_ADDR_MASK</name><operator pos:start="173:43" pos:end="173:43">)</operator> <operator pos:start="173:45" pos:end="173:45">+</operator> <operator pos:start="173:47" pos:end="173:47">(</operator><operator pos:start="173:48" pos:end="173:48">(</operator><operator pos:start="173:49" pos:end="173:49">(</operator><name pos:start="173:50" pos:end="173:53">addr</name> <operator pos:start="173:55" pos:end="173:56">&gt;&gt;</operator> <literal type="number" pos:start="173:58" pos:end="173:59">21</literal><operator pos:start="173:60" pos:end="173:60">)</operator> <operator pos:start="173:62" pos:end="173:62">&amp;</operator> <literal type="number" pos:start="173:64" pos:end="173:68">0x1ff</literal><operator pos:start="173:69" pos:end="173:69">)</operator> <operator pos:start="173:71" pos:end="173:72">&lt;&lt;</operator> <literal type="number" pos:start="173:74" pos:end="173:74">3</literal><operator pos:start="173:75" pos:end="173:75">)</operator><operator pos:start="173:76" pos:end="173:76">)</operator> <operator pos:start="173:78" pos:end="173:78">&amp;</operator>

            <name pos:start="175:13" pos:end="175:25"><name pos:start="175:13" pos:end="175:15">env</name><operator pos:start="175:16" pos:end="175:17">-&gt;</operator><name pos:start="175:18" pos:end="175:25">a20_mask</name></name></expr>;</expr_stmt>

        <expr_stmt pos:start="177:9" pos:end="177:33"><expr pos:start="177:9" pos:end="177:32"><name pos:start="177:9" pos:end="177:11">pde</name> <operator pos:start="177:13" pos:end="177:13">=</operator> <call pos:start="177:15" pos:end="177:32"><name pos:start="177:15" pos:end="177:22">ldq_phys</name><argument_list pos:start="177:23" pos:end="177:32">(<argument pos:start="177:24" pos:end="177:31"><expr pos:start="177:24" pos:end="177:31"><name pos:start="177:24" pos:end="177:31">pde_addr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="179:9" pos:end="185:9"><if pos:start="179:9" pos:end="185:9">if <condition pos:start="179:12" pos:end="179:37">(<expr pos:start="179:13" pos:end="179:36"><operator pos:start="179:13" pos:end="179:13">!</operator><operator pos:start="179:14" pos:end="179:14">(</operator><name pos:start="179:15" pos:end="179:17">pde</name> <operator pos:start="179:19" pos:end="179:19">&amp;</operator> <name pos:start="179:21" pos:end="179:35">PG_PRESENT_MASK</name><operator pos:start="179:36" pos:end="179:36">)</operator></expr>)</condition> <block pos:start="179:39" pos:end="185:9">{<block_content pos:start="181:13" pos:end="183:26">

            <expr_stmt pos:start="181:13" pos:end="181:27"><expr pos:start="181:13" pos:end="181:26"><name pos:start="181:13" pos:end="181:22">error_code</name> <operator pos:start="181:24" pos:end="181:24">=</operator> <literal type="number" pos:start="181:26" pos:end="181:26">0</literal></expr>;</expr_stmt>

            <goto pos:start="183:13" pos:end="183:26">goto <name pos:start="183:18" pos:end="183:25">do_fault</name>;</goto>

        </block_content>}</block></if></if_stmt>

        <if_stmt pos:start="187:9" pos:end="193:9"><if pos:start="187:9" pos:end="193:9">if <condition pos:start="187:12" pos:end="187:62">(<expr pos:start="187:13" pos:end="187:61"><operator pos:start="187:13" pos:end="187:13">!</operator><operator pos:start="187:14" pos:end="187:14">(</operator><name pos:start="187:15" pos:end="187:23"><name pos:start="187:15" pos:end="187:17">env</name><operator pos:start="187:18" pos:end="187:19">-&gt;</operator><name pos:start="187:20" pos:end="187:23">efer</name></name> <operator pos:start="187:25" pos:end="187:25">&amp;</operator> <name pos:start="187:27" pos:end="187:38">MSR_EFER_NXE</name><operator pos:start="187:39" pos:end="187:39">)</operator> <operator pos:start="187:41" pos:end="187:42">&amp;&amp;</operator> <operator pos:start="187:44" pos:end="187:44">(</operator><name pos:start="187:45" pos:end="187:47">pde</name> <operator pos:start="187:49" pos:end="187:49">&amp;</operator> <name pos:start="187:51" pos:end="187:60">PG_NX_MASK</name><operator pos:start="187:61" pos:end="187:61">)</operator></expr>)</condition> <block pos:start="187:64" pos:end="193:9">{<block_content pos:start="189:13" pos:end="191:26">

            <expr_stmt pos:start="189:13" pos:end="189:44"><expr pos:start="189:13" pos:end="189:43"><name pos:start="189:13" pos:end="189:22">error_code</name> <operator pos:start="189:24" pos:end="189:24">=</operator> <name pos:start="189:26" pos:end="189:43">PG_ERROR_RSVD_MASK</name></expr>;</expr_stmt>

            <goto pos:start="191:13" pos:end="191:26">goto <name pos:start="191:18" pos:end="191:25">do_fault</name>;</goto>

        </block_content>}</block></if></if_stmt>

        <expr_stmt pos:start="195:9" pos:end="195:33"><expr pos:start="195:9" pos:end="195:32"><name pos:start="195:9" pos:end="195:12">ptep</name> <operator pos:start="195:14" pos:end="195:15">&amp;=</operator> <name pos:start="195:17" pos:end="195:19">pde</name> <operator pos:start="195:21" pos:end="195:21">^</operator> <name pos:start="195:23" pos:end="195:32">PG_NX_MASK</name></expr>;</expr_stmt>

        <if_stmt pos:start="197:9" pos:end="333:9"><if pos:start="197:9" pos:end="249:9">if <condition pos:start="197:12" pos:end="197:30">(<expr pos:start="197:13" pos:end="197:29"><name pos:start="197:13" pos:end="197:15">pde</name> <operator pos:start="197:17" pos:end="197:17">&amp;</operator> <name pos:start="197:19" pos:end="197:29">PG_PSE_MASK</name></expr>)</condition> <block pos:start="197:32" pos:end="249:9">{<block_content pos:start="201:13" pos:end="247:48">

            <comment type="block" pos:start="199:13" pos:end="199:27">/* 2 MB page */</comment>

            <expr_stmt pos:start="201:13" pos:end="201:36"><expr pos:start="201:13" pos:end="201:35"><name pos:start="201:13" pos:end="201:21">page_size</name> <operator pos:start="201:23" pos:end="201:23">=</operator> <literal type="number" pos:start="201:25" pos:end="201:28">2048</literal> <operator pos:start="201:30" pos:end="201:30">*</operator> <literal type="number" pos:start="201:32" pos:end="201:35">1024</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="203:13" pos:end="203:31"><expr pos:start="203:13" pos:end="203:30"><name pos:start="203:13" pos:end="203:16">ptep</name> <operator pos:start="203:18" pos:end="203:19">^=</operator> <name pos:start="203:21" pos:end="203:30">PG_NX_MASK</name></expr>;</expr_stmt>

            <if_stmt pos:start="205:13" pos:end="207:38"><if pos:start="205:13" pos:end="207:38">if <condition pos:start="205:16" pos:end="205:54">(<expr pos:start="205:17" pos:end="205:53"><operator pos:start="205:17" pos:end="205:17">(</operator><name pos:start="205:18" pos:end="205:21">ptep</name> <operator pos:start="205:23" pos:end="205:23">&amp;</operator> <name pos:start="205:25" pos:end="205:34">PG_NX_MASK</name><operator pos:start="205:35" pos:end="205:35">)</operator> <operator pos:start="205:37" pos:end="205:38">&amp;&amp;</operator> <name pos:start="205:40" pos:end="205:48">is_write1</name> <operator pos:start="205:50" pos:end="205:51">==</operator> <literal type="number" pos:start="205:53" pos:end="205:53">2</literal></expr>)</condition><block type="pseudo" pos:start="207:17" pos:end="207:38"><block_content pos:start="207:17" pos:end="207:38">

                <goto pos:start="207:17" pos:end="207:38">goto <name pos:start="207:22" pos:end="207:37">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

            <if_stmt pos:start="209:13" pos:end="227:13"><if pos:start="209:13" pos:end="219:13">if <condition pos:start="209:16" pos:end="209:24">(<expr pos:start="209:17" pos:end="209:23"><name pos:start="209:17" pos:end="209:23">is_user</name></expr>)</condition> <block pos:start="209:26" pos:end="219:13">{<block_content pos:start="211:17" pos:end="217:42">

                <if_stmt pos:start="211:17" pos:end="213:42"><if pos:start="211:17" pos:end="213:42">if <condition pos:start="211:20" pos:end="211:43">(<expr pos:start="211:21" pos:end="211:42"><operator pos:start="211:21" pos:end="211:21">!</operator><operator pos:start="211:22" pos:end="211:22">(</operator><name pos:start="211:23" pos:end="211:26">ptep</name> <operator pos:start="211:28" pos:end="211:28">&amp;</operator> <name pos:start="211:30" pos:end="211:41">PG_USER_MASK</name><operator pos:start="211:42" pos:end="211:42">)</operator></expr>)</condition><block type="pseudo" pos:start="213:21" pos:end="213:42"><block_content pos:start="213:21" pos:end="213:42">

                    <goto pos:start="213:21" pos:end="213:42">goto <name pos:start="213:26" pos:end="213:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

                <if_stmt pos:start="215:17" pos:end="217:42"><if pos:start="215:17" pos:end="217:42">if <condition pos:start="215:20" pos:end="215:53">(<expr pos:start="215:21" pos:end="215:52"><name pos:start="215:21" pos:end="215:28">is_write</name> <operator pos:start="215:30" pos:end="215:31">&amp;&amp;</operator> <operator pos:start="215:33" pos:end="215:33">!</operator><operator pos:start="215:34" pos:end="215:34">(</operator><name pos:start="215:35" pos:end="215:38">ptep</name> <operator pos:start="215:40" pos:end="215:40">&amp;</operator> <name pos:start="215:42" pos:end="215:51">PG_RW_MASK</name><operator pos:start="215:52" pos:end="215:52">)</operator></expr>)</condition><block type="pseudo" pos:start="217:21" pos:end="217:42"><block_content pos:start="217:21" pos:end="217:42">

                    <goto pos:start="217:21" pos:end="217:42">goto <name pos:start="217:26" pos:end="217:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

            </block_content>}</block></if> <else pos:start="219:15" pos:end="227:13">else <block pos:start="219:20" pos:end="227:13">{<block_content pos:start="221:17" pos:end="225:42">

                <if_stmt pos:start="221:17" pos:end="225:42"><if pos:start="221:17" pos:end="225:42">if <condition pos:start="221:20" pos:end="223:53">(<expr pos:start="221:21" pos:end="223:52"><operator pos:start="221:21" pos:end="221:21">(</operator><name pos:start="221:22" pos:end="221:31"><name pos:start="221:22" pos:end="221:24">env</name><operator pos:start="221:25" pos:end="221:26">-&gt;</operator><name pos:start="221:27" pos:end="221:28">cr</name><index pos:start="221:29" pos:end="221:31">[<expr pos:start="221:30" pos:end="221:30"><literal type="number" pos:start="221:30" pos:end="221:30">0</literal></expr>]</index></name> <operator pos:start="221:33" pos:end="221:33">&amp;</operator> <name pos:start="221:35" pos:end="221:45">CR0_WP_MASK</name><operator pos:start="221:46" pos:end="221:46">)</operator> <operator pos:start="221:48" pos:end="221:49">&amp;&amp;</operator> 

                    <name pos:start="223:21" pos:end="223:28">is_write</name> <operator pos:start="223:30" pos:end="223:31">&amp;&amp;</operator> <operator pos:start="223:33" pos:end="223:33">!</operator><operator pos:start="223:34" pos:end="223:34">(</operator><name pos:start="223:35" pos:end="223:38">ptep</name> <operator pos:start="223:40" pos:end="223:40">&amp;</operator> <name pos:start="223:42" pos:end="223:51">PG_RW_MASK</name><operator pos:start="223:52" pos:end="223:52">)</operator></expr>)</condition><block type="pseudo" pos:start="225:21" pos:end="225:42"><block_content pos:start="225:21" pos:end="225:42"> 

                    <goto pos:start="225:21" pos:end="225:42">goto <name pos:start="225:26" pos:end="225:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

            </block_content>}</block></else></if_stmt>

            <expr_stmt pos:start="229:13" pos:end="229:58"><expr pos:start="229:13" pos:end="229:57"><name pos:start="229:13" pos:end="229:20">is_dirty</name> <operator pos:start="229:22" pos:end="229:22">=</operator> <name pos:start="229:24" pos:end="229:31">is_write</name> <operator pos:start="229:33" pos:end="229:34">&amp;&amp;</operator> <operator pos:start="229:36" pos:end="229:36">!</operator><operator pos:start="229:37" pos:end="229:37">(</operator><name pos:start="229:38" pos:end="229:40">pde</name> <operator pos:start="229:42" pos:end="229:42">&amp;</operator> <name pos:start="229:44" pos:end="229:56">PG_DIRTY_MASK</name><operator pos:start="229:57" pos:end="229:57">)</operator></expr>;</expr_stmt>

            <if_stmt pos:start="231:13" pos:end="241:13"><if pos:start="231:13" pos:end="241:13">if <condition pos:start="231:16" pos:end="231:54">(<expr pos:start="231:17" pos:end="231:53"><operator pos:start="231:17" pos:end="231:17">!</operator><operator pos:start="231:18" pos:end="231:18">(</operator><name pos:start="231:19" pos:end="231:21">pde</name> <operator pos:start="231:23" pos:end="231:23">&amp;</operator> <name pos:start="231:25" pos:end="231:40">PG_ACCESSED_MASK</name><operator pos:start="231:41" pos:end="231:41">)</operator> <operator pos:start="231:43" pos:end="231:44">||</operator> <name pos:start="231:46" pos:end="231:53">is_dirty</name></expr>)</condition> <block pos:start="231:56" pos:end="241:13">{<block_content pos:start="233:17" pos:end="239:49">

                <expr_stmt pos:start="233:17" pos:end="233:40"><expr pos:start="233:17" pos:end="233:39"><name pos:start="233:17" pos:end="233:19">pde</name> <operator pos:start="233:21" pos:end="233:22">|=</operator> <name pos:start="233:24" pos:end="233:39">PG_ACCESSED_MASK</name></expr>;</expr_stmt>

                <if_stmt pos:start="235:17" pos:end="237:41"><if pos:start="235:17" pos:end="237:41">if <condition pos:start="235:20" pos:end="235:29">(<expr pos:start="235:21" pos:end="235:28"><name pos:start="235:21" pos:end="235:28">is_dirty</name></expr>)</condition><block type="pseudo" pos:start="237:21" pos:end="237:41"><block_content pos:start="237:21" pos:end="237:41">

                    <expr_stmt pos:start="237:21" pos:end="237:41"><expr pos:start="237:21" pos:end="237:40"><name pos:start="237:21" pos:end="237:23">pde</name> <operator pos:start="237:25" pos:end="237:26">|=</operator> <name pos:start="237:28" pos:end="237:40">PG_DIRTY_MASK</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

                <expr_stmt pos:start="239:17" pos:end="239:49"><expr pos:start="239:17" pos:end="239:48"><call pos:start="239:17" pos:end="239:48"><name pos:start="239:17" pos:end="239:33">stl_phys_notdirty</name><argument_list pos:start="239:34" pos:end="239:48">(<argument pos:start="239:35" pos:end="239:42"><expr pos:start="239:35" pos:end="239:42"><name pos:start="239:35" pos:end="239:42">pde_addr</name></expr></argument>, <argument pos:start="239:45" pos:end="239:47"><expr pos:start="239:45" pos:end="239:47"><name pos:start="239:45" pos:end="239:47">pde</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            </block_content>}</block></if></if_stmt>

            <comment type="block" pos:start="243:13" pos:end="243:36">/* align to page_size */</comment>

            <expr_stmt pos:start="245:13" pos:end="245:70"><expr pos:start="245:13" pos:end="245:69"><name pos:start="245:13" pos:end="245:15">pte</name> <operator pos:start="245:17" pos:end="245:17">=</operator> <name pos:start="245:19" pos:end="245:21">pde</name> <operator pos:start="245:23" pos:end="245:23">&amp;</operator> <operator pos:start="245:25" pos:end="245:25">(</operator><operator pos:start="245:26" pos:end="245:26">(</operator><name pos:start="245:27" pos:end="245:40">PHYS_ADDR_MASK</name> <operator pos:start="245:42" pos:end="245:42">&amp;</operator> <operator pos:start="245:44" pos:end="245:44">~</operator><operator pos:start="245:45" pos:end="245:45">(</operator><name pos:start="245:46" pos:end="245:54">page_size</name> <operator pos:start="245:56" pos:end="245:56">-</operator> <literal type="number" pos:start="245:58" pos:end="245:58">1</literal><operator pos:start="245:59" pos:end="245:59">)</operator><operator pos:start="245:60" pos:end="245:60">)</operator> <operator pos:start="245:62" pos:end="245:62">|</operator> <literal type="number" pos:start="245:64" pos:end="245:68">0xfff</literal><operator pos:start="245:69" pos:end="245:69">)</operator></expr>;</expr_stmt> 

            <expr_stmt pos:start="247:13" pos:end="247:48"><expr pos:start="247:13" pos:end="247:47"><name pos:start="247:13" pos:end="247:21">virt_addr</name> <operator pos:start="247:23" pos:end="247:23">=</operator> <name pos:start="247:25" pos:end="247:28">addr</name> <operator pos:start="247:30" pos:end="247:30">&amp;</operator> <operator pos:start="247:32" pos:end="247:32">~</operator><operator pos:start="247:33" pos:end="247:33">(</operator><name pos:start="247:34" pos:end="247:42">page_size</name> <operator pos:start="247:44" pos:end="247:44">-</operator> <literal type="number" pos:start="247:46" pos:end="247:46">1</literal><operator pos:start="247:47" pos:end="247:47">)</operator></expr>;</expr_stmt>

        </block_content>}</block></if> <else pos:start="249:11" pos:end="333:9">else <block pos:start="249:16" pos:end="333:9">{<block_content pos:start="253:13" pos:end="331:49">

            <comment type="block" pos:start="251:13" pos:end="251:27">/* 4 KB page */</comment>

            <if_stmt pos:start="253:13" pos:end="259:13"><if pos:start="253:13" pos:end="259:13">if <condition pos:start="253:16" pos:end="253:42">(<expr pos:start="253:17" pos:end="253:41"><operator pos:start="253:17" pos:end="253:17">!</operator><operator pos:start="253:18" pos:end="253:18">(</operator><name pos:start="253:19" pos:end="253:21">pde</name> <operator pos:start="253:23" pos:end="253:23">&amp;</operator> <name pos:start="253:25" pos:end="253:40">PG_ACCESSED_MASK</name><operator pos:start="253:41" pos:end="253:41">)</operator></expr>)</condition> <block pos:start="253:44" pos:end="259:13">{<block_content pos:start="255:17" pos:end="257:49">

                <expr_stmt pos:start="255:17" pos:end="255:40"><expr pos:start="255:17" pos:end="255:39"><name pos:start="255:17" pos:end="255:19">pde</name> <operator pos:start="255:21" pos:end="255:22">|=</operator> <name pos:start="255:24" pos:end="255:39">PG_ACCESSED_MASK</name></expr>;</expr_stmt>

                <expr_stmt pos:start="257:17" pos:end="257:49"><expr pos:start="257:17" pos:end="257:48"><call pos:start="257:17" pos:end="257:48"><name pos:start="257:17" pos:end="257:33">stl_phys_notdirty</name><argument_list pos:start="257:34" pos:end="257:48">(<argument pos:start="257:35" pos:end="257:42"><expr pos:start="257:35" pos:end="257:42"><name pos:start="257:35" pos:end="257:42">pde_addr</name></expr></argument>, <argument pos:start="257:45" pos:end="257:47"><expr pos:start="257:45" pos:end="257:47"><name pos:start="257:45" pos:end="257:47">pde</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            </block_content>}</block></if></if_stmt>

            <expr_stmt pos:start="261:13" pos:end="263:30"><expr pos:start="261:13" pos:end="263:29"><name pos:start="261:13" pos:end="261:20">pte_addr</name> <operator pos:start="261:22" pos:end="261:22">=</operator> <operator pos:start="261:24" pos:end="261:24">(</operator><operator pos:start="261:25" pos:end="261:25">(</operator><name pos:start="261:26" pos:end="261:28">pde</name> <operator pos:start="261:30" pos:end="261:30">&amp;</operator> <name pos:start="261:32" pos:end="261:45">PHYS_ADDR_MASK</name><operator pos:start="261:46" pos:end="261:46">)</operator> <operator pos:start="261:48" pos:end="261:48">+</operator> <operator pos:start="261:50" pos:end="261:50">(</operator><operator pos:start="261:51" pos:end="261:51">(</operator><operator pos:start="261:52" pos:end="261:52">(</operator><name pos:start="261:53" pos:end="261:56">addr</name> <operator pos:start="261:58" pos:end="261:59">&gt;&gt;</operator> <literal type="number" pos:start="261:61" pos:end="261:62">12</literal><operator pos:start="261:63" pos:end="261:63">)</operator> <operator pos:start="261:65" pos:end="261:65">&amp;</operator> <literal type="number" pos:start="261:67" pos:end="261:71">0x1ff</literal><operator pos:start="261:72" pos:end="261:72">)</operator> <operator pos:start="261:74" pos:end="261:75">&lt;&lt;</operator> <literal type="number" pos:start="261:77" pos:end="261:77">3</literal><operator pos:start="261:78" pos:end="261:78">)</operator><operator pos:start="261:79" pos:end="261:79">)</operator> <operator pos:start="261:81" pos:end="261:81">&amp;</operator>

                <name pos:start="263:17" pos:end="263:29"><name pos:start="263:17" pos:end="263:19">env</name><operator pos:start="263:20" pos:end="263:21">-&gt;</operator><name pos:start="263:22" pos:end="263:29">a20_mask</name></name></expr>;</expr_stmt>

            <expr_stmt pos:start="265:13" pos:end="265:37"><expr pos:start="265:13" pos:end="265:36"><name pos:start="265:13" pos:end="265:15">pte</name> <operator pos:start="265:17" pos:end="265:17">=</operator> <call pos:start="265:19" pos:end="265:36"><name pos:start="265:19" pos:end="265:26">ldq_phys</name><argument_list pos:start="265:27" pos:end="265:36">(<argument pos:start="265:28" pos:end="265:35"><expr pos:start="265:28" pos:end="265:35"><name pos:start="265:28" pos:end="265:35">pte_addr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <if_stmt pos:start="267:13" pos:end="273:13"><if pos:start="267:13" pos:end="273:13">if <condition pos:start="267:16" pos:end="267:41">(<expr pos:start="267:17" pos:end="267:40"><operator pos:start="267:17" pos:end="267:17">!</operator><operator pos:start="267:18" pos:end="267:18">(</operator><name pos:start="267:19" pos:end="267:21">pte</name> <operator pos:start="267:23" pos:end="267:23">&amp;</operator> <name pos:start="267:25" pos:end="267:39">PG_PRESENT_MASK</name><operator pos:start="267:40" pos:end="267:40">)</operator></expr>)</condition> <block pos:start="267:43" pos:end="273:13">{<block_content pos:start="269:17" pos:end="271:30">

                <expr_stmt pos:start="269:17" pos:end="269:31"><expr pos:start="269:17" pos:end="269:30"><name pos:start="269:17" pos:end="269:26">error_code</name> <operator pos:start="269:28" pos:end="269:28">=</operator> <literal type="number" pos:start="269:30" pos:end="269:30">0</literal></expr>;</expr_stmt>

                <goto pos:start="271:17" pos:end="271:30">goto <name pos:start="271:22" pos:end="271:29">do_fault</name>;</goto>

            </block_content>}</block></if></if_stmt>

            <if_stmt pos:start="275:13" pos:end="281:13"><if pos:start="275:13" pos:end="281:13">if <condition pos:start="275:16" pos:end="275:66">(<expr pos:start="275:17" pos:end="275:65"><operator pos:start="275:17" pos:end="275:17">!</operator><operator pos:start="275:18" pos:end="275:18">(</operator><name pos:start="275:19" pos:end="275:27"><name pos:start="275:19" pos:end="275:21">env</name><operator pos:start="275:22" pos:end="275:23">-&gt;</operator><name pos:start="275:24" pos:end="275:27">efer</name></name> <operator pos:start="275:29" pos:end="275:29">&amp;</operator> <name pos:start="275:31" pos:end="275:42">MSR_EFER_NXE</name><operator pos:start="275:43" pos:end="275:43">)</operator> <operator pos:start="275:45" pos:end="275:46">&amp;&amp;</operator> <operator pos:start="275:48" pos:end="275:48">(</operator><name pos:start="275:49" pos:end="275:51">pte</name> <operator pos:start="275:53" pos:end="275:53">&amp;</operator> <name pos:start="275:55" pos:end="275:64">PG_NX_MASK</name><operator pos:start="275:65" pos:end="275:65">)</operator></expr>)</condition> <block pos:start="275:68" pos:end="281:13">{<block_content pos:start="277:17" pos:end="279:30">

                <expr_stmt pos:start="277:17" pos:end="277:48"><expr pos:start="277:17" pos:end="277:47"><name pos:start="277:17" pos:end="277:26">error_code</name> <operator pos:start="277:28" pos:end="277:28">=</operator> <name pos:start="277:30" pos:end="277:47">PG_ERROR_RSVD_MASK</name></expr>;</expr_stmt>

                <goto pos:start="279:17" pos:end="279:30">goto <name pos:start="279:22" pos:end="279:29">do_fault</name>;</goto>

            </block_content>}</block></if></if_stmt>

            <comment type="block" pos:start="283:13" pos:end="283:65">/* combine pde and pte nx, user and rw protections */</comment>

            <expr_stmt pos:start="285:13" pos:end="285:37"><expr pos:start="285:13" pos:end="285:36"><name pos:start="285:13" pos:end="285:16">ptep</name> <operator pos:start="285:18" pos:end="285:19">&amp;=</operator> <name pos:start="285:21" pos:end="285:23">pte</name> <operator pos:start="285:25" pos:end="285:25">^</operator> <name pos:start="285:27" pos:end="285:36">PG_NX_MASK</name></expr>;</expr_stmt>

            <expr_stmt pos:start="287:13" pos:end="287:31"><expr pos:start="287:13" pos:end="287:30"><name pos:start="287:13" pos:end="287:16">ptep</name> <operator pos:start="287:18" pos:end="287:19">^=</operator> <name pos:start="287:21" pos:end="287:30">PG_NX_MASK</name></expr>;</expr_stmt>

            <if_stmt pos:start="289:13" pos:end="291:38"><if pos:start="289:13" pos:end="291:38">if <condition pos:start="289:16" pos:end="289:54">(<expr pos:start="289:17" pos:end="289:53"><operator pos:start="289:17" pos:end="289:17">(</operator><name pos:start="289:18" pos:end="289:21">ptep</name> <operator pos:start="289:23" pos:end="289:23">&amp;</operator> <name pos:start="289:25" pos:end="289:34">PG_NX_MASK</name><operator pos:start="289:35" pos:end="289:35">)</operator> <operator pos:start="289:37" pos:end="289:38">&amp;&amp;</operator> <name pos:start="289:40" pos:end="289:48">is_write1</name> <operator pos:start="289:50" pos:end="289:51">==</operator> <literal type="number" pos:start="289:53" pos:end="289:53">2</literal></expr>)</condition><block type="pseudo" pos:start="291:17" pos:end="291:38"><block_content pos:start="291:17" pos:end="291:38">

                <goto pos:start="291:17" pos:end="291:38">goto <name pos:start="291:22" pos:end="291:37">do_fault_protect</name>;</goto></block_content></block></if></if_stmt> 

            <if_stmt pos:start="293:13" pos:end="311:13"><if pos:start="293:13" pos:end="303:13">if <condition pos:start="293:16" pos:end="293:24">(<expr pos:start="293:17" pos:end="293:23"><name pos:start="293:17" pos:end="293:23">is_user</name></expr>)</condition> <block pos:start="293:26" pos:end="303:13">{<block_content pos:start="295:17" pos:end="301:42">

                <if_stmt pos:start="295:17" pos:end="297:42"><if pos:start="295:17" pos:end="297:42">if <condition pos:start="295:20" pos:end="295:43">(<expr pos:start="295:21" pos:end="295:42"><operator pos:start="295:21" pos:end="295:21">!</operator><operator pos:start="295:22" pos:end="295:22">(</operator><name pos:start="295:23" pos:end="295:26">ptep</name> <operator pos:start="295:28" pos:end="295:28">&amp;</operator> <name pos:start="295:30" pos:end="295:41">PG_USER_MASK</name><operator pos:start="295:42" pos:end="295:42">)</operator></expr>)</condition><block type="pseudo" pos:start="297:21" pos:end="297:42"><block_content pos:start="297:21" pos:end="297:42">

                    <goto pos:start="297:21" pos:end="297:42">goto <name pos:start="297:26" pos:end="297:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

                <if_stmt pos:start="299:17" pos:end="301:42"><if pos:start="299:17" pos:end="301:42">if <condition pos:start="299:20" pos:end="299:53">(<expr pos:start="299:21" pos:end="299:52"><name pos:start="299:21" pos:end="299:28">is_write</name> <operator pos:start="299:30" pos:end="299:31">&amp;&amp;</operator> <operator pos:start="299:33" pos:end="299:33">!</operator><operator pos:start="299:34" pos:end="299:34">(</operator><name pos:start="299:35" pos:end="299:38">ptep</name> <operator pos:start="299:40" pos:end="299:40">&amp;</operator> <name pos:start="299:42" pos:end="299:51">PG_RW_MASK</name><operator pos:start="299:52" pos:end="299:52">)</operator></expr>)</condition><block type="pseudo" pos:start="301:21" pos:end="301:42"><block_content pos:start="301:21" pos:end="301:42">

                    <goto pos:start="301:21" pos:end="301:42">goto <name pos:start="301:26" pos:end="301:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

            </block_content>}</block></if> <else pos:start="303:15" pos:end="311:13">else <block pos:start="303:20" pos:end="311:13">{<block_content pos:start="305:17" pos:end="309:42">

                <if_stmt pos:start="305:17" pos:end="309:42"><if pos:start="305:17" pos:end="309:42">if <condition pos:start="305:20" pos:end="307:53">(<expr pos:start="305:21" pos:end="307:52"><operator pos:start="305:21" pos:end="305:21">(</operator><name pos:start="305:22" pos:end="305:31"><name pos:start="305:22" pos:end="305:24">env</name><operator pos:start="305:25" pos:end="305:26">-&gt;</operator><name pos:start="305:27" pos:end="305:28">cr</name><index pos:start="305:29" pos:end="305:31">[<expr pos:start="305:30" pos:end="305:30"><literal type="number" pos:start="305:30" pos:end="305:30">0</literal></expr>]</index></name> <operator pos:start="305:33" pos:end="305:33">&amp;</operator> <name pos:start="305:35" pos:end="305:45">CR0_WP_MASK</name><operator pos:start="305:46" pos:end="305:46">)</operator> <operator pos:start="305:48" pos:end="305:49">&amp;&amp;</operator>

                    <name pos:start="307:21" pos:end="307:28">is_write</name> <operator pos:start="307:30" pos:end="307:31">&amp;&amp;</operator> <operator pos:start="307:33" pos:end="307:33">!</operator><operator pos:start="307:34" pos:end="307:34">(</operator><name pos:start="307:35" pos:end="307:38">ptep</name> <operator pos:start="307:40" pos:end="307:40">&amp;</operator> <name pos:start="307:42" pos:end="307:51">PG_RW_MASK</name><operator pos:start="307:52" pos:end="307:52">)</operator></expr>)</condition><block type="pseudo" pos:start="309:21" pos:end="309:42"><block_content pos:start="309:21" pos:end="309:42"> 

                    <goto pos:start="309:21" pos:end="309:42">goto <name pos:start="309:26" pos:end="309:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

            </block_content>}</block></else></if_stmt>

            <expr_stmt pos:start="313:13" pos:end="313:58"><expr pos:start="313:13" pos:end="313:57"><name pos:start="313:13" pos:end="313:20">is_dirty</name> <operator pos:start="313:22" pos:end="313:22">=</operator> <name pos:start="313:24" pos:end="313:31">is_write</name> <operator pos:start="313:33" pos:end="313:34">&amp;&amp;</operator> <operator pos:start="313:36" pos:end="313:36">!</operator><operator pos:start="313:37" pos:end="313:37">(</operator><name pos:start="313:38" pos:end="313:40">pte</name> <operator pos:start="313:42" pos:end="313:42">&amp;</operator> <name pos:start="313:44" pos:end="313:56">PG_DIRTY_MASK</name><operator pos:start="313:57" pos:end="313:57">)</operator></expr>;</expr_stmt>

            <if_stmt pos:start="315:13" pos:end="325:13"><if pos:start="315:13" pos:end="325:13">if <condition pos:start="315:16" pos:end="315:54">(<expr pos:start="315:17" pos:end="315:53"><operator pos:start="315:17" pos:end="315:17">!</operator><operator pos:start="315:18" pos:end="315:18">(</operator><name pos:start="315:19" pos:end="315:21">pte</name> <operator pos:start="315:23" pos:end="315:23">&amp;</operator> <name pos:start="315:25" pos:end="315:40">PG_ACCESSED_MASK</name><operator pos:start="315:41" pos:end="315:41">)</operator> <operator pos:start="315:43" pos:end="315:44">||</operator> <name pos:start="315:46" pos:end="315:53">is_dirty</name></expr>)</condition> <block pos:start="315:56" pos:end="325:13">{<block_content pos:start="317:17" pos:end="323:49">

                <expr_stmt pos:start="317:17" pos:end="317:40"><expr pos:start="317:17" pos:end="317:39"><name pos:start="317:17" pos:end="317:19">pte</name> <operator pos:start="317:21" pos:end="317:22">|=</operator> <name pos:start="317:24" pos:end="317:39">PG_ACCESSED_MASK</name></expr>;</expr_stmt>

                <if_stmt pos:start="319:17" pos:end="321:41"><if pos:start="319:17" pos:end="321:41">if <condition pos:start="319:20" pos:end="319:29">(<expr pos:start="319:21" pos:end="319:28"><name pos:start="319:21" pos:end="319:28">is_dirty</name></expr>)</condition><block type="pseudo" pos:start="321:21" pos:end="321:41"><block_content pos:start="321:21" pos:end="321:41">

                    <expr_stmt pos:start="321:21" pos:end="321:41"><expr pos:start="321:21" pos:end="321:40"><name pos:start="321:21" pos:end="321:23">pte</name> <operator pos:start="321:25" pos:end="321:26">|=</operator> <name pos:start="321:28" pos:end="321:40">PG_DIRTY_MASK</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

                <expr_stmt pos:start="323:17" pos:end="323:49"><expr pos:start="323:17" pos:end="323:48"><call pos:start="323:17" pos:end="323:48"><name pos:start="323:17" pos:end="323:33">stl_phys_notdirty</name><argument_list pos:start="323:34" pos:end="323:48">(<argument pos:start="323:35" pos:end="323:42"><expr pos:start="323:35" pos:end="323:42"><name pos:start="323:35" pos:end="323:42">pte_addr</name></expr></argument>, <argument pos:start="323:45" pos:end="323:47"><expr pos:start="323:45" pos:end="323:47"><name pos:start="323:45" pos:end="323:47">pte</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            </block_content>}</block></if></if_stmt>

            <expr_stmt pos:start="327:13" pos:end="327:29"><expr pos:start="327:13" pos:end="327:28"><name pos:start="327:13" pos:end="327:21">page_size</name> <operator pos:start="327:23" pos:end="327:23">=</operator> <literal type="number" pos:start="327:25" pos:end="327:28">4096</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="329:13" pos:end="329:38"><expr pos:start="329:13" pos:end="329:37"><name pos:start="329:13" pos:end="329:21">virt_addr</name> <operator pos:start="329:23" pos:end="329:23">=</operator> <name pos:start="329:25" pos:end="329:28">addr</name> <operator pos:start="329:30" pos:end="329:30">&amp;</operator> <operator pos:start="329:32" pos:end="329:32">~</operator><literal type="number" pos:start="329:33" pos:end="329:37">0xfff</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="331:13" pos:end="331:49"><expr pos:start="331:13" pos:end="331:48"><name pos:start="331:13" pos:end="331:15">pte</name> <operator pos:start="331:17" pos:end="331:17">=</operator> <name pos:start="331:19" pos:end="331:21">pte</name> <operator pos:start="331:23" pos:end="331:23">&amp;</operator> <operator pos:start="331:25" pos:end="331:25">(</operator><name pos:start="331:26" pos:end="331:39">PHYS_ADDR_MASK</name> <operator pos:start="331:41" pos:end="331:41">|</operator> <literal type="number" pos:start="331:43" pos:end="331:47">0xfff</literal><operator pos:start="331:48" pos:end="331:48">)</operator></expr>;</expr_stmt>

        </block_content>}</block></else></if_stmt>

    </block_content>}</block></if> <else pos:start="335:7" pos:end="477:5">else <block pos:start="335:12" pos:end="477:5">{<block_content pos:start="337:9" pos:end="475:9">

        <decl_stmt pos:start="337:9" pos:end="337:21"><decl pos:start="337:9" pos:end="337:20"><type pos:start="337:9" pos:end="337:16"><name pos:start="337:9" pos:end="337:16">uint32_t</name></type> <name pos:start="337:18" pos:end="337:20">pde</name></decl>;</decl_stmt>



        <comment type="block" pos:start="341:9" pos:end="341:34">/* page directory entry */</comment>

        <expr_stmt pos:start="343:9" pos:end="345:26"><expr pos:start="343:9" pos:end="345:25"><name pos:start="343:9" pos:end="343:16">pde_addr</name> <operator pos:start="343:18" pos:end="343:18">=</operator> <operator pos:start="343:20" pos:end="343:20">(</operator><operator pos:start="343:21" pos:end="343:21">(</operator><name pos:start="343:22" pos:end="343:31"><name pos:start="343:22" pos:end="343:24">env</name><operator pos:start="343:25" pos:end="343:26">-&gt;</operator><name pos:start="343:27" pos:end="343:28">cr</name><index pos:start="343:29" pos:end="343:31">[<expr pos:start="343:30" pos:end="343:30"><literal type="number" pos:start="343:30" pos:end="343:30">3</literal></expr>]</index></name> <operator pos:start="343:33" pos:end="343:33">&amp;</operator> <operator pos:start="343:35" pos:end="343:35">~</operator><literal type="number" pos:start="343:36" pos:end="343:40">0xfff</literal><operator pos:start="343:41" pos:end="343:41">)</operator> <operator pos:start="343:43" pos:end="343:43">+</operator> <operator pos:start="343:45" pos:end="343:45">(</operator><operator pos:start="343:46" pos:end="343:46">(</operator><name pos:start="343:47" pos:end="343:50">addr</name> <operator pos:start="343:52" pos:end="343:53">&gt;&gt;</operator> <literal type="number" pos:start="343:55" pos:end="343:56">20</literal><operator pos:start="343:57" pos:end="343:57">)</operator> <operator pos:start="343:59" pos:end="343:59">&amp;</operator> <operator pos:start="343:61" pos:end="343:61">~</operator><literal type="number" pos:start="343:62" pos:end="343:62">3</literal><operator pos:start="343:63" pos:end="343:63">)</operator><operator pos:start="343:64" pos:end="343:64">)</operator> <operator pos:start="343:66" pos:end="343:66">&amp;</operator> 

            <name pos:start="345:13" pos:end="345:25"><name pos:start="345:13" pos:end="345:15">env</name><operator pos:start="345:16" pos:end="345:17">-&gt;</operator><name pos:start="345:18" pos:end="345:25">a20_mask</name></name></expr>;</expr_stmt>

        <expr_stmt pos:start="347:9" pos:end="347:33"><expr pos:start="347:9" pos:end="347:32"><name pos:start="347:9" pos:end="347:11">pde</name> <operator pos:start="347:13" pos:end="347:13">=</operator> <call pos:start="347:15" pos:end="347:32"><name pos:start="347:15" pos:end="347:22">ldl_phys</name><argument_list pos:start="347:23" pos:end="347:32">(<argument pos:start="347:24" pos:end="347:31"><expr pos:start="347:24" pos:end="347:31"><name pos:start="347:24" pos:end="347:31">pde_addr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="349:9" pos:end="355:9"><if pos:start="349:9" pos:end="355:9">if <condition pos:start="349:12" pos:end="349:37">(<expr pos:start="349:13" pos:end="349:36"><operator pos:start="349:13" pos:end="349:13">!</operator><operator pos:start="349:14" pos:end="349:14">(</operator><name pos:start="349:15" pos:end="349:17">pde</name> <operator pos:start="349:19" pos:end="349:19">&amp;</operator> <name pos:start="349:21" pos:end="349:35">PG_PRESENT_MASK</name><operator pos:start="349:36" pos:end="349:36">)</operator></expr>)</condition> <block pos:start="349:39" pos:end="355:9">{<block_content pos:start="351:13" pos:end="353:26">

            <expr_stmt pos:start="351:13" pos:end="351:27"><expr pos:start="351:13" pos:end="351:26"><name pos:start="351:13" pos:end="351:22">error_code</name> <operator pos:start="351:24" pos:end="351:24">=</operator> <literal type="number" pos:start="351:26" pos:end="351:26">0</literal></expr>;</expr_stmt>

            <goto pos:start="353:13" pos:end="353:26">goto <name pos:start="353:18" pos:end="353:25">do_fault</name>;</goto>

        </block_content>}</block></if></if_stmt>

        <comment type="block" pos:start="357:9" pos:end="357:55">/* if PSE bit is set, then we use a 4MB page */</comment>

        <if_stmt pos:start="359:9" pos:end="475:9"><if pos:start="359:9" pos:end="405:9">if <condition pos:start="359:12" pos:end="359:63">(<expr pos:start="359:13" pos:end="359:62"><operator pos:start="359:13" pos:end="359:13">(</operator><name pos:start="359:14" pos:end="359:16">pde</name> <operator pos:start="359:18" pos:end="359:18">&amp;</operator> <name pos:start="359:20" pos:end="359:30">PG_PSE_MASK</name><operator pos:start="359:31" pos:end="359:31">)</operator> <operator pos:start="359:33" pos:end="359:34">&amp;&amp;</operator> <operator pos:start="359:36" pos:end="359:36">(</operator><name pos:start="359:37" pos:end="359:46"><name pos:start="359:37" pos:end="359:39">env</name><operator pos:start="359:40" pos:end="359:41">-&gt;</operator><name pos:start="359:42" pos:end="359:43">cr</name><index pos:start="359:44" pos:end="359:46">[<expr pos:start="359:45" pos:end="359:45"><literal type="number" pos:start="359:45" pos:end="359:45">4</literal></expr>]</index></name> <operator pos:start="359:48" pos:end="359:48">&amp;</operator> <name pos:start="359:50" pos:end="359:61">CR4_PSE_MASK</name><operator pos:start="359:62" pos:end="359:62">)</operator></expr>)</condition> <block pos:start="359:65" pos:end="405:9">{<block_content pos:start="361:13" pos:end="403:48">

            <expr_stmt pos:start="361:13" pos:end="361:36"><expr pos:start="361:13" pos:end="361:35"><name pos:start="361:13" pos:end="361:21">page_size</name> <operator pos:start="361:23" pos:end="361:23">=</operator> <literal type="number" pos:start="361:25" pos:end="361:28">4096</literal> <operator pos:start="361:30" pos:end="361:30">*</operator> <literal type="number" pos:start="361:32" pos:end="361:35">1024</literal></expr>;</expr_stmt>

            <if_stmt pos:start="363:13" pos:end="381:13"><if pos:start="363:13" pos:end="373:13">if <condition pos:start="363:16" pos:end="363:24">(<expr pos:start="363:17" pos:end="363:23"><name pos:start="363:17" pos:end="363:23">is_user</name></expr>)</condition> <block pos:start="363:26" pos:end="373:13">{<block_content pos:start="365:17" pos:end="371:42">

                <if_stmt pos:start="365:17" pos:end="367:42"><if pos:start="365:17" pos:end="367:42">if <condition pos:start="365:20" pos:end="365:42">(<expr pos:start="365:21" pos:end="365:41"><operator pos:start="365:21" pos:end="365:21">!</operator><operator pos:start="365:22" pos:end="365:22">(</operator><name pos:start="365:23" pos:end="365:25">pde</name> <operator pos:start="365:27" pos:end="365:27">&amp;</operator> <name pos:start="365:29" pos:end="365:40">PG_USER_MASK</name><operator pos:start="365:41" pos:end="365:41">)</operator></expr>)</condition><block type="pseudo" pos:start="367:21" pos:end="367:42"><block_content pos:start="367:21" pos:end="367:42">

                    <goto pos:start="367:21" pos:end="367:42">goto <name pos:start="367:26" pos:end="367:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

                <if_stmt pos:start="369:17" pos:end="371:42"><if pos:start="369:17" pos:end="371:42">if <condition pos:start="369:20" pos:end="369:52">(<expr pos:start="369:21" pos:end="369:51"><name pos:start="369:21" pos:end="369:28">is_write</name> <operator pos:start="369:30" pos:end="369:31">&amp;&amp;</operator> <operator pos:start="369:33" pos:end="369:33">!</operator><operator pos:start="369:34" pos:end="369:34">(</operator><name pos:start="369:35" pos:end="369:37">pde</name> <operator pos:start="369:39" pos:end="369:39">&amp;</operator> <name pos:start="369:41" pos:end="369:50">PG_RW_MASK</name><operator pos:start="369:51" pos:end="369:51">)</operator></expr>)</condition><block type="pseudo" pos:start="371:21" pos:end="371:42"><block_content pos:start="371:21" pos:end="371:42">

                    <goto pos:start="371:21" pos:end="371:42">goto <name pos:start="371:26" pos:end="371:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

            </block_content>}</block></if> <else pos:start="373:15" pos:end="381:13">else <block pos:start="373:20" pos:end="381:13">{<block_content pos:start="375:17" pos:end="379:42">

                <if_stmt pos:start="375:17" pos:end="379:42"><if pos:start="375:17" pos:end="379:42">if <condition pos:start="375:20" pos:end="377:52">(<expr pos:start="375:21" pos:end="377:51"><operator pos:start="375:21" pos:end="375:21">(</operator><name pos:start="375:22" pos:end="375:31"><name pos:start="375:22" pos:end="375:24">env</name><operator pos:start="375:25" pos:end="375:26">-&gt;</operator><name pos:start="375:27" pos:end="375:28">cr</name><index pos:start="375:29" pos:end="375:31">[<expr pos:start="375:30" pos:end="375:30"><literal type="number" pos:start="375:30" pos:end="375:30">0</literal></expr>]</index></name> <operator pos:start="375:33" pos:end="375:33">&amp;</operator> <name pos:start="375:35" pos:end="375:45">CR0_WP_MASK</name><operator pos:start="375:46" pos:end="375:46">)</operator> <operator pos:start="375:48" pos:end="375:49">&amp;&amp;</operator> 

                    <name pos:start="377:21" pos:end="377:28">is_write</name> <operator pos:start="377:30" pos:end="377:31">&amp;&amp;</operator> <operator pos:start="377:33" pos:end="377:33">!</operator><operator pos:start="377:34" pos:end="377:34">(</operator><name pos:start="377:35" pos:end="377:37">pde</name> <operator pos:start="377:39" pos:end="377:39">&amp;</operator> <name pos:start="377:41" pos:end="377:50">PG_RW_MASK</name><operator pos:start="377:51" pos:end="377:51">)</operator></expr>)</condition><block type="pseudo" pos:start="379:21" pos:end="379:42"><block_content pos:start="379:21" pos:end="379:42"> 

                    <goto pos:start="379:21" pos:end="379:42">goto <name pos:start="379:26" pos:end="379:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

            </block_content>}</block></else></if_stmt>

            <expr_stmt pos:start="383:13" pos:end="383:58"><expr pos:start="383:13" pos:end="383:57"><name pos:start="383:13" pos:end="383:20">is_dirty</name> <operator pos:start="383:22" pos:end="383:22">=</operator> <name pos:start="383:24" pos:end="383:31">is_write</name> <operator pos:start="383:33" pos:end="383:34">&amp;&amp;</operator> <operator pos:start="383:36" pos:end="383:36">!</operator><operator pos:start="383:37" pos:end="383:37">(</operator><name pos:start="383:38" pos:end="383:40">pde</name> <operator pos:start="383:42" pos:end="383:42">&amp;</operator> <name pos:start="383:44" pos:end="383:56">PG_DIRTY_MASK</name><operator pos:start="383:57" pos:end="383:57">)</operator></expr>;</expr_stmt>

            <if_stmt pos:start="385:13" pos:end="395:13"><if pos:start="385:13" pos:end="395:13">if <condition pos:start="385:16" pos:end="385:54">(<expr pos:start="385:17" pos:end="385:53"><operator pos:start="385:17" pos:end="385:17">!</operator><operator pos:start="385:18" pos:end="385:18">(</operator><name pos:start="385:19" pos:end="385:21">pde</name> <operator pos:start="385:23" pos:end="385:23">&amp;</operator> <name pos:start="385:25" pos:end="385:40">PG_ACCESSED_MASK</name><operator pos:start="385:41" pos:end="385:41">)</operator> <operator pos:start="385:43" pos:end="385:44">||</operator> <name pos:start="385:46" pos:end="385:53">is_dirty</name></expr>)</condition> <block pos:start="385:56" pos:end="395:13">{<block_content pos:start="387:17" pos:end="393:49">

                <expr_stmt pos:start="387:17" pos:end="387:40"><expr pos:start="387:17" pos:end="387:39"><name pos:start="387:17" pos:end="387:19">pde</name> <operator pos:start="387:21" pos:end="387:22">|=</operator> <name pos:start="387:24" pos:end="387:39">PG_ACCESSED_MASK</name></expr>;</expr_stmt>

                <if_stmt pos:start="389:17" pos:end="391:41"><if pos:start="389:17" pos:end="391:41">if <condition pos:start="389:20" pos:end="389:29">(<expr pos:start="389:21" pos:end="389:28"><name pos:start="389:21" pos:end="389:28">is_dirty</name></expr>)</condition><block type="pseudo" pos:start="391:21" pos:end="391:41"><block_content pos:start="391:21" pos:end="391:41">

                    <expr_stmt pos:start="391:21" pos:end="391:41"><expr pos:start="391:21" pos:end="391:40"><name pos:start="391:21" pos:end="391:23">pde</name> <operator pos:start="391:25" pos:end="391:26">|=</operator> <name pos:start="391:28" pos:end="391:40">PG_DIRTY_MASK</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

                <expr_stmt pos:start="393:17" pos:end="393:49"><expr pos:start="393:17" pos:end="393:48"><call pos:start="393:17" pos:end="393:48"><name pos:start="393:17" pos:end="393:33">stl_phys_notdirty</name><argument_list pos:start="393:34" pos:end="393:48">(<argument pos:start="393:35" pos:end="393:42"><expr pos:start="393:35" pos:end="393:42"><name pos:start="393:35" pos:end="393:42">pde_addr</name></expr></argument>, <argument pos:start="393:45" pos:end="393:47"><expr pos:start="393:45" pos:end="393:47"><name pos:start="393:45" pos:end="393:47">pde</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            </block_content>}</block></if></if_stmt>

        

            <expr_stmt pos:start="399:13" pos:end="399:53"><expr pos:start="399:13" pos:end="399:52"><name pos:start="399:13" pos:end="399:15">pte</name> <operator pos:start="399:17" pos:end="399:17">=</operator> <name pos:start="399:19" pos:end="399:21">pde</name> <operator pos:start="399:23" pos:end="399:23">&amp;</operator> <operator pos:start="399:25" pos:end="399:25">~</operator><operator pos:start="399:26" pos:end="399:26">(</operator> <operator pos:start="399:28" pos:end="399:28">(</operator><name pos:start="399:29" pos:end="399:37">page_size</name> <operator pos:start="399:39" pos:end="399:39">-</operator> <literal type="number" pos:start="399:41" pos:end="399:41">1</literal><operator pos:start="399:42" pos:end="399:42">)</operator> <operator pos:start="399:44" pos:end="399:44">&amp;</operator> <operator pos:start="399:46" pos:end="399:46">~</operator><literal type="number" pos:start="399:47" pos:end="399:51">0xfff</literal><operator pos:start="399:52" pos:end="399:52">)</operator></expr>;</expr_stmt> <comment type="block" pos:start="399:55" pos:end="399:78">/* align to page_size */</comment>

            <expr_stmt pos:start="401:13" pos:end="401:23"><expr pos:start="401:13" pos:end="401:22"><name pos:start="401:13" pos:end="401:16">ptep</name> <operator pos:start="401:18" pos:end="401:18">=</operator> <name pos:start="401:20" pos:end="401:22">pte</name></expr>;</expr_stmt>

            <expr_stmt pos:start="403:13" pos:end="403:48"><expr pos:start="403:13" pos:end="403:47"><name pos:start="403:13" pos:end="403:21">virt_addr</name> <operator pos:start="403:23" pos:end="403:23">=</operator> <name pos:start="403:25" pos:end="403:28">addr</name> <operator pos:start="403:30" pos:end="403:30">&amp;</operator> <operator pos:start="403:32" pos:end="403:32">~</operator><operator pos:start="403:33" pos:end="403:33">(</operator><name pos:start="403:34" pos:end="403:42">page_size</name> <operator pos:start="403:44" pos:end="403:44">-</operator> <literal type="number" pos:start="403:46" pos:end="403:46">1</literal><operator pos:start="403:47" pos:end="403:47">)</operator></expr>;</expr_stmt>

        </block_content>}</block></if> <else pos:start="405:11" pos:end="475:9">else <block pos:start="405:16" pos:end="475:9">{<block_content pos:start="407:13" pos:end="473:38">

            <if_stmt pos:start="407:13" pos:end="413:13"><if pos:start="407:13" pos:end="413:13">if <condition pos:start="407:16" pos:end="407:42">(<expr pos:start="407:17" pos:end="407:41"><operator pos:start="407:17" pos:end="407:17">!</operator><operator pos:start="407:18" pos:end="407:18">(</operator><name pos:start="407:19" pos:end="407:21">pde</name> <operator pos:start="407:23" pos:end="407:23">&amp;</operator> <name pos:start="407:25" pos:end="407:40">PG_ACCESSED_MASK</name><operator pos:start="407:41" pos:end="407:41">)</operator></expr>)</condition> <block pos:start="407:44" pos:end="413:13">{<block_content pos:start="409:17" pos:end="411:49">

                <expr_stmt pos:start="409:17" pos:end="409:40"><expr pos:start="409:17" pos:end="409:39"><name pos:start="409:17" pos:end="409:19">pde</name> <operator pos:start="409:21" pos:end="409:22">|=</operator> <name pos:start="409:24" pos:end="409:39">PG_ACCESSED_MASK</name></expr>;</expr_stmt>

                <expr_stmt pos:start="411:17" pos:end="411:49"><expr pos:start="411:17" pos:end="411:48"><call pos:start="411:17" pos:end="411:48"><name pos:start="411:17" pos:end="411:33">stl_phys_notdirty</name><argument_list pos:start="411:34" pos:end="411:48">(<argument pos:start="411:35" pos:end="411:42"><expr pos:start="411:35" pos:end="411:42"><name pos:start="411:35" pos:end="411:42">pde_addr</name></expr></argument>, <argument pos:start="411:45" pos:end="411:47"><expr pos:start="411:45" pos:end="411:47"><name pos:start="411:45" pos:end="411:47">pde</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            </block_content>}</block></if></if_stmt>



            <comment type="block" pos:start="417:13" pos:end="417:38">/* page directory entry */</comment>

            <expr_stmt pos:start="419:13" pos:end="421:30"><expr pos:start="419:13" pos:end="421:29"><name pos:start="419:13" pos:end="419:20">pte_addr</name> <operator pos:start="419:22" pos:end="419:22">=</operator> <operator pos:start="419:24" pos:end="419:24">(</operator><operator pos:start="419:25" pos:end="419:25">(</operator><name pos:start="419:26" pos:end="419:28">pde</name> <operator pos:start="419:30" pos:end="419:30">&amp;</operator> <operator pos:start="419:32" pos:end="419:32">~</operator><literal type="number" pos:start="419:33" pos:end="419:37">0xfff</literal><operator pos:start="419:38" pos:end="419:38">)</operator> <operator pos:start="419:40" pos:end="419:40">+</operator> <operator pos:start="419:42" pos:end="419:42">(</operator><operator pos:start="419:43" pos:end="419:43">(</operator><name pos:start="419:44" pos:end="419:47">addr</name> <operator pos:start="419:49" pos:end="419:50">&gt;&gt;</operator> <literal type="number" pos:start="419:52" pos:end="419:53">10</literal><operator pos:start="419:54" pos:end="419:54">)</operator> <operator pos:start="419:56" pos:end="419:56">&amp;</operator> <literal type="number" pos:start="419:58" pos:end="419:62">0xffc</literal><operator pos:start="419:63" pos:end="419:63">)</operator><operator pos:start="419:64" pos:end="419:64">)</operator> <operator pos:start="419:66" pos:end="419:66">&amp;</operator> 

                <name pos:start="421:17" pos:end="421:29"><name pos:start="421:17" pos:end="421:19">env</name><operator pos:start="421:20" pos:end="421:21">-&gt;</operator><name pos:start="421:22" pos:end="421:29">a20_mask</name></name></expr>;</expr_stmt>

            <expr_stmt pos:start="423:13" pos:end="423:37"><expr pos:start="423:13" pos:end="423:36"><name pos:start="423:13" pos:end="423:15">pte</name> <operator pos:start="423:17" pos:end="423:17">=</operator> <call pos:start="423:19" pos:end="423:36"><name pos:start="423:19" pos:end="423:26">ldl_phys</name><argument_list pos:start="423:27" pos:end="423:36">(<argument pos:start="423:28" pos:end="423:35"><expr pos:start="423:28" pos:end="423:35"><name pos:start="423:28" pos:end="423:35">pte_addr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <if_stmt pos:start="425:13" pos:end="431:13"><if pos:start="425:13" pos:end="431:13">if <condition pos:start="425:16" pos:end="425:41">(<expr pos:start="425:17" pos:end="425:40"><operator pos:start="425:17" pos:end="425:17">!</operator><operator pos:start="425:18" pos:end="425:18">(</operator><name pos:start="425:19" pos:end="425:21">pte</name> <operator pos:start="425:23" pos:end="425:23">&amp;</operator> <name pos:start="425:25" pos:end="425:39">PG_PRESENT_MASK</name><operator pos:start="425:40" pos:end="425:40">)</operator></expr>)</condition> <block pos:start="425:43" pos:end="431:13">{<block_content pos:start="427:17" pos:end="429:30">

                <expr_stmt pos:start="427:17" pos:end="427:31"><expr pos:start="427:17" pos:end="427:30"><name pos:start="427:17" pos:end="427:26">error_code</name> <operator pos:start="427:28" pos:end="427:28">=</operator> <literal type="number" pos:start="427:30" pos:end="427:30">0</literal></expr>;</expr_stmt>

                <goto pos:start="429:17" pos:end="429:30">goto <name pos:start="429:22" pos:end="429:29">do_fault</name>;</goto>

            </block_content>}</block></if></if_stmt>

            <comment type="block" pos:start="433:13" pos:end="433:61">/* combine pde and pte user and rw protections */</comment>

            <expr_stmt pos:start="435:13" pos:end="435:29"><expr pos:start="435:13" pos:end="435:28"><name pos:start="435:13" pos:end="435:16">ptep</name> <operator pos:start="435:18" pos:end="435:18">=</operator> <name pos:start="435:20" pos:end="435:22">pte</name> <operator pos:start="435:24" pos:end="435:24">&amp;</operator> <name pos:start="435:26" pos:end="435:28">pde</name></expr>;</expr_stmt>

            <if_stmt pos:start="437:13" pos:end="455:13"><if pos:start="437:13" pos:end="447:13">if <condition pos:start="437:16" pos:end="437:24">(<expr pos:start="437:17" pos:end="437:23"><name pos:start="437:17" pos:end="437:23">is_user</name></expr>)</condition> <block pos:start="437:26" pos:end="447:13">{<block_content pos:start="439:17" pos:end="445:42">

                <if_stmt pos:start="439:17" pos:end="441:42"><if pos:start="439:17" pos:end="441:42">if <condition pos:start="439:20" pos:end="439:43">(<expr pos:start="439:21" pos:end="439:42"><operator pos:start="439:21" pos:end="439:21">!</operator><operator pos:start="439:22" pos:end="439:22">(</operator><name pos:start="439:23" pos:end="439:26">ptep</name> <operator pos:start="439:28" pos:end="439:28">&amp;</operator> <name pos:start="439:30" pos:end="439:41">PG_USER_MASK</name><operator pos:start="439:42" pos:end="439:42">)</operator></expr>)</condition><block type="pseudo" pos:start="441:21" pos:end="441:42"><block_content pos:start="441:21" pos:end="441:42">

                    <goto pos:start="441:21" pos:end="441:42">goto <name pos:start="441:26" pos:end="441:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

                <if_stmt pos:start="443:17" pos:end="445:42"><if pos:start="443:17" pos:end="445:42">if <condition pos:start="443:20" pos:end="443:53">(<expr pos:start="443:21" pos:end="443:52"><name pos:start="443:21" pos:end="443:28">is_write</name> <operator pos:start="443:30" pos:end="443:31">&amp;&amp;</operator> <operator pos:start="443:33" pos:end="443:33">!</operator><operator pos:start="443:34" pos:end="443:34">(</operator><name pos:start="443:35" pos:end="443:38">ptep</name> <operator pos:start="443:40" pos:end="443:40">&amp;</operator> <name pos:start="443:42" pos:end="443:51">PG_RW_MASK</name><operator pos:start="443:52" pos:end="443:52">)</operator></expr>)</condition><block type="pseudo" pos:start="445:21" pos:end="445:42"><block_content pos:start="445:21" pos:end="445:42">

                    <goto pos:start="445:21" pos:end="445:42">goto <name pos:start="445:26" pos:end="445:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

            </block_content>}</block></if> <else pos:start="447:15" pos:end="455:13">else <block pos:start="447:20" pos:end="455:13">{<block_content pos:start="449:17" pos:end="453:42">

                <if_stmt pos:start="449:17" pos:end="453:42"><if pos:start="449:17" pos:end="453:42">if <condition pos:start="449:20" pos:end="451:53">(<expr pos:start="449:21" pos:end="451:52"><operator pos:start="449:21" pos:end="449:21">(</operator><name pos:start="449:22" pos:end="449:31"><name pos:start="449:22" pos:end="449:24">env</name><operator pos:start="449:25" pos:end="449:26">-&gt;</operator><name pos:start="449:27" pos:end="449:28">cr</name><index pos:start="449:29" pos:end="449:31">[<expr pos:start="449:30" pos:end="449:30"><literal type="number" pos:start="449:30" pos:end="449:30">0</literal></expr>]</index></name> <operator pos:start="449:33" pos:end="449:33">&amp;</operator> <name pos:start="449:35" pos:end="449:45">CR0_WP_MASK</name><operator pos:start="449:46" pos:end="449:46">)</operator> <operator pos:start="449:48" pos:end="449:49">&amp;&amp;</operator>

                    <name pos:start="451:21" pos:end="451:28">is_write</name> <operator pos:start="451:30" pos:end="451:31">&amp;&amp;</operator> <operator pos:start="451:33" pos:end="451:33">!</operator><operator pos:start="451:34" pos:end="451:34">(</operator><name pos:start="451:35" pos:end="451:38">ptep</name> <operator pos:start="451:40" pos:end="451:40">&amp;</operator> <name pos:start="451:42" pos:end="451:51">PG_RW_MASK</name><operator pos:start="451:52" pos:end="451:52">)</operator></expr>)</condition><block type="pseudo" pos:start="453:21" pos:end="453:42"><block_content pos:start="453:21" pos:end="453:42"> 

                    <goto pos:start="453:21" pos:end="453:42">goto <name pos:start="453:26" pos:end="453:41">do_fault_protect</name>;</goto></block_content></block></if></if_stmt>

            </block_content>}</block></else></if_stmt>

            <expr_stmt pos:start="457:13" pos:end="457:58"><expr pos:start="457:13" pos:end="457:57"><name pos:start="457:13" pos:end="457:20">is_dirty</name> <operator pos:start="457:22" pos:end="457:22">=</operator> <name pos:start="457:24" pos:end="457:31">is_write</name> <operator pos:start="457:33" pos:end="457:34">&amp;&amp;</operator> <operator pos:start="457:36" pos:end="457:36">!</operator><operator pos:start="457:37" pos:end="457:37">(</operator><name pos:start="457:38" pos:end="457:40">pte</name> <operator pos:start="457:42" pos:end="457:42">&amp;</operator> <name pos:start="457:44" pos:end="457:56">PG_DIRTY_MASK</name><operator pos:start="457:57" pos:end="457:57">)</operator></expr>;</expr_stmt>

            <if_stmt pos:start="459:13" pos:end="469:13"><if pos:start="459:13" pos:end="469:13">if <condition pos:start="459:16" pos:end="459:54">(<expr pos:start="459:17" pos:end="459:53"><operator pos:start="459:17" pos:end="459:17">!</operator><operator pos:start="459:18" pos:end="459:18">(</operator><name pos:start="459:19" pos:end="459:21">pte</name> <operator pos:start="459:23" pos:end="459:23">&amp;</operator> <name pos:start="459:25" pos:end="459:40">PG_ACCESSED_MASK</name><operator pos:start="459:41" pos:end="459:41">)</operator> <operator pos:start="459:43" pos:end="459:44">||</operator> <name pos:start="459:46" pos:end="459:53">is_dirty</name></expr>)</condition> <block pos:start="459:56" pos:end="469:13">{<block_content pos:start="461:17" pos:end="467:49">

                <expr_stmt pos:start="461:17" pos:end="461:40"><expr pos:start="461:17" pos:end="461:39"><name pos:start="461:17" pos:end="461:19">pte</name> <operator pos:start="461:21" pos:end="461:22">|=</operator> <name pos:start="461:24" pos:end="461:39">PG_ACCESSED_MASK</name></expr>;</expr_stmt>

                <if_stmt pos:start="463:17" pos:end="465:41"><if pos:start="463:17" pos:end="465:41">if <condition pos:start="463:20" pos:end="463:29">(<expr pos:start="463:21" pos:end="463:28"><name pos:start="463:21" pos:end="463:28">is_dirty</name></expr>)</condition><block type="pseudo" pos:start="465:21" pos:end="465:41"><block_content pos:start="465:21" pos:end="465:41">

                    <expr_stmt pos:start="465:21" pos:end="465:41"><expr pos:start="465:21" pos:end="465:40"><name pos:start="465:21" pos:end="465:23">pte</name> <operator pos:start="465:25" pos:end="465:26">|=</operator> <name pos:start="465:28" pos:end="465:40">PG_DIRTY_MASK</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

                <expr_stmt pos:start="467:17" pos:end="467:49"><expr pos:start="467:17" pos:end="467:48"><call pos:start="467:17" pos:end="467:48"><name pos:start="467:17" pos:end="467:33">stl_phys_notdirty</name><argument_list pos:start="467:34" pos:end="467:48">(<argument pos:start="467:35" pos:end="467:42"><expr pos:start="467:35" pos:end="467:42"><name pos:start="467:35" pos:end="467:42">pte_addr</name></expr></argument>, <argument pos:start="467:45" pos:end="467:47"><expr pos:start="467:45" pos:end="467:47"><name pos:start="467:45" pos:end="467:47">pte</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            </block_content>}</block></if></if_stmt>

            <expr_stmt pos:start="471:13" pos:end="471:29"><expr pos:start="471:13" pos:end="471:28"><name pos:start="471:13" pos:end="471:21">page_size</name> <operator pos:start="471:23" pos:end="471:23">=</operator> <literal type="number" pos:start="471:25" pos:end="471:28">4096</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="473:13" pos:end="473:38"><expr pos:start="473:13" pos:end="473:37"><name pos:start="473:13" pos:end="473:21">virt_addr</name> <operator pos:start="473:23" pos:end="473:23">=</operator> <name pos:start="473:25" pos:end="473:28">addr</name> <operator pos:start="473:30" pos:end="473:30">&amp;</operator> <operator pos:start="473:32" pos:end="473:32">~</operator><literal type="number" pos:start="473:33" pos:end="473:37">0xfff</literal></expr>;</expr_stmt>

        </block_content>}</block></else></if_stmt>

    </block_content>}</block></else></if_stmt>

    <comment type="block" pos:start="479:5" pos:end="479:40">/* the page can be put in the TLB */</comment>

    <expr_stmt pos:start="481:5" pos:end="481:21"><expr pos:start="481:5" pos:end="481:20"><name pos:start="481:5" pos:end="481:8">prot</name> <operator pos:start="481:10" pos:end="481:10">=</operator> <name pos:start="481:12" pos:end="481:20">PAGE_READ</name></expr>;</expr_stmt>

    <if_stmt pos:start="483:5" pos:end="485:26"><if pos:start="483:5" pos:end="485:26">if <condition pos:start="483:8" pos:end="483:29">(<expr pos:start="483:9" pos:end="483:28"><operator pos:start="483:9" pos:end="483:9">!</operator><operator pos:start="483:10" pos:end="483:10">(</operator><name pos:start="483:11" pos:end="483:14">ptep</name> <operator pos:start="483:16" pos:end="483:16">&amp;</operator> <name pos:start="483:18" pos:end="483:27">PG_NX_MASK</name><operator pos:start="483:28" pos:end="483:28">)</operator></expr>)</condition><block type="pseudo" pos:start="485:9" pos:end="485:26"><block_content pos:start="485:9" pos:end="485:26">

        <expr_stmt pos:start="485:9" pos:end="485:26"><expr pos:start="485:9" pos:end="485:25"><name pos:start="485:9" pos:end="485:12">prot</name> <operator pos:start="485:14" pos:end="485:15">|=</operator> <name pos:start="485:17" pos:end="485:25">PAGE_EXEC</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

    <if_stmt pos:start="487:5" pos:end="509:5"><if pos:start="487:5" pos:end="509:5">if <condition pos:start="487:8" pos:end="487:28">(<expr pos:start="487:9" pos:end="487:27"><name pos:start="487:9" pos:end="487:11">pte</name> <operator pos:start="487:13" pos:end="487:13">&amp;</operator> <name pos:start="487:15" pos:end="487:27">PG_DIRTY_MASK</name></expr>)</condition> <block pos:start="487:30" pos:end="509:5">{<block_content pos:start="493:9" pos:end="507:9">

        <comment type="block" pos:start="489:9" pos:end="491:30">/* only set write access if already dirty... otherwise wait

           for dirty access */</comment>

        <if_stmt pos:start="493:9" pos:end="507:9"><if pos:start="493:9" pos:end="499:9">if <condition pos:start="493:12" pos:end="493:20">(<expr pos:start="493:13" pos:end="493:19"><name pos:start="493:13" pos:end="493:19">is_user</name></expr>)</condition> <block pos:start="493:22" pos:end="499:9">{<block_content pos:start="495:13" pos:end="497:35">

            <if_stmt pos:start="495:13" pos:end="497:35"><if pos:start="495:13" pos:end="497:35">if <condition pos:start="495:16" pos:end="495:34">(<expr pos:start="495:17" pos:end="495:33"><name pos:start="495:17" pos:end="495:20">ptep</name> <operator pos:start="495:22" pos:end="495:22">&amp;</operator> <name pos:start="495:24" pos:end="495:33">PG_RW_MASK</name></expr>)</condition><block type="pseudo" pos:start="497:17" pos:end="497:35"><block_content pos:start="497:17" pos:end="497:35">

                <expr_stmt pos:start="497:17" pos:end="497:35"><expr pos:start="497:17" pos:end="497:34"><name pos:start="497:17" pos:end="497:20">prot</name> <operator pos:start="497:22" pos:end="497:23">|=</operator> <name pos:start="497:25" pos:end="497:34">PAGE_WRITE</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

        </block_content>}</block></if> <else pos:start="499:11" pos:end="507:9">else <block pos:start="499:16" pos:end="507:9">{<block_content pos:start="501:13" pos:end="505:35">

            <if_stmt pos:start="501:13" pos:end="505:35"><if pos:start="501:13" pos:end="505:35">if <condition pos:start="501:16" pos:end="503:36">(<expr pos:start="501:17" pos:end="503:35"><operator pos:start="501:17" pos:end="501:17">!</operator><operator pos:start="501:18" pos:end="501:18">(</operator><name pos:start="501:19" pos:end="501:28"><name pos:start="501:19" pos:end="501:21">env</name><operator pos:start="501:22" pos:end="501:23">-&gt;</operator><name pos:start="501:24" pos:end="501:25">cr</name><index pos:start="501:26" pos:end="501:28">[<expr pos:start="501:27" pos:end="501:27"><literal type="number" pos:start="501:27" pos:end="501:27">0</literal></expr>]</index></name> <operator pos:start="501:30" pos:end="501:30">&amp;</operator> <name pos:start="501:32" pos:end="501:42">CR0_WP_MASK</name><operator pos:start="501:43" pos:end="501:43">)</operator> <operator pos:start="501:45" pos:end="501:46">||</operator>

                <operator pos:start="503:17" pos:end="503:17">(</operator><name pos:start="503:18" pos:end="503:21">ptep</name> <operator pos:start="503:23" pos:end="503:23">&amp;</operator> <name pos:start="503:25" pos:end="503:34">PG_RW_MASK</name><operator pos:start="503:35" pos:end="503:35">)</operator></expr>)</condition><block type="pseudo" pos:start="505:17" pos:end="505:35"><block_content pos:start="505:17" pos:end="505:35">

                <expr_stmt pos:start="505:17" pos:end="505:35"><expr pos:start="505:17" pos:end="505:34"><name pos:start="505:17" pos:end="505:20">prot</name> <operator pos:start="505:22" pos:end="505:23">|=</operator> <name pos:start="505:25" pos:end="505:34">PAGE_WRITE</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

        </block_content>}</block></else></if_stmt>

    </block_content>}</block></if></if_stmt>

 <label pos:start="511:2" pos:end="511:12"><name pos:start="511:2" pos:end="511:11">do_mapping</name>:</label>

    <expr_stmt pos:start="513:5" pos:end="513:30"><expr pos:start="513:5" pos:end="513:29"><name pos:start="513:5" pos:end="513:7">pte</name> <operator pos:start="513:9" pos:end="513:9">=</operator> <name pos:start="513:11" pos:end="513:13">pte</name> <operator pos:start="513:15" pos:end="513:15">&amp;</operator> <name pos:start="513:17" pos:end="513:29"><name pos:start="513:17" pos:end="513:19">env</name><operator pos:start="513:20" pos:end="513:21">-&gt;</operator><name pos:start="513:22" pos:end="513:29">a20_mask</name></name></expr>;</expr_stmt>



    <comment type="block" pos:start="517:5" pos:end="519:35">/* Even if 4MB pages, we map only one 4KB page in the cache to

       avoid filling it too fast */</comment>

    <expr_stmt pos:start="521:5" pos:end="521:62"><expr pos:start="521:5" pos:end="521:61"><name pos:start="521:5" pos:end="521:15">page_offset</name> <operator pos:start="521:17" pos:end="521:17">=</operator> <operator pos:start="521:19" pos:end="521:19">(</operator><name pos:start="521:20" pos:end="521:23">addr</name> <operator pos:start="521:25" pos:end="521:25">&amp;</operator> <name pos:start="521:27" pos:end="521:42">TARGET_PAGE_MASK</name><operator pos:start="521:43" pos:end="521:43">)</operator> <operator pos:start="521:45" pos:end="521:45">&amp;</operator> <operator pos:start="521:47" pos:end="521:47">(</operator><name pos:start="521:48" pos:end="521:56">page_size</name> <operator pos:start="521:58" pos:end="521:58">-</operator> <literal type="number" pos:start="521:60" pos:end="521:60">1</literal><operator pos:start="521:61" pos:end="521:61">)</operator></expr>;</expr_stmt>

    <expr_stmt pos:start="523:5" pos:end="523:51"><expr pos:start="523:5" pos:end="523:50"><name pos:start="523:5" pos:end="523:9">paddr</name> <operator pos:start="523:11" pos:end="523:11">=</operator> <operator pos:start="523:13" pos:end="523:13">(</operator><name pos:start="523:14" pos:end="523:16">pte</name> <operator pos:start="523:18" pos:end="523:18">&amp;</operator> <name pos:start="523:20" pos:end="523:35">TARGET_PAGE_MASK</name><operator pos:start="523:36" pos:end="523:36">)</operator> <operator pos:start="523:38" pos:end="523:38">+</operator> <name pos:start="523:40" pos:end="523:50">page_offset</name></expr>;</expr_stmt>

    <expr_stmt pos:start="525:5" pos:end="525:36"><expr pos:start="525:5" pos:end="525:35"><name pos:start="525:5" pos:end="525:9">vaddr</name> <operator pos:start="525:11" pos:end="525:11">=</operator> <name pos:start="525:13" pos:end="525:21">virt_addr</name> <operator pos:start="525:23" pos:end="525:23">+</operator> <name pos:start="525:25" pos:end="525:35">page_offset</name></expr>;</expr_stmt>

    

    <expr_stmt pos:start="529:5" pos:end="529:74"><expr pos:start="529:5" pos:end="529:73"><name pos:start="529:5" pos:end="529:7">ret</name> <operator pos:start="529:9" pos:end="529:9">=</operator> <call pos:start="529:11" pos:end="529:73"><name pos:start="529:11" pos:end="529:27">tlb_set_page_exec</name><argument_list pos:start="529:28" pos:end="529:73">(<argument pos:start="529:29" pos:end="529:31"><expr pos:start="529:29" pos:end="529:31"><name pos:start="529:29" pos:end="529:31">env</name></expr></argument>, <argument pos:start="529:34" pos:end="529:38"><expr pos:start="529:34" pos:end="529:38"><name pos:start="529:34" pos:end="529:38">vaddr</name></expr></argument>, <argument pos:start="529:41" pos:end="529:45"><expr pos:start="529:41" pos:end="529:45"><name pos:start="529:41" pos:end="529:45">paddr</name></expr></argument>, <argument pos:start="529:48" pos:end="529:51"><expr pos:start="529:48" pos:end="529:51"><name pos:start="529:48" pos:end="529:51">prot</name></expr></argument>, <argument pos:start="529:54" pos:end="529:60"><expr pos:start="529:54" pos:end="529:60"><name pos:start="529:54" pos:end="529:60">is_user</name></expr></argument>, <argument pos:start="529:63" pos:end="529:72"><expr pos:start="529:63" pos:end="529:72"><name pos:start="529:63" pos:end="529:72">is_softmmu</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <return pos:start="531:5" pos:end="531:15">return <expr pos:start="531:12" pos:end="531:14"><name pos:start="531:12" pos:end="531:14">ret</name></expr>;</return>

 <label pos:start="533:2" pos:end="533:18"><name pos:start="533:2" pos:end="533:17">do_fault_protect</name>:</label>

    <expr_stmt pos:start="535:5" pos:end="535:33"><expr pos:start="535:5" pos:end="535:32"><name pos:start="535:5" pos:end="535:14">error_code</name> <operator pos:start="535:16" pos:end="535:16">=</operator> <name pos:start="535:18" pos:end="535:32">PG_ERROR_P_MASK</name></expr>;</expr_stmt>

 <label pos:start="537:2" pos:end="537:10"><name pos:start="537:2" pos:end="537:9">do_fault</name>:</label>

    <expr_stmt pos:start="539:5" pos:end="539:22"><expr pos:start="539:5" pos:end="539:21"><name pos:start="539:5" pos:end="539:14"><name pos:start="539:5" pos:end="539:7">env</name><operator pos:start="539:8" pos:end="539:9">-&gt;</operator><name pos:start="539:10" pos:end="539:11">cr</name><index pos:start="539:12" pos:end="539:14">[<expr pos:start="539:13" pos:end="539:13"><literal type="number" pos:start="539:13" pos:end="539:13">2</literal></expr>]</index></name> <operator pos:start="539:16" pos:end="539:16">=</operator> <name pos:start="539:18" pos:end="539:21">addr</name></expr>;</expr_stmt>

    <expr_stmt pos:start="541:5" pos:end="541:47"><expr pos:start="541:5" pos:end="541:46"><name pos:start="541:5" pos:end="541:14">error_code</name> <operator pos:start="541:16" pos:end="541:17">|=</operator> <operator pos:start="541:19" pos:end="541:19">(</operator><name pos:start="541:20" pos:end="541:27">is_write</name> <operator pos:start="541:29" pos:end="541:30">&lt;&lt;</operator> <name pos:start="541:32" pos:end="541:45">PG_ERROR_W_BIT</name><operator pos:start="541:46" pos:end="541:46">)</operator></expr>;</expr_stmt>

    <if_stmt pos:start="543:5" pos:end="545:38"><if pos:start="543:5" pos:end="545:38">if <condition pos:start="543:8" pos:end="543:16">(<expr pos:start="543:9" pos:end="543:15"><name pos:start="543:9" pos:end="543:15">is_user</name></expr>)</condition><block type="pseudo" pos:start="545:9" pos:end="545:38"><block_content pos:start="545:9" pos:end="545:38">

        <expr_stmt pos:start="545:9" pos:end="545:38"><expr pos:start="545:9" pos:end="545:37"><name pos:start="545:9" pos:end="545:18">error_code</name> <operator pos:start="545:20" pos:end="545:21">|=</operator> <name pos:start="545:23" pos:end="545:37">PG_ERROR_U_MASK</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

    <if_stmt pos:start="547:5" pos:end="553:40"><if pos:start="547:5" pos:end="553:40">if <condition pos:start="547:8" pos:end="551:36">(<expr pos:start="547:9" pos:end="551:35"><name pos:start="547:9" pos:end="547:17">is_write1</name> <operator pos:start="547:19" pos:end="547:20">==</operator> <literal type="number" pos:start="547:22" pos:end="547:22">2</literal> <operator pos:start="547:24" pos:end="547:25">&amp;&amp;</operator> 

        <operator pos:start="549:9" pos:end="549:9">(</operator><name pos:start="549:10" pos:end="549:18"><name pos:start="549:10" pos:end="549:12">env</name><operator pos:start="549:13" pos:end="549:14">-&gt;</operator><name pos:start="549:15" pos:end="549:18">efer</name></name> <operator pos:start="549:20" pos:end="549:20">&amp;</operator> <name pos:start="549:22" pos:end="549:33">MSR_EFER_NXE</name><operator pos:start="549:34" pos:end="549:34">)</operator> <operator pos:start="549:36" pos:end="549:37">&amp;&amp;</operator> 

        <operator pos:start="551:9" pos:end="551:9">(</operator><name pos:start="551:10" pos:end="551:19"><name pos:start="551:10" pos:end="551:12">env</name><operator pos:start="551:13" pos:end="551:14">-&gt;</operator><name pos:start="551:15" pos:end="551:16">cr</name><index pos:start="551:17" pos:end="551:19">[<expr pos:start="551:18" pos:end="551:18"><literal type="number" pos:start="551:18" pos:end="551:18">4</literal></expr>]</index></name> <operator pos:start="551:21" pos:end="551:21">&amp;</operator> <name pos:start="551:23" pos:end="551:34">CR4_PAE_MASK</name><operator pos:start="551:35" pos:end="551:35">)</operator></expr>)</condition><block type="pseudo" pos:start="553:9" pos:end="553:40"><block_content pos:start="553:9" pos:end="553:40">

        <expr_stmt pos:start="553:9" pos:end="553:40"><expr pos:start="553:9" pos:end="553:39"><name pos:start="553:9" pos:end="553:18">error_code</name> <operator pos:start="553:20" pos:end="553:21">|=</operator> <name pos:start="553:23" pos:end="553:39">PG_ERROR_I_D_MASK</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

    <expr_stmt pos:start="555:5" pos:end="555:33"><expr pos:start="555:5" pos:end="555:32"><name pos:start="555:5" pos:end="555:19"><name pos:start="555:5" pos:end="555:7">env</name><operator pos:start="555:8" pos:end="555:9">-&gt;</operator><name pos:start="555:10" pos:end="555:19">error_code</name></name> <operator pos:start="555:21" pos:end="555:21">=</operator> <name pos:start="555:23" pos:end="555:32">error_code</name></expr>;</expr_stmt>

    <return pos:start="557:5" pos:end="557:13">return <expr pos:start="557:12" pos:end="557:12"><literal type="number" pos:start="557:12" pos:end="557:12">1</literal></expr>;</return>

</block_content>}</block></function>
</unit>
