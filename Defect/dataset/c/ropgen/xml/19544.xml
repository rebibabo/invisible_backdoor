<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/1/19544.c" pos:tabs="8"><function pos:start="1:1" pos:end="78:18"><type pos:start="1:1" pos:end="1:15"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:15">uint32_t</name></type> <name pos:start="1:17" pos:end="1:23">get_cmd</name><parameter_list pos:start="1:24" pos:end="1:66">(<parameter pos:start="1:25" pos:end="1:35"><decl pos:start="1:25" pos:end="1:35"><type pos:start="1:25" pos:end="1:35"><name pos:start="1:25" pos:end="1:32">ESPState</name> <modifier pos:start="1:34" pos:end="1:34">*</modifier></type><name pos:start="1:35" pos:end="1:35">s</name></decl></parameter>, <parameter pos:start="1:38" pos:end="1:49"><decl pos:start="1:38" pos:end="1:49"><type pos:start="1:38" pos:end="1:49"><name pos:start="1:38" pos:end="1:44">uint8_t</name> <modifier pos:start="1:46" pos:end="1:46">*</modifier></type><name pos:start="1:47" pos:end="1:49">buf</name></decl></parameter>, <parameter pos:start="1:52" pos:end="1:65"><decl pos:start="1:52" pos:end="1:65"><type pos:start="1:52" pos:end="1:65"><name pos:start="1:52" pos:end="1:58">uint8_t</name></type> <name pos:start="1:60" pos:end="1:65">buflen</name></decl></parameter>)</parameter_list>

<block pos:start="3:1" pos:end="78:18">{<block_content pos:start="5:5" pos:end="78:18">

    <decl_stmt pos:start="5:5" pos:end="5:20"><decl pos:start="5:5" pos:end="5:19"><type pos:start="5:5" pos:end="5:12"><name pos:start="5:5" pos:end="5:12">uint32_t</name></type> <name pos:start="5:14" pos:end="5:19">dmalen</name></decl>;</decl_stmt>

    <decl_stmt pos:start="7:5" pos:end="7:15"><decl pos:start="7:5" pos:end="7:14"><type pos:start="7:5" pos:end="7:7"><name pos:start="7:5" pos:end="7:7">int</name></type> <name pos:start="7:9" pos:end="7:14">target</name></decl>;</decl_stmt>



    <expr_stmt pos:start="11:5" pos:end="11:46"><expr pos:start="11:5" pos:end="11:45"><name pos:start="11:5" pos:end="11:10">target</name> <operator pos:start="11:12" pos:end="11:12">=</operator> <name pos:start="11:14" pos:end="11:33"><name pos:start="11:14" pos:end="11:14">s</name><operator pos:start="11:15" pos:end="11:16">-&gt;</operator><name pos:start="11:17" pos:end="11:21">wregs</name><index pos:start="11:22" pos:end="11:33">[<expr pos:start="11:23" pos:end="11:32"><name pos:start="11:23" pos:end="11:32">ESP_WBUSID</name></expr>]</index></name> <operator pos:start="11:35" pos:end="11:35">&amp;</operator> <name pos:start="11:37" pos:end="11:45">BUSID_DID</name></expr>;</expr_stmt>

    <if_stmt pos:start="13:5" pos:end="78:18"><if pos:start="13:5" pos:end="78:18">if <condition pos:start="13:8" pos:end="13:15">(<expr pos:start="13:9" pos:end="13:14"><name pos:start="13:9" pos:end="13:14"><name pos:start="13:9" pos:end="13:9">s</name><operator pos:start="13:10" pos:end="13:11">-&gt;</operator><name pos:start="13:12" pos:end="13:14">dma</name></name></expr>)</condition> <block pos:start="13:17" pos:end="78:18">{<block_content pos:start="15:9" pos:end="78:18">

        <expr_stmt pos:start="15:9" pos:end="15:36"><expr pos:start="15:9" pos:end="15:35"><name pos:start="15:9" pos:end="15:14">dmalen</name> <operator pos:start="15:16" pos:end="15:16">=</operator> <name pos:start="15:18" pos:end="15:35"><name pos:start="15:18" pos:end="15:18">s</name><operator pos:start="15:19" pos:end="15:20">-&gt;</operator><name pos:start="15:21" pos:end="15:25">rregs</name><index pos:start="15:26" pos:end="15:35">[<expr pos:start="15:27" pos:end="15:34"><name pos:start="15:27" pos:end="15:34">ESP_TCLO</name></expr>]</index></name></expr>;</expr_stmt>

        <expr_stmt pos:start="17:9" pos:end="17:43"><expr pos:start="17:9" pos:end="17:42"><name pos:start="17:9" pos:end="17:14">dmalen</name> <operator pos:start="17:16" pos:end="17:17">|=</operator> <name pos:start="17:19" pos:end="17:37"><name pos:start="17:19" pos:end="17:19">s</name><operator pos:start="17:20" pos:end="17:21">-&gt;</operator><name pos:start="17:22" pos:end="17:26">rregs</name><index pos:start="17:27" pos:end="17:37">[<expr pos:start="17:28" pos:end="17:36"><name pos:start="17:28" pos:end="17:36">ESP_TCMID</name></expr>]</index></name> <operator pos:start="17:39" pos:end="17:40">&lt;&lt;</operator> <literal type="number" pos:start="17:42" pos:end="17:42">8</literal></expr>;</expr_stmt>

        <expr_stmt pos:start="19:9" pos:end="19:43"><expr pos:start="19:9" pos:end="19:42"><name pos:start="19:9" pos:end="19:14">dmalen</name> <operator pos:start="19:16" pos:end="19:17">|=</operator> <name pos:start="19:19" pos:end="19:36"><name pos:start="19:19" pos:end="19:19">s</name><operator pos:start="19:20" pos:end="19:21">-&gt;</operator><name pos:start="19:22" pos:end="19:26">rregs</name><index pos:start="19:27" pos:end="19:36">[<expr pos:start="19:28" pos:end="19:35"><name pos:start="19:28" pos:end="19:35">ESP_TCHI</name></expr>]</index></name> <operator pos:start="19:38" pos:end="19:39">&lt;&lt;</operator> <literal type="number" pos:start="19:41" pos:end="19:42">16</literal></expr>;</expr_stmt>

        <if_stmt pos:start="21:9" pos:end="78:18"><if pos:start="21:9" pos:end="27:5">if <condition pos:start="21:12" pos:end="21:28">(<expr pos:start="21:13" pos:end="21:27"><name pos:start="21:13" pos:end="21:18">dmalen</name> <operator pos:start="21:20" pos:end="21:20">&gt;</operator> <name pos:start="21:22" pos:end="21:27">buflen</name></expr>)</condition> <block pos:start="21:30" pos:end="27:5">{<block_content pos:start="25:9" pos:end="25:55">



        <expr_stmt pos:start="25:9" pos:end="25:55"><expr pos:start="25:9" pos:end="25:54"><call pos:start="25:9" pos:end="25:54"><name pos:start="25:9" pos:end="25:26"><name pos:start="25:9" pos:end="25:9">s</name><operator pos:start="25:10" pos:end="25:11">-&gt;</operator><name pos:start="25:12" pos:end="25:26">dma_memory_read</name></name><argument_list pos:start="25:27" pos:end="25:54">(<argument pos:start="25:28" pos:end="25:40"><expr pos:start="25:28" pos:end="25:40"><name pos:start="25:28" pos:end="25:40"><name pos:start="25:28" pos:end="25:28">s</name><operator pos:start="25:29" pos:end="25:30">-&gt;</operator><name pos:start="25:31" pos:end="25:40">dma_opaque</name></name></expr></argument>, <argument pos:start="25:43" pos:end="25:45"><expr pos:start="25:43" pos:end="25:45"><name pos:start="25:43" pos:end="25:45">buf</name></expr></argument>, <argument pos:start="25:48" pos:end="25:53"><expr pos:start="25:48" pos:end="25:53"><name pos:start="25:48" pos:end="25:53">dmalen</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if> <else pos:start="27:7" pos:end="78:18">else <block pos:start="27:12" pos:end="78:18">{<block_content pos:start="29:9" pos:end="78:18">

        <expr_stmt pos:start="29:9" pos:end="29:28"><expr pos:start="29:9" pos:end="29:27"><name pos:start="29:9" pos:end="29:14">dmalen</name> <operator pos:start="29:16" pos:end="29:16">=</operator> <name pos:start="29:18" pos:end="29:27"><name pos:start="29:18" pos:end="29:18">s</name><operator pos:start="29:19" pos:end="29:20">-&gt;</operator><name pos:start="29:21" pos:end="29:27">ti_size</name></name></expr>;</expr_stmt>




        <expr_stmt pos:start="34:9" pos:end="34:39"><expr pos:start="34:9" pos:end="34:38"><call pos:start="34:9" pos:end="34:38"><name pos:start="34:9" pos:end="34:14">memcpy</name><argument_list pos:start="34:15" pos:end="34:38">(<argument pos:start="34:16" pos:end="34:18"><expr pos:start="34:16" pos:end="34:18"><name pos:start="34:16" pos:end="34:18">buf</name></expr></argument>, <argument pos:start="34:21" pos:end="34:29"><expr pos:start="34:21" pos:end="34:29"><name pos:start="34:21" pos:end="34:29"><name pos:start="34:21" pos:end="34:21">s</name><operator pos:start="34:22" pos:end="34:23">-&gt;</operator><name pos:start="34:24" pos:end="34:29">ti_buf</name></name></expr></argument>, <argument pos:start="34:32" pos:end="34:37"><expr pos:start="34:32" pos:end="34:37"><name pos:start="34:32" pos:end="34:37">dmalen</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="36:9" pos:end="36:29"><expr pos:start="36:9" pos:end="36:28"><name pos:start="36:9" pos:end="36:14"><name pos:start="36:9" pos:end="36:11">buf</name><index pos:start="36:12" pos:end="36:14">[<expr pos:start="36:13" pos:end="36:13"><literal type="number" pos:start="36:13" pos:end="36:13">0</literal></expr>]</index></name> <operator pos:start="36:16" pos:end="36:16">=</operator> <name pos:start="36:18" pos:end="36:23"><name pos:start="36:18" pos:end="36:20">buf</name><index pos:start="36:21" pos:end="36:23">[<expr pos:start="36:22" pos:end="36:22"><literal type="number" pos:start="36:22" pos:end="36:22">2</literal></expr>]</index></name> <operator pos:start="36:25" pos:end="36:26">&gt;&gt;</operator> <literal type="number" pos:start="36:28" pos:end="36:28">5</literal></expr>;</expr_stmt>


    <expr_stmt pos:start="39:5" pos:end="39:38"><expr pos:start="39:5" pos:end="39:37"><call pos:start="39:5" pos:end="39:37"><name pos:start="39:5" pos:end="39:21">trace_esp_get_cmd</name><argument_list pos:start="39:22" pos:end="39:37">(<argument pos:start="39:23" pos:end="39:28"><expr pos:start="39:23" pos:end="39:28"><name pos:start="39:23" pos:end="39:28">dmalen</name></expr></argument>, <argument pos:start="39:31" pos:end="39:36"><expr pos:start="39:31" pos:end="39:36"><name pos:start="39:31" pos:end="39:36">target</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <expr_stmt pos:start="43:5" pos:end="43:19"><expr pos:start="43:5" pos:end="43:18"><name pos:start="43:5" pos:end="43:14"><name pos:start="43:5" pos:end="43:5">s</name><operator pos:start="43:6" pos:end="43:7">-&gt;</operator><name pos:start="43:8" pos:end="43:14">ti_size</name></name> <operator pos:start="43:16" pos:end="43:16">=</operator> <literal type="number" pos:start="43:18" pos:end="43:18">0</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="45:5" pos:end="45:19"><expr pos:start="45:5" pos:end="45:18"><name pos:start="45:5" pos:end="45:14"><name pos:start="45:5" pos:end="45:5">s</name><operator pos:start="45:6" pos:end="45:7">-&gt;</operator><name pos:start="45:8" pos:end="45:14">ti_rptr</name></name> <operator pos:start="45:16" pos:end="45:16">=</operator> <literal type="number" pos:start="45:18" pos:end="45:18">0</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="47:5" pos:end="47:19"><expr pos:start="47:5" pos:end="47:18"><name pos:start="47:5" pos:end="47:14"><name pos:start="47:5" pos:end="47:5">s</name><operator pos:start="47:6" pos:end="47:7">-&gt;</operator><name pos:start="47:8" pos:end="47:14">ti_wptr</name></name> <operator pos:start="47:16" pos:end="47:16">=</operator> <literal type="number" pos:start="47:18" pos:end="47:18">0</literal></expr>;</expr_stmt>



    <if_stmt pos:start="51:5" pos:end="78:18"><if pos:start="51:5" pos:end="78:18">if <condition pos:start="51:8" pos:end="51:23">(<expr pos:start="51:9" pos:end="51:22"><name pos:start="51:9" pos:end="51:22"><name pos:start="51:9" pos:end="51:9">s</name><operator pos:start="51:10" pos:end="51:11">-&gt;</operator><name pos:start="51:12" pos:end="51:22">current_req</name></name></expr>)</condition> <block pos:start="51:25" pos:end="78:18">{<block_content pos:start="55:9" pos:end="78:18">

        <comment type="block" pos:start="53:9" pos:end="53:77">/* Started a new command before the old one finished.  Cancel it.  */</comment>

        <expr_stmt pos:start="55:9" pos:end="55:40"><expr pos:start="55:9" pos:end="55:39"><call pos:start="55:9" pos:end="55:39"><name pos:start="55:9" pos:end="55:23">scsi_req_cancel</name><argument_list pos:start="55:24" pos:end="55:39">(<argument pos:start="55:25" pos:end="55:38"><expr pos:start="55:25" pos:end="55:38"><name pos:start="55:25" pos:end="55:38"><name pos:start="55:25" pos:end="55:25">s</name><operator pos:start="55:26" pos:end="55:27">-&gt;</operator><name pos:start="55:28" pos:end="55:38">current_req</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="57:9" pos:end="57:25"><expr pos:start="57:9" pos:end="57:24"><name pos:start="57:9" pos:end="57:20"><name pos:start="57:9" pos:end="57:9">s</name><operator pos:start="57:10" pos:end="57:11">-&gt;</operator><name pos:start="57:12" pos:end="57:20">async_len</name></name> <operator pos:start="57:22" pos:end="57:22">=</operator> <literal type="number" pos:start="57:24" pos:end="57:24">0</literal></expr>;</expr_stmt>




    <expr_stmt pos:start="62:5" pos:end="62:61"><expr pos:start="62:5" pos:end="62:60"><name pos:start="62:5" pos:end="62:18"><name pos:start="62:5" pos:end="62:5">s</name><operator pos:start="62:6" pos:end="62:7">-&gt;</operator><name pos:start="62:8" pos:end="62:18">current_dev</name></name> <operator pos:start="62:20" pos:end="62:20">=</operator> <call pos:start="62:22" pos:end="62:60"><name pos:start="62:22" pos:end="62:37">scsi_device_find</name><argument_list pos:start="62:38" pos:end="62:60">(<argument pos:start="62:39" pos:end="62:45"><expr pos:start="62:39" pos:end="62:45"><operator pos:start="62:39" pos:end="62:39">&amp;</operator><name pos:start="62:40" pos:end="62:45"><name pos:start="62:40" pos:end="62:40">s</name><operator pos:start="62:41" pos:end="62:42">-&gt;</operator><name pos:start="62:43" pos:end="62:45">bus</name></name></expr></argument>, <argument pos:start="62:48" pos:end="62:48"><expr pos:start="62:48" pos:end="62:48"><literal type="number" pos:start="62:48" pos:end="62:48">0</literal></expr></argument>, <argument pos:start="62:51" pos:end="62:56"><expr pos:start="62:51" pos:end="62:56"><name pos:start="62:51" pos:end="62:56">target</name></expr></argument>, <argument pos:start="62:59" pos:end="62:59"><expr pos:start="62:59" pos:end="62:59"><literal type="number" pos:start="62:59" pos:end="62:59">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <if_stmt pos:start="64:5" pos:end="78:18"><if pos:start="64:5" pos:end="78:18">if <condition pos:start="64:8" pos:end="64:24">(<expr pos:start="64:9" pos:end="64:23"><operator pos:start="64:9" pos:end="64:9">!</operator><name pos:start="64:10" pos:end="64:23"><name pos:start="64:10" pos:end="64:10">s</name><operator pos:start="64:11" pos:end="64:12">-&gt;</operator><name pos:start="64:13" pos:end="64:23">current_dev</name></name></expr>)</condition> <block pos:start="64:26" pos:end="78:18">{<block_content pos:start="68:9" pos:end="78:18">

        <comment type="line" pos:start="66:9" pos:end="66:24">// No such drive</comment>

        <expr_stmt pos:start="68:9" pos:end="68:32"><expr pos:start="68:9" pos:end="68:31"><name pos:start="68:9" pos:end="68:27"><name pos:start="68:9" pos:end="68:9">s</name><operator pos:start="68:10" pos:end="68:11">-&gt;</operator><name pos:start="68:12" pos:end="68:16">rregs</name><index pos:start="68:17" pos:end="68:27">[<expr pos:start="68:18" pos:end="68:26"><name pos:start="68:18" pos:end="68:26">ESP_RSTAT</name></expr>]</index></name> <operator pos:start="68:29" pos:end="68:29">=</operator> <literal type="number" pos:start="68:31" pos:end="68:31">0</literal></expr>;</expr_stmt>

        <expr_stmt pos:start="70:9" pos:end="70:38"><expr pos:start="70:9" pos:end="70:37"><name pos:start="70:9" pos:end="70:27"><name pos:start="70:9" pos:end="70:9">s</name><operator pos:start="70:10" pos:end="70:11">-&gt;</operator><name pos:start="70:12" pos:end="70:16">rregs</name><index pos:start="70:17" pos:end="70:27">[<expr pos:start="70:18" pos:end="70:26"><name pos:start="70:18" pos:end="70:26">ESP_RINTR</name></expr>]</index></name> <operator pos:start="70:29" pos:end="70:29">=</operator> <name pos:start="70:31" pos:end="70:37">INTR_DC</name></expr>;</expr_stmt>

        <expr_stmt pos:start="72:9" pos:end="72:35"><expr pos:start="72:9" pos:end="72:34"><name pos:start="72:9" pos:end="72:26"><name pos:start="72:9" pos:end="72:9">s</name><operator pos:start="72:10" pos:end="72:11">-&gt;</operator><name pos:start="72:12" pos:end="72:16">rregs</name><index pos:start="72:17" pos:end="72:26">[<expr pos:start="72:18" pos:end="72:25"><name pos:start="72:18" pos:end="72:25">ESP_RSEQ</name></expr>]</index></name> <operator pos:start="72:28" pos:end="72:28">=</operator> <name pos:start="72:30" pos:end="72:34">SEQ_0</name></expr>;</expr_stmt>

        <expr_stmt pos:start="74:9" pos:end="74:25"><expr pos:start="74:9" pos:end="74:24"><call pos:start="74:9" pos:end="74:24"><name pos:start="74:9" pos:end="74:21">esp_raise_irq</name><argument_list pos:start="74:22" pos:end="74:24">(<argument pos:start="74:23" pos:end="74:23"><expr pos:start="74:23" pos:end="74:23"><name pos:start="74:23" pos:end="74:23">s</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <return pos:start="78:5" pos:end="78:18">return <expr pos:start="78:12" pos:end="78:17"><name pos:start="78:12" pos:end="78:17">dmalen</name></expr>;</return></block_content></block></if></if_stmt></block_content></block></if></if_stmt></block_content></block></else></if_stmt></block_content></block></if></if_stmt></block_content></block></function>
</unit>
