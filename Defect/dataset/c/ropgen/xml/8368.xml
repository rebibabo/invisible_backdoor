<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/8368.c" pos:tabs="8"><function pos:start="1:1" pos:end="215:1"><type pos:start="1:1" pos:end="1:11"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:11">void</name></type> <name pos:start="1:13" pos:end="1:21">end_frame</name><parameter_list pos:start="1:22" pos:end="1:41">(<parameter pos:start="1:23" pos:end="1:40"><decl pos:start="1:23" pos:end="1:40"><type pos:start="1:23" pos:end="1:36"><name pos:start="1:23" pos:end="1:34">AVFilterLink</name> <modifier pos:start="1:36" pos:end="1:36">*</modifier></type><name pos:start="1:37" pos:end="1:40">link</name></decl></parameter>)</parameter_list>

<block pos:start="3:1" pos:end="215:1">{<block_content pos:start="5:5" pos:end="213:31">

    <decl_stmt pos:start="5:5" pos:end="5:46"><decl pos:start="5:5" pos:end="5:45"><type pos:start="5:5" pos:end="5:20"><name pos:start="5:5" pos:end="5:18">DeshakeContext</name> <modifier pos:start="5:20" pos:end="5:20">*</modifier></type><name pos:start="5:21" pos:end="5:27">deshake</name> <init pos:start="5:29" pos:end="5:45">= <expr pos:start="5:31" pos:end="5:45"><name pos:start="5:31" pos:end="5:45"><name pos:start="5:31" pos:end="5:34">link</name><operator pos:start="5:35" pos:end="5:36">-&gt;</operator><name pos:start="5:37" pos:end="5:39">dst</name><operator pos:start="5:40" pos:end="5:41">-&gt;</operator><name pos:start="5:42" pos:end="5:45">priv</name></name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="7:5" pos:end="7:43"><decl pos:start="7:5" pos:end="7:42"><type pos:start="7:5" pos:end="7:23"><name pos:start="7:5" pos:end="7:21">AVFilterBufferRef</name> <modifier pos:start="7:23" pos:end="7:23">*</modifier></type><name pos:start="7:24" pos:end="7:25">in</name>  <init pos:start="7:28" pos:end="7:42">= <expr pos:start="7:30" pos:end="7:42"><name pos:start="7:30" pos:end="7:42"><name pos:start="7:30" pos:end="7:33">link</name><operator pos:start="7:34" pos:end="7:35">-&gt;</operator><name pos:start="7:36" pos:end="7:42">cur_buf</name></name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="9:5" pos:end="9:60"><decl pos:start="9:5" pos:end="9:59"><type pos:start="9:5" pos:end="9:23"><name pos:start="9:5" pos:end="9:21">AVFilterBufferRef</name> <modifier pos:start="9:23" pos:end="9:23">*</modifier></type><name pos:start="9:24" pos:end="9:26">out</name> <init pos:start="9:28" pos:end="9:59">= <expr pos:start="9:30" pos:end="9:59"><name pos:start="9:30" pos:end="9:50"><name pos:start="9:30" pos:end="9:33">link</name><operator pos:start="9:34" pos:end="9:35">-&gt;</operator><name pos:start="9:36" pos:end="9:38">dst</name><operator pos:start="9:39" pos:end="9:40">-&gt;</operator><name pos:start="9:41" pos:end="9:47">outputs</name><index pos:start="9:48" pos:end="9:50">[<expr pos:start="9:49" pos:end="9:49"><literal type="number" pos:start="9:49" pos:end="9:49">0</literal></expr>]</index></name><operator pos:start="9:51" pos:end="9:52">-&gt;</operator><name pos:start="9:53" pos:end="9:59">out_buf</name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="11:5" pos:end="11:16"><decl pos:start="11:5" pos:end="11:15"><type pos:start="11:5" pos:end="11:13"><name pos:start="11:5" pos:end="11:13">Transform</name></type> <name pos:start="11:15" pos:end="11:15">t</name></decl>;</decl_stmt>

    <decl_stmt pos:start="13:5" pos:end="13:20"><decl pos:start="13:5" pos:end="13:19"><type pos:start="13:5" pos:end="13:9"><name pos:start="13:5" pos:end="13:9">float</name></type> <name pos:start="13:11" pos:end="13:19"><name pos:start="13:11" pos:end="13:16">matrix</name><index pos:start="13:17" pos:end="13:19">[<expr pos:start="13:18" pos:end="13:18"><literal type="number" pos:start="13:18" pos:end="13:18">9</literal></expr>]</index></name></decl>;</decl_stmt>

    <decl_stmt pos:start="15:5" pos:end="15:42"><decl pos:start="15:5" pos:end="15:41"><type pos:start="15:5" pos:end="15:9"><name pos:start="15:5" pos:end="15:9">float</name></type> <name pos:start="15:11" pos:end="15:15">alpha</name> <init pos:start="15:17" pos:end="15:41">= <expr pos:start="15:19" pos:end="15:41"><literal type="number" pos:start="15:19" pos:end="15:21">2.0</literal> <operator pos:start="15:23" pos:end="15:23">/</operator> <name pos:start="15:25" pos:end="15:41"><name pos:start="15:25" pos:end="15:31">deshake</name><operator pos:start="15:32" pos:end="15:33">-&gt;</operator><name pos:start="15:34" pos:end="15:41">refcount</name></name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="17:5" pos:end="17:18"><decl pos:start="17:5" pos:end="17:17"><type pos:start="17:5" pos:end="17:8"><name pos:start="17:5" pos:end="17:8">char</name></type> <name pos:start="17:10" pos:end="17:17"><name pos:start="17:10" pos:end="17:12">tmp</name><index pos:start="17:13" pos:end="17:17">[<expr pos:start="17:14" pos:end="17:16"><literal type="number" pos:start="17:14" pos:end="17:16">256</literal></expr>]</index></name></decl>;</decl_stmt>

    <decl_stmt pos:start="19:5" pos:end="19:19"><decl pos:start="19:5" pos:end="19:18"><type pos:start="19:5" pos:end="19:13"><name pos:start="19:5" pos:end="19:13">Transform</name></type> <name pos:start="19:15" pos:end="19:18">orig</name></decl>;</decl_stmt>



    <if_stmt pos:start="23:5" pos:end="63:5"><if pos:start="23:5" pos:end="29:5">if <condition pos:start="23:8" pos:end="23:81">(<expr pos:start="23:9" pos:end="23:80"><name pos:start="23:9" pos:end="23:19"><name pos:start="23:9" pos:end="23:15">deshake</name><operator pos:start="23:16" pos:end="23:17">-&gt;</operator><name pos:start="23:18" pos:end="23:19">cx</name></name> <operator pos:start="23:21" pos:end="23:21">&lt;</operator> <literal type="number" pos:start="23:23" pos:end="23:23">0</literal> <operator pos:start="23:25" pos:end="23:26">||</operator> <name pos:start="23:28" pos:end="23:38"><name pos:start="23:28" pos:end="23:34">deshake</name><operator pos:start="23:35" pos:end="23:36">-&gt;</operator><name pos:start="23:37" pos:end="23:38">cy</name></name> <operator pos:start="23:40" pos:end="23:40">&lt;</operator> <literal type="number" pos:start="23:42" pos:end="23:42">0</literal> <operator pos:start="23:44" pos:end="23:45">||</operator> <name pos:start="23:47" pos:end="23:57"><name pos:start="23:47" pos:end="23:53">deshake</name><operator pos:start="23:54" pos:end="23:55">-&gt;</operator><name pos:start="23:56" pos:end="23:57">cw</name></name> <operator pos:start="23:59" pos:end="23:59">&lt;</operator> <literal type="number" pos:start="23:61" pos:end="23:61">0</literal> <operator pos:start="23:63" pos:end="23:64">||</operator> <name pos:start="23:66" pos:end="23:76"><name pos:start="23:66" pos:end="23:72">deshake</name><operator pos:start="23:73" pos:end="23:74">-&gt;</operator><name pos:start="23:75" pos:end="23:76">ch</name></name> <operator pos:start="23:78" pos:end="23:78">&lt;</operator> <literal type="number" pos:start="23:80" pos:end="23:80">0</literal></expr>)</condition> <block pos:start="23:83" pos:end="29:5">{<block_content pos:start="27:9" pos:end="27:143">

        <comment type="line" pos:start="25:9" pos:end="25:67">// Find the most likely global motion for the current frame</comment>

        <expr_stmt pos:start="27:9" pos:end="27:143"><expr pos:start="27:9" pos:end="27:142"><call pos:start="27:9" pos:end="27:142"><name pos:start="27:9" pos:end="27:19">find_motion</name><argument_list pos:start="27:20" pos:end="27:142">(<argument pos:start="27:21" pos:end="27:27"><expr pos:start="27:21" pos:end="27:27"><name pos:start="27:21" pos:end="27:27">deshake</name></expr></argument>, <argument pos:start="27:30" pos:end="27:89"><expr pos:start="27:30" pos:end="27:89"><ternary pos:start="27:30" pos:end="27:89"><condition pos:start="27:30" pos:end="27:53"><expr pos:start="27:30" pos:end="27:51"><operator pos:start="27:30" pos:end="27:30">(</operator><name pos:start="27:31" pos:end="27:42"><name pos:start="27:31" pos:end="27:37">deshake</name><operator pos:start="27:38" pos:end="27:39">-&gt;</operator><name pos:start="27:40" pos:end="27:42">ref</name></name> <operator pos:start="27:44" pos:end="27:45">==</operator> <name pos:start="27:47" pos:end="27:50">NULL</name><operator pos:start="27:51" pos:end="27:51">)</operator></expr> ?</condition><then pos:start="27:55" pos:end="27:65"> <expr pos:start="27:55" pos:end="27:65"><name pos:start="27:55" pos:end="27:65"><name pos:start="27:55" pos:end="27:56">in</name><operator pos:start="27:57" pos:end="27:58">-&gt;</operator><name pos:start="27:59" pos:end="27:62">data</name><index pos:start="27:63" pos:end="27:65">[<expr pos:start="27:64" pos:end="27:64"><literal type="number" pos:start="27:64" pos:end="27:64">0</literal></expr>]</index></name></expr> </then><else pos:start="27:67" pos:end="27:89">: <expr pos:start="27:69" pos:end="27:89"><name pos:start="27:69" pos:end="27:89"><name pos:start="27:69" pos:end="27:75">deshake</name><operator pos:start="27:76" pos:end="27:77">-&gt;</operator><name pos:start="27:78" pos:end="27:80">ref</name><operator pos:start="27:81" pos:end="27:82">-&gt;</operator><name pos:start="27:83" pos:end="27:86">data</name><index pos:start="27:87" pos:end="27:89">[<expr pos:start="27:88" pos:end="27:88"><literal type="number" pos:start="27:88" pos:end="27:88">0</literal></expr>]</index></name></expr></else></ternary></expr></argument>, <argument pos:start="27:92" pos:end="27:102"><expr pos:start="27:92" pos:end="27:102"><name pos:start="27:92" pos:end="27:102"><name pos:start="27:92" pos:end="27:93">in</name><operator pos:start="27:94" pos:end="27:95">-&gt;</operator><name pos:start="27:96" pos:end="27:99">data</name><index pos:start="27:100" pos:end="27:102">[<expr pos:start="27:101" pos:end="27:101"><literal type="number" pos:start="27:101" pos:end="27:101">0</literal></expr>]</index></name></expr></argument>, <argument pos:start="27:105" pos:end="27:111"><expr pos:start="27:105" pos:end="27:111"><name pos:start="27:105" pos:end="27:111"><name pos:start="27:105" pos:end="27:108">link</name><operator pos:start="27:109" pos:end="27:110">-&gt;</operator><name pos:start="27:111" pos:end="27:111">w</name></name></expr></argument>, <argument pos:start="27:114" pos:end="27:120"><expr pos:start="27:114" pos:end="27:120"><name pos:start="27:114" pos:end="27:120"><name pos:start="27:114" pos:end="27:117">link</name><operator pos:start="27:118" pos:end="27:119">-&gt;</operator><name pos:start="27:120" pos:end="27:120">h</name></name></expr></argument>, <argument pos:start="27:123" pos:end="27:137"><expr pos:start="27:123" pos:end="27:137"><name pos:start="27:123" pos:end="27:137"><name pos:start="27:123" pos:end="27:124">in</name><operator pos:start="27:125" pos:end="27:126">-&gt;</operator><name pos:start="27:127" pos:end="27:134">linesize</name><index pos:start="27:135" pos:end="27:137">[<expr pos:start="27:136" pos:end="27:136"><literal type="number" pos:start="27:136" pos:end="27:136">0</literal></expr>]</index></name></expr></argument>, <argument pos:start="27:140" pos:end="27:141"><expr pos:start="27:140" pos:end="27:141"><operator pos:start="27:140" pos:end="27:140">&amp;</operator><name pos:start="27:141" pos:end="27:141">t</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if> <else pos:start="29:7" pos:end="63:5">else <block pos:start="29:12" pos:end="63:5">{<block_content pos:start="31:9" pos:end="61:88">

        <decl_stmt pos:start="31:9" pos:end="31:85"><decl pos:start="31:9" pos:end="31:84"><type pos:start="31:9" pos:end="31:17"><name pos:start="31:9" pos:end="31:15">uint8_t</name> <modifier pos:start="31:17" pos:end="31:17">*</modifier></type><name pos:start="31:18" pos:end="31:21">src1</name> <init pos:start="31:23" pos:end="31:84">= <expr pos:start="31:25" pos:end="31:84"><ternary pos:start="31:25" pos:end="31:84"><condition pos:start="31:25" pos:end="31:48"><expr pos:start="31:25" pos:end="31:46"><operator pos:start="31:25" pos:end="31:25">(</operator><name pos:start="31:26" pos:end="31:37"><name pos:start="31:26" pos:end="31:32">deshake</name><operator pos:start="31:33" pos:end="31:34">-&gt;</operator><name pos:start="31:35" pos:end="31:37">ref</name></name> <operator pos:start="31:39" pos:end="31:40">==</operator> <name pos:start="31:42" pos:end="31:45">NULL</name><operator pos:start="31:46" pos:end="31:46">)</operator></expr> ?</condition><then pos:start="31:50" pos:end="31:60"> <expr pos:start="31:50" pos:end="31:60"><name pos:start="31:50" pos:end="31:60"><name pos:start="31:50" pos:end="31:51">in</name><operator pos:start="31:52" pos:end="31:53">-&gt;</operator><name pos:start="31:54" pos:end="31:57">data</name><index pos:start="31:58" pos:end="31:60">[<expr pos:start="31:59" pos:end="31:59"><literal type="number" pos:start="31:59" pos:end="31:59">0</literal></expr>]</index></name></expr> </then><else pos:start="31:62" pos:end="31:84">: <expr pos:start="31:64" pos:end="31:84"><name pos:start="31:64" pos:end="31:84"><name pos:start="31:64" pos:end="31:70">deshake</name><operator pos:start="31:71" pos:end="31:72">-&gt;</operator><name pos:start="31:73" pos:end="31:75">ref</name><operator pos:start="31:76" pos:end="31:77">-&gt;</operator><name pos:start="31:78" pos:end="31:81">data</name><index pos:start="31:82" pos:end="31:84">[<expr pos:start="31:83" pos:end="31:83"><literal type="number" pos:start="31:83" pos:end="31:83">0</literal></expr>]</index></name></expr></else></ternary></expr></init></decl>;</decl_stmt>

        <decl_stmt pos:start="33:9" pos:end="33:36"><decl pos:start="33:9" pos:end="33:35"><type pos:start="33:9" pos:end="33:17"><name pos:start="33:9" pos:end="33:15">uint8_t</name> <modifier pos:start="33:17" pos:end="33:17">*</modifier></type><name pos:start="33:18" pos:end="33:21">src2</name> <init pos:start="33:23" pos:end="33:35">= <expr pos:start="33:25" pos:end="33:35"><name pos:start="33:25" pos:end="33:35"><name pos:start="33:25" pos:end="33:26">in</name><operator pos:start="33:27" pos:end="33:28">-&gt;</operator><name pos:start="33:29" pos:end="33:32">data</name><index pos:start="33:33" pos:end="33:35">[<expr pos:start="33:34" pos:end="33:34"><literal type="number" pos:start="33:34" pos:end="33:34">0</literal></expr>]</index></name></expr></init></decl>;</decl_stmt>



        <expr_stmt pos:start="37:9" pos:end="37:50"><expr pos:start="37:9" pos:end="37:49"><name pos:start="37:9" pos:end="37:19"><name pos:start="37:9" pos:end="37:15">deshake</name><operator pos:start="37:16" pos:end="37:17">-&gt;</operator><name pos:start="37:18" pos:end="37:19">cx</name></name> <operator pos:start="37:21" pos:end="37:21">=</operator> <call pos:start="37:23" pos:end="37:49"><name pos:start="37:23" pos:end="37:27">FFMIN</name><argument_list pos:start="37:28" pos:end="37:49">(<argument pos:start="37:29" pos:end="37:39"><expr pos:start="37:29" pos:end="37:39"><name pos:start="37:29" pos:end="37:39"><name pos:start="37:29" pos:end="37:35">deshake</name><operator pos:start="37:36" pos:end="37:37">-&gt;</operator><name pos:start="37:38" pos:end="37:39">cx</name></name></expr></argument>, <argument pos:start="37:42" pos:end="37:48"><expr pos:start="37:42" pos:end="37:48"><name pos:start="37:42" pos:end="37:48"><name pos:start="37:42" pos:end="37:45">link</name><operator pos:start="37:46" pos:end="37:47">-&gt;</operator><name pos:start="37:48" pos:end="37:48">w</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="39:9" pos:end="39:50"><expr pos:start="39:9" pos:end="39:49"><name pos:start="39:9" pos:end="39:19"><name pos:start="39:9" pos:end="39:15">deshake</name><operator pos:start="39:16" pos:end="39:17">-&gt;</operator><name pos:start="39:18" pos:end="39:19">cy</name></name> <operator pos:start="39:21" pos:end="39:21">=</operator> <call pos:start="39:23" pos:end="39:49"><name pos:start="39:23" pos:end="39:27">FFMIN</name><argument_list pos:start="39:28" pos:end="39:49">(<argument pos:start="39:29" pos:end="39:39"><expr pos:start="39:29" pos:end="39:39"><name pos:start="39:29" pos:end="39:39"><name pos:start="39:29" pos:end="39:35">deshake</name><operator pos:start="39:36" pos:end="39:37">-&gt;</operator><name pos:start="39:38" pos:end="39:39">cy</name></name></expr></argument>, <argument pos:start="39:42" pos:end="39:48"><expr pos:start="39:42" pos:end="39:48"><name pos:start="39:42" pos:end="39:48"><name pos:start="39:42" pos:end="39:45">link</name><operator pos:start="39:46" pos:end="39:47">-&gt;</operator><name pos:start="39:48" pos:end="39:48">h</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <if_stmt pos:start="43:9" pos:end="43:105"><if pos:start="43:9" pos:end="43:105">if <condition pos:start="43:12" pos:end="43:68">(<expr pos:start="43:13" pos:end="43:67"><operator pos:start="43:13" pos:end="43:13">(</operator><name pos:start="43:14" pos:end="43:21">unsigned</name><operator pos:start="43:22" pos:end="43:22">)</operator><name pos:start="43:23" pos:end="43:33"><name pos:start="43:23" pos:end="43:29">deshake</name><operator pos:start="43:30" pos:end="43:31">-&gt;</operator><name pos:start="43:32" pos:end="43:33">cx</name></name> <operator pos:start="43:35" pos:end="43:35">+</operator> <operator pos:start="43:37" pos:end="43:37">(</operator><name pos:start="43:38" pos:end="43:45">unsigned</name><operator pos:start="43:46" pos:end="43:46">)</operator><name pos:start="43:47" pos:end="43:57"><name pos:start="43:47" pos:end="43:53">deshake</name><operator pos:start="43:54" pos:end="43:55">-&gt;</operator><name pos:start="43:56" pos:end="43:57">cw</name></name> <operator pos:start="43:59" pos:end="43:59">&gt;</operator> <name pos:start="43:61" pos:end="43:67"><name pos:start="43:61" pos:end="43:64">link</name><operator pos:start="43:65" pos:end="43:66">-&gt;</operator><name pos:start="43:67" pos:end="43:67">w</name></name></expr>)</condition><block type="pseudo" pos:start="43:70" pos:end="43:105"><block_content pos:start="43:70" pos:end="43:105"> <expr_stmt pos:start="43:70" pos:end="43:105"><expr pos:start="43:70" pos:end="43:104"><name pos:start="43:70" pos:end="43:80"><name pos:start="43:70" pos:end="43:76">deshake</name><operator pos:start="43:77" pos:end="43:78">-&gt;</operator><name pos:start="43:79" pos:end="43:80">cw</name></name> <operator pos:start="43:82" pos:end="43:82">=</operator> <name pos:start="43:84" pos:end="43:90"><name pos:start="43:84" pos:end="43:87">link</name><operator pos:start="43:88" pos:end="43:89">-&gt;</operator><name pos:start="43:90" pos:end="43:90">w</name></name> <operator pos:start="43:92" pos:end="43:92">-</operator> <name pos:start="43:94" pos:end="43:104"><name pos:start="43:94" pos:end="43:100">deshake</name><operator pos:start="43:101" pos:end="43:102">-&gt;</operator><name pos:start="43:103" pos:end="43:104">cx</name></name></expr>;</expr_stmt></block_content></block></if></if_stmt>

        <if_stmt pos:start="45:9" pos:end="45:105"><if pos:start="45:9" pos:end="45:105">if <condition pos:start="45:12" pos:end="45:68">(<expr pos:start="45:13" pos:end="45:67"><operator pos:start="45:13" pos:end="45:13">(</operator><name pos:start="45:14" pos:end="45:21">unsigned</name><operator pos:start="45:22" pos:end="45:22">)</operator><name pos:start="45:23" pos:end="45:33"><name pos:start="45:23" pos:end="45:29">deshake</name><operator pos:start="45:30" pos:end="45:31">-&gt;</operator><name pos:start="45:32" pos:end="45:33">cy</name></name> <operator pos:start="45:35" pos:end="45:35">+</operator> <operator pos:start="45:37" pos:end="45:37">(</operator><name pos:start="45:38" pos:end="45:45">unsigned</name><operator pos:start="45:46" pos:end="45:46">)</operator><name pos:start="45:47" pos:end="45:57"><name pos:start="45:47" pos:end="45:53">deshake</name><operator pos:start="45:54" pos:end="45:55">-&gt;</operator><name pos:start="45:56" pos:end="45:57">ch</name></name> <operator pos:start="45:59" pos:end="45:59">&gt;</operator> <name pos:start="45:61" pos:end="45:67"><name pos:start="45:61" pos:end="45:64">link</name><operator pos:start="45:65" pos:end="45:66">-&gt;</operator><name pos:start="45:67" pos:end="45:67">h</name></name></expr>)</condition><block type="pseudo" pos:start="45:70" pos:end="45:105"><block_content pos:start="45:70" pos:end="45:105"> <expr_stmt pos:start="45:70" pos:end="45:105"><expr pos:start="45:70" pos:end="45:104"><name pos:start="45:70" pos:end="45:80"><name pos:start="45:70" pos:end="45:76">deshake</name><operator pos:start="45:77" pos:end="45:78">-&gt;</operator><name pos:start="45:79" pos:end="45:80">ch</name></name> <operator pos:start="45:82" pos:end="45:82">=</operator> <name pos:start="45:84" pos:end="45:90"><name pos:start="45:84" pos:end="45:87">link</name><operator pos:start="45:88" pos:end="45:89">-&gt;</operator><name pos:start="45:90" pos:end="45:90">h</name></name> <operator pos:start="45:92" pos:end="45:92">-</operator> <name pos:start="45:94" pos:end="45:104"><name pos:start="45:94" pos:end="45:100">deshake</name><operator pos:start="45:101" pos:end="45:102">-&gt;</operator><name pos:start="45:103" pos:end="45:104">cy</name></name></expr>;</expr_stmt></block_content></block></if></if_stmt>



        <comment type="line" pos:start="49:9" pos:end="49:38">// Quadword align right margin</comment>

        <expr_stmt pos:start="51:9" pos:end="51:27"><expr pos:start="51:9" pos:end="51:26"><name pos:start="51:9" pos:end="51:19"><name pos:start="51:9" pos:end="51:15">deshake</name><operator pos:start="51:16" pos:end="51:17">-&gt;</operator><name pos:start="51:18" pos:end="51:19">cw</name></name> <operator pos:start="51:21" pos:end="51:22">&amp;=</operator> <operator pos:start="51:24" pos:end="51:24">~</operator><literal type="number" pos:start="51:25" pos:end="51:26">15</literal></expr>;</expr_stmt>



        <expr_stmt pos:start="55:9" pos:end="55:60"><expr pos:start="55:9" pos:end="55:59"><name pos:start="55:9" pos:end="55:12">src1</name> <operator pos:start="55:14" pos:end="55:15">+=</operator> <name pos:start="55:17" pos:end="55:27"><name pos:start="55:17" pos:end="55:23">deshake</name><operator pos:start="55:24" pos:end="55:25">-&gt;</operator><name pos:start="55:26" pos:end="55:27">cy</name></name> <operator pos:start="55:29" pos:end="55:29">*</operator> <name pos:start="55:31" pos:end="55:45"><name pos:start="55:31" pos:end="55:32">in</name><operator pos:start="55:33" pos:end="55:34">-&gt;</operator><name pos:start="55:35" pos:end="55:42">linesize</name><index pos:start="55:43" pos:end="55:45">[<expr pos:start="55:44" pos:end="55:44"><literal type="number" pos:start="55:44" pos:end="55:44">0</literal></expr>]</index></name> <operator pos:start="55:47" pos:end="55:47">+</operator> <name pos:start="55:49" pos:end="55:59"><name pos:start="55:49" pos:end="55:55">deshake</name><operator pos:start="55:56" pos:end="55:57">-&gt;</operator><name pos:start="55:58" pos:end="55:59">cx</name></name></expr>;</expr_stmt>

        <expr_stmt pos:start="57:9" pos:end="57:60"><expr pos:start="57:9" pos:end="57:59"><name pos:start="57:9" pos:end="57:12">src2</name> <operator pos:start="57:14" pos:end="57:15">+=</operator> <name pos:start="57:17" pos:end="57:27"><name pos:start="57:17" pos:end="57:23">deshake</name><operator pos:start="57:24" pos:end="57:25">-&gt;</operator><name pos:start="57:26" pos:end="57:27">cy</name></name> <operator pos:start="57:29" pos:end="57:29">*</operator> <name pos:start="57:31" pos:end="57:45"><name pos:start="57:31" pos:end="57:32">in</name><operator pos:start="57:33" pos:end="57:34">-&gt;</operator><name pos:start="57:35" pos:end="57:42">linesize</name><index pos:start="57:43" pos:end="57:45">[<expr pos:start="57:44" pos:end="57:44"><literal type="number" pos:start="57:44" pos:end="57:44">0</literal></expr>]</index></name> <operator pos:start="57:47" pos:end="57:47">+</operator> <name pos:start="57:49" pos:end="57:59"><name pos:start="57:49" pos:end="57:55">deshake</name><operator pos:start="57:56" pos:end="57:57">-&gt;</operator><name pos:start="57:58" pos:end="57:59">cx</name></name></expr>;</expr_stmt>



        <expr_stmt pos:start="61:9" pos:end="61:88"><expr pos:start="61:9" pos:end="61:87"><call pos:start="61:9" pos:end="61:87"><name pos:start="61:9" pos:end="61:19">find_motion</name><argument_list pos:start="61:20" pos:end="61:87">(<argument pos:start="61:21" pos:end="61:27"><expr pos:start="61:21" pos:end="61:27"><name pos:start="61:21" pos:end="61:27">deshake</name></expr></argument>, <argument pos:start="61:30" pos:end="61:33"><expr pos:start="61:30" pos:end="61:33"><name pos:start="61:30" pos:end="61:33">src1</name></expr></argument>, <argument pos:start="61:36" pos:end="61:39"><expr pos:start="61:36" pos:end="61:39"><name pos:start="61:36" pos:end="61:39">src2</name></expr></argument>, <argument pos:start="61:42" pos:end="61:52"><expr pos:start="61:42" pos:end="61:52"><name pos:start="61:42" pos:end="61:52"><name pos:start="61:42" pos:end="61:48">deshake</name><operator pos:start="61:49" pos:end="61:50">-&gt;</operator><name pos:start="61:51" pos:end="61:52">cw</name></name></expr></argument>, <argument pos:start="61:55" pos:end="61:65"><expr pos:start="61:55" pos:end="61:65"><name pos:start="61:55" pos:end="61:65"><name pos:start="61:55" pos:end="61:61">deshake</name><operator pos:start="61:62" pos:end="61:63">-&gt;</operator><name pos:start="61:64" pos:end="61:65">ch</name></name></expr></argument>, <argument pos:start="61:68" pos:end="61:82"><expr pos:start="61:68" pos:end="61:82"><name pos:start="61:68" pos:end="61:82"><name pos:start="61:68" pos:end="61:69">in</name><operator pos:start="61:70" pos:end="61:71">-&gt;</operator><name pos:start="61:72" pos:end="61:79">linesize</name><index pos:start="61:80" pos:end="61:82">[<expr pos:start="61:81" pos:end="61:81"><literal type="number" pos:start="61:81" pos:end="61:81">0</literal></expr>]</index></name></expr></argument>, <argument pos:start="61:85" pos:end="61:86"><expr pos:start="61:85" pos:end="61:86"><operator pos:start="61:85" pos:end="61:85">&amp;</operator><name pos:start="61:86" pos:end="61:86">t</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></else></if_stmt>





    <comment type="line" pos:start="69:5" pos:end="69:80">// Copy transform so we can output it later to compare to the smoothed value</comment>

    <expr_stmt pos:start="71:5" pos:end="71:31"><expr pos:start="71:5" pos:end="71:30"><name pos:start="71:5" pos:end="71:17"><name pos:start="71:5" pos:end="71:8">orig</name><operator pos:start="71:9" pos:end="71:9">.</operator><name pos:start="71:10" pos:end="71:15">vector</name><operator pos:start="71:16" pos:end="71:16">.</operator><name pos:start="71:17" pos:end="71:17">x</name></name> <operator pos:start="71:19" pos:end="71:19">=</operator> <name pos:start="71:21" pos:end="71:30"><name pos:start="71:21" pos:end="71:21">t</name><operator pos:start="71:22" pos:end="71:22">.</operator><name pos:start="71:23" pos:end="71:28">vector</name><operator pos:start="71:29" pos:end="71:29">.</operator><name pos:start="71:30" pos:end="71:30">x</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="73:5" pos:end="73:31"><expr pos:start="73:5" pos:end="73:30"><name pos:start="73:5" pos:end="73:17"><name pos:start="73:5" pos:end="73:8">orig</name><operator pos:start="73:9" pos:end="73:9">.</operator><name pos:start="73:10" pos:end="73:15">vector</name><operator pos:start="73:16" pos:end="73:16">.</operator><name pos:start="73:17" pos:end="73:17">y</name></name> <operator pos:start="73:19" pos:end="73:19">=</operator> <name pos:start="73:21" pos:end="73:30"><name pos:start="73:21" pos:end="73:21">t</name><operator pos:start="73:22" pos:end="73:22">.</operator><name pos:start="73:23" pos:end="73:28">vector</name><operator pos:start="73:29" pos:end="73:29">.</operator><name pos:start="73:30" pos:end="73:30">y</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="75:5" pos:end="75:25"><expr pos:start="75:5" pos:end="75:24"><name pos:start="75:5" pos:end="75:14"><name pos:start="75:5" pos:end="75:8">orig</name><operator pos:start="75:9" pos:end="75:9">.</operator><name pos:start="75:10" pos:end="75:14">angle</name></name> <operator pos:start="75:16" pos:end="75:16">=</operator> <name pos:start="75:18" pos:end="75:24"><name pos:start="75:18" pos:end="75:18">t</name><operator pos:start="75:19" pos:end="75:19">.</operator><name pos:start="75:20" pos:end="75:24">angle</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="77:5" pos:end="77:23"><expr pos:start="77:5" pos:end="77:22"><name pos:start="77:5" pos:end="77:13"><name pos:start="77:5" pos:end="77:8">orig</name><operator pos:start="77:9" pos:end="77:9">.</operator><name pos:start="77:10" pos:end="77:13">zoom</name></name> <operator pos:start="77:15" pos:end="77:15">=</operator> <name pos:start="77:17" pos:end="77:22"><name pos:start="77:17" pos:end="77:17">t</name><operator pos:start="77:18" pos:end="77:18">.</operator><name pos:start="77:19" pos:end="77:22">zoom</name></name></expr>;</expr_stmt>



    <comment type="line" pos:start="81:5" pos:end="81:54">// Generate a one-sided moving exponential average</comment>

    <expr_stmt pos:start="83:5" pos:end="83:87"><expr pos:start="83:5" pos:end="83:86"><name pos:start="83:5" pos:end="83:25"><name pos:start="83:5" pos:end="83:11">deshake</name><operator pos:start="83:12" pos:end="83:13">-&gt;</operator><name pos:start="83:14" pos:end="83:16">avg</name><operator pos:start="83:17" pos:end="83:17">.</operator><name pos:start="83:18" pos:end="83:23">vector</name><operator pos:start="83:24" pos:end="83:24">.</operator><name pos:start="83:25" pos:end="83:25">x</name></name> <operator pos:start="83:27" pos:end="83:27">=</operator> <name pos:start="83:29" pos:end="83:33">alpha</name> <operator pos:start="83:35" pos:end="83:35">*</operator> <name pos:start="83:37" pos:end="83:46"><name pos:start="83:37" pos:end="83:37">t</name><operator pos:start="83:38" pos:end="83:38">.</operator><name pos:start="83:39" pos:end="83:44">vector</name><operator pos:start="83:45" pos:end="83:45">.</operator><name pos:start="83:46" pos:end="83:46">x</name></name> <operator pos:start="83:48" pos:end="83:48">+</operator> <operator pos:start="83:50" pos:end="83:50">(</operator><literal type="number" pos:start="83:51" pos:end="83:55">1.0</literal> <operator pos:start="83:55" pos:end="83:55">-</operator> <name pos:start="83:57" pos:end="83:61">alpha</name><operator pos:start="83:62" pos:end="83:62">)</operator> <operator pos:start="83:64" pos:end="83:64">*</operator> <name pos:start="83:66" pos:end="83:86"><name pos:start="83:66" pos:end="83:72">deshake</name><operator pos:start="83:73" pos:end="83:74">-&gt;</operator><name pos:start="83:75" pos:end="83:77">avg</name><operator pos:start="83:78" pos:end="83:78">.</operator><name pos:start="83:79" pos:end="83:84">vector</name><operator pos:start="83:85" pos:end="83:85">.</operator><name pos:start="83:86" pos:end="83:86">x</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="85:5" pos:end="85:87"><expr pos:start="85:5" pos:end="85:86"><name pos:start="85:5" pos:end="85:25"><name pos:start="85:5" pos:end="85:11">deshake</name><operator pos:start="85:12" pos:end="85:13">-&gt;</operator><name pos:start="85:14" pos:end="85:16">avg</name><operator pos:start="85:17" pos:end="85:17">.</operator><name pos:start="85:18" pos:end="85:23">vector</name><operator pos:start="85:24" pos:end="85:24">.</operator><name pos:start="85:25" pos:end="85:25">y</name></name> <operator pos:start="85:27" pos:end="85:27">=</operator> <name pos:start="85:29" pos:end="85:33">alpha</name> <operator pos:start="85:35" pos:end="85:35">*</operator> <name pos:start="85:37" pos:end="85:46"><name pos:start="85:37" pos:end="85:37">t</name><operator pos:start="85:38" pos:end="85:38">.</operator><name pos:start="85:39" pos:end="85:44">vector</name><operator pos:start="85:45" pos:end="85:45">.</operator><name pos:start="85:46" pos:end="85:46">y</name></name> <operator pos:start="85:48" pos:end="85:48">+</operator> <operator pos:start="85:50" pos:end="85:50">(</operator><literal type="number" pos:start="85:51" pos:end="85:55">1.0</literal> <operator pos:start="85:55" pos:end="85:55">-</operator> <name pos:start="85:57" pos:end="85:61">alpha</name><operator pos:start="85:62" pos:end="85:62">)</operator> <operator pos:start="85:64" pos:end="85:64">*</operator> <name pos:start="85:66" pos:end="85:86"><name pos:start="85:66" pos:end="85:72">deshake</name><operator pos:start="85:73" pos:end="85:74">-&gt;</operator><name pos:start="85:75" pos:end="85:77">avg</name><operator pos:start="85:78" pos:end="85:78">.</operator><name pos:start="85:79" pos:end="85:84">vector</name><operator pos:start="85:85" pos:end="85:85">.</operator><name pos:start="85:86" pos:end="85:86">y</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="87:5" pos:end="87:78"><expr pos:start="87:5" pos:end="87:77"><name pos:start="87:5" pos:end="87:22"><name pos:start="87:5" pos:end="87:11">deshake</name><operator pos:start="87:12" pos:end="87:13">-&gt;</operator><name pos:start="87:14" pos:end="87:16">avg</name><operator pos:start="87:17" pos:end="87:17">.</operator><name pos:start="87:18" pos:end="87:22">angle</name></name> <operator pos:start="87:24" pos:end="87:24">=</operator> <name pos:start="87:26" pos:end="87:30">alpha</name> <operator pos:start="87:32" pos:end="87:32">*</operator> <name pos:start="87:34" pos:end="87:40"><name pos:start="87:34" pos:end="87:34">t</name><operator pos:start="87:35" pos:end="87:35">.</operator><name pos:start="87:36" pos:end="87:40">angle</name></name> <operator pos:start="87:42" pos:end="87:42">+</operator> <operator pos:start="87:44" pos:end="87:44">(</operator><literal type="number" pos:start="87:45" pos:end="87:49">1.0</literal> <operator pos:start="87:49" pos:end="87:49">-</operator> <name pos:start="87:51" pos:end="87:55">alpha</name><operator pos:start="87:56" pos:end="87:56">)</operator> <operator pos:start="87:58" pos:end="87:58">*</operator> <name pos:start="87:60" pos:end="87:77"><name pos:start="87:60" pos:end="87:66">deshake</name><operator pos:start="87:67" pos:end="87:68">-&gt;</operator><name pos:start="87:69" pos:end="87:71">avg</name><operator pos:start="87:72" pos:end="87:72">.</operator><name pos:start="87:73" pos:end="87:77">angle</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="89:5" pos:end="89:75"><expr pos:start="89:5" pos:end="89:74"><name pos:start="89:5" pos:end="89:21"><name pos:start="89:5" pos:end="89:11">deshake</name><operator pos:start="89:12" pos:end="89:13">-&gt;</operator><name pos:start="89:14" pos:end="89:16">avg</name><operator pos:start="89:17" pos:end="89:17">.</operator><name pos:start="89:18" pos:end="89:21">zoom</name></name> <operator pos:start="89:23" pos:end="89:23">=</operator> <name pos:start="89:25" pos:end="89:29">alpha</name> <operator pos:start="89:31" pos:end="89:31">*</operator> <name pos:start="89:33" pos:end="89:38"><name pos:start="89:33" pos:end="89:33">t</name><operator pos:start="89:34" pos:end="89:34">.</operator><name pos:start="89:35" pos:end="89:38">zoom</name></name> <operator pos:start="89:40" pos:end="89:40">+</operator> <operator pos:start="89:42" pos:end="89:42">(</operator><literal type="number" pos:start="89:43" pos:end="89:47">1.0</literal> <operator pos:start="89:47" pos:end="89:47">-</operator> <name pos:start="89:49" pos:end="89:53">alpha</name><operator pos:start="89:54" pos:end="89:54">)</operator> <operator pos:start="89:56" pos:end="89:56">*</operator> <name pos:start="89:58" pos:end="89:74"><name pos:start="89:58" pos:end="89:64">deshake</name><operator pos:start="89:65" pos:end="89:66">-&gt;</operator><name pos:start="89:67" pos:end="89:69">avg</name><operator pos:start="89:70" pos:end="89:70">.</operator><name pos:start="89:71" pos:end="89:74">zoom</name></name></expr>;</expr_stmt>



    <comment type="line" pos:start="93:5" pos:end="93:75">// Remove the average from the current motion to detect the motion that</comment>

    <comment type="line" pos:start="95:5" pos:end="95:64">// is not on purpose, just as jitter from bumping the camera</comment>

    <expr_stmt pos:start="97:5" pos:end="97:40"><expr pos:start="97:5" pos:end="97:39"><name pos:start="97:5" pos:end="97:14"><name pos:start="97:5" pos:end="97:5">t</name><operator pos:start="97:6" pos:end="97:6">.</operator><name pos:start="97:7" pos:end="97:12">vector</name><operator pos:start="97:13" pos:end="97:13">.</operator><name pos:start="97:14" pos:end="97:14">x</name></name> <operator pos:start="97:16" pos:end="97:17">-=</operator> <name pos:start="97:19" pos:end="97:39"><name pos:start="97:19" pos:end="97:25">deshake</name><operator pos:start="97:26" pos:end="97:27">-&gt;</operator><name pos:start="97:28" pos:end="97:30">avg</name><operator pos:start="97:31" pos:end="97:31">.</operator><name pos:start="97:32" pos:end="97:37">vector</name><operator pos:start="97:38" pos:end="97:38">.</operator><name pos:start="97:39" pos:end="97:39">x</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="99:5" pos:end="99:40"><expr pos:start="99:5" pos:end="99:39"><name pos:start="99:5" pos:end="99:14"><name pos:start="99:5" pos:end="99:5">t</name><operator pos:start="99:6" pos:end="99:6">.</operator><name pos:start="99:7" pos:end="99:12">vector</name><operator pos:start="99:13" pos:end="99:13">.</operator><name pos:start="99:14" pos:end="99:14">y</name></name> <operator pos:start="99:16" pos:end="99:17">-=</operator> <name pos:start="99:19" pos:end="99:39"><name pos:start="99:19" pos:end="99:25">deshake</name><operator pos:start="99:26" pos:end="99:27">-&gt;</operator><name pos:start="99:28" pos:end="99:30">avg</name><operator pos:start="99:31" pos:end="99:31">.</operator><name pos:start="99:32" pos:end="99:37">vector</name><operator pos:start="99:38" pos:end="99:38">.</operator><name pos:start="99:39" pos:end="99:39">y</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="101:5" pos:end="101:34"><expr pos:start="101:5" pos:end="101:33"><name pos:start="101:5" pos:end="101:11"><name pos:start="101:5" pos:end="101:5">t</name><operator pos:start="101:6" pos:end="101:6">.</operator><name pos:start="101:7" pos:end="101:11">angle</name></name> <operator pos:start="101:13" pos:end="101:14">-=</operator> <name pos:start="101:16" pos:end="101:33"><name pos:start="101:16" pos:end="101:22">deshake</name><operator pos:start="101:23" pos:end="101:24">-&gt;</operator><name pos:start="101:25" pos:end="101:27">avg</name><operator pos:start="101:28" pos:end="101:28">.</operator><name pos:start="101:29" pos:end="101:33">angle</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="103:5" pos:end="103:32"><expr pos:start="103:5" pos:end="103:31"><name pos:start="103:5" pos:end="103:10"><name pos:start="103:5" pos:end="103:5">t</name><operator pos:start="103:6" pos:end="103:6">.</operator><name pos:start="103:7" pos:end="103:10">zoom</name></name> <operator pos:start="103:12" pos:end="103:13">-=</operator> <name pos:start="103:15" pos:end="103:31"><name pos:start="103:15" pos:end="103:21">deshake</name><operator pos:start="103:22" pos:end="103:23">-&gt;</operator><name pos:start="103:24" pos:end="103:26">avg</name><operator pos:start="103:27" pos:end="103:27">.</operator><name pos:start="103:28" pos:end="103:31">zoom</name></name></expr>;</expr_stmt>



    <comment type="line" pos:start="107:5" pos:end="107:35">// Invert the motion to undo it</comment>

    <expr_stmt pos:start="109:5" pos:end="109:21"><expr pos:start="109:5" pos:end="109:20"><name pos:start="109:5" pos:end="109:14"><name pos:start="109:5" pos:end="109:5">t</name><operator pos:start="109:6" pos:end="109:6">.</operator><name pos:start="109:7" pos:end="109:12">vector</name><operator pos:start="109:13" pos:end="109:13">.</operator><name pos:start="109:14" pos:end="109:14">x</name></name> <operator pos:start="109:16" pos:end="109:17">*=</operator> <operator pos:start="109:19" pos:end="109:19">-</operator><literal type="number" pos:start="109:20" pos:end="109:20">1</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="111:5" pos:end="111:21"><expr pos:start="111:5" pos:end="111:20"><name pos:start="111:5" pos:end="111:14"><name pos:start="111:5" pos:end="111:5">t</name><operator pos:start="111:6" pos:end="111:6">.</operator><name pos:start="111:7" pos:end="111:12">vector</name><operator pos:start="111:13" pos:end="111:13">.</operator><name pos:start="111:14" pos:end="111:14">y</name></name> <operator pos:start="111:16" pos:end="111:17">*=</operator> <operator pos:start="111:19" pos:end="111:19">-</operator><literal type="number" pos:start="111:20" pos:end="111:20">1</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="113:5" pos:end="113:18"><expr pos:start="113:5" pos:end="113:17"><name pos:start="113:5" pos:end="113:11"><name pos:start="113:5" pos:end="113:5">t</name><operator pos:start="113:6" pos:end="113:6">.</operator><name pos:start="113:7" pos:end="113:11">angle</name></name> <operator pos:start="113:13" pos:end="113:14">*=</operator> <operator pos:start="113:16" pos:end="113:16">-</operator><literal type="number" pos:start="113:17" pos:end="113:17">1</literal></expr>;</expr_stmt>



    <comment type="line" pos:start="117:5" pos:end="117:31">// Write statistics to file</comment>

    <if_stmt pos:start="119:5" pos:end="125:5"><if pos:start="119:5" pos:end="125:5">if <condition pos:start="119:8" pos:end="119:20">(<expr pos:start="119:9" pos:end="119:19"><name pos:start="119:9" pos:end="119:19"><name pos:start="119:9" pos:end="119:15">deshake</name><operator pos:start="119:16" pos:end="119:17">-&gt;</operator><name pos:start="119:18" pos:end="119:19">fp</name></name></expr>)</condition> <block pos:start="119:22" pos:end="125:5">{<block_content pos:start="121:9" pos:end="123:60">

        <expr_stmt pos:start="121:9" pos:end="121:258"><expr pos:start="121:9" pos:end="121:257"><call pos:start="121:9" pos:end="121:257"><name pos:start="121:9" pos:end="121:16">snprintf</name><argument_list pos:start="121:17" pos:end="121:257">(<argument pos:start="121:18" pos:end="121:20"><expr pos:start="121:18" pos:end="121:20"><name pos:start="121:18" pos:end="121:20">tmp</name></expr></argument>, <argument pos:start="121:23" pos:end="121:25"><expr pos:start="121:23" pos:end="121:25"><literal type="number" pos:start="121:23" pos:end="121:25">256</literal></expr></argument>, <argument pos:start="121:28" pos:end="121:77"><expr pos:start="121:28" pos:end="121:77"><literal type="string" pos:start="121:28" pos:end="121:77">"%f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f\n"</literal></expr></argument>, <argument pos:start="121:80" pos:end="121:92"><expr pos:start="121:80" pos:end="121:92"><name pos:start="121:80" pos:end="121:92"><name pos:start="121:80" pos:end="121:83">orig</name><operator pos:start="121:84" pos:end="121:84">.</operator><name pos:start="121:85" pos:end="121:90">vector</name><operator pos:start="121:91" pos:end="121:91">.</operator><name pos:start="121:92" pos:end="121:92">x</name></name></expr></argument>, <argument pos:start="121:95" pos:end="121:115"><expr pos:start="121:95" pos:end="121:115"><name pos:start="121:95" pos:end="121:115"><name pos:start="121:95" pos:end="121:101">deshake</name><operator pos:start="121:102" pos:end="121:103">-&gt;</operator><name pos:start="121:104" pos:end="121:106">avg</name><operator pos:start="121:107" pos:end="121:107">.</operator><name pos:start="121:108" pos:end="121:113">vector</name><operator pos:start="121:114" pos:end="121:114">.</operator><name pos:start="121:115" pos:end="121:115">x</name></name></expr></argument>, <argument pos:start="121:118" pos:end="121:127"><expr pos:start="121:118" pos:end="121:127"><name pos:start="121:118" pos:end="121:127"><name pos:start="121:118" pos:end="121:118">t</name><operator pos:start="121:119" pos:end="121:119">.</operator><name pos:start="121:120" pos:end="121:125">vector</name><operator pos:start="121:126" pos:end="121:126">.</operator><name pos:start="121:127" pos:end="121:127">x</name></name></expr></argument>, <argument pos:start="121:130" pos:end="121:142"><expr pos:start="121:130" pos:end="121:142"><name pos:start="121:130" pos:end="121:142"><name pos:start="121:130" pos:end="121:133">orig</name><operator pos:start="121:134" pos:end="121:134">.</operator><name pos:start="121:135" pos:end="121:140">vector</name><operator pos:start="121:141" pos:end="121:141">.</operator><name pos:start="121:142" pos:end="121:142">y</name></name></expr></argument>, <argument pos:start="121:145" pos:end="121:165"><expr pos:start="121:145" pos:end="121:165"><name pos:start="121:145" pos:end="121:165"><name pos:start="121:145" pos:end="121:151">deshake</name><operator pos:start="121:152" pos:end="121:153">-&gt;</operator><name pos:start="121:154" pos:end="121:156">avg</name><operator pos:start="121:157" pos:end="121:157">.</operator><name pos:start="121:158" pos:end="121:163">vector</name><operator pos:start="121:164" pos:end="121:164">.</operator><name pos:start="121:165" pos:end="121:165">y</name></name></expr></argument>, <argument pos:start="121:168" pos:end="121:177"><expr pos:start="121:168" pos:end="121:177"><name pos:start="121:168" pos:end="121:177"><name pos:start="121:168" pos:end="121:168">t</name><operator pos:start="121:169" pos:end="121:169">.</operator><name pos:start="121:170" pos:end="121:175">vector</name><operator pos:start="121:176" pos:end="121:176">.</operator><name pos:start="121:177" pos:end="121:177">y</name></name></expr></argument>, <argument pos:start="121:180" pos:end="121:189"><expr pos:start="121:180" pos:end="121:189"><name pos:start="121:180" pos:end="121:189"><name pos:start="121:180" pos:end="121:183">orig</name><operator pos:start="121:184" pos:end="121:184">.</operator><name pos:start="121:185" pos:end="121:189">angle</name></name></expr></argument>, <argument pos:start="121:192" pos:end="121:209"><expr pos:start="121:192" pos:end="121:209"><name pos:start="121:192" pos:end="121:209"><name pos:start="121:192" pos:end="121:198">deshake</name><operator pos:start="121:199" pos:end="121:200">-&gt;</operator><name pos:start="121:201" pos:end="121:203">avg</name><operator pos:start="121:204" pos:end="121:204">.</operator><name pos:start="121:205" pos:end="121:209">angle</name></name></expr></argument>, <argument pos:start="121:212" pos:end="121:218"><expr pos:start="121:212" pos:end="121:218"><name pos:start="121:212" pos:end="121:218"><name pos:start="121:212" pos:end="121:212">t</name><operator pos:start="121:213" pos:end="121:213">.</operator><name pos:start="121:214" pos:end="121:218">angle</name></name></expr></argument>, <argument pos:start="121:221" pos:end="121:229"><expr pos:start="121:221" pos:end="121:229"><name pos:start="121:221" pos:end="121:229"><name pos:start="121:221" pos:end="121:224">orig</name><operator pos:start="121:225" pos:end="121:225">.</operator><name pos:start="121:226" pos:end="121:229">zoom</name></name></expr></argument>, <argument pos:start="121:232" pos:end="121:248"><expr pos:start="121:232" pos:end="121:248"><name pos:start="121:232" pos:end="121:248"><name pos:start="121:232" pos:end="121:238">deshake</name><operator pos:start="121:239" pos:end="121:240">-&gt;</operator><name pos:start="121:241" pos:end="121:243">avg</name><operator pos:start="121:244" pos:end="121:244">.</operator><name pos:start="121:245" pos:end="121:248">zoom</name></name></expr></argument>, <argument pos:start="121:251" pos:end="121:256"><expr pos:start="121:251" pos:end="121:256"><name pos:start="121:251" pos:end="121:256"><name pos:start="121:251" pos:end="121:251">t</name><operator pos:start="121:252" pos:end="121:252">.</operator><name pos:start="121:253" pos:end="121:256">zoom</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="123:9" pos:end="123:60"><expr pos:start="123:9" pos:end="123:59"><call pos:start="123:9" pos:end="123:59"><name pos:start="123:9" pos:end="123:14">fwrite</name><argument_list pos:start="123:15" pos:end="123:59">(<argument pos:start="123:16" pos:end="123:18"><expr pos:start="123:16" pos:end="123:18"><name pos:start="123:16" pos:end="123:18">tmp</name></expr></argument>, <argument pos:start="123:21" pos:end="123:32"><expr pos:start="123:21" pos:end="123:32"><sizeof pos:start="123:21" pos:end="123:32">sizeof<argument_list pos:start="123:27" pos:end="123:32">(<argument pos:start="123:28" pos:end="123:31"><expr pos:start="123:28" pos:end="123:31"><name pos:start="123:28" pos:end="123:31">char</name></expr></argument>)</argument_list></sizeof></expr></argument>, <argument pos:start="123:35" pos:end="123:45"><expr pos:start="123:35" pos:end="123:45"><call pos:start="123:35" pos:end="123:45"><name pos:start="123:35" pos:end="123:40">strlen</name><argument_list pos:start="123:41" pos:end="123:45">(<argument pos:start="123:42" pos:end="123:44"><expr pos:start="123:42" pos:end="123:44"><name pos:start="123:42" pos:end="123:44">tmp</name></expr></argument>)</argument_list></call></expr></argument>, <argument pos:start="123:48" pos:end="123:58"><expr pos:start="123:48" pos:end="123:58"><name pos:start="123:48" pos:end="123:58"><name pos:start="123:48" pos:end="123:54">deshake</name><operator pos:start="123:55" pos:end="123:56">-&gt;</operator><name pos:start="123:57" pos:end="123:58">fp</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if></if_stmt>



    <comment type="line" pos:start="129:5" pos:end="129:75">// Turn relative current frame motion into absolute by adding it to the</comment>

    <comment type="line" pos:start="131:5" pos:end="131:27">// last absolute motion</comment>

    <expr_stmt pos:start="133:5" pos:end="133:41"><expr pos:start="133:5" pos:end="133:40"><name pos:start="133:5" pos:end="133:14"><name pos:start="133:5" pos:end="133:5">t</name><operator pos:start="133:6" pos:end="133:6">.</operator><name pos:start="133:7" pos:end="133:12">vector</name><operator pos:start="133:13" pos:end="133:13">.</operator><name pos:start="133:14" pos:end="133:14">x</name></name> <operator pos:start="133:16" pos:end="133:17">+=</operator> <name pos:start="133:19" pos:end="133:40"><name pos:start="133:19" pos:end="133:25">deshake</name><operator pos:start="133:26" pos:end="133:27">-&gt;</operator><name pos:start="133:28" pos:end="133:31">last</name><operator pos:start="133:32" pos:end="133:32">.</operator><name pos:start="133:33" pos:end="133:38">vector</name><operator pos:start="133:39" pos:end="133:39">.</operator><name pos:start="133:40" pos:end="133:40">x</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="135:5" pos:end="135:41"><expr pos:start="135:5" pos:end="135:40"><name pos:start="135:5" pos:end="135:14"><name pos:start="135:5" pos:end="135:5">t</name><operator pos:start="135:6" pos:end="135:6">.</operator><name pos:start="135:7" pos:end="135:12">vector</name><operator pos:start="135:13" pos:end="135:13">.</operator><name pos:start="135:14" pos:end="135:14">y</name></name> <operator pos:start="135:16" pos:end="135:17">+=</operator> <name pos:start="135:19" pos:end="135:40"><name pos:start="135:19" pos:end="135:25">deshake</name><operator pos:start="135:26" pos:end="135:27">-&gt;</operator><name pos:start="135:28" pos:end="135:31">last</name><operator pos:start="135:32" pos:end="135:32">.</operator><name pos:start="135:33" pos:end="135:38">vector</name><operator pos:start="135:39" pos:end="135:39">.</operator><name pos:start="135:40" pos:end="135:40">y</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="137:5" pos:end="137:35"><expr pos:start="137:5" pos:end="137:34"><name pos:start="137:5" pos:end="137:11"><name pos:start="137:5" pos:end="137:5">t</name><operator pos:start="137:6" pos:end="137:6">.</operator><name pos:start="137:7" pos:end="137:11">angle</name></name> <operator pos:start="137:13" pos:end="137:14">+=</operator> <name pos:start="137:16" pos:end="137:34"><name pos:start="137:16" pos:end="137:22">deshake</name><operator pos:start="137:23" pos:end="137:24">-&gt;</operator><name pos:start="137:25" pos:end="137:28">last</name><operator pos:start="137:29" pos:end="137:29">.</operator><name pos:start="137:30" pos:end="137:34">angle</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="139:5" pos:end="139:33"><expr pos:start="139:5" pos:end="139:32"><name pos:start="139:5" pos:end="139:10"><name pos:start="139:5" pos:end="139:5">t</name><operator pos:start="139:6" pos:end="139:6">.</operator><name pos:start="139:7" pos:end="139:10">zoom</name></name> <operator pos:start="139:12" pos:end="139:13">+=</operator> <name pos:start="139:15" pos:end="139:32"><name pos:start="139:15" pos:end="139:21">deshake</name><operator pos:start="139:22" pos:end="139:23">-&gt;</operator><name pos:start="139:24" pos:end="139:27">last</name><operator pos:start="139:28" pos:end="139:28">.</operator><name pos:start="139:29" pos:end="139:32">zoom</name></name></expr>;</expr_stmt>



    <comment type="line" pos:start="143:5" pos:end="143:71">// Shrink motion by 10% to keep things centered in the camera frame</comment>

    <expr_stmt pos:start="145:5" pos:end="145:22"><expr pos:start="145:5" pos:end="145:21"><name pos:start="145:5" pos:end="145:14"><name pos:start="145:5" pos:end="145:5">t</name><operator pos:start="145:6" pos:end="145:6">.</operator><name pos:start="145:7" pos:end="145:12">vector</name><operator pos:start="145:13" pos:end="145:13">.</operator><name pos:start="145:14" pos:end="145:14">x</name></name> <operator pos:start="145:16" pos:end="145:17">*=</operator> <literal type="number" pos:start="145:19" pos:end="145:21">0.9</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="147:5" pos:end="147:22"><expr pos:start="147:5" pos:end="147:21"><name pos:start="147:5" pos:end="147:14"><name pos:start="147:5" pos:end="147:5">t</name><operator pos:start="147:6" pos:end="147:6">.</operator><name pos:start="147:7" pos:end="147:12">vector</name><operator pos:start="147:13" pos:end="147:13">.</operator><name pos:start="147:14" pos:end="147:14">y</name></name> <operator pos:start="147:16" pos:end="147:17">*=</operator> <literal type="number" pos:start="147:19" pos:end="147:21">0.9</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="149:5" pos:end="149:19"><expr pos:start="149:5" pos:end="149:18"><name pos:start="149:5" pos:end="149:11"><name pos:start="149:5" pos:end="149:5">t</name><operator pos:start="149:6" pos:end="149:6">.</operator><name pos:start="149:7" pos:end="149:11">angle</name></name> <operator pos:start="149:13" pos:end="149:14">*=</operator> <literal type="number" pos:start="149:16" pos:end="149:18">0.9</literal></expr>;</expr_stmt>



    <comment type="line" pos:start="153:5" pos:end="153:49">// Store the last absolute motion information</comment>

    <expr_stmt pos:start="155:5" pos:end="155:40"><expr pos:start="155:5" pos:end="155:39"><name pos:start="155:5" pos:end="155:26"><name pos:start="155:5" pos:end="155:11">deshake</name><operator pos:start="155:12" pos:end="155:13">-&gt;</operator><name pos:start="155:14" pos:end="155:17">last</name><operator pos:start="155:18" pos:end="155:18">.</operator><name pos:start="155:19" pos:end="155:24">vector</name><operator pos:start="155:25" pos:end="155:25">.</operator><name pos:start="155:26" pos:end="155:26">x</name></name> <operator pos:start="155:28" pos:end="155:28">=</operator> <name pos:start="155:30" pos:end="155:39"><name pos:start="155:30" pos:end="155:30">t</name><operator pos:start="155:31" pos:end="155:31">.</operator><name pos:start="155:32" pos:end="155:37">vector</name><operator pos:start="155:38" pos:end="155:38">.</operator><name pos:start="155:39" pos:end="155:39">x</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="157:5" pos:end="157:40"><expr pos:start="157:5" pos:end="157:39"><name pos:start="157:5" pos:end="157:26"><name pos:start="157:5" pos:end="157:11">deshake</name><operator pos:start="157:12" pos:end="157:13">-&gt;</operator><name pos:start="157:14" pos:end="157:17">last</name><operator pos:start="157:18" pos:end="157:18">.</operator><name pos:start="157:19" pos:end="157:24">vector</name><operator pos:start="157:25" pos:end="157:25">.</operator><name pos:start="157:26" pos:end="157:26">y</name></name> <operator pos:start="157:28" pos:end="157:28">=</operator> <name pos:start="157:30" pos:end="157:39"><name pos:start="157:30" pos:end="157:30">t</name><operator pos:start="157:31" pos:end="157:31">.</operator><name pos:start="157:32" pos:end="157:37">vector</name><operator pos:start="157:38" pos:end="157:38">.</operator><name pos:start="157:39" pos:end="157:39">y</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="159:5" pos:end="159:34"><expr pos:start="159:5" pos:end="159:33"><name pos:start="159:5" pos:end="159:23"><name pos:start="159:5" pos:end="159:11">deshake</name><operator pos:start="159:12" pos:end="159:13">-&gt;</operator><name pos:start="159:14" pos:end="159:17">last</name><operator pos:start="159:18" pos:end="159:18">.</operator><name pos:start="159:19" pos:end="159:23">angle</name></name> <operator pos:start="159:25" pos:end="159:25">=</operator> <name pos:start="159:27" pos:end="159:33"><name pos:start="159:27" pos:end="159:27">t</name><operator pos:start="159:28" pos:end="159:28">.</operator><name pos:start="159:29" pos:end="159:33">angle</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="161:5" pos:end="161:32"><expr pos:start="161:5" pos:end="161:31"><name pos:start="161:5" pos:end="161:22"><name pos:start="161:5" pos:end="161:11">deshake</name><operator pos:start="161:12" pos:end="161:13">-&gt;</operator><name pos:start="161:14" pos:end="161:17">last</name><operator pos:start="161:18" pos:end="161:18">.</operator><name pos:start="161:19" pos:end="161:22">zoom</name></name> <operator pos:start="161:24" pos:end="161:24">=</operator> <name pos:start="161:26" pos:end="161:31"><name pos:start="161:26" pos:end="161:26">t</name><operator pos:start="161:27" pos:end="161:27">.</operator><name pos:start="161:28" pos:end="161:31">zoom</name></name></expr>;</expr_stmt>



    <comment type="line" pos:start="165:5" pos:end="165:44">// Generate a luma transformation matrix</comment>

    <expr_stmt pos:start="167:5" pos:end="167:87"><expr pos:start="167:5" pos:end="167:86"><call pos:start="167:5" pos:end="167:86"><name pos:start="167:5" pos:end="167:23">avfilter_get_matrix</name><argument_list pos:start="167:24" pos:end="167:86">(<argument pos:start="167:25" pos:end="167:34"><expr pos:start="167:25" pos:end="167:34"><name pos:start="167:25" pos:end="167:34"><name pos:start="167:25" pos:end="167:25">t</name><operator pos:start="167:26" pos:end="167:26">.</operator><name pos:start="167:27" pos:end="167:32">vector</name><operator pos:start="167:33" pos:end="167:33">.</operator><name pos:start="167:34" pos:end="167:34">x</name></name></expr></argument>, <argument pos:start="167:37" pos:end="167:46"><expr pos:start="167:37" pos:end="167:46"><name pos:start="167:37" pos:end="167:46"><name pos:start="167:37" pos:end="167:37">t</name><operator pos:start="167:38" pos:end="167:38">.</operator><name pos:start="167:39" pos:end="167:44">vector</name><operator pos:start="167:45" pos:end="167:45">.</operator><name pos:start="167:46" pos:end="167:46">y</name></name></expr></argument>, <argument pos:start="167:49" pos:end="167:55"><expr pos:start="167:49" pos:end="167:55"><name pos:start="167:49" pos:end="167:55"><name pos:start="167:49" pos:end="167:49">t</name><operator pos:start="167:50" pos:end="167:50">.</operator><name pos:start="167:51" pos:end="167:55">angle</name></name></expr></argument>, <argument pos:start="167:58" pos:end="167:77"><expr pos:start="167:58" pos:end="167:77"><literal type="number" pos:start="167:58" pos:end="167:62">1.0</literal> <operator pos:start="167:62" pos:end="167:62">+</operator> <name pos:start="167:64" pos:end="167:69"><name pos:start="167:64" pos:end="167:64">t</name><operator pos:start="167:65" pos:end="167:65">.</operator><name pos:start="167:66" pos:end="167:69">zoom</name></name> <operator pos:start="167:71" pos:end="167:71">/</operator> <literal type="number" pos:start="167:73" pos:end="167:77">100.0</literal></expr></argument>, <argument pos:start="167:80" pos:end="167:85"><expr pos:start="167:80" pos:end="167:85"><name pos:start="167:80" pos:end="167:85">matrix</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <comment type="line" pos:start="171:5" pos:end="171:31">// Transform the luma plane</comment>

    <expr_stmt pos:start="173:5" pos:end="173:148"><expr pos:start="173:5" pos:end="173:147"><call pos:start="173:5" pos:end="173:147"><name pos:start="173:5" pos:end="173:22">avfilter_transform</name><argument_list pos:start="173:23" pos:end="173:147">(<argument pos:start="173:24" pos:end="173:34"><expr pos:start="173:24" pos:end="173:34"><name pos:start="173:24" pos:end="173:34"><name pos:start="173:24" pos:end="173:25">in</name><operator pos:start="173:26" pos:end="173:27">-&gt;</operator><name pos:start="173:28" pos:end="173:31">data</name><index pos:start="173:32" pos:end="173:34">[<expr pos:start="173:33" pos:end="173:33"><literal type="number" pos:start="173:33" pos:end="173:33">0</literal></expr>]</index></name></expr></argument>, <argument pos:start="173:37" pos:end="173:48"><expr pos:start="173:37" pos:end="173:48"><name pos:start="173:37" pos:end="173:48"><name pos:start="173:37" pos:end="173:39">out</name><operator pos:start="173:40" pos:end="173:41">-&gt;</operator><name pos:start="173:42" pos:end="173:45">data</name><index pos:start="173:46" pos:end="173:48">[<expr pos:start="173:47" pos:end="173:47"><literal type="number" pos:start="173:47" pos:end="173:47">0</literal></expr>]</index></name></expr></argument>, <argument pos:start="173:51" pos:end="173:65"><expr pos:start="173:51" pos:end="173:65"><name pos:start="173:51" pos:end="173:65"><name pos:start="173:51" pos:end="173:52">in</name><operator pos:start="173:53" pos:end="173:54">-&gt;</operator><name pos:start="173:55" pos:end="173:62">linesize</name><index pos:start="173:63" pos:end="173:65">[<expr pos:start="173:64" pos:end="173:64"><literal type="number" pos:start="173:64" pos:end="173:64">0</literal></expr>]</index></name></expr></argument>, <argument pos:start="173:68" pos:end="173:83"><expr pos:start="173:68" pos:end="173:83"><name pos:start="173:68" pos:end="173:83"><name pos:start="173:68" pos:end="173:70">out</name><operator pos:start="173:71" pos:end="173:72">-&gt;</operator><name pos:start="173:73" pos:end="173:80">linesize</name><index pos:start="173:81" pos:end="173:83">[<expr pos:start="173:82" pos:end="173:82"><literal type="number" pos:start="173:82" pos:end="173:82">0</literal></expr>]</index></name></expr></argument>, <argument pos:start="173:86" pos:end="173:92"><expr pos:start="173:86" pos:end="173:92"><name pos:start="173:86" pos:end="173:92"><name pos:start="173:86" pos:end="173:89">link</name><operator pos:start="173:90" pos:end="173:91">-&gt;</operator><name pos:start="173:92" pos:end="173:92">w</name></name></expr></argument>, <argument pos:start="173:95" pos:end="173:101"><expr pos:start="173:95" pos:end="173:101"><name pos:start="173:95" pos:end="173:101"><name pos:start="173:95" pos:end="173:98">link</name><operator pos:start="173:99" pos:end="173:100">-&gt;</operator><name pos:start="173:101" pos:end="173:101">h</name></name></expr></argument>, <argument pos:start="173:104" pos:end="173:109"><expr pos:start="173:104" pos:end="173:109"><name pos:start="173:104" pos:end="173:109">matrix</name></expr></argument>, <argument pos:start="173:112" pos:end="173:131"><expr pos:start="173:112" pos:end="173:131"><name pos:start="173:112" pos:end="173:131">INTERPOLATE_BILINEAR</name></expr></argument>, <argument pos:start="173:134" pos:end="173:146"><expr pos:start="173:134" pos:end="173:146"><name pos:start="173:134" pos:end="173:146"><name pos:start="173:134" pos:end="173:140">deshake</name><operator pos:start="173:141" pos:end="173:142">-&gt;</operator><name pos:start="173:143" pos:end="173:146">edge</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <comment type="line" pos:start="177:5" pos:end="177:46">// Generate a chroma transformation matrix</comment>

    <expr_stmt pos:start="179:5" pos:end="179:154"><expr pos:start="179:5" pos:end="179:153"><call pos:start="179:5" pos:end="179:153"><name pos:start="179:5" pos:end="179:23">avfilter_get_matrix</name><argument_list pos:start="179:24" pos:end="179:153">(<argument pos:start="179:25" pos:end="179:67"><expr pos:start="179:25" pos:end="179:67"><name pos:start="179:25" pos:end="179:34"><name pos:start="179:25" pos:end="179:25">t</name><operator pos:start="179:26" pos:end="179:26">.</operator><name pos:start="179:27" pos:end="179:32">vector</name><operator pos:start="179:33" pos:end="179:33">.</operator><name pos:start="179:34" pos:end="179:34">x</name></name> <operator pos:start="179:36" pos:end="179:36">/</operator> <operator pos:start="179:38" pos:end="179:38">(</operator><name pos:start="179:39" pos:end="179:45"><name pos:start="179:39" pos:end="179:42">link</name><operator pos:start="179:43" pos:end="179:44">-&gt;</operator><name pos:start="179:45" pos:end="179:45">w</name></name> <operator pos:start="179:47" pos:end="179:47">/</operator> <call pos:start="179:49" pos:end="179:66"><name pos:start="179:49" pos:end="179:60">CHROMA_WIDTH</name><argument_list pos:start="179:61" pos:end="179:66">(<argument pos:start="179:62" pos:end="179:65"><expr pos:start="179:62" pos:end="179:65"><name pos:start="179:62" pos:end="179:65">link</name></expr></argument>)</argument_list></call><operator pos:start="179:67" pos:end="179:67">)</operator></expr></argument>, <argument pos:start="179:70" pos:end="179:113"><expr pos:start="179:70" pos:end="179:113"><name pos:start="179:70" pos:end="179:79"><name pos:start="179:70" pos:end="179:70">t</name><operator pos:start="179:71" pos:end="179:71">.</operator><name pos:start="179:72" pos:end="179:77">vector</name><operator pos:start="179:78" pos:end="179:78">.</operator><name pos:start="179:79" pos:end="179:79">y</name></name> <operator pos:start="179:81" pos:end="179:81">/</operator> <operator pos:start="179:83" pos:end="179:83">(</operator><name pos:start="179:84" pos:end="179:90"><name pos:start="179:84" pos:end="179:87">link</name><operator pos:start="179:88" pos:end="179:89">-&gt;</operator><name pos:start="179:90" pos:end="179:90">h</name></name> <operator pos:start="179:92" pos:end="179:92">/</operator> <call pos:start="179:94" pos:end="179:112"><name pos:start="179:94" pos:end="179:106">CHROMA_HEIGHT</name><argument_list pos:start="179:107" pos:end="179:112">(<argument pos:start="179:108" pos:end="179:111"><expr pos:start="179:108" pos:end="179:111"><name pos:start="179:108" pos:end="179:111">link</name></expr></argument>)</argument_list></call><operator pos:start="179:113" pos:end="179:113">)</operator></expr></argument>, <argument pos:start="179:116" pos:end="179:122"><expr pos:start="179:116" pos:end="179:122"><name pos:start="179:116" pos:end="179:122"><name pos:start="179:116" pos:end="179:116">t</name><operator pos:start="179:117" pos:end="179:117">.</operator><name pos:start="179:118" pos:end="179:122">angle</name></name></expr></argument>, <argument pos:start="179:125" pos:end="179:144"><expr pos:start="179:125" pos:end="179:144"><literal type="number" pos:start="179:125" pos:end="179:129">1.0</literal> <operator pos:start="179:129" pos:end="179:129">+</operator> <name pos:start="179:131" pos:end="179:136"><name pos:start="179:131" pos:end="179:131">t</name><operator pos:start="179:132" pos:end="179:132">.</operator><name pos:start="179:133" pos:end="179:136">zoom</name></name> <operator pos:start="179:138" pos:end="179:138">/</operator> <literal type="number" pos:start="179:140" pos:end="179:144">100.0</literal></expr></argument>, <argument pos:start="179:147" pos:end="179:152"><expr pos:start="179:147" pos:end="179:152"><name pos:start="179:147" pos:end="179:152">matrix</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <comment type="line" pos:start="183:5" pos:end="183:34">// Transform the chroma planes</comment>

    <expr_stmt pos:start="185:5" pos:end="185:171"><expr pos:start="185:5" pos:end="185:170"><call pos:start="185:5" pos:end="185:170"><name pos:start="185:5" pos:end="185:22">avfilter_transform</name><argument_list pos:start="185:23" pos:end="185:170">(<argument pos:start="185:24" pos:end="185:34"><expr pos:start="185:24" pos:end="185:34"><name pos:start="185:24" pos:end="185:34"><name pos:start="185:24" pos:end="185:25">in</name><operator pos:start="185:26" pos:end="185:27">-&gt;</operator><name pos:start="185:28" pos:end="185:31">data</name><index pos:start="185:32" pos:end="185:34">[<expr pos:start="185:33" pos:end="185:33"><literal type="number" pos:start="185:33" pos:end="185:33">1</literal></expr>]</index></name></expr></argument>, <argument pos:start="185:37" pos:end="185:48"><expr pos:start="185:37" pos:end="185:48"><name pos:start="185:37" pos:end="185:48"><name pos:start="185:37" pos:end="185:39">out</name><operator pos:start="185:40" pos:end="185:41">-&gt;</operator><name pos:start="185:42" pos:end="185:45">data</name><index pos:start="185:46" pos:end="185:48">[<expr pos:start="185:47" pos:end="185:47"><literal type="number" pos:start="185:47" pos:end="185:47">1</literal></expr>]</index></name></expr></argument>, <argument pos:start="185:51" pos:end="185:65"><expr pos:start="185:51" pos:end="185:65"><name pos:start="185:51" pos:end="185:65"><name pos:start="185:51" pos:end="185:52">in</name><operator pos:start="185:53" pos:end="185:54">-&gt;</operator><name pos:start="185:55" pos:end="185:62">linesize</name><index pos:start="185:63" pos:end="185:65">[<expr pos:start="185:64" pos:end="185:64"><literal type="number" pos:start="185:64" pos:end="185:64">1</literal></expr>]</index></name></expr></argument>, <argument pos:start="185:68" pos:end="185:83"><expr pos:start="185:68" pos:end="185:83"><name pos:start="185:68" pos:end="185:83"><name pos:start="185:68" pos:end="185:70">out</name><operator pos:start="185:71" pos:end="185:72">-&gt;</operator><name pos:start="185:73" pos:end="185:80">linesize</name><index pos:start="185:81" pos:end="185:83">[<expr pos:start="185:82" pos:end="185:82"><literal type="number" pos:start="185:82" pos:end="185:82">1</literal></expr>]</index></name></expr></argument>, <argument pos:start="185:86" pos:end="185:103"><expr pos:start="185:86" pos:end="185:103"><call pos:start="185:86" pos:end="185:103"><name pos:start="185:86" pos:end="185:97">CHROMA_WIDTH</name><argument_list pos:start="185:98" pos:end="185:103">(<argument pos:start="185:99" pos:end="185:102"><expr pos:start="185:99" pos:end="185:102"><name pos:start="185:99" pos:end="185:102">link</name></expr></argument>)</argument_list></call></expr></argument>, <argument pos:start="185:106" pos:end="185:124"><expr pos:start="185:106" pos:end="185:124"><call pos:start="185:106" pos:end="185:124"><name pos:start="185:106" pos:end="185:118">CHROMA_HEIGHT</name><argument_list pos:start="185:119" pos:end="185:124">(<argument pos:start="185:120" pos:end="185:123"><expr pos:start="185:120" pos:end="185:123"><name pos:start="185:120" pos:end="185:123">link</name></expr></argument>)</argument_list></call></expr></argument>, <argument pos:start="185:127" pos:end="185:132"><expr pos:start="185:127" pos:end="185:132"><name pos:start="185:127" pos:end="185:132">matrix</name></expr></argument>, <argument pos:start="185:135" pos:end="185:154"><expr pos:start="185:135" pos:end="185:154"><name pos:start="185:135" pos:end="185:154">INTERPOLATE_BILINEAR</name></expr></argument>, <argument pos:start="185:157" pos:end="185:169"><expr pos:start="185:157" pos:end="185:169"><name pos:start="185:157" pos:end="185:169"><name pos:start="185:157" pos:end="185:163">deshake</name><operator pos:start="185:164" pos:end="185:165">-&gt;</operator><name pos:start="185:166" pos:end="185:169">edge</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="187:5" pos:end="187:171"><expr pos:start="187:5" pos:end="187:170"><call pos:start="187:5" pos:end="187:170"><name pos:start="187:5" pos:end="187:22">avfilter_transform</name><argument_list pos:start="187:23" pos:end="187:170">(<argument pos:start="187:24" pos:end="187:34"><expr pos:start="187:24" pos:end="187:34"><name pos:start="187:24" pos:end="187:34"><name pos:start="187:24" pos:end="187:25">in</name><operator pos:start="187:26" pos:end="187:27">-&gt;</operator><name pos:start="187:28" pos:end="187:31">data</name><index pos:start="187:32" pos:end="187:34">[<expr pos:start="187:33" pos:end="187:33"><literal type="number" pos:start="187:33" pos:end="187:33">2</literal></expr>]</index></name></expr></argument>, <argument pos:start="187:37" pos:end="187:48"><expr pos:start="187:37" pos:end="187:48"><name pos:start="187:37" pos:end="187:48"><name pos:start="187:37" pos:end="187:39">out</name><operator pos:start="187:40" pos:end="187:41">-&gt;</operator><name pos:start="187:42" pos:end="187:45">data</name><index pos:start="187:46" pos:end="187:48">[<expr pos:start="187:47" pos:end="187:47"><literal type="number" pos:start="187:47" pos:end="187:47">2</literal></expr>]</index></name></expr></argument>, <argument pos:start="187:51" pos:end="187:65"><expr pos:start="187:51" pos:end="187:65"><name pos:start="187:51" pos:end="187:65"><name pos:start="187:51" pos:end="187:52">in</name><operator pos:start="187:53" pos:end="187:54">-&gt;</operator><name pos:start="187:55" pos:end="187:62">linesize</name><index pos:start="187:63" pos:end="187:65">[<expr pos:start="187:64" pos:end="187:64"><literal type="number" pos:start="187:64" pos:end="187:64">2</literal></expr>]</index></name></expr></argument>, <argument pos:start="187:68" pos:end="187:83"><expr pos:start="187:68" pos:end="187:83"><name pos:start="187:68" pos:end="187:83"><name pos:start="187:68" pos:end="187:70">out</name><operator pos:start="187:71" pos:end="187:72">-&gt;</operator><name pos:start="187:73" pos:end="187:80">linesize</name><index pos:start="187:81" pos:end="187:83">[<expr pos:start="187:82" pos:end="187:82"><literal type="number" pos:start="187:82" pos:end="187:82">2</literal></expr>]</index></name></expr></argument>, <argument pos:start="187:86" pos:end="187:103"><expr pos:start="187:86" pos:end="187:103"><call pos:start="187:86" pos:end="187:103"><name pos:start="187:86" pos:end="187:97">CHROMA_WIDTH</name><argument_list pos:start="187:98" pos:end="187:103">(<argument pos:start="187:99" pos:end="187:102"><expr pos:start="187:99" pos:end="187:102"><name pos:start="187:99" pos:end="187:102">link</name></expr></argument>)</argument_list></call></expr></argument>, <argument pos:start="187:106" pos:end="187:124"><expr pos:start="187:106" pos:end="187:124"><call pos:start="187:106" pos:end="187:124"><name pos:start="187:106" pos:end="187:118">CHROMA_HEIGHT</name><argument_list pos:start="187:119" pos:end="187:124">(<argument pos:start="187:120" pos:end="187:123"><expr pos:start="187:120" pos:end="187:123"><name pos:start="187:120" pos:end="187:123">link</name></expr></argument>)</argument_list></call></expr></argument>, <argument pos:start="187:127" pos:end="187:132"><expr pos:start="187:127" pos:end="187:132"><name pos:start="187:127" pos:end="187:132">matrix</name></expr></argument>, <argument pos:start="187:135" pos:end="187:154"><expr pos:start="187:135" pos:end="187:154"><name pos:start="187:135" pos:end="187:154">INTERPOLATE_BILINEAR</name></expr></argument>, <argument pos:start="187:157" pos:end="187:169"><expr pos:start="187:157" pos:end="187:169"><name pos:start="187:157" pos:end="187:169"><name pos:start="187:157" pos:end="187:163">deshake</name><operator pos:start="187:164" pos:end="187:165">-&gt;</operator><name pos:start="187:166" pos:end="187:169">edge</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <comment type="line" pos:start="191:5" pos:end="191:73">// Store the current frame as the reference frame for calculating the</comment>

    <comment type="line" pos:start="193:5" pos:end="193:31">// motion of the next frame</comment>

    <if_stmt pos:start="195:5" pos:end="197:44"><if pos:start="195:5" pos:end="197:44">if <condition pos:start="195:8" pos:end="195:29">(<expr pos:start="195:9" pos:end="195:28"><name pos:start="195:9" pos:end="195:20"><name pos:start="195:9" pos:end="195:15">deshake</name><operator pos:start="195:16" pos:end="195:17">-&gt;</operator><name pos:start="195:18" pos:end="195:20">ref</name></name> <operator pos:start="195:22" pos:end="195:23">!=</operator> <name pos:start="195:25" pos:end="195:28">NULL</name></expr>)</condition><block type="pseudo" pos:start="197:9" pos:end="197:44"><block_content pos:start="197:9" pos:end="197:44">

        <expr_stmt pos:start="197:9" pos:end="197:44"><expr pos:start="197:9" pos:end="197:43"><call pos:start="197:9" pos:end="197:43"><name pos:start="197:9" pos:end="197:29">avfilter_unref_buffer</name><argument_list pos:start="197:30" pos:end="197:43">(<argument pos:start="197:31" pos:end="197:42"><expr pos:start="197:31" pos:end="197:42"><name pos:start="197:31" pos:end="197:42"><name pos:start="197:31" pos:end="197:37">deshake</name><operator pos:start="197:38" pos:end="197:39">-&gt;</operator><name pos:start="197:40" pos:end="197:42">ref</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>



    <comment type="line" pos:start="201:5" pos:end="201:38">// Cleanup the old reference frame</comment>

    <expr_stmt pos:start="203:5" pos:end="203:22"><expr pos:start="203:5" pos:end="203:21"><name pos:start="203:5" pos:end="203:16"><name pos:start="203:5" pos:end="203:11">deshake</name><operator pos:start="203:12" pos:end="203:13">-&gt;</operator><name pos:start="203:14" pos:end="203:16">ref</name></name> <operator pos:start="203:18" pos:end="203:18">=</operator> <name pos:start="203:20" pos:end="203:21">in</name></expr>;</expr_stmt>



    <comment type="line" pos:start="207:5" pos:end="207:45">// Draw the transformed frame information</comment>

    <expr_stmt pos:start="209:5" pos:end="209:62"><expr pos:start="209:5" pos:end="209:61"><call pos:start="209:5" pos:end="209:61"><name pos:start="209:5" pos:end="209:23">avfilter_draw_slice</name><argument_list pos:start="209:24" pos:end="209:61">(<argument pos:start="209:25" pos:end="209:45"><expr pos:start="209:25" pos:end="209:45"><name pos:start="209:25" pos:end="209:45"><name pos:start="209:25" pos:end="209:28">link</name><operator pos:start="209:29" pos:end="209:30">-&gt;</operator><name pos:start="209:31" pos:end="209:33">dst</name><operator pos:start="209:34" pos:end="209:35">-&gt;</operator><name pos:start="209:36" pos:end="209:42">outputs</name><index pos:start="209:43" pos:end="209:45">[<expr pos:start="209:44" pos:end="209:44"><literal type="number" pos:start="209:44" pos:end="209:44">0</literal></expr>]</index></name></expr></argument>, <argument pos:start="209:48" pos:end="209:48"><expr pos:start="209:48" pos:end="209:48"><literal type="number" pos:start="209:48" pos:end="209:48">0</literal></expr></argument>, <argument pos:start="209:51" pos:end="209:57"><expr pos:start="209:51" pos:end="209:57"><name pos:start="209:51" pos:end="209:57"><name pos:start="209:51" pos:end="209:54">link</name><operator pos:start="209:55" pos:end="209:56">-&gt;</operator><name pos:start="209:57" pos:end="209:57">h</name></name></expr></argument>, <argument pos:start="209:60" pos:end="209:60"><expr pos:start="209:60" pos:end="209:60"><literal type="number" pos:start="209:60" pos:end="209:60">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="211:5" pos:end="211:46"><expr pos:start="211:5" pos:end="211:45"><call pos:start="211:5" pos:end="211:45"><name pos:start="211:5" pos:end="211:22">avfilter_end_frame</name><argument_list pos:start="211:23" pos:end="211:45">(<argument pos:start="211:24" pos:end="211:44"><expr pos:start="211:24" pos:end="211:44"><name pos:start="211:24" pos:end="211:44"><name pos:start="211:24" pos:end="211:27">link</name><operator pos:start="211:28" pos:end="211:29">-&gt;</operator><name pos:start="211:30" pos:end="211:32">dst</name><operator pos:start="211:33" pos:end="211:34">-&gt;</operator><name pos:start="211:35" pos:end="211:41">outputs</name><index pos:start="211:42" pos:end="211:44">[<expr pos:start="211:43" pos:end="211:43"><literal type="number" pos:start="211:43" pos:end="211:43">0</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="213:5" pos:end="213:31"><expr pos:start="213:5" pos:end="213:30"><call pos:start="213:5" pos:end="213:30"><name pos:start="213:5" pos:end="213:25">avfilter_unref_buffer</name><argument_list pos:start="213:26" pos:end="213:30">(<argument pos:start="213:27" pos:end="213:29"><expr pos:start="213:27" pos:end="213:29"><name pos:start="213:27" pos:end="213:29">out</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

</block_content>}</block></function>
</unit>
