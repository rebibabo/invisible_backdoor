<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:cpp="http://www.srcML.org/srcML/cpp" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/1/1873.c" pos:tabs="8"><function pos:start="1:1" pos:end="255:1"><type pos:start="1:1" pos:end="1:10"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:10">int</name></type> <name pos:start="1:12" pos:end="1:18">do_fork</name><parameter_list pos:start="1:19" pos:end="5:42">(<parameter pos:start="1:20" pos:end="1:32"><decl pos:start="1:20" pos:end="1:32"><type pos:start="1:20" pos:end="1:32"><name pos:start="1:20" pos:end="1:27">CPUState</name> <modifier pos:start="1:29" pos:end="1:29">*</modifier></type><name pos:start="1:30" pos:end="1:32">env</name></decl></parameter>, <parameter pos:start="1:35" pos:end="1:52"><decl pos:start="1:35" pos:end="1:52"><type pos:start="1:35" pos:end="1:52"><name pos:start="1:35" pos:end="1:42">unsigned</name> <name pos:start="1:44" pos:end="1:46">int</name></type> <name pos:start="1:48" pos:end="1:52">flags</name></decl></parameter>, <parameter pos:start="1:55" pos:end="1:69"><decl pos:start="1:55" pos:end="1:69"><type pos:start="1:55" pos:end="1:69"><name pos:start="1:55" pos:end="1:63">abi_ulong</name></type> <name pos:start="1:65" pos:end="1:69">newsp</name></decl></parameter>,

                   <parameter pos:start="3:20" pos:end="3:42"><decl pos:start="3:20" pos:end="3:42"><type pos:start="3:20" pos:end="3:42"><name pos:start="3:20" pos:end="3:28">abi_ulong</name></type> <name pos:start="3:30" pos:end="3:42">parent_tidptr</name></decl></parameter>, <parameter pos:start="3:45" pos:end="3:63"><decl pos:start="3:45" pos:end="3:63"><type pos:start="3:45" pos:end="3:63"><name pos:start="3:45" pos:end="3:56">target_ulong</name></type> <name pos:start="3:58" pos:end="3:63">newtls</name></decl></parameter>,

                   <parameter pos:start="5:20" pos:end="5:41"><decl pos:start="5:20" pos:end="5:41"><type pos:start="5:20" pos:end="5:41"><name pos:start="5:20" pos:end="5:28">abi_ulong</name></type> <name pos:start="5:30" pos:end="5:41">child_tidptr</name></decl></parameter>)</parameter_list>

<block pos:start="7:1" pos:end="255:1">{<block_content pos:start="9:5" pos:end="253:15">

    <decl_stmt pos:start="9:5" pos:end="9:12"><decl pos:start="9:5" pos:end="9:11"><type pos:start="9:5" pos:end="9:7"><name pos:start="9:5" pos:end="9:7">int</name></type> <name pos:start="9:9" pos:end="9:11">ret</name></decl>;</decl_stmt>

    <decl_stmt pos:start="11:5" pos:end="11:18"><decl pos:start="11:5" pos:end="11:17"><type pos:start="11:5" pos:end="11:15"><name pos:start="11:5" pos:end="11:13">TaskState</name> <modifier pos:start="11:15" pos:end="11:15">*</modifier></type><name pos:start="11:16" pos:end="11:17">ts</name></decl>;</decl_stmt>

    <decl_stmt pos:start="13:5" pos:end="13:23"><decl pos:start="13:5" pos:end="13:22"><type pos:start="13:5" pos:end="13:13"><name pos:start="13:5" pos:end="13:11">uint8_t</name> <modifier pos:start="13:13" pos:end="13:13">*</modifier></type><name pos:start="13:14" pos:end="13:22">new_stack</name></decl>;</decl_stmt>

    <decl_stmt pos:start="15:5" pos:end="18:0"><decl pos:start="15:5" pos:end="15:21"><type pos:start="15:5" pos:end="15:14"><name pos:start="15:5" pos:end="15:12">CPUState</name> <modifier pos:start="15:14" pos:end="15:14">*</modifier></type><name pos:start="15:15" pos:end="15:21">new_env</name></decl>;</decl_stmt>

<cpp:if pos:start="17:1" pos:end="17:28">#<cpp:directive pos:start="17:2" pos:end="17:3">if</cpp:directive> <expr pos:start="17:5" pos:end="17:28"><call pos:start="17:5" pos:end="17:28"><name pos:start="17:5" pos:end="17:11">defined</name><argument_list pos:start="17:12" pos:end="17:28">(<argument pos:start="17:13" pos:end="17:27"><expr pos:start="17:13" pos:end="17:27"><name pos:start="17:13" pos:end="17:27">CONFIG_USE_NPTL</name></expr></argument>)</argument_list></call></expr></cpp:if>

    <decl_stmt pos:start="19:5" pos:end="19:28"><decl pos:start="19:5" pos:end="19:27"><type pos:start="19:5" pos:end="19:16"><name pos:start="19:5" pos:end="19:12">unsigned</name> <name pos:start="19:14" pos:end="19:16">int</name></type> <name pos:start="19:18" pos:end="19:27">nptl_flags</name></decl>;</decl_stmt>

    <decl_stmt pos:start="21:5" pos:end="24:0"><decl pos:start="21:5" pos:end="21:20"><type pos:start="21:5" pos:end="21:12"><name pos:start="21:5" pos:end="21:12">sigset_t</name></type> <name pos:start="21:14" pos:end="21:20">sigmask</name></decl>;</decl_stmt>

<cpp:endif pos:start="23:1" pos:end="23:6">#<cpp:directive pos:start="23:2" pos:end="23:6">endif</cpp:directive></cpp:endif>



    <comment type="block" pos:start="27:5" pos:end="27:37">/* Emulate vfork() with fork() */</comment>

    <if_stmt pos:start="29:5" pos:end="31:43"><if pos:start="29:5" pos:end="31:43">if <condition pos:start="29:8" pos:end="29:28">(<expr pos:start="29:9" pos:end="29:27"><name pos:start="29:9" pos:end="29:13">flags</name> <operator pos:start="29:15" pos:end="29:15">&amp;</operator> <name pos:start="29:17" pos:end="29:27">CLONE_VFORK</name></expr>)</condition><block type="pseudo" pos:start="31:9" pos:end="31:43"><block_content pos:start="31:9" pos:end="31:43">

        <expr_stmt pos:start="31:9" pos:end="31:43"><expr pos:start="31:9" pos:end="31:42"><name pos:start="31:9" pos:end="31:13">flags</name> <operator pos:start="31:15" pos:end="31:16">&amp;=</operator> <operator pos:start="31:18" pos:end="31:18">~</operator><operator pos:start="31:19" pos:end="31:19">(</operator><name pos:start="31:20" pos:end="31:30">CLONE_VFORK</name> <operator pos:start="31:32" pos:end="31:32">|</operator> <name pos:start="31:34" pos:end="31:41">CLONE_VM</name><operator pos:start="31:42" pos:end="31:42">)</operator></expr>;</expr_stmt></block_content></block></if></if_stmt>



    <if_stmt pos:start="35:5" pos:end="251:5"><if pos:start="35:5" pos:end="191:5">if <condition pos:start="35:8" pos:end="35:25">(<expr pos:start="35:9" pos:end="35:24"><name pos:start="35:9" pos:end="35:13">flags</name> <operator pos:start="35:15" pos:end="35:15">&amp;</operator> <name pos:start="35:17" pos:end="35:24">CLONE_VM</name></expr>)</condition> <block pos:start="35:27" pos:end="191:5">{<block_content pos:start="37:9" pos:end="190:0">

        <decl_stmt pos:start="37:9" pos:end="40:0"><decl pos:start="37:9" pos:end="37:55"><type pos:start="37:9" pos:end="37:19"><name pos:start="37:9" pos:end="37:17">TaskState</name> <modifier pos:start="37:19" pos:end="37:19">*</modifier></type><name pos:start="37:20" pos:end="37:28">parent_ts</name> <init pos:start="37:30" pos:end="37:55">= <expr pos:start="37:32" pos:end="37:55"><operator pos:start="37:32" pos:end="37:32">(</operator><name pos:start="37:33" pos:end="37:41">TaskState</name> <operator pos:start="37:43" pos:end="37:43">*</operator><operator pos:start="37:44" pos:end="37:44">)</operator><name pos:start="37:45" pos:end="37:55"><name pos:start="37:45" pos:end="37:47">env</name><operator pos:start="37:48" pos:end="37:49">-&gt;</operator><name pos:start="37:50" pos:end="37:55">opaque</name></name></expr></init></decl>;</decl_stmt>

<cpp:if pos:start="39:1" pos:end="39:28">#<cpp:directive pos:start="39:2" pos:end="39:3">if</cpp:directive> <expr pos:start="39:5" pos:end="39:28"><call pos:start="39:5" pos:end="39:28"><name pos:start="39:5" pos:end="39:11">defined</name><argument_list pos:start="39:12" pos:end="39:28">(<argument pos:start="39:13" pos:end="39:27"><expr pos:start="39:13" pos:end="39:27"><name pos:start="39:13" pos:end="39:27">CONFIG_USE_NPTL</name></expr></argument>)</argument_list></call></expr></cpp:if>

        <decl_stmt pos:start="41:9" pos:end="41:29"><decl pos:start="41:9" pos:end="41:28"><type pos:start="41:9" pos:end="41:23"><name pos:start="41:9" pos:end="41:23">new_thread_info</name></type> <name pos:start="41:25" pos:end="41:28">info</name></decl>;</decl_stmt>

        <decl_stmt pos:start="43:9" pos:end="46:0"><decl pos:start="43:9" pos:end="43:27"><type pos:start="43:9" pos:end="43:22"><name pos:start="43:9" pos:end="43:22">pthread_attr_t</name></type> <name pos:start="43:24" pos:end="43:27">attr</name></decl>;</decl_stmt>

<cpp:endif pos:start="45:1" pos:end="45:6">#<cpp:directive pos:start="45:2" pos:end="45:6">endif</cpp:directive></cpp:endif>

        <expr_stmt pos:start="47:9" pos:end="47:62"><expr pos:start="47:9" pos:end="47:61"><name pos:start="47:9" pos:end="47:10">ts</name> <operator pos:start="47:12" pos:end="47:12">=</operator> <call pos:start="47:14" pos:end="47:61"><name pos:start="47:14" pos:end="47:25">qemu_mallocz</name><argument_list pos:start="47:26" pos:end="47:61">(<argument pos:start="47:27" pos:end="47:60"><expr pos:start="47:27" pos:end="47:60"><sizeof pos:start="47:27" pos:end="47:43">sizeof<argument_list pos:start="47:33" pos:end="47:43">(<argument pos:start="47:34" pos:end="47:42"><expr pos:start="47:34" pos:end="47:42"><name pos:start="47:34" pos:end="47:42">TaskState</name></expr></argument>)</argument_list></sizeof> <operator pos:start="47:45" pos:end="47:45">+</operator> <name pos:start="47:47" pos:end="47:60">NEW_STACK_SIZE</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="49:9" pos:end="49:28"><expr pos:start="49:9" pos:end="49:27"><call pos:start="49:9" pos:end="49:27"><name pos:start="49:9" pos:end="49:23">init_task_state</name><argument_list pos:start="49:24" pos:end="49:27">(<argument pos:start="49:25" pos:end="49:26"><expr pos:start="49:25" pos:end="49:26"><name pos:start="49:25" pos:end="49:26">ts</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="51:9" pos:end="51:30"><expr pos:start="51:9" pos:end="51:29"><name pos:start="51:9" pos:end="51:17">new_stack</name> <operator pos:start="51:19" pos:end="51:19">=</operator> <name pos:start="51:21" pos:end="51:29"><name pos:start="51:21" pos:end="51:22">ts</name><operator pos:start="51:23" pos:end="51:24">-&gt;</operator><name pos:start="51:25" pos:end="51:29">stack</name></name></expr>;</expr_stmt>

        <comment type="block" pos:start="53:9" pos:end="53:43">/* we create a new CPU instance. */</comment>

        <expr_stmt pos:start="55:9" pos:end="58:0"><expr pos:start="55:9" pos:end="55:31"><name pos:start="55:9" pos:end="55:15">new_env</name> <operator pos:start="55:17" pos:end="55:17">=</operator> <call pos:start="55:19" pos:end="55:31"><name pos:start="55:19" pos:end="55:26">cpu_copy</name><argument_list pos:start="55:27" pos:end="55:31">(<argument pos:start="55:28" pos:end="55:30"><expr pos:start="55:28" pos:end="55:30"><name pos:start="55:28" pos:end="55:30">env</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

<cpp:if pos:start="57:1" pos:end="57:72">#<cpp:directive pos:start="57:2" pos:end="57:3">if</cpp:directive> <expr pos:start="57:5" pos:end="57:72"><call pos:start="57:5" pos:end="57:24"><name pos:start="57:5" pos:end="57:11">defined</name><argument_list pos:start="57:12" pos:end="57:24">(<argument pos:start="57:13" pos:end="57:23"><expr pos:start="57:13" pos:end="57:23"><name pos:start="57:13" pos:end="57:23">TARGET_I386</name></expr></argument>)</argument_list></call> <operator pos:start="57:26" pos:end="57:27">||</operator> <call pos:start="57:29" pos:end="57:49"><name pos:start="57:29" pos:end="57:35">defined</name><argument_list pos:start="57:36" pos:end="57:49">(<argument pos:start="57:37" pos:end="57:48"><expr pos:start="57:37" pos:end="57:48"><name pos:start="57:37" pos:end="57:48">TARGET_SPARC</name></expr></argument>)</argument_list></call> <operator pos:start="57:51" pos:end="57:52">||</operator> <call pos:start="57:54" pos:end="57:72"><name pos:start="57:54" pos:end="57:60">defined</name><argument_list pos:start="57:61" pos:end="57:72">(<argument pos:start="57:62" pos:end="57:71"><expr pos:start="57:62" pos:end="57:71"><name pos:start="57:62" pos:end="57:71">TARGET_PPC</name></expr></argument>)</argument_list></call></expr></cpp:if>

        <expr_stmt pos:start="59:9" pos:end="62:0"><expr pos:start="59:9" pos:end="59:26"><call pos:start="59:9" pos:end="59:26"><name pos:start="59:9" pos:end="59:17">cpu_reset</name><argument_list pos:start="59:18" pos:end="59:26">(<argument pos:start="59:19" pos:end="59:25"><expr pos:start="59:19" pos:end="59:25"><name pos:start="59:19" pos:end="59:25">new_env</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

<cpp:endif pos:start="61:1" pos:end="61:6">#<cpp:directive pos:start="61:2" pos:end="61:6">endif</cpp:directive></cpp:endif>

        <comment type="block" pos:start="63:9" pos:end="63:53">/* Init regs that differ from the parent.  */</comment>

        <expr_stmt pos:start="65:9" pos:end="65:39"><expr pos:start="65:9" pos:end="65:38"><call pos:start="65:9" pos:end="65:38"><name pos:start="65:9" pos:end="65:22">cpu_clone_regs</name><argument_list pos:start="65:23" pos:end="65:38">(<argument pos:start="65:24" pos:end="65:30"><expr pos:start="65:24" pos:end="65:30"><name pos:start="65:24" pos:end="65:30">new_env</name></expr></argument>, <argument pos:start="65:33" pos:end="65:37"><expr pos:start="65:33" pos:end="65:37"><name pos:start="65:33" pos:end="65:37">newsp</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="67:9" pos:end="67:29"><expr pos:start="67:9" pos:end="67:28"><name pos:start="67:9" pos:end="67:23"><name pos:start="67:9" pos:end="67:15">new_env</name><operator pos:start="67:16" pos:end="67:17">-&gt;</operator><name pos:start="67:18" pos:end="67:23">opaque</name></name> <operator pos:start="67:25" pos:end="67:25">=</operator> <name pos:start="67:27" pos:end="67:28">ts</name></expr>;</expr_stmt>

        <expr_stmt pos:start="69:9" pos:end="69:35"><expr pos:start="69:9" pos:end="69:34"><name pos:start="69:9" pos:end="69:16"><name pos:start="69:9" pos:end="69:10">ts</name><operator pos:start="69:11" pos:end="69:12">-&gt;</operator><name pos:start="69:13" pos:end="69:16">bprm</name></name> <operator pos:start="69:18" pos:end="69:18">=</operator> <name pos:start="69:20" pos:end="69:34"><name pos:start="69:20" pos:end="69:28">parent_ts</name><operator pos:start="69:29" pos:end="69:30">-&gt;</operator><name pos:start="69:31" pos:end="69:34">bprm</name></name></expr>;</expr_stmt>

        <expr_stmt pos:start="71:9" pos:end="74:0"><expr pos:start="71:9" pos:end="71:34"><name pos:start="71:9" pos:end="71:16"><name pos:start="71:9" pos:end="71:10">ts</name><operator pos:start="71:11" pos:end="71:12">-&gt;</operator><name pos:start="71:13" pos:end="71:16">info</name></name> <operator pos:start="71:18" pos:end="71:18">=</operator> <name pos:start="71:20" pos:end="71:34"><name pos:start="71:20" pos:end="71:28">parent_ts</name><operator pos:start="71:29" pos:end="71:30">-&gt;</operator><name pos:start="71:31" pos:end="71:34">info</name></name></expr>;</expr_stmt>

<cpp:if pos:start="73:1" pos:end="73:28">#<cpp:directive pos:start="73:2" pos:end="73:3">if</cpp:directive> <expr pos:start="73:5" pos:end="73:28"><call pos:start="73:5" pos:end="73:28"><name pos:start="73:5" pos:end="73:11">defined</name><argument_list pos:start="73:12" pos:end="73:28">(<argument pos:start="73:13" pos:end="73:27"><expr pos:start="73:13" pos:end="73:27"><name pos:start="73:13" pos:end="73:27">CONFIG_USE_NPTL</name></expr></argument>)</argument_list></call></expr></cpp:if>

        <expr_stmt pos:start="75:9" pos:end="75:27"><expr pos:start="75:9" pos:end="75:26"><name pos:start="75:9" pos:end="75:18">nptl_flags</name> <operator pos:start="75:20" pos:end="75:20">=</operator> <name pos:start="75:22" pos:end="75:26">flags</name></expr>;</expr_stmt>

        <expr_stmt pos:start="77:9" pos:end="77:36"><expr pos:start="77:9" pos:end="77:35"><name pos:start="77:9" pos:end="77:13">flags</name> <operator pos:start="77:15" pos:end="77:16">&amp;=</operator> <operator pos:start="77:18" pos:end="77:18">~</operator><name pos:start="77:19" pos:end="77:35">CLONE_NPTL_FLAGS2</name></expr>;</expr_stmt>



        <if_stmt pos:start="81:9" pos:end="85:9"><if pos:start="81:9" pos:end="85:9">if <condition pos:start="81:12" pos:end="81:46">(<expr pos:start="81:13" pos:end="81:45"><name pos:start="81:13" pos:end="81:22">nptl_flags</name> <operator pos:start="81:24" pos:end="81:24">&amp;</operator> <name pos:start="81:26" pos:end="81:45">CLONE_CHILD_CLEARTID</name></expr>)</condition> <block pos:start="81:48" pos:end="85:9">{<block_content pos:start="83:13" pos:end="83:44">

            <expr_stmt pos:start="83:13" pos:end="83:44"><expr pos:start="83:13" pos:end="83:43"><name pos:start="83:13" pos:end="83:28"><name pos:start="83:13" pos:end="83:14">ts</name><operator pos:start="83:15" pos:end="83:16">-&gt;</operator><name pos:start="83:17" pos:end="83:28">child_tidptr</name></name> <operator pos:start="83:30" pos:end="83:30">=</operator> <name pos:start="83:32" pos:end="83:43">child_tidptr</name></expr>;</expr_stmt>

        </block_content>}</block></if></if_stmt>



        <if_stmt pos:start="89:9" pos:end="91:42"><if pos:start="89:9" pos:end="91:42">if <condition pos:start="89:12" pos:end="89:38">(<expr pos:start="89:13" pos:end="89:37"><name pos:start="89:13" pos:end="89:22">nptl_flags</name> <operator pos:start="89:24" pos:end="89:24">&amp;</operator> <name pos:start="89:26" pos:end="89:37">CLONE_SETTLS</name></expr>)</condition><block type="pseudo" pos:start="91:13" pos:end="91:42"><block_content pos:start="91:13" pos:end="91:42">

            <expr_stmt pos:start="91:13" pos:end="91:42"><expr pos:start="91:13" pos:end="91:41"><call pos:start="91:13" pos:end="91:41"><name pos:start="91:13" pos:end="91:23">cpu_set_tls</name> <argument_list pos:start="91:25" pos:end="91:41">(<argument pos:start="91:26" pos:end="91:32"><expr pos:start="91:26" pos:end="91:32"><name pos:start="91:26" pos:end="91:32">new_env</name></expr></argument>, <argument pos:start="91:35" pos:end="91:40"><expr pos:start="91:35" pos:end="91:40"><name pos:start="91:35" pos:end="91:40">newtls</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>



        <comment type="block" pos:start="95:9" pos:end="95:64">/* Grab a mutex so that thread setup appears atomic.  */</comment>

        <expr_stmt pos:start="97:9" pos:end="97:40"><expr pos:start="97:9" pos:end="97:39"><call pos:start="97:9" pos:end="97:39"><name pos:start="97:9" pos:end="97:26">pthread_mutex_lock</name><argument_list pos:start="97:27" pos:end="97:39">(<argument pos:start="97:28" pos:end="97:38"><expr pos:start="97:28" pos:end="97:38"><operator pos:start="97:28" pos:end="97:28">&amp;</operator><name pos:start="97:29" pos:end="97:38">clone_lock</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <expr_stmt pos:start="101:9" pos:end="101:39"><expr pos:start="101:9" pos:end="101:38"><call pos:start="101:9" pos:end="101:38"><name pos:start="101:9" pos:end="101:14">memset</name><argument_list pos:start="101:15" pos:end="101:38">(<argument pos:start="101:16" pos:end="101:20"><expr pos:start="101:16" pos:end="101:20"><operator pos:start="101:16" pos:end="101:16">&amp;</operator><name pos:start="101:17" pos:end="101:20">info</name></expr></argument>, <argument pos:start="101:23" pos:end="101:23"><expr pos:start="101:23" pos:end="101:23"><literal type="number" pos:start="101:23" pos:end="101:23">0</literal></expr></argument>, <argument pos:start="101:26" pos:end="101:37"><expr pos:start="101:26" pos:end="101:37"><sizeof pos:start="101:26" pos:end="101:37">sizeof<argument_list pos:start="101:32" pos:end="101:37">(<argument pos:start="101:33" pos:end="101:36"><expr pos:start="101:33" pos:end="101:36"><name pos:start="101:33" pos:end="101:36">info</name></expr></argument>)</argument_list></sizeof></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="103:9" pos:end="103:46"><expr pos:start="103:9" pos:end="103:45"><call pos:start="103:9" pos:end="103:45"><name pos:start="103:9" pos:end="103:26">pthread_mutex_init</name><argument_list pos:start="103:27" pos:end="103:45">(<argument pos:start="103:28" pos:end="103:38"><expr pos:start="103:28" pos:end="103:38"><operator pos:start="103:28" pos:end="103:28">&amp;</operator><name pos:start="103:29" pos:end="103:38"><name pos:start="103:29" pos:end="103:32">info</name><operator pos:start="103:33" pos:end="103:33">.</operator><name pos:start="103:34" pos:end="103:38">mutex</name></name></expr></argument>, <argument pos:start="103:41" pos:end="103:44"><expr pos:start="103:41" pos:end="103:44"><name pos:start="103:41" pos:end="103:44">NULL</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="105:9" pos:end="105:40"><expr pos:start="105:9" pos:end="105:39"><call pos:start="105:9" pos:end="105:39"><name pos:start="105:9" pos:end="105:26">pthread_mutex_lock</name><argument_list pos:start="105:27" pos:end="105:39">(<argument pos:start="105:28" pos:end="105:38"><expr pos:start="105:28" pos:end="105:38"><operator pos:start="105:28" pos:end="105:28">&amp;</operator><name pos:start="105:29" pos:end="105:38"><name pos:start="105:29" pos:end="105:32">info</name><operator pos:start="105:33" pos:end="105:33">.</operator><name pos:start="105:34" pos:end="105:38">mutex</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="107:9" pos:end="107:44"><expr pos:start="107:9" pos:end="107:43"><call pos:start="107:9" pos:end="107:43"><name pos:start="107:9" pos:end="107:25">pthread_cond_init</name><argument_list pos:start="107:26" pos:end="107:43">(<argument pos:start="107:27" pos:end="107:36"><expr pos:start="107:27" pos:end="107:36"><operator pos:start="107:27" pos:end="107:27">&amp;</operator><name pos:start="107:28" pos:end="107:36"><name pos:start="107:28" pos:end="107:31">info</name><operator pos:start="107:32" pos:end="107:32">.</operator><name pos:start="107:33" pos:end="107:36">cond</name></name></expr></argument>, <argument pos:start="107:39" pos:end="107:42"><expr pos:start="107:39" pos:end="107:42"><name pos:start="107:39" pos:end="107:42">NULL</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="109:9" pos:end="109:27"><expr pos:start="109:9" pos:end="109:26"><name pos:start="109:9" pos:end="109:16"><name pos:start="109:9" pos:end="109:12">info</name><operator pos:start="109:13" pos:end="109:13">.</operator><name pos:start="109:14" pos:end="109:16">env</name></name> <operator pos:start="109:18" pos:end="109:18">=</operator> <name pos:start="109:20" pos:end="109:26">new_env</name></expr>;</expr_stmt>

        <if_stmt pos:start="111:9" pos:end="113:45"><if pos:start="111:9" pos:end="113:45">if <condition pos:start="111:12" pos:end="111:44">(<expr pos:start="111:13" pos:end="111:43"><name pos:start="111:13" pos:end="111:22">nptl_flags</name> <operator pos:start="111:24" pos:end="111:24">&amp;</operator> <name pos:start="111:26" pos:end="111:43">CLONE_CHILD_SETTID</name></expr>)</condition><block type="pseudo" pos:start="113:13" pos:end="113:45"><block_content pos:start="113:13" pos:end="113:45">

            <expr_stmt pos:start="113:13" pos:end="113:45"><expr pos:start="113:13" pos:end="113:44"><name pos:start="113:13" pos:end="113:29"><name pos:start="113:13" pos:end="113:16">info</name><operator pos:start="113:17" pos:end="113:17">.</operator><name pos:start="113:18" pos:end="113:29">child_tidptr</name></name> <operator pos:start="113:31" pos:end="113:31">=</operator> <name pos:start="113:33" pos:end="113:44">child_tidptr</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

        <if_stmt pos:start="115:9" pos:end="117:47"><if pos:start="115:9" pos:end="117:47">if <condition pos:start="115:12" pos:end="115:45">(<expr pos:start="115:13" pos:end="115:44"><name pos:start="115:13" pos:end="115:22">nptl_flags</name> <operator pos:start="115:24" pos:end="115:24">&amp;</operator> <name pos:start="115:26" pos:end="115:44">CLONE_PARENT_SETTID</name></expr>)</condition><block type="pseudo" pos:start="117:13" pos:end="117:47"><block_content pos:start="117:13" pos:end="117:47">

            <expr_stmt pos:start="117:13" pos:end="117:47"><expr pos:start="117:13" pos:end="117:46"><name pos:start="117:13" pos:end="117:30"><name pos:start="117:13" pos:end="117:16">info</name><operator pos:start="117:17" pos:end="117:17">.</operator><name pos:start="117:18" pos:end="117:30">parent_tidptr</name></name> <operator pos:start="117:32" pos:end="117:32">=</operator> <name pos:start="117:34" pos:end="117:46">parent_tidptr</name></expr>;</expr_stmt></block_content></block></if></if_stmt>



        <expr_stmt pos:start="121:9" pos:end="121:39"><expr pos:start="121:9" pos:end="121:38"><name pos:start="121:9" pos:end="121:11">ret</name> <operator pos:start="121:13" pos:end="121:13">=</operator> <call pos:start="121:15" pos:end="121:38"><name pos:start="121:15" pos:end="121:31">pthread_attr_init</name><argument_list pos:start="121:32" pos:end="121:38">(<argument pos:start="121:33" pos:end="121:37"><expr pos:start="121:33" pos:end="121:37"><operator pos:start="121:33" pos:end="121:33">&amp;</operator><name pos:start="121:34" pos:end="121:37">attr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="123:9" pos:end="123:70"><expr pos:start="123:9" pos:end="123:69"><name pos:start="123:9" pos:end="123:11">ret</name> <operator pos:start="123:13" pos:end="123:13">=</operator> <call pos:start="123:15" pos:end="123:69"><name pos:start="123:15" pos:end="123:35">pthread_attr_setstack</name><argument_list pos:start="123:36" pos:end="123:69">(<argument pos:start="123:37" pos:end="123:41"><expr pos:start="123:37" pos:end="123:41"><operator pos:start="123:37" pos:end="123:37">&amp;</operator><name pos:start="123:38" pos:end="123:41">attr</name></expr></argument>, <argument pos:start="123:44" pos:end="123:52"><expr pos:start="123:44" pos:end="123:52"><name pos:start="123:44" pos:end="123:52">new_stack</name></expr></argument>, <argument pos:start="123:55" pos:end="123:68"><expr pos:start="123:55" pos:end="123:68"><name pos:start="123:55" pos:end="123:68">NEW_STACK_SIZE</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="block" pos:start="125:9" pos:end="127:62">/* It is not safe to deliver signals until the child has finished

           initializing, so temporarily block all signals.  */</comment>

        <expr_stmt pos:start="129:9" pos:end="129:29"><expr pos:start="129:9" pos:end="129:28"><call pos:start="129:9" pos:end="129:28"><name pos:start="129:9" pos:end="129:18">sigfillset</name><argument_list pos:start="129:19" pos:end="129:28">(<argument pos:start="129:20" pos:end="129:27"><expr pos:start="129:20" pos:end="129:27"><operator pos:start="129:20" pos:end="129:20">&amp;</operator><name pos:start="129:21" pos:end="129:27">sigmask</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="131:9" pos:end="131:56"><expr pos:start="131:9" pos:end="131:55"><call pos:start="131:9" pos:end="131:55"><name pos:start="131:9" pos:end="131:19">sigprocmask</name><argument_list pos:start="131:20" pos:end="131:55">(<argument pos:start="131:21" pos:end="131:29"><expr pos:start="131:21" pos:end="131:29"><name pos:start="131:21" pos:end="131:29">SIG_BLOCK</name></expr></argument>, <argument pos:start="131:32" pos:end="131:39"><expr pos:start="131:32" pos:end="131:39"><operator pos:start="131:32" pos:end="131:32">&amp;</operator><name pos:start="131:33" pos:end="131:39">sigmask</name></expr></argument>, <argument pos:start="131:42" pos:end="131:54"><expr pos:start="131:42" pos:end="131:54"><operator pos:start="131:42" pos:end="131:42">&amp;</operator><name pos:start="131:43" pos:end="131:54"><name pos:start="131:43" pos:end="131:46">info</name><operator pos:start="131:47" pos:end="131:47">.</operator><name pos:start="131:48" pos:end="131:54">sigmask</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <expr_stmt pos:start="135:9" pos:end="135:69"><expr pos:start="135:9" pos:end="135:68"><name pos:start="135:9" pos:end="135:11">ret</name> <operator pos:start="135:13" pos:end="135:13">=</operator> <call pos:start="135:15" pos:end="135:68"><name pos:start="135:15" pos:end="135:28">pthread_create</name><argument_list pos:start="135:29" pos:end="135:68">(<argument pos:start="135:30" pos:end="135:41"><expr pos:start="135:30" pos:end="135:41"><operator pos:start="135:30" pos:end="135:30">&amp;</operator><name pos:start="135:31" pos:end="135:41"><name pos:start="135:31" pos:end="135:34">info</name><operator pos:start="135:35" pos:end="135:35">.</operator><name pos:start="135:36" pos:end="135:41">thread</name></name></expr></argument>, <argument pos:start="135:44" pos:end="135:48"><expr pos:start="135:44" pos:end="135:48"><operator pos:start="135:44" pos:end="135:44">&amp;</operator><name pos:start="135:45" pos:end="135:48">attr</name></expr></argument>, <argument pos:start="135:51" pos:end="135:60"><expr pos:start="135:51" pos:end="135:60"><name pos:start="135:51" pos:end="135:60">clone_func</name></expr></argument>, <argument pos:start="135:63" pos:end="135:67"><expr pos:start="135:63" pos:end="135:67"><operator pos:start="135:63" pos:end="135:63">&amp;</operator><name pos:start="135:64" pos:end="135:67">info</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="block" pos:start="137:9" pos:end="137:66">/* TODO: Free new CPU state if thread creation failed.  */</comment>



        <expr_stmt pos:start="141:9" pos:end="141:54"><expr pos:start="141:9" pos:end="141:53"><call pos:start="141:9" pos:end="141:53"><name pos:start="141:9" pos:end="141:19">sigprocmask</name><argument_list pos:start="141:20" pos:end="141:53">(<argument pos:start="141:21" pos:end="141:31"><expr pos:start="141:21" pos:end="141:31"><name pos:start="141:21" pos:end="141:31">SIG_SETMASK</name></expr></argument>, <argument pos:start="141:34" pos:end="141:46"><expr pos:start="141:34" pos:end="141:46"><operator pos:start="141:34" pos:end="141:34">&amp;</operator><name pos:start="141:35" pos:end="141:46"><name pos:start="141:35" pos:end="141:38">info</name><operator pos:start="141:39" pos:end="141:39">.</operator><name pos:start="141:40" pos:end="141:46">sigmask</name></name></expr></argument>, <argument pos:start="141:49" pos:end="141:52"><expr pos:start="141:49" pos:end="141:52"><name pos:start="141:49" pos:end="141:52">NULL</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="143:9" pos:end="143:36"><expr pos:start="143:9" pos:end="143:35"><call pos:start="143:9" pos:end="143:35"><name pos:start="143:9" pos:end="143:28">pthread_attr_destroy</name><argument_list pos:start="143:29" pos:end="143:35">(<argument pos:start="143:30" pos:end="143:34"><expr pos:start="143:30" pos:end="143:34"><operator pos:start="143:30" pos:end="143:30">&amp;</operator><name pos:start="143:31" pos:end="143:34">attr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="145:9" pos:end="161:9"><if pos:start="145:9" pos:end="157:9">if <condition pos:start="145:12" pos:end="145:21">(<expr pos:start="145:13" pos:end="145:20"><name pos:start="145:13" pos:end="145:15">ret</name> <operator pos:start="145:17" pos:end="145:18">==</operator> <literal type="number" pos:start="145:20" pos:end="145:20">0</literal></expr>)</condition> <block pos:start="145:23" pos:end="157:9">{<block_content pos:start="149:13" pos:end="155:49">

            <comment type="block" pos:start="147:13" pos:end="147:52">/* Wait for the child to initialize.  */</comment>

            <expr_stmt pos:start="149:13" pos:end="149:55"><expr pos:start="149:13" pos:end="149:54"><call pos:start="149:13" pos:end="149:54"><name pos:start="149:13" pos:end="149:29">pthread_cond_wait</name><argument_list pos:start="149:30" pos:end="149:54">(<argument pos:start="149:31" pos:end="149:40"><expr pos:start="149:31" pos:end="149:40"><operator pos:start="149:31" pos:end="149:31">&amp;</operator><name pos:start="149:32" pos:end="149:40"><name pos:start="149:32" pos:end="149:35">info</name><operator pos:start="149:36" pos:end="149:36">.</operator><name pos:start="149:37" pos:end="149:40">cond</name></name></expr></argument>, <argument pos:start="149:43" pos:end="149:53"><expr pos:start="149:43" pos:end="149:53"><operator pos:start="149:43" pos:end="149:43">&amp;</operator><name pos:start="149:44" pos:end="149:53"><name pos:start="149:44" pos:end="149:47">info</name><operator pos:start="149:48" pos:end="149:48">.</operator><name pos:start="149:49" pos:end="149:53">mutex</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="151:13" pos:end="151:27"><expr pos:start="151:13" pos:end="151:26"><name pos:start="151:13" pos:end="151:15">ret</name> <operator pos:start="151:17" pos:end="151:17">=</operator> <name pos:start="151:19" pos:end="151:26"><name pos:start="151:19" pos:end="151:22">info</name><operator pos:start="151:23" pos:end="151:23">.</operator><name pos:start="151:24" pos:end="151:26">tid</name></name></expr>;</expr_stmt>

            <if_stmt pos:start="153:13" pos:end="155:49"><if pos:start="153:13" pos:end="155:49">if <condition pos:start="153:16" pos:end="153:44">(<expr pos:start="153:17" pos:end="153:43"><name pos:start="153:17" pos:end="153:21">flags</name> <operator pos:start="153:23" pos:end="153:23">&amp;</operator> <name pos:start="153:25" pos:end="153:43">CLONE_PARENT_SETTID</name></expr>)</condition><block type="pseudo" pos:start="155:17" pos:end="155:49"><block_content pos:start="155:17" pos:end="155:49">

                <expr_stmt pos:start="155:17" pos:end="155:49"><expr pos:start="155:17" pos:end="155:48"><call pos:start="155:17" pos:end="155:48"><name pos:start="155:17" pos:end="155:28">put_user_u32</name><argument_list pos:start="155:29" pos:end="155:48">(<argument pos:start="155:30" pos:end="155:32"><expr pos:start="155:30" pos:end="155:32"><name pos:start="155:30" pos:end="155:32">ret</name></expr></argument>, <argument pos:start="155:35" pos:end="155:47"><expr pos:start="155:35" pos:end="155:47"><name pos:start="155:35" pos:end="155:47">parent_tidptr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>

        </block_content>}</block></if> <else pos:start="157:11" pos:end="161:9">else <block pos:start="157:16" pos:end="161:9">{<block_content pos:start="159:13" pos:end="159:21">

            <expr_stmt pos:start="159:13" pos:end="159:21"><expr pos:start="159:13" pos:end="159:20"><name pos:start="159:13" pos:end="159:15">ret</name> <operator pos:start="159:17" pos:end="159:17">=</operator> <operator pos:start="159:19" pos:end="159:19">-</operator><literal type="number" pos:start="159:20" pos:end="159:20">1</literal></expr>;</expr_stmt>

        </block_content>}</block></else></if_stmt>

        <expr_stmt pos:start="163:9" pos:end="163:42"><expr pos:start="163:9" pos:end="163:41"><call pos:start="163:9" pos:end="163:41"><name pos:start="163:9" pos:end="163:28">pthread_mutex_unlock</name><argument_list pos:start="163:29" pos:end="163:41">(<argument pos:start="163:30" pos:end="163:40"><expr pos:start="163:30" pos:end="163:40"><operator pos:start="163:30" pos:end="163:30">&amp;</operator><name pos:start="163:31" pos:end="163:40"><name pos:start="163:31" pos:end="163:34">info</name><operator pos:start="163:35" pos:end="163:35">.</operator><name pos:start="163:36" pos:end="163:40">mutex</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="165:9" pos:end="165:41"><expr pos:start="165:9" pos:end="165:40"><call pos:start="165:9" pos:end="165:40"><name pos:start="165:9" pos:end="165:28">pthread_cond_destroy</name><argument_list pos:start="165:29" pos:end="165:40">(<argument pos:start="165:30" pos:end="165:39"><expr pos:start="165:30" pos:end="165:39"><operator pos:start="165:30" pos:end="165:30">&amp;</operator><name pos:start="165:31" pos:end="165:39"><name pos:start="165:31" pos:end="165:34">info</name><operator pos:start="165:35" pos:end="165:35">.</operator><name pos:start="165:36" pos:end="165:39">cond</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="167:9" pos:end="167:43"><expr pos:start="167:9" pos:end="167:42"><call pos:start="167:9" pos:end="167:42"><name pos:start="167:9" pos:end="167:29">pthread_mutex_destroy</name><argument_list pos:start="167:30" pos:end="167:42">(<argument pos:start="167:31" pos:end="167:41"><expr pos:start="167:31" pos:end="167:41"><operator pos:start="167:31" pos:end="167:31">&amp;</operator><name pos:start="167:32" pos:end="167:41"><name pos:start="167:32" pos:end="167:35">info</name><operator pos:start="167:36" pos:end="167:36">.</operator><name pos:start="167:37" pos:end="167:41">mutex</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="169:9" pos:end="172:0"><expr pos:start="169:9" pos:end="169:41"><call pos:start="169:9" pos:end="169:41"><name pos:start="169:9" pos:end="169:28">pthread_mutex_unlock</name><argument_list pos:start="169:29" pos:end="169:41">(<argument pos:start="169:30" pos:end="169:40"><expr pos:start="169:30" pos:end="169:40"><operator pos:start="169:30" pos:end="169:30">&amp;</operator><name pos:start="169:31" pos:end="169:40">clone_lock</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

<cpp:else pos:start="171:1" pos:end="171:5">#<cpp:directive pos:start="171:2" pos:end="171:5">else</cpp:directive></cpp:else>

        <if_stmt pos:start="173:9" pos:end="180:0"><if pos:start="173:9" pos:end="180:0">if <condition pos:start="173:12" pos:end="173:38">(<expr pos:start="173:13" pos:end="173:37"><name pos:start="173:13" pos:end="173:17">flags</name> <operator pos:start="173:19" pos:end="173:19">&amp;</operator> <name pos:start="173:21" pos:end="173:37">CLONE_NPTL_FLAGS2</name></expr>)</condition><block type="pseudo" pos:start="175:13" pos:end="180:0"><block_content pos:start="175:13" pos:end="180:0">

            <return pos:start="175:13" pos:end="180:0">return <expr pos:start="175:20" pos:end="175:26"><operator pos:start="175:20" pos:end="175:20">-</operator><name pos:start="175:21" pos:end="175:26">EINVAL</name></expr>;</return></block_content></block></if></if_stmt>

        <comment type="block" pos:start="177:9" pos:end="177:76">/* This is probably going to die very quickly, but do it anyway.  */</comment>

<cpp:ifdef pos:start="179:1" pos:end="179:15">#<cpp:directive pos:start="179:2" pos:end="179:6">ifdef</cpp:directive> <name pos:start="179:8" pos:end="179:15">__ia64__</name></cpp:ifdef>

        <expr_stmt pos:start="181:9" pos:end="184:0"><expr pos:start="181:9" pos:end="181:77"><name pos:start="181:9" pos:end="181:11">ret</name> <operator pos:start="181:13" pos:end="181:13">=</operator> <call pos:start="181:15" pos:end="181:77"><name pos:start="181:15" pos:end="181:22">__clone2</name><argument_list pos:start="181:23" pos:end="181:77">(<argument pos:start="181:24" pos:end="181:33"><expr pos:start="181:24" pos:end="181:33"><name pos:start="181:24" pos:end="181:33">clone_func</name></expr></argument>, <argument pos:start="181:36" pos:end="181:44"><expr pos:start="181:36" pos:end="181:44"><name pos:start="181:36" pos:end="181:44">new_stack</name></expr></argument>, <argument pos:start="181:47" pos:end="181:60"><expr pos:start="181:47" pos:end="181:60"><name pos:start="181:47" pos:end="181:60">NEW_STACK_SIZE</name></expr></argument>, <argument pos:start="181:63" pos:end="181:67"><expr pos:start="181:63" pos:end="181:67"><name pos:start="181:63" pos:end="181:67">flags</name></expr></argument>, <argument pos:start="181:70" pos:end="181:76"><expr pos:start="181:70" pos:end="181:76"><name pos:start="181:70" pos:end="181:76">new_env</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

<cpp:else pos:start="183:1" pos:end="183:5">#<cpp:directive pos:start="183:2" pos:end="183:5">else</cpp:directive></cpp:else>

	<expr_stmt pos:start="185:9" pos:end="190:0"><expr pos:start="185:9" pos:end="185:75"><name pos:start="185:9" pos:end="185:11">ret</name> <operator pos:start="185:13" pos:end="185:13">=</operator> <call pos:start="185:15" pos:end="185:75"><name pos:start="185:15" pos:end="185:19">clone</name><argument_list pos:start="185:20" pos:end="185:75">(<argument pos:start="185:21" pos:end="185:30"><expr pos:start="185:21" pos:end="185:30"><name pos:start="185:21" pos:end="185:30">clone_func</name></expr></argument>, <argument pos:start="185:33" pos:end="185:58"><expr pos:start="185:33" pos:end="185:58"><name pos:start="185:33" pos:end="185:41">new_stack</name> <operator pos:start="185:43" pos:end="185:43">+</operator> <name pos:start="185:45" pos:end="185:58">NEW_STACK_SIZE</name></expr></argument>, <argument pos:start="185:61" pos:end="185:65"><expr pos:start="185:61" pos:end="185:65"><name pos:start="185:61" pos:end="185:65">flags</name></expr></argument>, <argument pos:start="185:68" pos:end="185:74"><expr pos:start="185:68" pos:end="185:74"><name pos:start="185:68" pos:end="185:74">new_env</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

<cpp:endif pos:start="187:1" pos:end="187:6">#<cpp:directive pos:start="187:2" pos:end="187:6">endif</cpp:directive></cpp:endif>

<cpp:endif pos:start="189:1" pos:end="189:6">#<cpp:directive pos:start="189:2" pos:end="189:6">endif</cpp:directive></cpp:endif>

    </block_content>}</block></if> <else pos:start="191:7" pos:end="251:5">else <block pos:start="191:12" pos:end="251:5">{<block_content pos:start="195:9" pos:end="249:9">

        <comment type="block" pos:start="193:9" pos:end="193:54">/* if no CLONE_VM, we consider it is a fork */</comment>

        <if_stmt pos:start="195:9" pos:end="197:27"><if pos:start="195:9" pos:end="197:27">if <condition pos:start="195:12" pos:end="195:58">(<expr pos:start="195:13" pos:end="195:57"><operator pos:start="195:13" pos:end="195:13">(</operator><name pos:start="195:14" pos:end="195:18">flags</name> <operator pos:start="195:20" pos:end="195:20">&amp;</operator> <operator pos:start="195:22" pos:end="195:22">~</operator><operator pos:start="195:23" pos:end="195:23">(</operator><name pos:start="195:24" pos:end="195:30">CSIGNAL</name> <operator pos:start="195:32" pos:end="195:32">|</operator> <name pos:start="195:34" pos:end="195:50">CLONE_NPTL_FLAGS2</name><operator pos:start="195:51" pos:end="195:51">)</operator><operator pos:start="195:52" pos:end="195:52">)</operator> <operator pos:start="195:54" pos:end="195:55">!=</operator> <literal type="number" pos:start="195:57" pos:end="195:57">0</literal></expr>)</condition><block type="pseudo" pos:start="197:13" pos:end="197:27"><block_content pos:start="197:13" pos:end="197:27">

            <return pos:start="197:13" pos:end="197:27">return <expr pos:start="197:20" pos:end="197:26"><operator pos:start="197:20" pos:end="197:20">-</operator><name pos:start="197:21" pos:end="197:26">EINVAL</name></expr>;</return></block_content></block></if></if_stmt>

        <expr_stmt pos:start="199:9" pos:end="199:21"><expr pos:start="199:9" pos:end="199:20"><call pos:start="199:9" pos:end="199:20"><name pos:start="199:9" pos:end="199:18">fork_start</name><argument_list pos:start="199:19" pos:end="199:20">()</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="201:9" pos:end="201:21"><expr pos:start="201:9" pos:end="201:20"><name pos:start="201:9" pos:end="201:11">ret</name> <operator pos:start="201:13" pos:end="201:13">=</operator> <call pos:start="201:15" pos:end="201:20"><name pos:start="201:15" pos:end="201:18">fork</name><argument_list pos:start="201:19" pos:end="201:20">()</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="203:9" pos:end="249:9"><if pos:start="203:9" pos:end="245:9">if <condition pos:start="203:12" pos:end="203:21">(<expr pos:start="203:13" pos:end="203:20"><name pos:start="203:13" pos:end="203:15">ret</name> <operator pos:start="203:17" pos:end="203:18">==</operator> <literal type="number" pos:start="203:20" pos:end="203:20">0</literal></expr>)</condition> <block pos:start="203:23" pos:end="245:9">{<block_content pos:start="207:13" pos:end="244:0">

            <comment type="block" pos:start="205:13" pos:end="205:33">/* Child Process.  */</comment>

            <expr_stmt pos:start="207:13" pos:end="207:39"><expr pos:start="207:13" pos:end="207:38"><call pos:start="207:13" pos:end="207:38"><name pos:start="207:13" pos:end="207:26">cpu_clone_regs</name><argument_list pos:start="207:27" pos:end="207:38">(<argument pos:start="207:28" pos:end="207:30"><expr pos:start="207:28" pos:end="207:30"><name pos:start="207:28" pos:end="207:30">env</name></expr></argument>, <argument pos:start="207:33" pos:end="207:37"><expr pos:start="207:33" pos:end="207:37"><name pos:start="207:33" pos:end="207:37">newsp</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="209:13" pos:end="212:0"><expr pos:start="209:13" pos:end="209:23"><call pos:start="209:13" pos:end="209:23"><name pos:start="209:13" pos:end="209:20">fork_end</name><argument_list pos:start="209:21" pos:end="209:23">(<argument pos:start="209:22" pos:end="209:22"><expr pos:start="209:22" pos:end="209:22"><literal type="number" pos:start="209:22" pos:end="209:22">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

<cpp:if pos:start="211:1" pos:end="211:28">#<cpp:directive pos:start="211:2" pos:end="211:3">if</cpp:directive> <expr pos:start="211:5" pos:end="211:28"><call pos:start="211:5" pos:end="211:28"><name pos:start="211:5" pos:end="211:11">defined</name><argument_list pos:start="211:12" pos:end="211:28">(<argument pos:start="211:13" pos:end="211:27"><expr pos:start="211:13" pos:end="211:27"><name pos:start="211:13" pos:end="211:27">CONFIG_USE_NPTL</name></expr></argument>)</argument_list></call></expr></cpp:if>

            <comment type="block" pos:start="213:13" pos:end="223:67">/* There is a race condition here.  The parent process could

               theoretically read the TID in the child process before the child

               tid is set.  This would require using either ptrace

               (not implemented) or having *_tidptr to point at a shared memory

               mapping.  We can't repeat the spinlock hack used above because

               the child process gets its own copy of the lock.  */</comment>

            <if_stmt pos:start="225:13" pos:end="227:53"><if pos:start="225:13" pos:end="227:53">if <condition pos:start="225:16" pos:end="225:43">(<expr pos:start="225:17" pos:end="225:42"><name pos:start="225:17" pos:end="225:21">flags</name> <operator pos:start="225:23" pos:end="225:23">&amp;</operator> <name pos:start="225:25" pos:end="225:42">CLONE_CHILD_SETTID</name></expr>)</condition><block type="pseudo" pos:start="227:17" pos:end="227:53"><block_content pos:start="227:17" pos:end="227:53">

                <expr_stmt pos:start="227:17" pos:end="227:53"><expr pos:start="227:17" pos:end="227:52"><call pos:start="227:17" pos:end="227:52"><name pos:start="227:17" pos:end="227:28">put_user_u32</name><argument_list pos:start="227:29" pos:end="227:52">(<argument pos:start="227:30" pos:end="227:37"><expr pos:start="227:30" pos:end="227:37"><call pos:start="227:30" pos:end="227:37"><name pos:start="227:30" pos:end="227:35">gettid</name><argument_list pos:start="227:36" pos:end="227:37">()</argument_list></call></expr></argument>, <argument pos:start="227:40" pos:end="227:51"><expr pos:start="227:40" pos:end="227:51"><name pos:start="227:40" pos:end="227:51">child_tidptr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>

            <if_stmt pos:start="229:13" pos:end="231:54"><if pos:start="229:13" pos:end="231:54">if <condition pos:start="229:16" pos:end="229:44">(<expr pos:start="229:17" pos:end="229:43"><name pos:start="229:17" pos:end="229:21">flags</name> <operator pos:start="229:23" pos:end="229:23">&amp;</operator> <name pos:start="229:25" pos:end="229:43">CLONE_PARENT_SETTID</name></expr>)</condition><block type="pseudo" pos:start="231:17" pos:end="231:54"><block_content pos:start="231:17" pos:end="231:54">

                <expr_stmt pos:start="231:17" pos:end="231:54"><expr pos:start="231:17" pos:end="231:53"><call pos:start="231:17" pos:end="231:53"><name pos:start="231:17" pos:end="231:28">put_user_u32</name><argument_list pos:start="231:29" pos:end="231:53">(<argument pos:start="231:30" pos:end="231:37"><expr pos:start="231:30" pos:end="231:37"><call pos:start="231:30" pos:end="231:37"><name pos:start="231:30" pos:end="231:35">gettid</name><argument_list pos:start="231:36" pos:end="231:37">()</argument_list></call></expr></argument>, <argument pos:start="231:40" pos:end="231:52"><expr pos:start="231:40" pos:end="231:52"><name pos:start="231:40" pos:end="231:52">parent_tidptr</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>

            <expr_stmt pos:start="233:13" pos:end="233:42"><expr pos:start="233:13" pos:end="233:41"><name pos:start="233:13" pos:end="233:14">ts</name> <operator pos:start="233:16" pos:end="233:16">=</operator> <operator pos:start="233:18" pos:end="233:18">(</operator><name pos:start="233:19" pos:end="233:27">TaskState</name> <operator pos:start="233:29" pos:end="233:29">*</operator><operator pos:start="233:30" pos:end="233:30">)</operator><name pos:start="233:31" pos:end="233:41"><name pos:start="233:31" pos:end="233:33">env</name><operator pos:start="233:34" pos:end="233:35">-&gt;</operator><name pos:start="233:36" pos:end="233:41">opaque</name></name></expr>;</expr_stmt>

            <if_stmt pos:start="235:13" pos:end="237:42"><if pos:start="235:13" pos:end="237:42">if <condition pos:start="235:16" pos:end="235:37">(<expr pos:start="235:17" pos:end="235:36"><name pos:start="235:17" pos:end="235:21">flags</name> <operator pos:start="235:23" pos:end="235:23">&amp;</operator> <name pos:start="235:25" pos:end="235:36">CLONE_SETTLS</name></expr>)</condition><block type="pseudo" pos:start="237:17" pos:end="237:42"><block_content pos:start="237:17" pos:end="237:42">

                <expr_stmt pos:start="237:17" pos:end="237:42"><expr pos:start="237:17" pos:end="237:41"><call pos:start="237:17" pos:end="237:41"><name pos:start="237:17" pos:end="237:27">cpu_set_tls</name> <argument_list pos:start="237:29" pos:end="237:41">(<argument pos:start="237:30" pos:end="237:32"><expr pos:start="237:30" pos:end="237:32"><name pos:start="237:30" pos:end="237:32">env</name></expr></argument>, <argument pos:start="237:35" pos:end="237:40"><expr pos:start="237:35" pos:end="237:40"><name pos:start="237:35" pos:end="237:40">newtls</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>

            <if_stmt pos:start="239:13" pos:end="244:0"><if pos:start="239:13" pos:end="244:0">if <condition pos:start="239:16" pos:end="239:45">(<expr pos:start="239:17" pos:end="239:44"><name pos:start="239:17" pos:end="239:21">flags</name> <operator pos:start="239:23" pos:end="239:23">&amp;</operator> <name pos:start="239:25" pos:end="239:44">CLONE_CHILD_CLEARTID</name></expr>)</condition><block type="pseudo" pos:start="241:17" pos:end="244:0"><block_content pos:start="241:17" pos:end="244:0">

                <expr_stmt pos:start="241:17" pos:end="244:0"><expr pos:start="241:17" pos:end="241:47"><name pos:start="241:17" pos:end="241:32"><name pos:start="241:17" pos:end="241:18">ts</name><operator pos:start="241:19" pos:end="241:20">-&gt;</operator><name pos:start="241:21" pos:end="241:32">child_tidptr</name></name> <operator pos:start="241:34" pos:end="241:34">=</operator> <name pos:start="241:36" pos:end="241:47">child_tidptr</name></expr>;</expr_stmt></block_content></block></if></if_stmt>

<cpp:endif pos:start="243:1" pos:end="243:6">#<cpp:directive pos:start="243:2" pos:end="243:6">endif</cpp:directive></cpp:endif>

        </block_content>}</block></if> <else pos:start="245:11" pos:end="249:9">else <block pos:start="245:16" pos:end="249:9">{<block_content pos:start="247:13" pos:end="247:24">

            <expr_stmt pos:start="247:13" pos:end="247:24"><expr pos:start="247:13" pos:end="247:23"><call pos:start="247:13" pos:end="247:23"><name pos:start="247:13" pos:end="247:20">fork_end</name><argument_list pos:start="247:21" pos:end="247:23">(<argument pos:start="247:22" pos:end="247:22"><expr pos:start="247:22" pos:end="247:22"><literal type="number" pos:start="247:22" pos:end="247:22">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></else></if_stmt>

    </block_content>}</block></else></if_stmt>

    <return pos:start="253:5" pos:end="253:15">return <expr pos:start="253:12" pos:end="253:14"><name pos:start="253:12" pos:end="253:14">ret</name></expr>;</return>

</block_content>}</block></function>
</unit>
