<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/2543.c" pos:tabs="8"><function pos:start="1:1" pos:end="63:1"><type pos:start="1:1" pos:end="1:10"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:10">int</name></type> <name pos:start="1:12" pos:end="1:33">usb_uhci_common_initfn</name><parameter_list pos:start="1:34" pos:end="1:47">(<parameter pos:start="1:35" pos:end="1:46"><decl pos:start="1:35" pos:end="1:46"><type pos:start="1:35" pos:end="1:45"><name pos:start="1:35" pos:end="1:43">UHCIState</name> <modifier pos:start="1:45" pos:end="1:45">*</modifier></type><name pos:start="1:46" pos:end="1:46">s</name></decl></parameter>)</parameter_list>

<block pos:start="3:1" pos:end="63:1">{<block_content pos:start="5:5" pos:end="61:13">

    <decl_stmt pos:start="5:5" pos:end="5:38"><decl pos:start="5:5" pos:end="5:37"><type pos:start="5:5" pos:end="5:13"><name pos:start="5:5" pos:end="5:11">uint8_t</name> <modifier pos:start="5:13" pos:end="5:13">*</modifier></type><name pos:start="5:14" pos:end="5:21">pci_conf</name> <init pos:start="5:23" pos:end="5:37">= <expr pos:start="5:25" pos:end="5:37"><name pos:start="5:25" pos:end="5:37"><name pos:start="5:25" pos:end="5:25">s</name><operator pos:start="5:26" pos:end="5:27">-&gt;</operator><name pos:start="5:28" pos:end="5:30">dev</name><operator pos:start="5:31" pos:end="5:31">.</operator><name pos:start="5:32" pos:end="5:37">config</name></name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="7:5" pos:end="7:10"><decl pos:start="7:5" pos:end="7:9"><type pos:start="7:5" pos:end="7:7"><name pos:start="7:5" pos:end="7:7">int</name></type> <name pos:start="7:9" pos:end="7:9">i</name></decl>;</decl_stmt>



    <expr_stmt pos:start="11:5" pos:end="11:37"><expr pos:start="11:5" pos:end="11:36"><name pos:start="11:5" pos:end="11:29"><name pos:start="11:5" pos:end="11:12">pci_conf</name><index pos:start="11:13" pos:end="11:29">[<expr pos:start="11:14" pos:end="11:28"><name pos:start="11:14" pos:end="11:28">PCI_REVISION_ID</name></expr>]</index></name> <operator pos:start="11:31" pos:end="11:31">=</operator> <literal type="number" pos:start="11:33" pos:end="11:36">0x01</literal></expr>;</expr_stmt> <comment type="line" pos:start="11:39" pos:end="11:56">// revision number</comment>

    <expr_stmt pos:start="13:5" pos:end="13:36"><expr pos:start="13:5" pos:end="13:35"><name pos:start="13:5" pos:end="13:28"><name pos:start="13:5" pos:end="13:12">pci_conf</name><index pos:start="13:13" pos:end="13:28">[<expr pos:start="13:14" pos:end="13:27"><name pos:start="13:14" pos:end="13:27">PCI_CLASS_PROG</name></expr>]</index></name> <operator pos:start="13:30" pos:end="13:30">=</operator> <literal type="number" pos:start="13:32" pos:end="13:35">0x00</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="15:5" pos:end="15:57"><expr pos:start="15:5" pos:end="15:56"><call pos:start="15:5" pos:end="15:56"><name pos:start="15:5" pos:end="15:24">pci_config_set_class</name><argument_list pos:start="15:25" pos:end="15:56">(<argument pos:start="15:26" pos:end="15:33"><expr pos:start="15:26" pos:end="15:33"><name pos:start="15:26" pos:end="15:33">pci_conf</name></expr></argument>, <argument pos:start="15:36" pos:end="15:55"><expr pos:start="15:36" pos:end="15:55"><name pos:start="15:36" pos:end="15:55">PCI_CLASS_SERIAL_USB</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <comment type="block" pos:start="17:5" pos:end="17:40">/* TODO: reset value should be 0. */</comment>

    <expr_stmt pos:start="19:5" pos:end="19:36"><expr pos:start="19:5" pos:end="19:35"><name pos:start="19:5" pos:end="19:31"><name pos:start="19:5" pos:end="19:12">pci_conf</name><index pos:start="19:13" pos:end="19:31">[<expr pos:start="19:14" pos:end="19:30"><name pos:start="19:14" pos:end="19:30">PCI_INTERRUPT_PIN</name></expr>]</index></name> <operator pos:start="19:33" pos:end="19:33">=</operator> <literal type="number" pos:start="19:35" pos:end="19:35">4</literal></expr>;</expr_stmt> <comment type="line" pos:start="19:38" pos:end="19:55">// interrupt pin 3</comment>

    <expr_stmt pos:start="21:5" pos:end="21:26"><expr pos:start="21:5" pos:end="21:25"><name pos:start="21:5" pos:end="21:18"><name pos:start="21:5" pos:end="21:12">pci_conf</name><index pos:start="21:13" pos:end="21:18">[<expr pos:start="21:14" pos:end="21:17"><literal type="number" pos:start="21:14" pos:end="21:17">0x60</literal></expr>]</index></name> <operator pos:start="21:20" pos:end="21:20">=</operator> <literal type="number" pos:start="21:22" pos:end="21:25">0x10</literal></expr>;</expr_stmt> <comment type="line" pos:start="21:28" pos:end="21:44">// release number</comment>



    <expr_stmt pos:start="25:5" pos:end="25:39"><expr pos:start="25:5" pos:end="25:38"><call pos:start="25:5" pos:end="25:38"><name pos:start="25:5" pos:end="25:15">usb_bus_new</name><argument_list pos:start="25:16" pos:end="25:38">(<argument pos:start="25:17" pos:end="25:23"><expr pos:start="25:17" pos:end="25:23"><operator pos:start="25:17" pos:end="25:17">&amp;</operator><name pos:start="25:18" pos:end="25:23"><name pos:start="25:18" pos:end="25:18">s</name><operator pos:start="25:19" pos:end="25:20">-&gt;</operator><name pos:start="25:21" pos:end="25:23">bus</name></name></expr></argument>, <argument pos:start="25:26" pos:end="25:37"><expr pos:start="25:26" pos:end="25:37"><operator pos:start="25:26" pos:end="25:26">&amp;</operator><name pos:start="25:27" pos:end="25:37"><name pos:start="25:27" pos:end="25:27">s</name><operator pos:start="25:28" pos:end="25:29">-&gt;</operator><name pos:start="25:30" pos:end="25:32">dev</name><operator pos:start="25:33" pos:end="25:33">.</operator><name pos:start="25:34" pos:end="25:37">qdev</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <for pos:start="27:5" pos:end="35:5">for<control pos:start="27:8" pos:end="27:33">(<init pos:start="27:9" pos:end="27:14"><expr pos:start="27:9" pos:end="27:13"><name pos:start="27:9" pos:end="27:9">i</name> <operator pos:start="27:11" pos:end="27:11">=</operator> <literal type="number" pos:start="27:13" pos:end="27:13">0</literal></expr>;</init> <condition pos:start="27:16" pos:end="27:28"><expr pos:start="27:16" pos:end="27:27"><name pos:start="27:16" pos:end="27:16">i</name> <operator pos:start="27:18" pos:end="27:18">&lt;</operator> <name pos:start="27:20" pos:end="27:27">NB_PORTS</name></expr>;</condition> <incr pos:start="27:30" pos:end="27:32"><expr pos:start="27:30" pos:end="27:32"><name pos:start="27:30" pos:end="27:30">i</name><operator pos:start="27:31" pos:end="27:32">++</operator></expr></incr>)</control> <block pos:start="27:35" pos:end="35:5">{<block_content pos:start="29:9" pos:end="33:56">

        <expr_stmt pos:start="29:9" pos:end="31:68"><expr pos:start="29:9" pos:end="31:67"><call pos:start="29:9" pos:end="31:67"><name pos:start="29:9" pos:end="29:25">usb_register_port</name><argument_list pos:start="29:26" pos:end="31:67">(<argument pos:start="29:27" pos:end="29:33"><expr pos:start="29:27" pos:end="29:33"><operator pos:start="29:27" pos:end="29:27">&amp;</operator><name pos:start="29:28" pos:end="29:33"><name pos:start="29:28" pos:end="29:28">s</name><operator pos:start="29:29" pos:end="29:30">-&gt;</operator><name pos:start="29:31" pos:end="29:33">bus</name></name></expr></argument>, <argument pos:start="29:36" pos:end="29:52"><expr pos:start="29:36" pos:end="29:52"><operator pos:start="29:36" pos:end="29:36">&amp;</operator><name pos:start="29:37" pos:end="29:47"><name pos:start="29:37" pos:end="29:37">s</name><operator pos:start="29:38" pos:end="29:39">-&gt;</operator><name pos:start="29:40" pos:end="29:44">ports</name><index pos:start="29:45" pos:end="29:47">[<expr pos:start="29:46" pos:end="29:46"><name pos:start="29:46" pos:end="29:46">i</name></expr>]</index></name><operator pos:start="29:48" pos:end="29:48">.</operator><name pos:start="29:49" pos:end="29:52">port</name></expr></argument>, <argument pos:start="29:55" pos:end="29:55"><expr pos:start="29:55" pos:end="29:55"><name pos:start="29:55" pos:end="29:55">s</name></expr></argument>, <argument pos:start="29:58" pos:end="29:58"><expr pos:start="29:58" pos:end="29:58"><name pos:start="29:58" pos:end="29:58">i</name></expr></argument>, <argument pos:start="29:61" pos:end="29:74"><expr pos:start="29:61" pos:end="29:74"><operator pos:start="29:61" pos:end="29:61">&amp;</operator><name pos:start="29:62" pos:end="29:74">uhci_port_ops</name></expr></argument>,

                          <argument pos:start="31:27" pos:end="31:66"><expr pos:start="31:27" pos:end="31:66"><name pos:start="31:27" pos:end="31:44">USB_SPEED_MASK_LOW</name> <operator pos:start="31:46" pos:end="31:46">|</operator> <name pos:start="31:48" pos:end="31:66">USB_SPEED_MASK_FULL</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="33:9" pos:end="33:56"><expr pos:start="33:9" pos:end="33:55"><call pos:start="33:9" pos:end="33:55"><name pos:start="33:9" pos:end="33:25">usb_port_location</name><argument_list pos:start="33:26" pos:end="33:55">(<argument pos:start="33:27" pos:end="33:43"><expr pos:start="33:27" pos:end="33:43"><operator pos:start="33:27" pos:end="33:27">&amp;</operator><name pos:start="33:28" pos:end="33:38"><name pos:start="33:28" pos:end="33:28">s</name><operator pos:start="33:29" pos:end="33:30">-&gt;</operator><name pos:start="33:31" pos:end="33:35">ports</name><index pos:start="33:36" pos:end="33:38">[<expr pos:start="33:37" pos:end="33:37"><name pos:start="33:37" pos:end="33:37">i</name></expr>]</index></name><operator pos:start="33:39" pos:end="33:39">.</operator><name pos:start="33:40" pos:end="33:43">port</name></expr></argument>, <argument pos:start="33:46" pos:end="33:49"><expr pos:start="33:46" pos:end="33:49"><name pos:start="33:46" pos:end="33:49">NULL</name></expr></argument>, <argument pos:start="33:52" pos:end="33:54"><expr pos:start="33:52" pos:end="33:54"><name pos:start="33:52" pos:end="33:52">i</name><operator pos:start="33:53" pos:end="33:53">+</operator><literal type="number" pos:start="33:54" pos:end="33:54">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></for>

    <expr_stmt pos:start="37:5" pos:end="37:70"><expr pos:start="37:5" pos:end="37:69"><name pos:start="37:5" pos:end="37:18"><name pos:start="37:5" pos:end="37:5">s</name><operator pos:start="37:6" pos:end="37:7">-&gt;</operator><name pos:start="37:8" pos:end="37:18">frame_timer</name></name> <operator pos:start="37:20" pos:end="37:20">=</operator> <call pos:start="37:22" pos:end="37:69"><name pos:start="37:22" pos:end="37:38">qemu_new_timer_ns</name><argument_list pos:start="37:39" pos:end="37:69">(<argument pos:start="37:40" pos:end="37:47"><expr pos:start="37:40" pos:end="37:47"><name pos:start="37:40" pos:end="37:47">vm_clock</name></expr></argument>, <argument pos:start="37:50" pos:end="37:65"><expr pos:start="37:50" pos:end="37:65"><name pos:start="37:50" pos:end="37:65">uhci_frame_timer</name></expr></argument>, <argument pos:start="37:68" pos:end="37:68"><expr pos:start="37:68" pos:end="37:68"><name pos:start="37:68" pos:end="37:68">s</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="39:5" pos:end="41:49"><expr pos:start="39:5" pos:end="41:48"><name pos:start="39:5" pos:end="39:18"><name pos:start="39:5" pos:end="39:5">s</name><operator pos:start="39:6" pos:end="39:7">-&gt;</operator><name pos:start="39:8" pos:end="39:18">expire_time</name></name> <operator pos:start="39:20" pos:end="39:20">=</operator> <call pos:start="39:22" pos:end="39:48"><name pos:start="39:22" pos:end="39:38">qemu_get_clock_ns</name><argument_list pos:start="39:39" pos:end="39:48">(<argument pos:start="39:40" pos:end="39:47"><expr pos:start="39:40" pos:end="39:47"><name pos:start="39:40" pos:end="39:47">vm_clock</name></expr></argument>)</argument_list></call> <operator pos:start="39:50" pos:end="39:50">+</operator>

        <operator pos:start="41:9" pos:end="41:9">(</operator><call pos:start="41:10" pos:end="41:28"><name pos:start="41:10" pos:end="41:26">get_ticks_per_sec</name><argument_list pos:start="41:27" pos:end="41:28">()</argument_list></call> <operator pos:start="41:30" pos:end="41:30">/</operator> <name pos:start="41:32" pos:end="41:47">FRAME_TIMER_FREQ</name><operator pos:start="41:48" pos:end="41:48">)</operator></expr>;</expr_stmt>

    <expr_stmt pos:start="43:5" pos:end="43:36"><expr pos:start="43:5" pos:end="43:35"><name pos:start="43:5" pos:end="43:24"><name pos:start="43:5" pos:end="43:5">s</name><operator pos:start="43:6" pos:end="43:7">-&gt;</operator><name pos:start="43:8" pos:end="43:24">num_ports_vmstate</name></name> <operator pos:start="43:26" pos:end="43:26">=</operator> <name pos:start="43:28" pos:end="43:35">NB_PORTS</name></expr>;</expr_stmt>



    <expr_stmt pos:start="47:5" pos:end="47:39"><expr pos:start="47:5" pos:end="47:38"><call pos:start="47:5" pos:end="47:38"><name pos:start="47:5" pos:end="47:23">qemu_register_reset</name><argument_list pos:start="47:24" pos:end="47:38">(<argument pos:start="47:25" pos:end="47:34"><expr pos:start="47:25" pos:end="47:34"><name pos:start="47:25" pos:end="47:34">uhci_reset</name></expr></argument>, <argument pos:start="47:37" pos:end="47:37"><expr pos:start="47:37" pos:end="47:37"><name pos:start="47:37" pos:end="47:37">s</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <comment type="block" pos:start="51:5" pos:end="53:27">/* Use region 4 for consistency with real hardware.  BSD guests seem

       to rely on this.  */</comment>

    <expr_stmt pos:start="55:5" pos:end="57:64"><expr pos:start="55:5" pos:end="57:63"><call pos:start="55:5" pos:end="57:63"><name pos:start="55:5" pos:end="55:20">pci_register_bar</name><argument_list pos:start="55:21" pos:end="57:63">(<argument pos:start="55:22" pos:end="55:28"><expr pos:start="55:22" pos:end="55:28"><operator pos:start="55:22" pos:end="55:22">&amp;</operator><name pos:start="55:23" pos:end="55:28"><name pos:start="55:23" pos:end="55:23">s</name><operator pos:start="55:24" pos:end="55:25">-&gt;</operator><name pos:start="55:26" pos:end="55:28">dev</name></name></expr></argument>, <argument pos:start="55:31" pos:end="55:31"><expr pos:start="55:31" pos:end="55:31"><literal type="number" pos:start="55:31" pos:end="55:31">4</literal></expr></argument>, <argument pos:start="55:34" pos:end="55:37"><expr pos:start="55:34" pos:end="55:37"><literal type="number" pos:start="55:34" pos:end="55:37">0x20</literal></expr></argument>,

                           <argument pos:start="57:28" pos:end="57:52"><expr pos:start="57:28" pos:end="57:52"><name pos:start="57:28" pos:end="57:52">PCI_BASE_ADDRESS_SPACE_IO</name></expr></argument>, <argument pos:start="57:55" pos:end="57:62"><expr pos:start="57:55" pos:end="57:62"><name pos:start="57:55" pos:end="57:62">uhci_map</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <return pos:start="61:5" pos:end="61:13">return <expr pos:start="61:12" pos:end="61:12"><literal type="number" pos:start="61:12" pos:end="61:12">0</literal></expr>;</return>

</block_content>}</block></function>
</unit>
