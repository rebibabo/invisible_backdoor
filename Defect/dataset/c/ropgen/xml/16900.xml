<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/16900.c" pos:tabs="8"><function pos:start="1:1" pos:end="75:1"><type pos:start="1:1" pos:end="1:11"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:11">void</name></type> <name pos:start="1:13" pos:end="1:23">musb_packet</name><parameter_list pos:start="1:24" pos:end="3:69">(<parameter pos:start="1:25" pos:end="1:36"><decl pos:start="1:25" pos:end="1:36"><type pos:start="1:25" pos:end="1:36"><name pos:start="1:25" pos:end="1:33">MUSBState</name> <modifier pos:start="1:35" pos:end="1:35">*</modifier></type><name pos:start="1:36" pos:end="1:36">s</name></decl></parameter>, <parameter pos:start="1:39" pos:end="1:54"><decl pos:start="1:39" pos:end="1:54"><type pos:start="1:39" pos:end="1:54"><name pos:start="1:39" pos:end="1:50">MUSBEndPoint</name> <modifier pos:start="1:52" pos:end="1:52">*</modifier></type><name pos:start="1:53" pos:end="1:54">ep</name></decl></parameter>,

                <parameter pos:start="3:17" pos:end="3:25"><decl pos:start="3:17" pos:end="3:25"><type pos:start="3:17" pos:end="3:25"><name pos:start="3:17" pos:end="3:19">int</name></type> <name pos:start="3:21" pos:end="3:25">epnum</name></decl></parameter>, <parameter pos:start="3:28" pos:end="3:34"><decl pos:start="3:28" pos:end="3:34"><type pos:start="3:28" pos:end="3:34"><name pos:start="3:28" pos:end="3:30">int</name></type> <name pos:start="3:32" pos:end="3:34">pid</name></decl></parameter>, <parameter pos:start="3:37" pos:end="3:43"><decl pos:start="3:37" pos:end="3:43"><type pos:start="3:37" pos:end="3:43"><name pos:start="3:37" pos:end="3:39">int</name></type> <name pos:start="3:41" pos:end="3:43">len</name></decl></parameter>, <parameter pos:start="3:46" pos:end="3:59"><decl pos:start="3:46" pos:end="3:59"><type pos:start="3:46" pos:end="3:59"><name pos:start="3:46" pos:end="3:56">USBCallback</name></type> <name pos:start="3:58" pos:end="3:59">cb</name></decl></parameter>, <parameter pos:start="3:62" pos:end="3:68"><decl pos:start="3:62" pos:end="3:68"><type pos:start="3:62" pos:end="3:68"><name pos:start="3:62" pos:end="3:64">int</name></type> <name pos:start="3:66" pos:end="3:68">dir</name></decl></parameter>)</parameter_list>

<block pos:start="5:1" pos:end="75:1">{<block_content pos:start="7:5" pos:end="73:51">

    <decl_stmt pos:start="7:5" pos:end="7:19"><decl pos:start="7:5" pos:end="7:18"><type pos:start="7:5" pos:end="7:15"><name pos:start="7:5" pos:end="7:13">USBDevice</name> <modifier pos:start="7:15" pos:end="7:15">*</modifier></type><name pos:start="7:16" pos:end="7:18">dev</name></decl>;</decl_stmt>

    <decl_stmt pos:start="9:5" pos:end="9:12"><decl pos:start="9:5" pos:end="9:11"><type pos:start="9:5" pos:end="9:7"><name pos:start="9:5" pos:end="9:7">int</name></type> <name pos:start="9:9" pos:end="9:11">ret</name></decl>;</decl_stmt>

    <decl_stmt pos:start="11:5" pos:end="11:27"><decl pos:start="11:5" pos:end="11:26"><type pos:start="11:5" pos:end="11:7"><name pos:start="11:5" pos:end="11:7">int</name></type> <name pos:start="11:9" pos:end="11:11">idx</name> <init pos:start="11:13" pos:end="11:26">= <expr pos:start="11:15" pos:end="11:26"><name pos:start="11:15" pos:end="11:19">epnum</name> <operator pos:start="11:21" pos:end="11:22">&amp;&amp;</operator> <name pos:start="11:24" pos:end="11:26">dir</name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="13:5" pos:end="13:14"><decl pos:start="13:5" pos:end="13:13"><type pos:start="13:5" pos:end="13:7"><name pos:start="13:5" pos:end="13:7">int</name></type> <name pos:start="13:9" pos:end="13:13">ttype</name></decl>;</decl_stmt>



    <comment type="block" pos:start="17:5" pos:end="25:7">/* ep-&gt;type[0,1] contains:

     * in bits 7:6 the speed (0 - invalid, 1 - high, 2 - full, 3 - slow)

     * in bits 5:4 the transfer type (BULK / INT)

     * in bits 3:0 the EP num

     */</comment>

    <expr_stmt pos:start="27:5" pos:end="27:49"><expr pos:start="27:5" pos:end="27:48"><name pos:start="27:5" pos:end="27:9">ttype</name> <operator pos:start="27:11" pos:end="27:11">=</operator> <ternary pos:start="27:13" pos:end="27:48"><condition pos:start="27:13" pos:end="27:19"><expr pos:start="27:13" pos:end="27:17"><name pos:start="27:13" pos:end="27:17">epnum</name></expr> ?</condition><then pos:start="27:21" pos:end="27:44"> <expr pos:start="27:21" pos:end="27:44"><operator pos:start="27:21" pos:end="27:21">(</operator><name pos:start="27:22" pos:end="27:34"><name pos:start="27:22" pos:end="27:23">ep</name><operator pos:start="27:24" pos:end="27:25">-&gt;</operator><name pos:start="27:26" pos:end="27:29">type</name><index pos:start="27:30" pos:end="27:34">[<expr pos:start="27:31" pos:end="27:33"><name pos:start="27:31" pos:end="27:33">idx</name></expr>]</index></name> <operator pos:start="27:36" pos:end="27:37">&gt;&gt;</operator> <literal type="number" pos:start="27:39" pos:end="27:39">4</literal><operator pos:start="27:40" pos:end="27:40">)</operator> <operator pos:start="27:42" pos:end="27:42">&amp;</operator> <literal type="number" pos:start="27:44" pos:end="27:44">3</literal></expr> </then><else pos:start="27:46" pos:end="27:48">: <expr pos:start="27:48" pos:end="27:48"><literal type="number" pos:start="27:48" pos:end="27:48">0</literal></expr></else></ternary></expr>;</expr_stmt>



    <expr_stmt pos:start="31:5" pos:end="33:59"><expr pos:start="31:5" pos:end="33:58"><name pos:start="31:5" pos:end="31:20"><name pos:start="31:5" pos:end="31:6">ep</name><operator pos:start="31:7" pos:end="31:8">-&gt;</operator><name pos:start="31:9" pos:end="31:15">timeout</name><index pos:start="31:16" pos:end="31:20">[<expr pos:start="31:17" pos:end="31:19"><name pos:start="31:17" pos:end="31:19">dir</name></expr>]</index></name> <operator pos:start="31:22" pos:end="31:22">=</operator> <call pos:start="31:24" pos:end="33:58"><name pos:start="31:24" pos:end="31:35">musb_timeout</name><argument_list pos:start="31:36" pos:end="33:58">(<argument pos:start="31:37" pos:end="31:41"><expr pos:start="31:37" pos:end="31:41"><name pos:start="31:37" pos:end="31:41">ttype</name></expr></argument>,

                    <argument pos:start="33:21" pos:end="33:38"><expr pos:start="33:21" pos:end="33:38"><name pos:start="33:21" pos:end="33:33"><name pos:start="33:21" pos:end="33:22">ep</name><operator pos:start="33:23" pos:end="33:24">-&gt;</operator><name pos:start="33:25" pos:end="33:28">type</name><index pos:start="33:29" pos:end="33:33">[<expr pos:start="33:30" pos:end="33:32"><name pos:start="33:30" pos:end="33:32">idx</name></expr>]</index></name> <operator pos:start="33:35" pos:end="33:36">&gt;&gt;</operator> <literal type="number" pos:start="33:38" pos:end="33:38">6</literal></expr></argument>, <argument pos:start="33:41" pos:end="33:57"><expr pos:start="33:41" pos:end="33:57"><name pos:start="33:41" pos:end="33:57"><name pos:start="33:41" pos:end="33:42">ep</name><operator pos:start="33:43" pos:end="33:44">-&gt;</operator><name pos:start="33:45" pos:end="33:52">interval</name><index pos:start="33:53" pos:end="33:57">[<expr pos:start="33:54" pos:end="33:56"><name pos:start="33:54" pos:end="33:56">idx</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="35:5" pos:end="35:56"><expr pos:start="35:5" pos:end="35:55"><name pos:start="35:5" pos:end="35:22"><name pos:start="35:5" pos:end="35:6">ep</name><operator pos:start="35:7" pos:end="35:8">-&gt;</operator><name pos:start="35:9" pos:end="35:17">interrupt</name><index pos:start="35:18" pos:end="35:22">[<expr pos:start="35:19" pos:end="35:21"><name pos:start="35:19" pos:end="35:21">dir</name></expr>]</index></name> <operator pos:start="35:24" pos:end="35:24">=</operator> <name pos:start="35:26" pos:end="35:30">ttype</name> <operator pos:start="35:32" pos:end="35:33">==</operator> <name pos:start="35:35" pos:end="35:55">USB_ENDPOINT_XFER_INT</name></expr>;</expr_stmt>

    <expr_stmt pos:start="37:5" pos:end="37:29"><expr pos:start="37:5" pos:end="37:28"><name pos:start="37:5" pos:end="37:23"><name pos:start="37:5" pos:end="37:6">ep</name><operator pos:start="37:7" pos:end="37:8">-&gt;</operator><name pos:start="37:9" pos:end="37:18">delayed_cb</name><index pos:start="37:19" pos:end="37:23">[<expr pos:start="37:20" pos:end="37:22"><name pos:start="37:20" pos:end="37:22">dir</name></expr>]</index></name> <operator pos:start="37:25" pos:end="37:25">=</operator> <name pos:start="37:27" pos:end="37:28">cb</name></expr>;</expr_stmt>



    <comment type="block" pos:start="41:5" pos:end="41:48">/* A wild guess on the FADDR semantics... */</comment>

    <expr_stmt pos:start="43:5" pos:end="45:42"><expr pos:start="43:5" pos:end="45:41"><call pos:start="43:5" pos:end="45:41"><name pos:start="43:5" pos:end="43:20">usb_packet_setup</name><argument_list pos:start="43:21" pos:end="45:41">(<argument pos:start="43:22" pos:end="43:39"><expr pos:start="43:22" pos:end="43:39"><operator pos:start="43:22" pos:end="43:22">&amp;</operator><name pos:start="43:23" pos:end="43:37"><name pos:start="43:23" pos:end="43:24">ep</name><operator pos:start="43:25" pos:end="43:26">-&gt;</operator><name pos:start="43:27" pos:end="43:32">packey</name><index pos:start="43:33" pos:end="43:37">[<expr pos:start="43:34" pos:end="43:36"><name pos:start="43:34" pos:end="43:36">dir</name></expr>]</index></name><operator pos:start="43:38" pos:end="43:38">.</operator><name pos:start="43:39" pos:end="43:39">p</name></expr></argument>, <argument pos:start="43:42" pos:end="43:44"><expr pos:start="43:42" pos:end="43:44"><name pos:start="43:42" pos:end="43:44">pid</name></expr></argument>, <argument pos:start="43:47" pos:end="43:60"><expr pos:start="43:47" pos:end="43:60"><name pos:start="43:47" pos:end="43:60"><name pos:start="43:47" pos:end="43:48">ep</name><operator pos:start="43:49" pos:end="43:50">-&gt;</operator><name pos:start="43:51" pos:end="43:55">faddr</name><index pos:start="43:56" pos:end="43:60">[<expr pos:start="43:57" pos:end="43:59"><name pos:start="43:57" pos:end="43:59">idx</name></expr>]</index></name></expr></argument>,

                     <argument pos:start="45:22" pos:end="45:40"><expr pos:start="45:22" pos:end="45:40"><name pos:start="45:22" pos:end="45:34"><name pos:start="45:22" pos:end="45:23">ep</name><operator pos:start="45:24" pos:end="45:25">-&gt;</operator><name pos:start="45:26" pos:end="45:29">type</name><index pos:start="45:30" pos:end="45:34">[<expr pos:start="45:31" pos:end="45:33"><name pos:start="45:31" pos:end="45:33">idx</name></expr>]</index></name> <operator pos:start="45:36" pos:end="45:36">&amp;</operator> <literal type="number" pos:start="45:38" pos:end="45:40">0xf</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="47:5" pos:end="47:61"><expr pos:start="47:5" pos:end="47:60"><call pos:start="47:5" pos:end="47:60"><name pos:start="47:5" pos:end="47:21">usb_packet_addbuf</name><argument_list pos:start="47:22" pos:end="47:60">(<argument pos:start="47:23" pos:end="47:40"><expr pos:start="47:23" pos:end="47:40"><operator pos:start="47:23" pos:end="47:23">&amp;</operator><name pos:start="47:24" pos:end="47:38"><name pos:start="47:24" pos:end="47:25">ep</name><operator pos:start="47:26" pos:end="47:27">-&gt;</operator><name pos:start="47:28" pos:end="47:33">packey</name><index pos:start="47:34" pos:end="47:38">[<expr pos:start="47:35" pos:end="47:37"><name pos:start="47:35" pos:end="47:37">dir</name></expr>]</index></name><operator pos:start="47:39" pos:end="47:39">.</operator><name pos:start="47:40" pos:end="47:40">p</name></expr></argument>, <argument pos:start="47:43" pos:end="47:54"><expr pos:start="47:43" pos:end="47:54"><name pos:start="47:43" pos:end="47:54"><name pos:start="47:43" pos:end="47:44">ep</name><operator pos:start="47:45" pos:end="47:46">-&gt;</operator><name pos:start="47:47" pos:end="47:49">buf</name><index pos:start="47:50" pos:end="47:54">[<expr pos:start="47:51" pos:end="47:53"><name pos:start="47:51" pos:end="47:53">idx</name></expr>]</index></name></expr></argument>, <argument pos:start="47:57" pos:end="47:59"><expr pos:start="47:57" pos:end="47:59"><name pos:start="47:57" pos:end="47:59">len</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="49:5" pos:end="49:28"><expr pos:start="49:5" pos:end="49:27"><name pos:start="49:5" pos:end="49:19"><name pos:start="49:5" pos:end="49:6">ep</name><operator pos:start="49:7" pos:end="49:8">-&gt;</operator><name pos:start="49:9" pos:end="49:14">packey</name><index pos:start="49:15" pos:end="49:19">[<expr pos:start="49:16" pos:end="49:18"><name pos:start="49:16" pos:end="49:18">dir</name></expr>]</index></name><operator pos:start="49:20" pos:end="49:20">.</operator><name pos:start="49:21" pos:end="49:22">ep</name> <operator pos:start="49:24" pos:end="49:24">=</operator> <name pos:start="49:26" pos:end="49:27">ep</name></expr>;</expr_stmt>

    <expr_stmt pos:start="51:5" pos:end="51:30"><expr pos:start="51:5" pos:end="51:29"><name pos:start="51:5" pos:end="51:19"><name pos:start="51:5" pos:end="51:6">ep</name><operator pos:start="51:7" pos:end="51:8">-&gt;</operator><name pos:start="51:9" pos:end="51:14">packey</name><index pos:start="51:15" pos:end="51:19">[<expr pos:start="51:16" pos:end="51:18"><name pos:start="51:16" pos:end="51:18">dir</name></expr>]</index></name><operator pos:start="51:20" pos:end="51:20">.</operator><name pos:start="51:21" pos:end="51:23">dir</name> <operator pos:start="51:25" pos:end="51:25">=</operator> <name pos:start="51:27" pos:end="51:29">dir</name></expr>;</expr_stmt>



    <expr_stmt pos:start="55:5" pos:end="55:63"><expr pos:start="55:5" pos:end="55:62"><name pos:start="55:5" pos:end="55:7">dev</name> <operator pos:start="55:9" pos:end="55:9">=</operator> <call pos:start="55:11" pos:end="55:62"><name pos:start="55:11" pos:end="55:25">usb_find_device</name><argument_list pos:start="55:26" pos:end="55:62">(<argument pos:start="55:27" pos:end="55:34"><expr pos:start="55:27" pos:end="55:34"><operator pos:start="55:27" pos:end="55:27">&amp;</operator><name pos:start="55:28" pos:end="55:34"><name pos:start="55:28" pos:end="55:28">s</name><operator pos:start="55:29" pos:end="55:30">-&gt;</operator><name pos:start="55:31" pos:end="55:34">port</name></name></expr></argument>, <argument pos:start="55:37" pos:end="55:61"><expr pos:start="55:37" pos:end="55:61"><name pos:start="55:37" pos:end="55:51"><name pos:start="55:37" pos:end="55:38">ep</name><operator pos:start="55:39" pos:end="55:40">-&gt;</operator><name pos:start="55:41" pos:end="55:46">packey</name><index pos:start="55:47" pos:end="55:51">[<expr pos:start="55:48" pos:end="55:50"><name pos:start="55:48" pos:end="55:50">dir</name></expr>]</index></name><operator pos:start="55:52" pos:end="55:52">.</operator><name pos:start="55:53" pos:end="55:61"><name pos:start="55:53" pos:end="55:53">p</name><operator pos:start="55:54" pos:end="55:54">.</operator><name pos:start="55:55" pos:end="55:61">devaddr</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="57:5" pos:end="57:53"><expr pos:start="57:5" pos:end="57:52"><name pos:start="57:5" pos:end="57:7">ret</name> <operator pos:start="57:9" pos:end="57:9">=</operator> <call pos:start="57:11" pos:end="57:52"><name pos:start="57:11" pos:end="57:27">usb_handle_packet</name><argument_list pos:start="57:28" pos:end="57:52">(<argument pos:start="57:29" pos:end="57:31"><expr pos:start="57:29" pos:end="57:31"><name pos:start="57:29" pos:end="57:31">dev</name></expr></argument>, <argument pos:start="57:34" pos:end="57:51"><expr pos:start="57:34" pos:end="57:51"><operator pos:start="57:34" pos:end="57:34">&amp;</operator><name pos:start="57:35" pos:end="57:49"><name pos:start="57:35" pos:end="57:36">ep</name><operator pos:start="57:37" pos:end="57:38">-&gt;</operator><name pos:start="57:39" pos:end="57:44">packey</name><index pos:start="57:45" pos:end="57:49">[<expr pos:start="57:46" pos:end="57:48"><name pos:start="57:46" pos:end="57:48">dir</name></expr>]</index></name><operator pos:start="57:50" pos:end="57:50">.</operator><name pos:start="57:51" pos:end="57:51">p</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <if_stmt pos:start="61:5" pos:end="67:5"><if pos:start="61:5" pos:end="67:5">if <condition pos:start="61:8" pos:end="61:29">(<expr pos:start="61:9" pos:end="61:28"><name pos:start="61:9" pos:end="61:11">ret</name> <operator pos:start="61:13" pos:end="61:14">==</operator> <name pos:start="61:16" pos:end="61:28">USB_RET_ASYNC</name></expr>)</condition> <block pos:start="61:31" pos:end="67:5">{<block_content pos:start="63:9" pos:end="65:15">

        <expr_stmt pos:start="63:9" pos:end="63:30"><expr pos:start="63:9" pos:end="63:29"><name pos:start="63:9" pos:end="63:23"><name pos:start="63:9" pos:end="63:10">ep</name><operator pos:start="63:11" pos:end="63:12">-&gt;</operator><name pos:start="63:13" pos:end="63:18">status</name><index pos:start="63:19" pos:end="63:23">[<expr pos:start="63:20" pos:end="63:22"><name pos:start="63:20" pos:end="63:22">dir</name></expr>]</index></name> <operator pos:start="63:25" pos:end="63:25">=</operator> <name pos:start="63:27" pos:end="63:29">len</name></expr>;</expr_stmt>

        <return pos:start="65:9" pos:end="65:15">return;</return>

    </block_content>}</block></if></if_stmt>



    <expr_stmt pos:start="71:5" pos:end="71:26"><expr pos:start="71:5" pos:end="71:25"><name pos:start="71:5" pos:end="71:19"><name pos:start="71:5" pos:end="71:6">ep</name><operator pos:start="71:7" pos:end="71:8">-&gt;</operator><name pos:start="71:9" pos:end="71:14">status</name><index pos:start="71:15" pos:end="71:19">[<expr pos:start="71:16" pos:end="71:18"><name pos:start="71:16" pos:end="71:18">dir</name></expr>]</index></name> <operator pos:start="71:21" pos:end="71:21">=</operator> <name pos:start="71:23" pos:end="71:25">ret</name></expr>;</expr_stmt>

    <expr_stmt pos:start="73:5" pos:end="73:51"><expr pos:start="73:5" pos:end="73:50"><call pos:start="73:5" pos:end="73:50"><name pos:start="73:5" pos:end="73:20">musb_schedule_cb</name><argument_list pos:start="73:21" pos:end="73:50">(<argument pos:start="73:22" pos:end="73:29"><expr pos:start="73:22" pos:end="73:29"><operator pos:start="73:22" pos:end="73:22">&amp;</operator><name pos:start="73:23" pos:end="73:29"><name pos:start="73:23" pos:end="73:23">s</name><operator pos:start="73:24" pos:end="73:25">-&gt;</operator><name pos:start="73:26" pos:end="73:29">port</name></name></expr></argument>, <argument pos:start="73:32" pos:end="73:49"><expr pos:start="73:32" pos:end="73:49"><operator pos:start="73:32" pos:end="73:32">&amp;</operator><name pos:start="73:33" pos:end="73:47"><name pos:start="73:33" pos:end="73:34">ep</name><operator pos:start="73:35" pos:end="73:36">-&gt;</operator><name pos:start="73:37" pos:end="73:42">packey</name><index pos:start="73:43" pos:end="73:47">[<expr pos:start="73:44" pos:end="73:46"><name pos:start="73:44" pos:end="73:46">dir</name></expr>]</index></name><operator pos:start="73:48" pos:end="73:48">.</operator><name pos:start="73:49" pos:end="73:49">p</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

</block_content>}</block></function>
</unit>
