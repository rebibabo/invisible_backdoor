<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/1/27288.c" pos:tabs="8"><function pos:start="1:1" pos:end="77:1"><type pos:start="1:1" pos:end="1:14"><name pos:start="1:1" pos:end="1:12">VirtIODevice</name> <modifier pos:start="1:14" pos:end="1:14">*</modifier></type><name pos:start="1:15" pos:end="1:30">virtio_scsi_init</name><parameter_list pos:start="1:31" pos:end="1:75">(<parameter pos:start="1:32" pos:end="1:47"><decl pos:start="1:32" pos:end="1:47"><type pos:start="1:32" pos:end="1:47"><name pos:start="1:32" pos:end="1:42">DeviceState</name> <modifier pos:start="1:44" pos:end="1:44">*</modifier></type><name pos:start="1:45" pos:end="1:47">dev</name></decl></parameter>, <parameter pos:start="1:50" pos:end="1:74"><decl pos:start="1:50" pos:end="1:74"><type pos:start="1:50" pos:end="1:74"><name pos:start="1:50" pos:end="1:63">VirtIOSCSIConf</name> <modifier pos:start="1:65" pos:end="1:65">*</modifier></type><name pos:start="1:66" pos:end="1:74">proxyconf</name></decl></parameter>)</parameter_list>

<block pos:start="3:1" pos:end="77:1">{<block_content pos:start="5:5" pos:end="75:20">

    <decl_stmt pos:start="5:5" pos:end="5:18"><decl pos:start="5:5" pos:end="5:17"><type pos:start="5:5" pos:end="5:16"><name pos:start="5:5" pos:end="5:14">VirtIOSCSI</name> <modifier pos:start="5:16" pos:end="5:16">*</modifier></type><name pos:start="5:17" pos:end="5:17">s</name></decl>;</decl_stmt>

    <decl_stmt pos:start="7:5" pos:end="7:30"><decl pos:start="7:5" pos:end="7:29"><type pos:start="7:5" pos:end="7:14"><specifier pos:start="7:5" pos:end="7:10">static</specifier> <name pos:start="7:12" pos:end="7:14">int</name></type> <name pos:start="7:16" pos:end="7:29">virtio_scsi_id</name></decl>;</decl_stmt>

    <decl_stmt pos:start="9:5" pos:end="9:14"><decl pos:start="9:5" pos:end="9:13"><type pos:start="9:5" pos:end="9:10"><name pos:start="9:5" pos:end="9:10">size_t</name></type> <name pos:start="9:12" pos:end="9:13">sz</name></decl>;</decl_stmt>

    <decl_stmt pos:start="11:5" pos:end="11:10"><decl pos:start="11:5" pos:end="11:9"><type pos:start="11:5" pos:end="11:7"><name pos:start="11:5" pos:end="11:7">int</name></type> <name pos:start="11:9" pos:end="11:9">i</name></decl>;</decl_stmt>



    <expr_stmt pos:start="15:5" pos:end="15:74"><expr pos:start="15:5" pos:end="15:73"><name pos:start="15:5" pos:end="15:6">sz</name> <operator pos:start="15:8" pos:end="15:8">=</operator> <sizeof pos:start="15:10" pos:end="15:27">sizeof<argument_list pos:start="15:16" pos:end="15:27">(<argument pos:start="15:17" pos:end="15:26"><expr pos:start="15:17" pos:end="15:26"><name pos:start="15:17" pos:end="15:26">VirtIOSCSI</name></expr></argument>)</argument_list></sizeof> <operator pos:start="15:29" pos:end="15:29">+</operator> <name pos:start="15:31" pos:end="15:51"><name pos:start="15:31" pos:end="15:39">proxyconf</name><operator pos:start="15:40" pos:end="15:41">-&gt;</operator><name pos:start="15:42" pos:end="15:51">num_queues</name></name> <operator pos:start="15:53" pos:end="15:53">*</operator> <sizeof pos:start="15:55" pos:end="15:73">sizeof<argument_list pos:start="15:61" pos:end="15:73">(<argument pos:start="15:62" pos:end="15:72"><expr pos:start="15:62" pos:end="15:72"><name pos:start="15:62" pos:end="15:70">VirtQueue</name> <operator pos:start="15:72" pos:end="15:72">*</operator></expr></argument>)</argument_list></sizeof></expr>;</expr_stmt>

    <expr_stmt pos:start="17:5" pos:end="19:71"><expr pos:start="17:5" pos:end="19:70"><name pos:start="17:5" pos:end="17:5">s</name> <operator pos:start="17:7" pos:end="17:7">=</operator> <operator pos:start="17:9" pos:end="17:9">(</operator><name pos:start="17:10" pos:end="17:19">VirtIOSCSI</name> <operator pos:start="17:21" pos:end="17:21">*</operator><operator pos:start="17:22" pos:end="17:22">)</operator><call pos:start="17:23" pos:end="19:70"><name pos:start="17:23" pos:end="17:40">virtio_common_init</name><argument_list pos:start="17:41" pos:end="19:70">(<argument pos:start="17:42" pos:end="17:54"><expr pos:start="17:42" pos:end="17:54"><literal type="string" pos:start="17:42" pos:end="17:54">"virtio-scsi"</literal></expr></argument>, <argument pos:start="17:57" pos:end="17:70"><expr pos:start="17:57" pos:end="17:70"><name pos:start="17:57" pos:end="17:70">VIRTIO_ID_SCSI</name></expr></argument>,

                                         <argument pos:start="19:42" pos:end="19:65"><expr pos:start="19:42" pos:end="19:65"><sizeof pos:start="19:42" pos:end="19:65">sizeof<argument_list pos:start="19:48" pos:end="19:65">(<argument pos:start="19:49" pos:end="19:64"><expr pos:start="19:49" pos:end="19:64"><name pos:start="19:49" pos:end="19:64">VirtIOSCSIConfig</name></expr></argument>)</argument_list></sizeof></expr></argument>, <argument pos:start="19:68" pos:end="19:69"><expr pos:start="19:68" pos:end="19:69"><name pos:start="19:68" pos:end="19:69">sz</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <expr_stmt pos:start="23:5" pos:end="23:18"><expr pos:start="23:5" pos:end="23:17"><name pos:start="23:5" pos:end="23:11"><name pos:start="23:5" pos:end="23:5">s</name><operator pos:start="23:6" pos:end="23:7">-&gt;</operator><name pos:start="23:8" pos:end="23:11">qdev</name></name> <operator pos:start="23:13" pos:end="23:13">=</operator> <name pos:start="23:15" pos:end="23:17">dev</name></expr>;</expr_stmt>

    <expr_stmt pos:start="25:5" pos:end="25:24"><expr pos:start="25:5" pos:end="25:23"><name pos:start="25:5" pos:end="25:11"><name pos:start="25:5" pos:end="25:5">s</name><operator pos:start="25:6" pos:end="25:7">-&gt;</operator><name pos:start="25:8" pos:end="25:11">conf</name></name> <operator pos:start="25:13" pos:end="25:13">=</operator> <name pos:start="25:15" pos:end="25:23">proxyconf</name></expr>;</expr_stmt>



    <comment type="block" pos:start="29:5" pos:end="29:44">/* TODO set up vdev function pointers */</comment>

    <expr_stmt pos:start="31:5" pos:end="31:48"><expr pos:start="31:5" pos:end="31:47"><name pos:start="31:5" pos:end="31:22"><name pos:start="31:5" pos:end="31:5">s</name><operator pos:start="31:6" pos:end="31:7">-&gt;</operator><name pos:start="31:8" pos:end="31:11">vdev</name><operator pos:start="31:12" pos:end="31:12">.</operator><name pos:start="31:13" pos:end="31:22">get_config</name></name> <operator pos:start="31:24" pos:end="31:24">=</operator> <name pos:start="31:26" pos:end="31:47">virtio_scsi_get_config</name></expr>;</expr_stmt>

    <expr_stmt pos:start="33:5" pos:end="33:48"><expr pos:start="33:5" pos:end="33:47"><name pos:start="33:5" pos:end="33:22"><name pos:start="33:5" pos:end="33:5">s</name><operator pos:start="33:6" pos:end="33:7">-&gt;</operator><name pos:start="33:8" pos:end="33:11">vdev</name><operator pos:start="33:12" pos:end="33:12">.</operator><name pos:start="33:13" pos:end="33:22">set_config</name></name> <operator pos:start="33:24" pos:end="33:24">=</operator> <name pos:start="33:26" pos:end="33:47">virtio_scsi_set_config</name></expr>;</expr_stmt>

    <expr_stmt pos:start="35:5" pos:end="35:52"><expr pos:start="35:5" pos:end="35:51"><name pos:start="35:5" pos:end="35:24"><name pos:start="35:5" pos:end="35:5">s</name><operator pos:start="35:6" pos:end="35:7">-&gt;</operator><name pos:start="35:8" pos:end="35:11">vdev</name><operator pos:start="35:12" pos:end="35:12">.</operator><name pos:start="35:13" pos:end="35:24">get_features</name></name> <operator pos:start="35:26" pos:end="35:26">=</operator> <name pos:start="35:28" pos:end="35:51">virtio_scsi_get_features</name></expr>;</expr_stmt>

    <expr_stmt pos:start="37:5" pos:end="37:38"><expr pos:start="37:5" pos:end="37:37"><name pos:start="37:5" pos:end="37:17"><name pos:start="37:5" pos:end="37:5">s</name><operator pos:start="37:6" pos:end="37:7">-&gt;</operator><name pos:start="37:8" pos:end="37:11">vdev</name><operator pos:start="37:12" pos:end="37:12">.</operator><name pos:start="37:13" pos:end="37:17">reset</name></name> <operator pos:start="37:19" pos:end="37:19">=</operator> <name pos:start="37:21" pos:end="37:37">virtio_scsi_reset</name></expr>;</expr_stmt>



    <expr_stmt pos:start="41:5" pos:end="43:60"><expr pos:start="41:5" pos:end="43:59"><name pos:start="41:5" pos:end="41:14"><name pos:start="41:5" pos:end="41:5">s</name><operator pos:start="41:6" pos:end="41:7">-&gt;</operator><name pos:start="41:8" pos:end="41:14">ctrl_vq</name></name> <operator pos:start="41:16" pos:end="41:16">=</operator> <call pos:start="41:18" pos:end="43:59"><name pos:start="41:18" pos:end="41:33">virtio_add_queue</name><argument_list pos:start="41:34" pos:end="43:59">(<argument pos:start="41:35" pos:end="41:42"><expr pos:start="41:35" pos:end="41:42"><operator pos:start="41:35" pos:end="41:35">&amp;</operator><name pos:start="41:36" pos:end="41:42"><name pos:start="41:36" pos:end="41:36">s</name><operator pos:start="41:37" pos:end="41:38">-&gt;</operator><name pos:start="41:39" pos:end="41:42">vdev</name></name></expr></argument>, <argument pos:start="41:45" pos:end="41:63"><expr pos:start="41:45" pos:end="41:63"><name pos:start="41:45" pos:end="41:63">VIRTIO_SCSI_VQ_SIZE</name></expr></argument>,

                                   <argument pos:start="43:36" pos:end="43:58"><expr pos:start="43:36" pos:end="43:58"><name pos:start="43:36" pos:end="43:58">virtio_scsi_handle_ctrl</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="45:5" pos:end="47:41"><expr pos:start="45:5" pos:end="47:40"><name pos:start="45:5" pos:end="45:15"><name pos:start="45:5" pos:end="45:5">s</name><operator pos:start="45:6" pos:end="45:7">-&gt;</operator><name pos:start="45:8" pos:end="45:15">event_vq</name></name> <operator pos:start="45:17" pos:end="45:17">=</operator> <call pos:start="45:19" pos:end="47:40"><name pos:start="45:19" pos:end="45:34">virtio_add_queue</name><argument_list pos:start="45:35" pos:end="47:40">(<argument pos:start="45:36" pos:end="45:43"><expr pos:start="45:36" pos:end="45:43"><operator pos:start="45:36" pos:end="45:36">&amp;</operator><name pos:start="45:37" pos:end="45:43"><name pos:start="45:37" pos:end="45:37">s</name><operator pos:start="45:38" pos:end="45:39">-&gt;</operator><name pos:start="45:40" pos:end="45:43">vdev</name></name></expr></argument>, <argument pos:start="45:46" pos:end="45:64"><expr pos:start="45:46" pos:end="45:64"><name pos:start="45:46" pos:end="45:64">VIRTIO_SCSI_VQ_SIZE</name></expr></argument>,

                                   <argument pos:start="47:36" pos:end="47:39"><expr pos:start="47:36" pos:end="47:39"><name pos:start="47:36" pos:end="47:39">NULL</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <for pos:start="49:5" pos:end="55:5">for <control pos:start="49:9" pos:end="49:45">(<init pos:start="49:10" pos:end="49:15"><expr pos:start="49:10" pos:end="49:14"><name pos:start="49:10" pos:end="49:10">i</name> <operator pos:start="49:12" pos:end="49:12">=</operator> <literal type="number" pos:start="49:14" pos:end="49:14">0</literal></expr>;</init> <condition pos:start="49:17" pos:end="49:40"><expr pos:start="49:17" pos:end="49:39"><name pos:start="49:17" pos:end="49:17">i</name> <operator pos:start="49:19" pos:end="49:19">&lt;</operator> <name pos:start="49:21" pos:end="49:39"><name pos:start="49:21" pos:end="49:21">s</name><operator pos:start="49:22" pos:end="49:23">-&gt;</operator><name pos:start="49:24" pos:end="49:27">conf</name><operator pos:start="49:28" pos:end="49:29">-&gt;</operator><name pos:start="49:30" pos:end="49:39">num_queues</name></name></expr>;</condition> <incr pos:start="49:42" pos:end="49:44"><expr pos:start="49:42" pos:end="49:44"><name pos:start="49:42" pos:end="49:42">i</name><operator pos:start="49:43" pos:end="49:44">++</operator></expr></incr>)</control> <block pos:start="49:47" pos:end="55:5">{<block_content pos:start="51:9" pos:end="53:65">

        <expr_stmt pos:start="51:9" pos:end="53:65"><expr pos:start="51:9" pos:end="53:64"><name pos:start="51:9" pos:end="51:21"><name pos:start="51:9" pos:end="51:9">s</name><operator pos:start="51:10" pos:end="51:11">-&gt;</operator><name pos:start="51:12" pos:end="51:18">cmd_vqs</name><index pos:start="51:19" pos:end="51:21">[<expr pos:start="51:20" pos:end="51:20"><name pos:start="51:20" pos:end="51:20">i</name></expr>]</index></name> <operator pos:start="51:23" pos:end="51:23">=</operator> <call pos:start="51:25" pos:end="53:64"><name pos:start="51:25" pos:end="51:40">virtio_add_queue</name><argument_list pos:start="51:41" pos:end="53:64">(<argument pos:start="51:42" pos:end="51:49"><expr pos:start="51:42" pos:end="51:49"><operator pos:start="51:42" pos:end="51:42">&amp;</operator><name pos:start="51:43" pos:end="51:49"><name pos:start="51:43" pos:end="51:43">s</name><operator pos:start="51:44" pos:end="51:45">-&gt;</operator><name pos:start="51:46" pos:end="51:49">vdev</name></name></expr></argument>, <argument pos:start="51:52" pos:end="51:70"><expr pos:start="51:52" pos:end="51:70"><name pos:start="51:52" pos:end="51:70">VIRTIO_SCSI_VQ_SIZE</name></expr></argument>,

                                         <argument pos:start="53:42" pos:end="53:63"><expr pos:start="53:42" pos:end="53:63"><name pos:start="53:42" pos:end="53:63">virtio_scsi_handle_cmd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></for>



    <expr_stmt pos:start="59:5" pos:end="59:55"><expr pos:start="59:5" pos:end="59:54"><call pos:start="59:5" pos:end="59:54"><name pos:start="59:5" pos:end="59:16">scsi_bus_new</name><argument_list pos:start="59:17" pos:end="59:54">(<argument pos:start="59:18" pos:end="59:24"><expr pos:start="59:18" pos:end="59:24"><operator pos:start="59:18" pos:end="59:18">&amp;</operator><name pos:start="59:19" pos:end="59:24"><name pos:start="59:19" pos:end="59:19">s</name><operator pos:start="59:20" pos:end="59:21">-&gt;</operator><name pos:start="59:22" pos:end="59:24">bus</name></name></expr></argument>, <argument pos:start="59:27" pos:end="59:29"><expr pos:start="59:27" pos:end="59:29"><name pos:start="59:27" pos:end="59:29">dev</name></expr></argument>, <argument pos:start="59:32" pos:end="59:53"><expr pos:start="59:32" pos:end="59:53"><operator pos:start="59:32" pos:end="59:32">&amp;</operator><name pos:start="59:33" pos:end="59:53">virtio_scsi_scsi_info</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <if_stmt pos:start="61:5" pos:end="65:5"><if pos:start="61:5" pos:end="65:5">if <condition pos:start="61:8" pos:end="61:25">(<expr pos:start="61:9" pos:end="61:24"><operator pos:start="61:9" pos:end="61:9">!</operator><name pos:start="61:10" pos:end="61:24"><name pos:start="61:10" pos:end="61:12">dev</name><operator pos:start="61:13" pos:end="61:14">-&gt;</operator><name pos:start="61:15" pos:end="61:24">hotplugged</name></name></expr>)</condition> <block pos:start="61:27" pos:end="65:5">{<block_content pos:start="63:9" pos:end="63:48">

        <expr_stmt pos:start="63:9" pos:end="63:48"><expr pos:start="63:9" pos:end="63:47"><call pos:start="63:9" pos:end="63:47"><name pos:start="63:9" pos:end="63:38">scsi_bus_legacy_handle_cmdline</name><argument_list pos:start="63:39" pos:end="63:47">(<argument pos:start="63:40" pos:end="63:46"><expr pos:start="63:40" pos:end="63:46"><operator pos:start="63:40" pos:end="63:40">&amp;</operator><name pos:start="63:41" pos:end="63:46"><name pos:start="63:41" pos:end="63:41">s</name><operator pos:start="63:42" pos:end="63:43">-&gt;</operator><name pos:start="63:44" pos:end="63:46">bus</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if></if_stmt>



    <expr_stmt pos:start="69:5" pos:end="71:59"><expr pos:start="69:5" pos:end="71:58"><call pos:start="69:5" pos:end="71:58"><name pos:start="69:5" pos:end="69:19">register_savevm</name><argument_list pos:start="69:20" pos:end="71:58">(<argument pos:start="69:21" pos:end="69:23"><expr pos:start="69:21" pos:end="69:23"><name pos:start="69:21" pos:end="69:23">dev</name></expr></argument>, <argument pos:start="69:26" pos:end="69:38"><expr pos:start="69:26" pos:end="69:38"><literal type="string" pos:start="69:26" pos:end="69:38">"virtio-scsi"</literal></expr></argument>, <argument pos:start="69:41" pos:end="69:56"><expr pos:start="69:41" pos:end="69:56"><name pos:start="69:41" pos:end="69:54">virtio_scsi_id</name><operator pos:start="69:55" pos:end="69:56">++</operator></expr></argument>, <argument pos:start="69:59" pos:end="69:59"><expr pos:start="69:59" pos:end="69:59"><literal type="number" pos:start="69:59" pos:end="69:59">1</literal></expr></argument>,

                    <argument pos:start="71:21" pos:end="71:36"><expr pos:start="71:21" pos:end="71:36"><name pos:start="71:21" pos:end="71:36">virtio_scsi_save</name></expr></argument>, <argument pos:start="71:39" pos:end="71:54"><expr pos:start="71:39" pos:end="71:54"><name pos:start="71:39" pos:end="71:54">virtio_scsi_load</name></expr></argument>, <argument pos:start="71:57" pos:end="71:57"><expr pos:start="71:57" pos:end="71:57"><name pos:start="71:57" pos:end="71:57">s</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <return pos:start="75:5" pos:end="75:20">return <expr pos:start="75:12" pos:end="75:19"><operator pos:start="75:12" pos:end="75:12">&amp;</operator><name pos:start="75:13" pos:end="75:19"><name pos:start="75:13" pos:end="75:13">s</name><operator pos:start="75:14" pos:end="75:15">-&gt;</operator><name pos:start="75:16" pos:end="75:19">vdev</name></name></expr>;</return>

</block_content>}</block></function>
</unit>
