<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/1/20665.c" pos:tabs="8"><function pos:start="1:1" pos:end="91:1"><type pos:start="1:1" pos:end="1:4"><name pos:start="1:1" pos:end="1:4">void</name></type> <name pos:start="1:6" pos:end="1:30">qmp_block_set_io_throttle</name><parameter_list pos:start="1:31" pos:end="5:61">(<parameter pos:start="1:32" pos:end="1:49"><decl pos:start="1:32" pos:end="1:49"><type pos:start="1:32" pos:end="1:49"><specifier pos:start="1:32" pos:end="1:36">const</specifier> <name pos:start="1:38" pos:end="1:41">char</name> <modifier pos:start="1:43" pos:end="1:43">*</modifier></type><name pos:start="1:44" pos:end="1:49">device</name></decl></parameter>, <parameter pos:start="1:52" pos:end="1:62"><decl pos:start="1:52" pos:end="1:62"><type pos:start="1:52" pos:end="1:62"><name pos:start="1:52" pos:end="1:58">int64_t</name></type> <name pos:start="1:60" pos:end="1:62">bps</name></decl></parameter>, <parameter pos:start="1:65" pos:end="1:78"><decl pos:start="1:65" pos:end="1:78"><type pos:start="1:65" pos:end="1:78"><name pos:start="1:65" pos:end="1:71">int64_t</name></type> <name pos:start="1:73" pos:end="1:78">bps_rd</name></decl></parameter>,

                               <parameter pos:start="3:32" pos:end="3:45"><decl pos:start="3:32" pos:end="3:45"><type pos:start="3:32" pos:end="3:45"><name pos:start="3:32" pos:end="3:38">int64_t</name></type> <name pos:start="3:40" pos:end="3:45">bps_wr</name></decl></parameter>, <parameter pos:start="3:48" pos:end="3:59"><decl pos:start="3:48" pos:end="3:59"><type pos:start="3:48" pos:end="3:59"><name pos:start="3:48" pos:end="3:54">int64_t</name></type> <name pos:start="3:56" pos:end="3:59">iops</name></decl></parameter>, <parameter pos:start="3:62" pos:end="3:76"><decl pos:start="3:62" pos:end="3:76"><type pos:start="3:62" pos:end="3:76"><name pos:start="3:62" pos:end="3:68">int64_t</name></type> <name pos:start="3:70" pos:end="3:76">iops_rd</name></decl></parameter>,

                               <parameter pos:start="5:32" pos:end="5:46"><decl pos:start="5:32" pos:end="5:46"><type pos:start="5:32" pos:end="5:46"><name pos:start="5:32" pos:end="5:38">int64_t</name></type> <name pos:start="5:40" pos:end="5:46">iops_wr</name></decl></parameter>, <parameter pos:start="5:49" pos:end="5:60"><decl pos:start="5:49" pos:end="5:60"><type pos:start="5:49" pos:end="5:60"><name pos:start="5:49" pos:end="5:53">Error</name> <modifier pos:start="5:55" pos:end="5:55">*</modifier><modifier pos:start="5:56" pos:end="5:56">*</modifier></type><name pos:start="5:57" pos:end="5:60">errp</name></decl></parameter>)</parameter_list>

<block pos:start="7:1" pos:end="91:1">{<block_content pos:start="9:5" pos:end="89:5">

    <decl_stmt pos:start="9:5" pos:end="9:23"><decl pos:start="9:5" pos:end="9:22"><type pos:start="9:5" pos:end="9:18"><name pos:start="9:5" pos:end="9:18">ThrottleConfig</name></type> <name pos:start="9:20" pos:end="9:22">cfg</name></decl>;</decl_stmt>

    <decl_stmt pos:start="11:5" pos:end="11:25"><decl pos:start="11:5" pos:end="11:24"><type pos:start="11:5" pos:end="11:22"><name pos:start="11:5" pos:end="11:20">BlockDriverState</name> <modifier pos:start="11:22" pos:end="11:22">*</modifier></type><name pos:start="11:23" pos:end="11:24">bs</name></decl>;</decl_stmt>



    <expr_stmt pos:start="15:5" pos:end="15:27"><expr pos:start="15:5" pos:end="15:26"><name pos:start="15:5" pos:end="15:6">bs</name> <operator pos:start="15:8" pos:end="15:8">=</operator> <call pos:start="15:10" pos:end="15:26"><name pos:start="15:10" pos:end="15:18">bdrv_find</name><argument_list pos:start="15:19" pos:end="15:26">(<argument pos:start="15:20" pos:end="15:25"><expr pos:start="15:20" pos:end="15:25"><name pos:start="15:20" pos:end="15:25">device</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <if_stmt pos:start="17:5" pos:end="23:5"><if pos:start="17:5" pos:end="23:5">if <condition pos:start="17:8" pos:end="17:12">(<expr pos:start="17:9" pos:end="17:11"><operator pos:start="17:9" pos:end="17:9">!</operator><name pos:start="17:10" pos:end="17:11">bs</name></expr>)</condition> <block pos:start="17:14" pos:end="23:5">{<block_content pos:start="19:9" pos:end="21:15">

        <expr_stmt pos:start="19:9" pos:end="19:55"><expr pos:start="19:9" pos:end="19:54"><call pos:start="19:9" pos:end="19:54"><name pos:start="19:9" pos:end="19:17">error_set</name><argument_list pos:start="19:18" pos:end="19:54">(<argument pos:start="19:19" pos:end="19:22"><expr pos:start="19:19" pos:end="19:22"><name pos:start="19:19" pos:end="19:22">errp</name></expr></argument>, <argument pos:start="19:25" pos:end="19:45"><expr pos:start="19:25" pos:end="19:45"><name pos:start="19:25" pos:end="19:45">QERR_DEVICE_NOT_FOUND</name></expr></argument>, <argument pos:start="19:48" pos:end="19:53"><expr pos:start="19:48" pos:end="19:53"><name pos:start="19:48" pos:end="19:53">device</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <return pos:start="21:9" pos:end="21:15">return;</return>

    </block_content>}</block></if></if_stmt>



    <expr_stmt pos:start="27:5" pos:end="27:33"><expr pos:start="27:5" pos:end="27:32"><call pos:start="27:5" pos:end="27:32"><name pos:start="27:5" pos:end="27:10">memset</name><argument_list pos:start="27:11" pos:end="27:32">(<argument pos:start="27:12" pos:end="27:15"><expr pos:start="27:12" pos:end="27:15"><operator pos:start="27:12" pos:end="27:12">&amp;</operator><name pos:start="27:13" pos:end="27:15">cfg</name></expr></argument>, <argument pos:start="27:18" pos:end="27:18"><expr pos:start="27:18" pos:end="27:18"><literal type="number" pos:start="27:18" pos:end="27:18">0</literal></expr></argument>, <argument pos:start="27:21" pos:end="27:31"><expr pos:start="27:21" pos:end="27:31"><sizeof pos:start="27:21" pos:end="27:31">sizeof<argument_list pos:start="27:27" pos:end="27:31">(<argument pos:start="27:28" pos:end="27:30"><expr pos:start="27:28" pos:end="27:30"><name pos:start="27:28" pos:end="27:30">cfg</name></expr></argument>)</argument_list></sizeof></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="29:5" pos:end="29:46"><expr pos:start="29:5" pos:end="29:45"><name pos:start="29:5" pos:end="29:35"><name pos:start="29:5" pos:end="29:7">cfg</name><operator pos:start="29:8" pos:end="29:8">.</operator><name pos:start="29:9" pos:end="29:15">buckets</name><index pos:start="29:16" pos:end="29:35">[<expr pos:start="29:17" pos:end="29:34"><name pos:start="29:17" pos:end="29:34">THROTTLE_BPS_TOTAL</name></expr>]</index></name><operator pos:start="29:36" pos:end="29:36">.</operator><name pos:start="29:37" pos:end="29:39">avg</name> <operator pos:start="29:41" pos:end="29:41">=</operator> <name pos:start="29:43" pos:end="29:45">bps</name></expr>;</expr_stmt>

    <expr_stmt pos:start="31:5" pos:end="31:49"><expr pos:start="31:5" pos:end="31:48"><name pos:start="31:5" pos:end="31:34"><name pos:start="31:5" pos:end="31:7">cfg</name><operator pos:start="31:8" pos:end="31:8">.</operator><name pos:start="31:9" pos:end="31:15">buckets</name><index pos:start="31:16" pos:end="31:34">[<expr pos:start="31:17" pos:end="31:33"><name pos:start="31:17" pos:end="31:33">THROTTLE_BPS_READ</name></expr>]</index></name><operator pos:start="31:35" pos:end="31:35">.</operator><name pos:start="31:36" pos:end="31:38">avg</name>  <operator pos:start="31:41" pos:end="31:41">=</operator> <name pos:start="31:43" pos:end="31:48">bps_rd</name></expr>;</expr_stmt>

    <expr_stmt pos:start="33:5" pos:end="33:49"><expr pos:start="33:5" pos:end="33:48"><name pos:start="33:5" pos:end="33:35"><name pos:start="33:5" pos:end="33:7">cfg</name><operator pos:start="33:8" pos:end="33:8">.</operator><name pos:start="33:9" pos:end="33:15">buckets</name><index pos:start="33:16" pos:end="33:35">[<expr pos:start="33:17" pos:end="33:34"><name pos:start="33:17" pos:end="33:34">THROTTLE_BPS_WRITE</name></expr>]</index></name><operator pos:start="33:36" pos:end="33:36">.</operator><name pos:start="33:37" pos:end="33:39">avg</name> <operator pos:start="33:41" pos:end="33:41">=</operator> <name pos:start="33:43" pos:end="33:48">bps_wr</name></expr>;</expr_stmt>



    <expr_stmt pos:start="37:5" pos:end="37:47"><expr pos:start="37:5" pos:end="37:46"><name pos:start="37:5" pos:end="37:35"><name pos:start="37:5" pos:end="37:7">cfg</name><operator pos:start="37:8" pos:end="37:8">.</operator><name pos:start="37:9" pos:end="37:15">buckets</name><index pos:start="37:16" pos:end="37:35">[<expr pos:start="37:17" pos:end="37:34"><name pos:start="37:17" pos:end="37:34">THROTTLE_OPS_TOTAL</name></expr>]</index></name><operator pos:start="37:36" pos:end="37:36">.</operator><name pos:start="37:37" pos:end="37:39">avg</name> <operator pos:start="37:41" pos:end="37:41">=</operator> <name pos:start="37:43" pos:end="37:46">iops</name></expr>;</expr_stmt>

    <expr_stmt pos:start="39:5" pos:end="39:50"><expr pos:start="39:5" pos:end="39:49"><name pos:start="39:5" pos:end="39:34"><name pos:start="39:5" pos:end="39:7">cfg</name><operator pos:start="39:8" pos:end="39:8">.</operator><name pos:start="39:9" pos:end="39:15">buckets</name><index pos:start="39:16" pos:end="39:34">[<expr pos:start="39:17" pos:end="39:33"><name pos:start="39:17" pos:end="39:33">THROTTLE_OPS_READ</name></expr>]</index></name><operator pos:start="39:35" pos:end="39:35">.</operator><name pos:start="39:36" pos:end="39:38">avg</name>  <operator pos:start="39:41" pos:end="39:41">=</operator> <name pos:start="39:43" pos:end="39:49">iops_rd</name></expr>;</expr_stmt>

    <expr_stmt pos:start="41:5" pos:end="41:50"><expr pos:start="41:5" pos:end="41:49"><name pos:start="41:5" pos:end="41:35"><name pos:start="41:5" pos:end="41:7">cfg</name><operator pos:start="41:8" pos:end="41:8">.</operator><name pos:start="41:9" pos:end="41:15">buckets</name><index pos:start="41:16" pos:end="41:35">[<expr pos:start="41:17" pos:end="41:34"><name pos:start="41:17" pos:end="41:34">THROTTLE_OPS_WRITE</name></expr>]</index></name><operator pos:start="41:36" pos:end="41:36">.</operator><name pos:start="41:37" pos:end="41:39">avg</name> <operator pos:start="41:41" pos:end="41:41">=</operator> <name pos:start="41:43" pos:end="41:49">iops_wr</name></expr>;</expr_stmt>



    <expr_stmt pos:start="45:5" pos:end="45:44"><expr pos:start="45:5" pos:end="45:43"><name pos:start="45:5" pos:end="45:35"><name pos:start="45:5" pos:end="45:7">cfg</name><operator pos:start="45:8" pos:end="45:8">.</operator><name pos:start="45:9" pos:end="45:15">buckets</name><index pos:start="45:16" pos:end="45:35">[<expr pos:start="45:17" pos:end="45:34"><name pos:start="45:17" pos:end="45:34">THROTTLE_BPS_TOTAL</name></expr>]</index></name><operator pos:start="45:36" pos:end="45:36">.</operator><name pos:start="45:37" pos:end="45:39">max</name> <operator pos:start="45:41" pos:end="45:41">=</operator> <literal type="number" pos:start="45:43" pos:end="45:43">0</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="47:5" pos:end="47:44"><expr pos:start="47:5" pos:end="47:43"><name pos:start="47:5" pos:end="47:34"><name pos:start="47:5" pos:end="47:7">cfg</name><operator pos:start="47:8" pos:end="47:8">.</operator><name pos:start="47:9" pos:end="47:15">buckets</name><index pos:start="47:16" pos:end="47:34">[<expr pos:start="47:17" pos:end="47:33"><name pos:start="47:17" pos:end="47:33">THROTTLE_BPS_READ</name></expr>]</index></name><operator pos:start="47:35" pos:end="47:35">.</operator><name pos:start="47:36" pos:end="47:38">max</name>  <operator pos:start="47:41" pos:end="47:41">=</operator> <literal type="number" pos:start="47:43" pos:end="47:43">0</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="49:5" pos:end="49:44"><expr pos:start="49:5" pos:end="49:43"><name pos:start="49:5" pos:end="49:35"><name pos:start="49:5" pos:end="49:7">cfg</name><operator pos:start="49:8" pos:end="49:8">.</operator><name pos:start="49:9" pos:end="49:15">buckets</name><index pos:start="49:16" pos:end="49:35">[<expr pos:start="49:17" pos:end="49:34"><name pos:start="49:17" pos:end="49:34">THROTTLE_BPS_WRITE</name></expr>]</index></name><operator pos:start="49:36" pos:end="49:36">.</operator><name pos:start="49:37" pos:end="49:39">max</name> <operator pos:start="49:41" pos:end="49:41">=</operator> <literal type="number" pos:start="49:43" pos:end="49:43">0</literal></expr>;</expr_stmt>



    <expr_stmt pos:start="53:5" pos:end="53:44"><expr pos:start="53:5" pos:end="53:43"><name pos:start="53:5" pos:end="53:35"><name pos:start="53:5" pos:end="53:7">cfg</name><operator pos:start="53:8" pos:end="53:8">.</operator><name pos:start="53:9" pos:end="53:15">buckets</name><index pos:start="53:16" pos:end="53:35">[<expr pos:start="53:17" pos:end="53:34"><name pos:start="53:17" pos:end="53:34">THROTTLE_OPS_TOTAL</name></expr>]</index></name><operator pos:start="53:36" pos:end="53:36">.</operator><name pos:start="53:37" pos:end="53:39">max</name> <operator pos:start="53:41" pos:end="53:41">=</operator> <literal type="number" pos:start="53:43" pos:end="53:43">0</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="55:5" pos:end="55:44"><expr pos:start="55:5" pos:end="55:43"><name pos:start="55:5" pos:end="55:34"><name pos:start="55:5" pos:end="55:7">cfg</name><operator pos:start="55:8" pos:end="55:8">.</operator><name pos:start="55:9" pos:end="55:15">buckets</name><index pos:start="55:16" pos:end="55:34">[<expr pos:start="55:17" pos:end="55:33"><name pos:start="55:17" pos:end="55:33">THROTTLE_OPS_READ</name></expr>]</index></name><operator pos:start="55:35" pos:end="55:35">.</operator><name pos:start="55:36" pos:end="55:38">max</name>  <operator pos:start="55:41" pos:end="55:41">=</operator> <literal type="number" pos:start="55:43" pos:end="55:43">0</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="57:5" pos:end="57:44"><expr pos:start="57:5" pos:end="57:43"><name pos:start="57:5" pos:end="57:35"><name pos:start="57:5" pos:end="57:7">cfg</name><operator pos:start="57:8" pos:end="57:8">.</operator><name pos:start="57:9" pos:end="57:15">buckets</name><index pos:start="57:16" pos:end="57:35">[<expr pos:start="57:17" pos:end="57:34"><name pos:start="57:17" pos:end="57:34">THROTTLE_OPS_WRITE</name></expr>]</index></name><operator pos:start="57:36" pos:end="57:36">.</operator><name pos:start="57:37" pos:end="57:39">max</name> <operator pos:start="57:41" pos:end="57:41">=</operator> <literal type="number" pos:start="57:43" pos:end="57:43">0</literal></expr>;</expr_stmt>



    <expr_stmt pos:start="61:5" pos:end="61:20"><expr pos:start="61:5" pos:end="61:19"><name pos:start="61:5" pos:end="61:15"><name pos:start="61:5" pos:end="61:7">cfg</name><operator pos:start="61:8" pos:end="61:8">.</operator><name pos:start="61:9" pos:end="61:15">op_size</name></name> <operator pos:start="61:17" pos:end="61:17">=</operator> <literal type="number" pos:start="61:19" pos:end="61:19">0</literal></expr>;</expr_stmt>



    <if_stmt pos:start="65:5" pos:end="69:5"><if pos:start="65:5" pos:end="69:5">if <condition pos:start="65:8" pos:end="65:43">(<expr pos:start="65:9" pos:end="65:42"><operator pos:start="65:9" pos:end="65:9">!</operator><call pos:start="65:10" pos:end="65:42"><name pos:start="65:10" pos:end="65:30">check_throttle_config</name><argument_list pos:start="65:31" pos:end="65:42">(<argument pos:start="65:32" pos:end="65:35"><expr pos:start="65:32" pos:end="65:35"><operator pos:start="65:32" pos:end="65:32">&amp;</operator><name pos:start="65:33" pos:end="65:35">cfg</name></expr></argument>, <argument pos:start="65:38" pos:end="65:41"><expr pos:start="65:38" pos:end="65:41"><name pos:start="65:38" pos:end="65:41">errp</name></expr></argument>)</argument_list></call></expr>)</condition> <block pos:start="65:45" pos:end="69:5">{<block_content pos:start="67:9" pos:end="67:15">

        <return pos:start="67:9" pos:end="67:15">return;</return>

    </block_content>}</block></if></if_stmt>



    <if_stmt pos:start="73:5" pos:end="81:5"><if pos:start="73:5" pos:end="77:5">if <condition pos:start="73:8" pos:end="73:57">(<expr pos:start="73:9" pos:end="73:56"><operator pos:start="73:9" pos:end="73:9">!</operator><name pos:start="73:10" pos:end="73:30"><name pos:start="73:10" pos:end="73:11">bs</name><operator pos:start="73:12" pos:end="73:13">-&gt;</operator><name pos:start="73:14" pos:end="73:30">io_limits_enabled</name></name> <operator pos:start="73:32" pos:end="73:33">&amp;&amp;</operator> <call pos:start="73:35" pos:end="73:56"><name pos:start="73:35" pos:end="73:50">throttle_enabled</name><argument_list pos:start="73:51" pos:end="73:56">(<argument pos:start="73:52" pos:end="73:55"><expr pos:start="73:52" pos:end="73:55"><operator pos:start="73:52" pos:end="73:52">&amp;</operator><name pos:start="73:53" pos:end="73:55">cfg</name></expr></argument>)</argument_list></call></expr>)</condition> <block pos:start="73:59" pos:end="77:5">{<block_content pos:start="75:9" pos:end="75:34">

        <expr_stmt pos:start="75:9" pos:end="75:34"><expr pos:start="75:9" pos:end="75:33"><call pos:start="75:9" pos:end="75:33"><name pos:start="75:9" pos:end="75:29">bdrv_io_limits_enable</name><argument_list pos:start="75:30" pos:end="75:33">(<argument pos:start="75:31" pos:end="75:32"><expr pos:start="75:31" pos:end="75:32"><name pos:start="75:31" pos:end="75:32">bs</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if> <if type="elseif" pos:start="77:7" pos:end="81:5">else if <condition pos:start="77:15" pos:end="77:64">(<expr pos:start="77:16" pos:end="77:63"><name pos:start="77:16" pos:end="77:36"><name pos:start="77:16" pos:end="77:17">bs</name><operator pos:start="77:18" pos:end="77:19">-&gt;</operator><name pos:start="77:20" pos:end="77:36">io_limits_enabled</name></name> <operator pos:start="77:38" pos:end="77:39">&amp;&amp;</operator> <operator pos:start="77:41" pos:end="77:41">!</operator><call pos:start="77:42" pos:end="77:63"><name pos:start="77:42" pos:end="77:57">throttle_enabled</name><argument_list pos:start="77:58" pos:end="77:63">(<argument pos:start="77:59" pos:end="77:62"><expr pos:start="77:59" pos:end="77:62"><operator pos:start="77:59" pos:end="77:59">&amp;</operator><name pos:start="77:60" pos:end="77:62">cfg</name></expr></argument>)</argument_list></call></expr>)</condition> <block pos:start="77:66" pos:end="81:5">{<block_content pos:start="79:9" pos:end="79:35">

        <expr_stmt pos:start="79:9" pos:end="79:35"><expr pos:start="79:9" pos:end="79:34"><call pos:start="79:9" pos:end="79:34"><name pos:start="79:9" pos:end="79:30">bdrv_io_limits_disable</name><argument_list pos:start="79:31" pos:end="79:34">(<argument pos:start="79:32" pos:end="79:33"><expr pos:start="79:32" pos:end="79:33"><name pos:start="79:32" pos:end="79:33">bs</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if></if_stmt>



    <if_stmt pos:start="85:5" pos:end="89:5"><if pos:start="85:5" pos:end="89:5">if <condition pos:start="85:8" pos:end="85:30">(<expr pos:start="85:9" pos:end="85:29"><name pos:start="85:9" pos:end="85:29"><name pos:start="85:9" pos:end="85:10">bs</name><operator pos:start="85:11" pos:end="85:12">-&gt;</operator><name pos:start="85:13" pos:end="85:29">io_limits_enabled</name></name></expr>)</condition> <block pos:start="85:32" pos:end="89:5">{<block_content pos:start="87:9" pos:end="87:37">

        <expr_stmt pos:start="87:9" pos:end="87:37"><expr pos:start="87:9" pos:end="87:36"><call pos:start="87:9" pos:end="87:36"><name pos:start="87:9" pos:end="87:26">bdrv_set_io_limits</name><argument_list pos:start="87:27" pos:end="87:36">(<argument pos:start="87:28" pos:end="87:29"><expr pos:start="87:28" pos:end="87:29"><name pos:start="87:28" pos:end="87:29">bs</name></expr></argument>, <argument pos:start="87:32" pos:end="87:35"><expr pos:start="87:32" pos:end="87:35"><operator pos:start="87:32" pos:end="87:32">&amp;</operator><name pos:start="87:33" pos:end="87:35">cfg</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if></if_stmt>

</block_content>}</block></function>
</unit>
