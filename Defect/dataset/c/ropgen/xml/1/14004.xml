<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/1/14004.c" pos:tabs="8"><function pos:start="1:1" pos:end="27:67"><type pos:start="1:1" pos:end="1:10"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:10">int</name></type> <name pos:start="1:12" pos:end="1:30">calculate_refcounts</name><parameter_list pos:start="1:31" pos:end="3:75">(<parameter pos:start="1:32" pos:end="1:51"><decl pos:start="1:32" pos:end="1:51"><type pos:start="1:32" pos:end="1:51"><name pos:start="1:32" pos:end="1:47">BlockDriverState</name> <modifier pos:start="1:49" pos:end="1:49">*</modifier></type><name pos:start="1:50" pos:end="1:51">bs</name></decl></parameter>, <parameter pos:start="1:54" pos:end="1:73"><decl pos:start="1:54" pos:end="1:73"><type pos:start="1:54" pos:end="1:73"><name pos:start="1:54" pos:end="1:68">BdrvCheckResult</name> <modifier pos:start="1:70" pos:end="1:70">*</modifier></type><name pos:start="1:71" pos:end="1:73">res</name></decl></parameter>,
                               <parameter pos:start="2:32" pos:end="2:48"><decl pos:start="2:32" pos:end="2:48"><type pos:start="2:32" pos:end="2:48"><name pos:start="2:32" pos:end="2:44">BdrvCheckMode</name></type> <name pos:start="2:46" pos:end="2:48">fix</name></decl></parameter>, <parameter pos:start="2:51" pos:end="2:63"><decl pos:start="2:51" pos:end="2:63"><type pos:start="2:51" pos:end="2:63"><name pos:start="2:51" pos:end="2:54">bool</name> <modifier pos:start="2:56" pos:end="2:56">*</modifier></type><name pos:start="2:57" pos:end="2:63">rebuild</name></decl></parameter>,
                               <parameter pos:start="3:32" pos:end="3:52"><decl pos:start="3:32" pos:end="3:52"><type pos:start="3:32" pos:end="3:52"><name pos:start="3:32" pos:end="3:35">void</name> <modifier pos:start="3:37" pos:end="3:37">*</modifier><modifier pos:start="3:38" pos:end="3:38">*</modifier></type><name pos:start="3:39" pos:end="3:52">refcount_table</name></decl></parameter>, <parameter pos:start="3:55" pos:end="3:74"><decl pos:start="3:55" pos:end="3:74"><type pos:start="3:55" pos:end="3:74"><name pos:start="3:55" pos:end="3:61">int64_t</name> <modifier pos:start="3:63" pos:end="3:63">*</modifier></type><name pos:start="3:64" pos:end="3:74">nb_clusters</name></decl></parameter>)</parameter_list>
<block pos:start="4:1" pos:end="27:66">{<block_content pos:start="5:5" pos:end="27:66">
    <decl_stmt pos:start="5:5" pos:end="5:35"><decl pos:start="5:5" pos:end="5:34"><type pos:start="5:5" pos:end="5:20"><name pos:start="5:5" pos:end="5:18">BDRVQcow2State</name> <modifier pos:start="5:20" pos:end="5:20">*</modifier></type><name pos:start="5:21" pos:end="5:21">s</name> <init pos:start="5:23" pos:end="5:34">= <expr pos:start="5:25" pos:end="5:34"><name pos:start="5:25" pos:end="5:34"><name pos:start="5:25" pos:end="5:26">bs</name><operator pos:start="5:27" pos:end="5:28">-&gt;</operator><name pos:start="5:29" pos:end="5:34">opaque</name></name></expr></init></decl>;</decl_stmt>
    <decl_stmt pos:start="6:5" pos:end="6:14"><decl pos:start="6:5" pos:end="6:13"><type pos:start="6:5" pos:end="6:11"><name pos:start="6:5" pos:end="6:11">int64_t</name></type> <name pos:start="6:13" pos:end="6:13">i</name></decl>;</decl_stmt>
    <decl_stmt pos:start="7:5" pos:end="7:21"><decl pos:start="7:5" pos:end="7:20"><type pos:start="7:5" pos:end="7:18"><name pos:start="7:5" pos:end="7:16">QCowSnapshot</name> <modifier pos:start="7:18" pos:end="7:18">*</modifier></type><name pos:start="7:19" pos:end="7:20">sn</name></decl>;</decl_stmt>
    <decl_stmt pos:start="8:5" pos:end="8:12"><decl pos:start="8:5" pos:end="8:11"><type pos:start="8:5" pos:end="8:7"><name pos:start="8:5" pos:end="8:7">int</name></type> <name pos:start="8:9" pos:end="8:11">ret</name></decl>;</decl_stmt>
    <if_stmt pos:start="9:5" pos:end="15:44"><if pos:start="9:5" pos:end="15:44">if <condition pos:start="9:8" pos:end="9:25">(<expr pos:start="9:9" pos:end="9:24"><operator pos:start="9:9" pos:end="9:9">!</operator><operator pos:start="9:10" pos:end="9:10">*</operator><name pos:start="9:11" pos:end="9:24">refcount_table</name></expr>)</condition> <block pos:start="9:27" pos:end="15:43">{<block_content pos:start="10:9" pos:end="15:43">
        <decl_stmt pos:start="10:9" pos:end="10:29"><decl pos:start="10:9" pos:end="10:28"><type pos:start="10:9" pos:end="10:15"><name pos:start="10:9" pos:end="10:15">int64_t</name></type> <name pos:start="10:17" pos:end="10:24">old_size</name> <init pos:start="10:26" pos:end="10:28">= <expr pos:start="10:28" pos:end="10:28"><literal type="number" pos:start="10:28" pos:end="10:28">0</literal></expr></init></decl>;</decl_stmt>
        <expr_stmt pos:start="11:9" pos:end="12:62"><expr pos:start="11:9" pos:end="12:61"><name pos:start="11:9" pos:end="11:11">ret</name> <operator pos:start="11:13" pos:end="11:13">=</operator> <call pos:start="11:15" pos:end="12:61"><name pos:start="11:15" pos:end="11:36">realloc_refcount_array</name><argument_list pos:start="11:37" pos:end="12:61">(<argument pos:start="11:38" pos:end="11:38"><expr pos:start="11:38" pos:end="11:38"><name pos:start="11:38" pos:end="11:38">s</name></expr></argument>, <argument pos:start="11:41" pos:end="11:54"><expr pos:start="11:41" pos:end="11:54"><name pos:start="11:41" pos:end="11:54">refcount_table</name></expr></argument>,
                                     <argument pos:start="12:38" pos:end="12:46"><expr pos:start="12:38" pos:end="12:46"><operator pos:start="12:38" pos:end="12:38">&amp;</operator><name pos:start="12:39" pos:end="12:46">old_size</name></expr></argument>, <argument pos:start="12:49" pos:end="12:60"><expr pos:start="12:49" pos:end="12:60"><operator pos:start="12:49" pos:end="12:49">*</operator><name pos:start="12:50" pos:end="12:60">nb_clusters</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
            <expr_stmt pos:start="13:13" pos:end="13:32"><expr pos:start="13:13" pos:end="13:31"><name pos:start="13:13" pos:end="13:29"><name pos:start="13:13" pos:end="13:15">res</name><operator pos:start="13:16" pos:end="13:17">-&gt;</operator><name pos:start="13:18" pos:end="13:29">check_errors</name></name><operator pos:start="13:30" pos:end="13:31">++</operator></expr>;</expr_stmt>
    <comment type="block" pos:start="14:5" pos:end="14:16">/* header */</comment>
                        <expr_stmt pos:start="15:25" pos:end="15:42"><expr pos:start="15:25" pos:end="15:25"><literal type="number" pos:start="15:25" pos:end="15:25">0</literal></expr><operator pos:start="15:26" pos:end="15:26">,</operator> <expr pos:start="15:28" pos:end="15:42"><name pos:start="15:28" pos:end="15:42"><name pos:start="15:28" pos:end="15:28">s</name><operator pos:start="15:29" pos:end="15:30">-&gt;</operator><name pos:start="15:31" pos:end="15:42">cluster_size</name></name></expr></expr_stmt>)</block_content></block><empty_stmt pos:start="15:44" pos:end="15:44">;</empty_stmt></if></if_stmt>
    <comment type="block" pos:start="16:5" pos:end="16:26">/* current L1 table */</comment>
    <expr_stmt pos:start="17:5" pos:end="18:78"><expr pos:start="17:5" pos:end="18:77"><name pos:start="17:5" pos:end="17:7">ret</name> <operator pos:start="17:9" pos:end="17:9">=</operator> <call pos:start="17:11" pos:end="18:77"><name pos:start="17:11" pos:end="17:28">check_refcounts_l1</name><argument_list pos:start="17:29" pos:end="18:77">(<argument pos:start="17:30" pos:end="17:31"><expr pos:start="17:30" pos:end="17:31"><name pos:start="17:30" pos:end="17:31">bs</name></expr></argument>, <argument pos:start="17:34" pos:end="17:36"><expr pos:start="17:34" pos:end="17:36"><name pos:start="17:34" pos:end="17:36">res</name></expr></argument>, <argument pos:start="17:39" pos:end="17:52"><expr pos:start="17:39" pos:end="17:52"><name pos:start="17:39" pos:end="17:52">refcount_table</name></expr></argument>, <argument pos:start="17:55" pos:end="17:65"><expr pos:start="17:55" pos:end="17:65"><name pos:start="17:55" pos:end="17:65">nb_clusters</name></expr></argument>,
                             <argument pos:start="18:30" pos:end="18:47"><expr pos:start="18:30" pos:end="18:47"><name pos:start="18:30" pos:end="18:47"><name pos:start="18:30" pos:end="18:30">s</name><operator pos:start="18:31" pos:end="18:32">-&gt;</operator><name pos:start="18:33" pos:end="18:47">l1_table_offset</name></name></expr></argument>, <argument pos:start="18:50" pos:end="18:59"><expr pos:start="18:50" pos:end="18:59"><name pos:start="18:50" pos:end="18:59"><name pos:start="18:50" pos:end="18:50">s</name><operator pos:start="18:51" pos:end="18:52">-&gt;</operator><name pos:start="18:53" pos:end="18:59">l1_size</name></name></expr></argument>, <argument pos:start="18:62" pos:end="18:76"><expr pos:start="18:62" pos:end="18:76"><name pos:start="18:62" pos:end="18:76">CHECK_FRAG_INFO</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <comment type="block" pos:start="19:5" pos:end="19:19">/* snapshots */</comment>
    <for pos:start="20:5" pos:end="24:64">for <control pos:start="20:9" pos:end="20:41">(<init pos:start="20:10" pos:end="20:15"><expr pos:start="20:10" pos:end="20:14"><name pos:start="20:10" pos:end="20:10">i</name> <operator pos:start="20:12" pos:end="20:12">=</operator> <literal type="number" pos:start="20:14" pos:end="20:14">0</literal></expr>;</init> <condition pos:start="20:17" pos:end="20:36"><expr pos:start="20:17" pos:end="20:35"><name pos:start="20:17" pos:end="20:17">i</name> <operator pos:start="20:19" pos:end="20:19">&lt;</operator> <name pos:start="20:21" pos:end="20:35"><name pos:start="20:21" pos:end="20:21">s</name><operator pos:start="20:22" pos:end="20:23">-&gt;</operator><name pos:start="20:24" pos:end="20:35">nb_snapshots</name></name></expr>;</condition> <incr pos:start="20:38" pos:end="20:40"><expr pos:start="20:38" pos:end="20:40"><name pos:start="20:38" pos:end="20:38">i</name><operator pos:start="20:39" pos:end="20:40">++</operator></expr></incr>)</control> <block pos:start="20:43" pos:end="24:63">{<block_content pos:start="21:9" pos:end="24:63">
        <expr_stmt pos:start="21:9" pos:end="21:30"><expr pos:start="21:9" pos:end="21:29"><name pos:start="21:9" pos:end="21:10">sn</name> <operator pos:start="21:12" pos:end="21:12">=</operator> <name pos:start="21:14" pos:end="21:25"><name pos:start="21:14" pos:end="21:14">s</name><operator pos:start="21:15" pos:end="21:16">-&gt;</operator><name pos:start="21:17" pos:end="21:25">snapshots</name></name> <operator pos:start="21:27" pos:end="21:27">+</operator> <name pos:start="21:29" pos:end="21:29">i</name></expr>;</expr_stmt>
        <expr_stmt pos:start="22:9" pos:end="23:70"><expr pos:start="22:9" pos:end="23:69"><name pos:start="22:9" pos:end="22:11">ret</name> <operator pos:start="22:13" pos:end="22:13">=</operator> <call pos:start="22:15" pos:end="23:69"><name pos:start="22:15" pos:end="22:32">check_refcounts_l1</name><argument_list pos:start="22:33" pos:end="23:69">(<argument pos:start="22:34" pos:end="22:35"><expr pos:start="22:34" pos:end="22:35"><name pos:start="22:34" pos:end="22:35">bs</name></expr></argument>, <argument pos:start="22:38" pos:end="22:40"><expr pos:start="22:38" pos:end="22:40"><name pos:start="22:38" pos:end="22:40">res</name></expr></argument>, <argument pos:start="22:43" pos:end="22:56"><expr pos:start="22:43" pos:end="22:56"><name pos:start="22:43" pos:end="22:56">refcount_table</name></expr></argument>, <argument pos:start="22:59" pos:end="22:69"><expr pos:start="22:59" pos:end="22:69"><name pos:start="22:59" pos:end="22:69">nb_clusters</name></expr></argument>,
                                 <argument pos:start="23:34" pos:end="23:52"><expr pos:start="23:34" pos:end="23:52"><name pos:start="23:34" pos:end="23:52"><name pos:start="23:34" pos:end="23:35">sn</name><operator pos:start="23:36" pos:end="23:37">-&gt;</operator><name pos:start="23:38" pos:end="23:52">l1_table_offset</name></name></expr></argument>, <argument pos:start="23:55" pos:end="23:65"><expr pos:start="23:55" pos:end="23:65"><name pos:start="23:55" pos:end="23:65"><name pos:start="23:55" pos:end="23:56">sn</name><operator pos:start="23:57" pos:end="23:58">-&gt;</operator><name pos:start="23:59" pos:end="23:65">l1_size</name></name></expr></argument>, <argument pos:start="23:68" pos:end="23:68"><expr pos:start="23:68" pos:end="23:68"><literal type="number" pos:start="23:68" pos:end="23:68">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
                        <expr_stmt pos:start="24:25" pos:end="24:62"><expr pos:start="24:25" pos:end="24:43"><name pos:start="24:25" pos:end="24:43"><name pos:start="24:25" pos:end="24:25">s</name><operator pos:start="24:26" pos:end="24:27">-&gt;</operator><name pos:start="24:28" pos:end="24:43">snapshots_offset</name></name></expr><operator pos:start="24:44" pos:end="24:44">,</operator> <expr pos:start="24:46" pos:end="24:62"><name pos:start="24:46" pos:end="24:62"><name pos:start="24:46" pos:end="24:46">s</name><operator pos:start="24:47" pos:end="24:48">-&gt;</operator><name pos:start="24:49" pos:end="24:62">snapshots_size</name></name></expr></expr_stmt>)</block_content></block><empty_stmt pos:start="24:64" pos:end="24:64">;</empty_stmt></for>
    <comment type="block" pos:start="25:5" pos:end="25:23">/* refcount data */</comment>
                        <expr_stmt pos:start="26:25" pos:end="27:65"><expr pos:start="26:25" pos:end="26:48"><name pos:start="26:25" pos:end="26:48"><name pos:start="26:25" pos:end="26:25">s</name><operator pos:start="26:26" pos:end="26:27">-&gt;</operator><name pos:start="26:28" pos:end="26:48">refcount_table_offset</name></name></expr><operator pos:start="26:49" pos:end="26:49">,</operator>
                        <expr pos:start="27:25" pos:end="27:65"><name pos:start="27:25" pos:end="27:46"><name pos:start="27:25" pos:end="27:25">s</name><operator pos:start="27:26" pos:end="27:27">-&gt;</operator><name pos:start="27:28" pos:end="27:46">refcount_table_size</name></name> <operator pos:start="27:48" pos:end="27:48">*</operator> <sizeof pos:start="27:50" pos:end="27:65">sizeof<argument_list pos:start="27:56" pos:end="27:65">(<argument pos:start="27:57" pos:end="27:64"><expr pos:start="27:57" pos:end="27:64"><name pos:start="27:57" pos:end="27:64">uint64_t</name></expr></argument>)</argument_list></sizeof></expr></expr_stmt>)</block_content></block>;</function>
    <return pos:start="28:5" pos:end="28:79">return <expr pos:start="28:12" pos:end="28:78"><call pos:start="28:12" pos:end="28:78"><name pos:start="28:12" pos:end="28:26">check_refblocks</name><argument_list pos:start="28:27" pos:end="28:78">(<argument pos:start="28:28" pos:end="28:29"><expr pos:start="28:28" pos:end="28:29"><name pos:start="28:28" pos:end="28:29">bs</name></expr></argument>, <argument pos:start="28:32" pos:end="28:34"><expr pos:start="28:32" pos:end="28:34"><name pos:start="28:32" pos:end="28:34">res</name></expr></argument>, <argument pos:start="28:37" pos:end="28:39"><expr pos:start="28:37" pos:end="28:39"><name pos:start="28:37" pos:end="28:39">fix</name></expr></argument>, <argument pos:start="28:42" pos:end="28:48"><expr pos:start="28:42" pos:end="28:48"><name pos:start="28:42" pos:end="28:48">rebuild</name></expr></argument>, <argument pos:start="28:51" pos:end="28:64"><expr pos:start="28:51" pos:end="28:64"><name pos:start="28:51" pos:end="28:64">refcount_table</name></expr></argument>, <argument pos:start="28:67" pos:end="28:77"><expr pos:start="28:67" pos:end="28:77"><name pos:start="28:67" pos:end="28:77">nb_clusters</name></expr></argument>)</argument_list></call></expr>;</return></unit>
