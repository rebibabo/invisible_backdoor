<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/1/19975.c" pos:tabs="8"><function pos:start="1:1" pos:end="69:1"><type pos:start="1:1" pos:end="1:11"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:11">void</name></type> <name pos:start="1:13" pos:end="1:26">do_video_stats</name><parameter_list pos:start="1:27" pos:end="1:61">(<parameter pos:start="1:28" pos:end="1:44"><decl pos:start="1:28" pos:end="1:44"><type pos:start="1:28" pos:end="1:44"><name pos:start="1:28" pos:end="1:39">OutputStream</name> <modifier pos:start="1:41" pos:end="1:41">*</modifier></type><name pos:start="1:42" pos:end="1:44">ost</name></decl></parameter>, <parameter pos:start="1:47" pos:end="1:60"><decl pos:start="1:47" pos:end="1:60"><type pos:start="1:47" pos:end="1:60"><name pos:start="1:47" pos:end="1:49">int</name></type> <name pos:start="1:51" pos:end="1:60">frame_size</name></decl></parameter>)</parameter_list>

<block pos:start="3:1" pos:end="69:1">{<block_content pos:start="5:5" pos:end="67:5">

    <decl_stmt pos:start="5:5" pos:end="5:24"><decl pos:start="5:5" pos:end="5:23"><type pos:start="5:5" pos:end="5:20"><name pos:start="5:5" pos:end="5:18">AVCodecContext</name> <modifier pos:start="5:20" pos:end="5:20">*</modifier></type><name pos:start="5:21" pos:end="5:23">enc</name></decl>;</decl_stmt>

    <decl_stmt pos:start="7:5" pos:end="7:21"><decl pos:start="7:5" pos:end="7:20"><type pos:start="7:5" pos:end="7:7"><name pos:start="7:5" pos:end="7:7">int</name></type> <name pos:start="7:9" pos:end="7:20">frame_number</name></decl>;</decl_stmt>

    <decl_stmt pos:start="9:5" pos:end="9:37"><decl pos:start="9:5" pos:end="9:14"><type pos:start="9:5" pos:end="9:10"><name pos:start="9:5" pos:end="9:10">double</name></type> <name pos:start="9:12" pos:end="9:14">ti1</name></decl>, <decl pos:start="9:17" pos:end="9:23"><type ref="prev" pos:start="9:5" pos:end="9:10"/><name pos:start="9:17" pos:end="9:23">bitrate</name></decl>, <decl pos:start="9:26" pos:end="9:36"><type ref="prev" pos:start="9:5" pos:end="9:10"/><name pos:start="9:26" pos:end="9:36">avg_bitrate</name></decl>;</decl_stmt>



    <comment type="block" pos:start="13:5" pos:end="13:71">/* this is executed just the first time do_video_stats is called */</comment>

    <if_stmt pos:start="15:5" pos:end="27:5"><if pos:start="15:5" pos:end="27:5">if <condition pos:start="15:8" pos:end="15:21">(<expr pos:start="15:9" pos:end="15:20"><operator pos:start="15:9" pos:end="15:9">!</operator><name pos:start="15:10" pos:end="15:20">vstats_file</name></expr>)</condition> <block pos:start="15:23" pos:end="27:5">{<block_content pos:start="17:9" pos:end="25:9">

        <expr_stmt pos:start="17:9" pos:end="17:50"><expr pos:start="17:9" pos:end="17:49"><name pos:start="17:9" pos:end="17:19">vstats_file</name> <operator pos:start="17:21" pos:end="17:21">=</operator> <call pos:start="17:23" pos:end="17:49"><name pos:start="17:23" pos:end="17:27">fopen</name><argument_list pos:start="17:28" pos:end="17:49">(<argument pos:start="17:29" pos:end="17:43"><expr pos:start="17:29" pos:end="17:43"><name pos:start="17:29" pos:end="17:43">vstats_filename</name></expr></argument>, <argument pos:start="17:46" pos:end="17:48"><expr pos:start="17:46" pos:end="17:48"><literal type="string" pos:start="17:46" pos:end="17:48">"w"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="19:9" pos:end="25:9"><if pos:start="19:9" pos:end="25:9">if <condition pos:start="19:12" pos:end="19:25">(<expr pos:start="19:13" pos:end="19:24"><operator pos:start="19:13" pos:end="19:13">!</operator><name pos:start="19:14" pos:end="19:24">vstats_file</name></expr>)</condition> <block pos:start="19:27" pos:end="25:9">{<block_content pos:start="21:13" pos:end="23:20">

            <expr_stmt pos:start="21:13" pos:end="21:28"><expr pos:start="21:13" pos:end="21:27"><call pos:start="21:13" pos:end="21:27"><name pos:start="21:13" pos:end="21:18">perror</name><argument_list pos:start="21:19" pos:end="21:27">(<argument pos:start="21:20" pos:end="21:26"><expr pos:start="21:20" pos:end="21:26"><literal type="string" pos:start="21:20" pos:end="21:26">"fopen"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="23:13" pos:end="23:20"><expr pos:start="23:13" pos:end="23:19"><call pos:start="23:13" pos:end="23:19"><name pos:start="23:13" pos:end="23:16">exit</name><argument_list pos:start="23:17" pos:end="23:19">(<argument pos:start="23:18" pos:end="23:18"><expr pos:start="23:18" pos:end="23:18"><literal type="number" pos:start="23:18" pos:end="23:18">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></if></if_stmt>

    </block_content>}</block></if></if_stmt>



    <expr_stmt pos:start="31:5" pos:end="31:25"><expr pos:start="31:5" pos:end="31:24"><name pos:start="31:5" pos:end="31:7">enc</name> <operator pos:start="31:9" pos:end="31:9">=</operator> <name pos:start="31:11" pos:end="31:24"><name pos:start="31:11" pos:end="31:13">ost</name><operator pos:start="31:14" pos:end="31:15">-&gt;</operator><name pos:start="31:16" pos:end="31:17">st</name><operator pos:start="31:18" pos:end="31:19">-&gt;</operator><name pos:start="31:20" pos:end="31:24">codec</name></name></expr>;</expr_stmt>

    <if_stmt pos:start="33:5" pos:end="67:5"><if pos:start="33:5" pos:end="67:5">if <condition pos:start="33:8" pos:end="33:46">(<expr pos:start="33:9" pos:end="33:45"><name pos:start="33:9" pos:end="33:23"><name pos:start="33:9" pos:end="33:11">enc</name><operator pos:start="33:12" pos:end="33:13">-&gt;</operator><name pos:start="33:14" pos:end="33:23">codec_type</name></name> <operator pos:start="33:25" pos:end="33:26">==</operator> <name pos:start="33:28" pos:end="33:45">AVMEDIA_TYPE_VIDEO</name></expr>)</condition> <block pos:start="33:48" pos:end="67:5">{<block_content pos:start="35:9" pos:end="65:98">

        <expr_stmt pos:start="35:9" pos:end="35:41"><expr pos:start="35:9" pos:end="35:40"><name pos:start="35:9" pos:end="35:20">frame_number</name> <operator pos:start="35:22" pos:end="35:22">=</operator> <name pos:start="35:24" pos:end="35:40"><name pos:start="35:24" pos:end="35:26">ost</name><operator pos:start="35:27" pos:end="35:28">-&gt;</operator><name pos:start="35:29" pos:end="35:40">frame_number</name></name></expr>;</expr_stmt>

        <expr_stmt pos:start="37:9" pos:end="37:116"><expr pos:start="37:9" pos:end="37:115"><call pos:start="37:9" pos:end="37:115"><name pos:start="37:9" pos:end="37:15">fprintf</name><argument_list pos:start="37:16" pos:end="37:115">(<argument pos:start="37:17" pos:end="37:27"><expr pos:start="37:17" pos:end="37:27"><name pos:start="37:17" pos:end="37:27">vstats_file</name></expr></argument>, <argument pos:start="37:30" pos:end="37:51"><expr pos:start="37:30" pos:end="37:51"><literal type="string" pos:start="37:30" pos:end="37:51">"frame= %5d q= %2.1f "</literal></expr></argument>, <argument pos:start="37:54" pos:end="37:65"><expr pos:start="37:54" pos:end="37:65"><name pos:start="37:54" pos:end="37:65">frame_number</name></expr></argument>, <argument pos:start="37:68" pos:end="37:114"><expr pos:start="37:68" pos:end="37:114"><name pos:start="37:68" pos:end="37:92"><name pos:start="37:68" pos:end="37:70">enc</name><operator pos:start="37:71" pos:end="37:72">-&gt;</operator><name pos:start="37:73" pos:end="37:83">coded_frame</name><operator pos:start="37:84" pos:end="37:85">-&gt;</operator><name pos:start="37:86" pos:end="37:92">quality</name></name> <operator pos:start="37:94" pos:end="37:94">/</operator> <operator pos:start="37:96" pos:end="37:96">(</operator><name pos:start="37:97" pos:end="37:101">float</name><operator pos:start="37:102" pos:end="37:102">)</operator><name pos:start="37:103" pos:end="37:114">FF_QP2LAMBDA</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="39:9" pos:end="41:128"><if pos:start="39:9" pos:end="41:128">if <condition pos:start="39:12" pos:end="39:39">(<expr pos:start="39:13" pos:end="39:38"><name pos:start="39:13" pos:end="39:22"><name pos:start="39:13" pos:end="39:15">enc</name><operator pos:start="39:16" pos:end="39:17">-&gt;</operator><name pos:start="39:18" pos:end="39:22">flags</name></name><operator pos:start="39:23" pos:end="39:23">&amp;</operator><name pos:start="39:24" pos:end="39:38">CODEC_FLAG_PSNR</name></expr>)</condition><block type="pseudo" pos:start="41:13" pos:end="41:128"><block_content pos:start="41:13" pos:end="41:128">

            <expr_stmt pos:start="41:13" pos:end="41:128"><expr pos:start="41:13" pos:end="41:127"><call pos:start="41:13" pos:end="41:127"><name pos:start="41:13" pos:end="41:19">fprintf</name><argument_list pos:start="41:20" pos:end="41:127">(<argument pos:start="41:21" pos:end="41:31"><expr pos:start="41:21" pos:end="41:31"><name pos:start="41:21" pos:end="41:31">vstats_file</name></expr></argument>, <argument pos:start="41:34" pos:end="41:47"><expr pos:start="41:34" pos:end="41:47"><literal type="string" pos:start="41:34" pos:end="41:47">"PSNR= %6.2f "</literal></expr></argument>, <argument pos:start="41:50" pos:end="41:126"><expr pos:start="41:50" pos:end="41:126"><call pos:start="41:50" pos:end="41:126"><name pos:start="41:50" pos:end="41:53">psnr</name><argument_list pos:start="41:54" pos:end="41:126">(<argument pos:start="41:55" pos:end="41:125"><expr pos:start="41:55" pos:end="41:125"><name pos:start="41:55" pos:end="41:80"><name pos:start="41:55" pos:end="41:57">enc</name><operator pos:start="41:58" pos:end="41:59">-&gt;</operator><name pos:start="41:60" pos:end="41:70">coded_frame</name><operator pos:start="41:71" pos:end="41:72">-&gt;</operator><name pos:start="41:73" pos:end="41:77">error</name><index pos:start="41:78" pos:end="41:80">[<expr pos:start="41:79" pos:end="41:79"><literal type="number" pos:start="41:79" pos:end="41:79">0</literal></expr>]</index></name> <operator pos:start="41:82" pos:end="41:82">/</operator> <operator pos:start="41:84" pos:end="41:84">(</operator><name pos:start="41:85" pos:end="41:94"><name pos:start="41:85" pos:end="41:87">enc</name><operator pos:start="41:88" pos:end="41:89">-&gt;</operator><name pos:start="41:90" pos:end="41:94">width</name></name> <operator pos:start="41:96" pos:end="41:96">*</operator> <name pos:start="41:98" pos:end="41:108"><name pos:start="41:98" pos:end="41:100">enc</name><operator pos:start="41:101" pos:end="41:102">-&gt;</operator><name pos:start="41:103" pos:end="41:108">height</name></name> <operator pos:start="41:110" pos:end="41:110">*</operator> <literal type="number" pos:start="41:112" pos:end="41:116">255.0</literal> <operator pos:start="41:118" pos:end="41:118">*</operator> <literal type="number" pos:start="41:120" pos:end="41:124">255.0</literal><operator pos:start="41:125" pos:end="41:125">)</operator></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>



        <expr_stmt pos:start="45:9" pos:end="45:56"><expr pos:start="45:9" pos:end="45:55"><call pos:start="45:9" pos:end="45:55"><name pos:start="45:9" pos:end="45:15">fprintf</name><argument_list pos:start="45:16" pos:end="45:55">(<argument pos:start="45:17" pos:end="45:27"><expr pos:start="45:17" pos:end="45:27"><name pos:start="45:17" pos:end="45:27">vstats_file</name></expr></argument>,<argument pos:start="45:29" pos:end="45:42"><expr pos:start="45:29" pos:end="45:42"><literal type="string" pos:start="45:29" pos:end="45:42">"f_size= %6d "</literal></expr></argument>, <argument pos:start="45:45" pos:end="45:54"><expr pos:start="45:45" pos:end="45:54"><name pos:start="45:45" pos:end="45:54">frame_size</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <comment type="block" pos:start="47:9" pos:end="47:31">/* compute pts value */</comment>

        <expr_stmt pos:start="49:9" pos:end="49:54"><expr pos:start="49:9" pos:end="49:53"><name pos:start="49:9" pos:end="49:11">ti1</name> <operator pos:start="49:13" pos:end="49:13">=</operator> <name pos:start="49:15" pos:end="49:28"><name pos:start="49:15" pos:end="49:17">ost</name><operator pos:start="49:18" pos:end="49:19">-&gt;</operator><name pos:start="49:20" pos:end="49:28">sync_opts</name></name> <operator pos:start="49:30" pos:end="49:30">*</operator> <call pos:start="49:32" pos:end="49:53"><name pos:start="49:32" pos:end="49:37">av_q2d</name><argument_list pos:start="49:38" pos:end="49:53">(<argument pos:start="49:39" pos:end="49:52"><expr pos:start="49:39" pos:end="49:52"><name pos:start="49:39" pos:end="49:52"><name pos:start="49:39" pos:end="49:41">enc</name><operator pos:start="49:42" pos:end="49:43">-&gt;</operator><name pos:start="49:44" pos:end="49:52">time_base</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="51:9" pos:end="53:23"><if pos:start="51:9" pos:end="53:23">if <condition pos:start="51:12" pos:end="51:23">(<expr pos:start="51:13" pos:end="51:22"><name pos:start="51:13" pos:end="51:15">ti1</name> <operator pos:start="51:17" pos:end="51:17">&lt;</operator> <literal type="number" pos:start="51:19" pos:end="51:22">0.01</literal></expr>)</condition><block type="pseudo" pos:start="53:13" pos:end="53:23"><block_content pos:start="53:13" pos:end="53:23">

            <expr_stmt pos:start="53:13" pos:end="53:23"><expr pos:start="53:13" pos:end="53:22"><name pos:start="53:13" pos:end="53:15">ti1</name> <operator pos:start="53:17" pos:end="53:17">=</operator> <literal type="number" pos:start="53:19" pos:end="53:22">0.01</literal></expr>;</expr_stmt></block_content></block></if></if_stmt>



        <expr_stmt pos:start="57:9" pos:end="57:73"><expr pos:start="57:9" pos:end="57:72"><name pos:start="57:9" pos:end="57:15">bitrate</name>     <operator pos:start="57:21" pos:end="57:21">=</operator> <operator pos:start="57:23" pos:end="57:23">(</operator><name pos:start="57:24" pos:end="57:33">frame_size</name> <operator pos:start="57:35" pos:end="57:35">*</operator> <literal type="number" pos:start="57:37" pos:end="57:37">8</literal><operator pos:start="57:38" pos:end="57:38">)</operator> <operator pos:start="57:40" pos:end="57:40">/</operator> <call pos:start="57:42" pos:end="57:63"><name pos:start="57:42" pos:end="57:47">av_q2d</name><argument_list pos:start="57:48" pos:end="57:63">(<argument pos:start="57:49" pos:end="57:62"><expr pos:start="57:49" pos:end="57:62"><name pos:start="57:49" pos:end="57:62"><name pos:start="57:49" pos:end="57:51">enc</name><operator pos:start="57:52" pos:end="57:53">-&gt;</operator><name pos:start="57:54" pos:end="57:62">time_base</name></name></expr></argument>)</argument_list></call> <operator pos:start="57:65" pos:end="57:65">/</operator> <literal type="number" pos:start="57:67" pos:end="57:72">1000.0</literal></expr>;</expr_stmt>

        <expr_stmt pos:start="59:9" pos:end="59:62"><expr pos:start="59:9" pos:end="59:61"><name pos:start="59:9" pos:end="59:19">avg_bitrate</name> <operator pos:start="59:21" pos:end="59:21">=</operator> <operator pos:start="59:23" pos:end="59:23">(</operator><name pos:start="59:24" pos:end="59:29">double</name><operator pos:start="59:30" pos:end="59:30">)</operator><operator pos:start="59:31" pos:end="59:31">(</operator><name pos:start="59:32" pos:end="59:41">video_size</name> <operator pos:start="59:43" pos:end="59:43">*</operator> <literal type="number" pos:start="59:45" pos:end="59:45">8</literal><operator pos:start="59:46" pos:end="59:46">)</operator> <operator pos:start="59:48" pos:end="59:48">/</operator> <name pos:start="59:50" pos:end="59:52">ti1</name> <operator pos:start="59:54" pos:end="59:54">/</operator> <literal type="number" pos:start="59:56" pos:end="59:61">1000.0</literal></expr>;</expr_stmt>

        <expr_stmt pos:start="61:9" pos:end="63:69"><expr pos:start="61:9" pos:end="63:68"><call pos:start="61:9" pos:end="63:68"><name pos:start="61:9" pos:end="61:15">fprintf</name><argument_list pos:start="61:16" pos:end="63:68">(<argument pos:start="61:17" pos:end="61:27"><expr pos:start="61:17" pos:end="61:27"><name pos:start="61:17" pos:end="61:27">vstats_file</name></expr></argument>, <argument pos:start="61:30" pos:end="61:97"><expr pos:start="61:30" pos:end="61:97"><literal type="string" pos:start="61:30" pos:end="61:97">"s_size= %8.0fkB time= %0.3f br= %7.1fkbits/s avg_br= %7.1fkbits/s "</literal></expr></argument>,

               <argument pos:start="63:16" pos:end="63:40"><expr pos:start="63:16" pos:end="63:40"><operator pos:start="63:16" pos:end="63:16">(</operator><name pos:start="63:17" pos:end="63:22">double</name><operator pos:start="63:23" pos:end="63:23">)</operator><name pos:start="63:24" pos:end="63:33">video_size</name> <operator pos:start="63:35" pos:end="63:35">/</operator> <literal type="number" pos:start="63:37" pos:end="63:40">1024</literal></expr></argument>, <argument pos:start="63:43" pos:end="63:45"><expr pos:start="63:43" pos:end="63:45"><name pos:start="63:43" pos:end="63:45">ti1</name></expr></argument>, <argument pos:start="63:48" pos:end="63:54"><expr pos:start="63:48" pos:end="63:54"><name pos:start="63:48" pos:end="63:54">bitrate</name></expr></argument>, <argument pos:start="63:57" pos:end="63:67"><expr pos:start="63:57" pos:end="63:67"><name pos:start="63:57" pos:end="63:67">avg_bitrate</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="65:9" pos:end="65:98"><expr pos:start="65:9" pos:end="65:97"><call pos:start="65:9" pos:end="65:97"><name pos:start="65:9" pos:end="65:15">fprintf</name><argument_list pos:start="65:16" pos:end="65:97">(<argument pos:start="65:17" pos:end="65:27"><expr pos:start="65:17" pos:end="65:27"><name pos:start="65:17" pos:end="65:27">vstats_file</name></expr></argument>, <argument pos:start="65:30" pos:end="65:41"><expr pos:start="65:30" pos:end="65:41"><literal type="string" pos:start="65:30" pos:end="65:41">"type= %c\n"</literal></expr></argument>, <argument pos:start="65:44" pos:end="65:96"><expr pos:start="65:44" pos:end="65:96"><call pos:start="65:44" pos:end="65:96"><name pos:start="65:44" pos:end="65:67">av_get_picture_type_char</name><argument_list pos:start="65:68" pos:end="65:96">(<argument pos:start="65:69" pos:end="65:95"><expr pos:start="65:69" pos:end="65:95"><name pos:start="65:69" pos:end="65:95"><name pos:start="65:69" pos:end="65:71">enc</name><operator pos:start="65:72" pos:end="65:73">-&gt;</operator><name pos:start="65:74" pos:end="65:84">coded_frame</name><operator pos:start="65:85" pos:end="65:86">-&gt;</operator><name pos:start="65:87" pos:end="65:95">pict_type</name></name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if></if_stmt>

</block_content>}</block></function>
</unit>
