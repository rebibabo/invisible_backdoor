<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/1/15298.c" pos:tabs="8"><function pos:start="1:1" pos:end="337:1"><type pos:start="1:1" pos:end="1:15"><name pos:start="1:1" pos:end="1:13">QCryptoCipher</name> <modifier pos:start="1:15" pos:end="1:15">*</modifier></type><name pos:start="1:16" pos:end="1:33">qcrypto_cipher_new</name><parameter_list pos:start="1:34" pos:end="7:47">(<parameter pos:start="1:35" pos:end="1:60"><decl pos:start="1:35" pos:end="1:60"><type pos:start="1:35" pos:end="1:60"><name pos:start="1:35" pos:end="1:56">QCryptoCipherAlgorithm</name></type> <name pos:start="1:58" pos:end="1:60">alg</name></decl></parameter>,

                                  <parameter pos:start="3:35" pos:end="3:56"><decl pos:start="3:35" pos:end="3:56"><type pos:start="3:35" pos:end="3:56"><name pos:start="3:35" pos:end="3:51">QCryptoCipherMode</name></type> <name pos:start="3:53" pos:end="3:56">mode</name></decl></parameter>,

                                  <parameter pos:start="5:35" pos:end="5:52"><decl pos:start="5:35" pos:end="5:52"><type pos:start="5:35" pos:end="5:52"><specifier pos:start="5:35" pos:end="5:39">const</specifier> <name pos:start="5:41" pos:end="5:47">uint8_t</name> <modifier pos:start="5:49" pos:end="5:49">*</modifier></type><name pos:start="5:50" pos:end="5:52">key</name></decl></parameter>, <parameter pos:start="5:55" pos:end="5:65"><decl pos:start="5:55" pos:end="5:65"><type pos:start="5:55" pos:end="5:65"><name pos:start="5:55" pos:end="5:60">size_t</name></type> <name pos:start="5:62" pos:end="5:65">nkey</name></decl></parameter>,

                                  <parameter pos:start="7:35" pos:end="7:46"><decl pos:start="7:35" pos:end="7:46"><type pos:start="7:35" pos:end="7:46"><name pos:start="7:35" pos:end="7:39">Error</name> <modifier pos:start="7:41" pos:end="7:41">*</modifier><modifier pos:start="7:42" pos:end="7:42">*</modifier></type><name pos:start="7:43" pos:end="7:46">errp</name></decl></parameter>)</parameter_list>

<block pos:start="9:1" pos:end="337:1">{<block_content pos:start="11:5" pos:end="335:16">

    <decl_stmt pos:start="11:5" pos:end="11:26"><decl pos:start="11:5" pos:end="11:25"><type pos:start="11:5" pos:end="11:19"><name pos:start="11:5" pos:end="11:17">QCryptoCipher</name> <modifier pos:start="11:19" pos:end="11:19">*</modifier></type><name pos:start="11:20" pos:end="11:25">cipher</name></decl>;</decl_stmt>

    <decl_stmt pos:start="13:5" pos:end="13:29"><decl pos:start="13:5" pos:end="13:28"><type pos:start="13:5" pos:end="13:25"><name pos:start="13:5" pos:end="13:23">QCryptoCipherNettle</name> <modifier pos:start="13:25" pos:end="13:25">*</modifier></type><name pos:start="13:26" pos:end="13:28">ctx</name></decl>;</decl_stmt>

    <decl_stmt pos:start="15:5" pos:end="15:20"><decl pos:start="15:5" pos:end="15:19"><type pos:start="15:5" pos:end="15:13"><name pos:start="15:5" pos:end="15:11">uint8_t</name> <modifier pos:start="15:13" pos:end="15:13">*</modifier></type><name pos:start="15:14" pos:end="15:19">rfbkey</name></decl>;</decl_stmt>



    <switch pos:start="19:5" pos:end="39:5">switch <condition pos:start="19:12" pos:end="19:17">(<expr pos:start="19:13" pos:end="19:16"><name pos:start="19:13" pos:end="19:16">mode</name></expr>)</condition> <block pos:start="19:19" pos:end="39:5">{<block_content pos:start="21:5" pos:end="37:20">

    <case pos:start="21:5" pos:end="21:33">case <expr pos:start="21:10" pos:end="21:32"><name pos:start="21:10" pos:end="21:32">QCRYPTO_CIPHER_MODE_ECB</name></expr>:</case>

    <case pos:start="23:5" pos:end="23:33">case <expr pos:start="23:10" pos:end="23:32"><name pos:start="23:10" pos:end="23:32">QCRYPTO_CIPHER_MODE_CBC</name></expr>:</case>

    <case pos:start="25:5" pos:end="25:33">case <expr pos:start="25:10" pos:end="25:32"><name pos:start="25:10" pos:end="25:32">QCRYPTO_CIPHER_MODE_XTS</name></expr>:</case>

    <case pos:start="27:5" pos:end="27:33">case <expr pos:start="27:10" pos:end="27:32"><name pos:start="27:10" pos:end="27:32">QCRYPTO_CIPHER_MODE_CTR</name></expr>:</case>

        <break pos:start="29:9" pos:end="29:14">break;</break>

    <default pos:start="31:5" pos:end="31:12">default:</default>

        <expr_stmt pos:start="33:9" pos:end="35:51"><expr pos:start="33:9" pos:end="35:50"><call pos:start="33:9" pos:end="35:50"><name pos:start="33:9" pos:end="33:18">error_setg</name><argument_list pos:start="33:19" pos:end="35:50">(<argument pos:start="33:20" pos:end="33:23"><expr pos:start="33:20" pos:end="33:23"><name pos:start="33:20" pos:end="33:23">errp</name></expr></argument>, <argument pos:start="33:26" pos:end="33:53"><expr pos:start="33:26" pos:end="33:53"><literal type="string" pos:start="33:26" pos:end="33:53">"Unsupported cipher mode %s"</literal></expr></argument>,

                   <argument pos:start="35:20" pos:end="35:49"><expr pos:start="35:20" pos:end="35:49"><name pos:start="35:20" pos:end="35:49"><name pos:start="35:20" pos:end="35:43">QCryptoCipherMode_lookup</name><index pos:start="35:44" pos:end="35:49">[<expr pos:start="35:45" pos:end="35:48"><name pos:start="35:45" pos:end="35:48">mode</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <return pos:start="37:9" pos:end="37:20">return <expr pos:start="37:16" pos:end="37:19"><name pos:start="37:16" pos:end="37:19">NULL</name></expr>;</return>

    </block_content>}</block></switch>



    <if_stmt pos:start="43:5" pos:end="47:5"><if pos:start="43:5" pos:end="47:5">if <condition pos:start="43:8" pos:end="43:67">(<expr pos:start="43:9" pos:end="43:66"><operator pos:start="43:9" pos:end="43:9">!</operator><call pos:start="43:10" pos:end="43:66"><name pos:start="43:10" pos:end="43:43">qcrypto_cipher_validate_key_length</name><argument_list pos:start="43:44" pos:end="43:66">(<argument pos:start="43:45" pos:end="43:47"><expr pos:start="43:45" pos:end="43:47"><name pos:start="43:45" pos:end="43:47">alg</name></expr></argument>, <argument pos:start="43:50" pos:end="43:53"><expr pos:start="43:50" pos:end="43:53"><name pos:start="43:50" pos:end="43:53">mode</name></expr></argument>, <argument pos:start="43:56" pos:end="43:59"><expr pos:start="43:56" pos:end="43:59"><name pos:start="43:56" pos:end="43:59">nkey</name></expr></argument>, <argument pos:start="43:62" pos:end="43:65"><expr pos:start="43:62" pos:end="43:65"><name pos:start="43:62" pos:end="43:65">errp</name></expr></argument>)</argument_list></call></expr>)</condition> <block pos:start="43:69" pos:end="47:5">{<block_content pos:start="45:9" pos:end="45:20">

        <return pos:start="45:9" pos:end="45:20">return <expr pos:start="45:16" pos:end="45:19"><name pos:start="45:16" pos:end="45:19">NULL</name></expr>;</return>

    </block_content>}</block></if></if_stmt>



    <expr_stmt pos:start="51:5" pos:end="51:38"><expr pos:start="51:5" pos:end="51:37"><name pos:start="51:5" pos:end="51:10">cipher</name> <operator pos:start="51:12" pos:end="51:12">=</operator> <call pos:start="51:14" pos:end="51:37"><name pos:start="51:14" pos:end="51:19">g_new0</name><argument_list pos:start="51:20" pos:end="51:37">(<argument pos:start="51:21" pos:end="51:33"><expr pos:start="51:21" pos:end="51:33"><name pos:start="51:21" pos:end="51:33">QCryptoCipher</name></expr></argument>, <argument pos:start="51:36" pos:end="51:36"><expr pos:start="51:36" pos:end="51:36"><literal type="number" pos:start="51:36" pos:end="51:36">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="53:5" pos:end="53:22"><expr pos:start="53:5" pos:end="53:21"><name pos:start="53:5" pos:end="53:15"><name pos:start="53:5" pos:end="53:10">cipher</name><operator pos:start="53:11" pos:end="53:12">-&gt;</operator><name pos:start="53:13" pos:end="53:15">alg</name></name> <operator pos:start="53:17" pos:end="53:17">=</operator> <name pos:start="53:19" pos:end="53:21">alg</name></expr>;</expr_stmt>

    <expr_stmt pos:start="55:5" pos:end="55:24"><expr pos:start="55:5" pos:end="55:23"><name pos:start="55:5" pos:end="55:16"><name pos:start="55:5" pos:end="55:10">cipher</name><operator pos:start="55:11" pos:end="55:12">-&gt;</operator><name pos:start="55:13" pos:end="55:16">mode</name></name> <operator pos:start="55:18" pos:end="55:18">=</operator> <name pos:start="55:20" pos:end="55:23">mode</name></expr>;</expr_stmt>



    <expr_stmt pos:start="59:5" pos:end="59:41"><expr pos:start="59:5" pos:end="59:40"><name pos:start="59:5" pos:end="59:7">ctx</name> <operator pos:start="59:9" pos:end="59:9">=</operator> <call pos:start="59:11" pos:end="59:40"><name pos:start="59:11" pos:end="59:16">g_new0</name><argument_list pos:start="59:17" pos:end="59:40">(<argument pos:start="59:18" pos:end="59:36"><expr pos:start="59:18" pos:end="59:36"><name pos:start="59:18" pos:end="59:36">QCryptoCipherNettle</name></expr></argument>, <argument pos:start="59:39" pos:end="59:39"><expr pos:start="59:39" pos:end="59:39"><literal type="number" pos:start="59:39" pos:end="59:39">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <switch pos:start="63:5" pos:end="301:5">switch <condition pos:start="63:12" pos:end="63:16">(<expr pos:start="63:13" pos:end="63:15"><name pos:start="63:13" pos:end="63:15">alg</name></expr>)</condition> <block pos:start="63:18" pos:end="301:5">{<block_content pos:start="65:5" pos:end="299:19">

    <case pos:start="65:5" pos:end="65:36">case <expr pos:start="65:10" pos:end="65:35"><name pos:start="65:10" pos:end="65:35">QCRYPTO_CIPHER_ALG_DES_RFB</name></expr>:</case>

        <expr_stmt pos:start="67:9" pos:end="67:45"><expr pos:start="67:9" pos:end="67:44"><name pos:start="67:9" pos:end="67:16"><name pos:start="67:9" pos:end="67:11">ctx</name><operator pos:start="67:12" pos:end="67:13">-&gt;</operator><name pos:start="67:14" pos:end="67:16">ctx</name></name> <operator pos:start="67:18" pos:end="67:18">=</operator> <call pos:start="67:20" pos:end="67:44"><name pos:start="67:20" pos:end="67:25">g_new0</name><argument_list pos:start="67:26" pos:end="67:44">(<argument pos:start="67:27" pos:end="67:40"><expr pos:start="67:27" pos:end="67:40">struct <name pos:start="67:34" pos:end="67:40">des_ctx</name></expr></argument>, <argument pos:start="67:43" pos:end="67:43"><expr pos:start="67:43" pos:end="67:43"><literal type="number" pos:start="67:43" pos:end="67:43">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="69:9" pos:end="69:61"><expr pos:start="69:9" pos:end="69:60"><name pos:start="69:9" pos:end="69:14">rfbkey</name> <operator pos:start="69:16" pos:end="69:16">=</operator> <call pos:start="69:18" pos:end="69:60"><name pos:start="69:18" pos:end="69:49">qcrypto_cipher_munge_des_rfb_key</name><argument_list pos:start="69:50" pos:end="69:60">(<argument pos:start="69:51" pos:end="69:53"><expr pos:start="69:51" pos:end="69:53"><name pos:start="69:51" pos:end="69:53">key</name></expr></argument>, <argument pos:start="69:56" pos:end="69:59"><expr pos:start="69:56" pos:end="69:59"><name pos:start="69:56" pos:end="69:59">nkey</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="71:9" pos:end="71:38"><expr pos:start="71:9" pos:end="71:37"><call pos:start="71:9" pos:end="71:37"><name pos:start="71:9" pos:end="71:19">des_set_key</name><argument_list pos:start="71:20" pos:end="71:37">(<argument pos:start="71:21" pos:end="71:28"><expr pos:start="71:21" pos:end="71:28"><name pos:start="71:21" pos:end="71:28"><name pos:start="71:21" pos:end="71:23">ctx</name><operator pos:start="71:24" pos:end="71:25">-&gt;</operator><name pos:start="71:26" pos:end="71:28">ctx</name></name></expr></argument>, <argument pos:start="71:31" pos:end="71:36"><expr pos:start="71:31" pos:end="71:36"><name pos:start="71:31" pos:end="71:36">rfbkey</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="73:9" pos:end="73:23"><expr pos:start="73:9" pos:end="73:22"><call pos:start="73:9" pos:end="73:22"><name pos:start="73:9" pos:end="73:14">g_free</name><argument_list pos:start="73:15" pos:end="73:22">(<argument pos:start="73:16" pos:end="73:21"><expr pos:start="73:16" pos:end="73:21"><name pos:start="73:16" pos:end="73:21">rfbkey</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <expr_stmt pos:start="77:9" pos:end="77:53"><expr pos:start="77:9" pos:end="77:52"><name pos:start="77:9" pos:end="77:31"><name pos:start="77:9" pos:end="77:11">ctx</name><operator pos:start="77:12" pos:end="77:13">-&gt;</operator><name pos:start="77:14" pos:end="77:31">alg_encrypt_native</name></name> <operator pos:start="77:33" pos:end="77:33">=</operator> <name pos:start="77:35" pos:end="77:52">des_encrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="79:9" pos:end="79:53"><expr pos:start="79:9" pos:end="79:52"><name pos:start="79:9" pos:end="79:31"><name pos:start="79:9" pos:end="79:11">ctx</name><operator pos:start="79:12" pos:end="79:13">-&gt;</operator><name pos:start="79:14" pos:end="79:31">alg_decrypt_native</name></name> <operator pos:start="79:33" pos:end="79:33">=</operator> <name pos:start="79:35" pos:end="79:52">des_decrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="81:9" pos:end="81:55"><expr pos:start="81:9" pos:end="81:54"><name pos:start="81:9" pos:end="81:32"><name pos:start="81:9" pos:end="81:11">ctx</name><operator pos:start="81:12" pos:end="81:13">-&gt;</operator><name pos:start="81:14" pos:end="81:32">alg_encrypt_wrapper</name></name> <operator pos:start="81:34" pos:end="81:34">=</operator> <name pos:start="81:36" pos:end="81:54">des_encrypt_wrapper</name></expr>;</expr_stmt>

        <expr_stmt pos:start="83:9" pos:end="83:55"><expr pos:start="83:9" pos:end="83:54"><name pos:start="83:9" pos:end="83:32"><name pos:start="83:9" pos:end="83:11">ctx</name><operator pos:start="83:12" pos:end="83:13">-&gt;</operator><name pos:start="83:14" pos:end="83:32">alg_decrypt_wrapper</name></name> <operator pos:start="83:34" pos:end="83:34">=</operator> <name pos:start="83:36" pos:end="83:54">des_decrypt_wrapper</name></expr>;</expr_stmt>



        <expr_stmt pos:start="87:9" pos:end="87:40"><expr pos:start="87:9" pos:end="87:39"><name pos:start="87:9" pos:end="87:22"><name pos:start="87:9" pos:end="87:11">ctx</name><operator pos:start="87:12" pos:end="87:13">-&gt;</operator><name pos:start="87:14" pos:end="87:22">blocksize</name></name> <operator pos:start="87:24" pos:end="87:24">=</operator> <name pos:start="87:26" pos:end="87:39">DES_BLOCK_SIZE</name></expr>;</expr_stmt>

        <break pos:start="89:9" pos:end="89:14">break;</break>



    <case pos:start="93:5" pos:end="93:36">case <expr pos:start="93:10" pos:end="93:35"><name pos:start="93:10" pos:end="93:35">QCRYPTO_CIPHER_ALG_AES_128</name></expr>:</case>

    <case pos:start="95:5" pos:end="95:36">case <expr pos:start="95:10" pos:end="95:35"><name pos:start="95:10" pos:end="95:35">QCRYPTO_CIPHER_ALG_AES_192</name></expr>:</case>

    <case pos:start="97:5" pos:end="97:36">case <expr pos:start="97:10" pos:end="97:35"><name pos:start="97:10" pos:end="97:35">QCRYPTO_CIPHER_ALG_AES_256</name></expr>:</case>

        <expr_stmt pos:start="99:9" pos:end="99:47"><expr pos:start="99:9" pos:end="99:46"><name pos:start="99:9" pos:end="99:16"><name pos:start="99:9" pos:end="99:11">ctx</name><operator pos:start="99:12" pos:end="99:13">-&gt;</operator><name pos:start="99:14" pos:end="99:16">ctx</name></name> <operator pos:start="99:18" pos:end="99:18">=</operator> <call pos:start="99:20" pos:end="99:46"><name pos:start="99:20" pos:end="99:25">g_new0</name><argument_list pos:start="99:26" pos:end="99:46">(<argument pos:start="99:27" pos:end="99:42"><expr pos:start="99:27" pos:end="99:42"><name pos:start="99:27" pos:end="99:42">QCryptoNettleAES</name></expr></argument>, <argument pos:start="99:45" pos:end="99:45"><expr pos:start="99:45" pos:end="99:45"><literal type="number" pos:start="99:45" pos:end="99:45">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <if_stmt pos:start="103:9" pos:end="139:9"><if pos:start="103:9" pos:end="129:9">if <condition pos:start="103:12" pos:end="103:44">(<expr pos:start="103:13" pos:end="103:43"><name pos:start="103:13" pos:end="103:16">mode</name> <operator pos:start="103:18" pos:end="103:19">==</operator> <name pos:start="103:21" pos:end="103:43">QCRYPTO_CIPHER_MODE_XTS</name></expr>)</condition> <block pos:start="103:46" pos:end="129:9">{<block_content pos:start="105:13" pos:end="127:50">

            <expr_stmt pos:start="105:13" pos:end="105:57"><expr pos:start="105:13" pos:end="105:56"><name pos:start="105:13" pos:end="105:26"><name pos:start="105:13" pos:end="105:15">ctx</name><operator pos:start="105:16" pos:end="105:17">-&gt;</operator><name pos:start="105:18" pos:end="105:26">ctx_tweak</name></name> <operator pos:start="105:28" pos:end="105:28">=</operator> <call pos:start="105:30" pos:end="105:56"><name pos:start="105:30" pos:end="105:35">g_new0</name><argument_list pos:start="105:36" pos:end="105:56">(<argument pos:start="105:37" pos:end="105:52"><expr pos:start="105:37" pos:end="105:52"><name pos:start="105:37" pos:end="105:52">QCryptoNettleAES</name></expr></argument>, <argument pos:start="105:55" pos:end="105:55"><expr pos:start="105:55" pos:end="105:55"><literal type="number" pos:start="105:55" pos:end="105:55">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



            <expr_stmt pos:start="109:13" pos:end="109:22"><expr pos:start="109:13" pos:end="109:21"><name pos:start="109:13" pos:end="109:16">nkey</name> <operator pos:start="109:18" pos:end="109:19">/=</operator> <literal type="number" pos:start="109:21" pos:end="109:21">2</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="111:13" pos:end="113:43"><expr pos:start="111:13" pos:end="113:42"><call pos:start="111:13" pos:end="113:42"><name pos:start="111:13" pos:end="111:31">aes_set_encrypt_key</name><argument_list pos:start="111:32" pos:end="113:42">(<argument pos:start="111:33" pos:end="111:68"><expr pos:start="111:33" pos:end="111:68"><operator pos:start="111:33" pos:end="111:33">&amp;</operator><operator pos:start="111:34" pos:end="111:34">(</operator><operator pos:start="111:35" pos:end="111:35">(</operator><name pos:start="111:36" pos:end="111:51">QCryptoNettleAES</name> <operator pos:start="111:53" pos:end="111:53">*</operator><operator pos:start="111:54" pos:end="111:54">)</operator><name pos:start="111:55" pos:end="111:62"><name pos:start="111:55" pos:end="111:57">ctx</name><operator pos:start="111:58" pos:end="111:59">-&gt;</operator><name pos:start="111:60" pos:end="111:62">ctx</name></name><operator pos:start="111:63" pos:end="111:63">)</operator><operator pos:start="111:64" pos:end="111:65">-&gt;</operator><name pos:start="111:66" pos:end="111:68">enc</name></expr></argument>,

                                <argument pos:start="113:33" pos:end="113:36"><expr pos:start="113:33" pos:end="113:36"><name pos:start="113:33" pos:end="113:36">nkey</name></expr></argument>, <argument pos:start="113:39" pos:end="113:41"><expr pos:start="113:39" pos:end="113:41"><name pos:start="113:39" pos:end="113:41">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="115:13" pos:end="117:43"><expr pos:start="115:13" pos:end="117:42"><call pos:start="115:13" pos:end="117:42"><name pos:start="115:13" pos:end="115:31">aes_set_decrypt_key</name><argument_list pos:start="115:32" pos:end="117:42">(<argument pos:start="115:33" pos:end="115:68"><expr pos:start="115:33" pos:end="115:68"><operator pos:start="115:33" pos:end="115:33">&amp;</operator><operator pos:start="115:34" pos:end="115:34">(</operator><operator pos:start="115:35" pos:end="115:35">(</operator><name pos:start="115:36" pos:end="115:51">QCryptoNettleAES</name> <operator pos:start="115:53" pos:end="115:53">*</operator><operator pos:start="115:54" pos:end="115:54">)</operator><name pos:start="115:55" pos:end="115:62"><name pos:start="115:55" pos:end="115:57">ctx</name><operator pos:start="115:58" pos:end="115:59">-&gt;</operator><name pos:start="115:60" pos:end="115:62">ctx</name></name><operator pos:start="115:63" pos:end="115:63">)</operator><operator pos:start="115:64" pos:end="115:65">-&gt;</operator><name pos:start="115:66" pos:end="115:68">dec</name></expr></argument>,

                                <argument pos:start="117:33" pos:end="117:36"><expr pos:start="117:33" pos:end="117:36"><name pos:start="117:33" pos:end="117:36">nkey</name></expr></argument>, <argument pos:start="117:39" pos:end="117:41"><expr pos:start="117:39" pos:end="117:41"><name pos:start="117:39" pos:end="117:41">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



            <expr_stmt pos:start="121:13" pos:end="123:50"><expr pos:start="121:13" pos:end="123:49"><call pos:start="121:13" pos:end="123:49"><name pos:start="121:13" pos:end="121:31">aes_set_encrypt_key</name><argument_list pos:start="121:32" pos:end="123:49">(<argument pos:start="121:33" pos:end="121:74"><expr pos:start="121:33" pos:end="121:74"><operator pos:start="121:33" pos:end="121:33">&amp;</operator><operator pos:start="121:34" pos:end="121:34">(</operator><operator pos:start="121:35" pos:end="121:35">(</operator><name pos:start="121:36" pos:end="121:51">QCryptoNettleAES</name> <operator pos:start="121:53" pos:end="121:53">*</operator><operator pos:start="121:54" pos:end="121:54">)</operator><name pos:start="121:55" pos:end="121:68"><name pos:start="121:55" pos:end="121:57">ctx</name><operator pos:start="121:58" pos:end="121:59">-&gt;</operator><name pos:start="121:60" pos:end="121:68">ctx_tweak</name></name><operator pos:start="121:69" pos:end="121:69">)</operator><operator pos:start="121:70" pos:end="121:71">-&gt;</operator><name pos:start="121:72" pos:end="121:74">enc</name></expr></argument>,

                                <argument pos:start="123:33" pos:end="123:36"><expr pos:start="123:33" pos:end="123:36"><name pos:start="123:33" pos:end="123:36">nkey</name></expr></argument>, <argument pos:start="123:39" pos:end="123:48"><expr pos:start="123:39" pos:end="123:48"><name pos:start="123:39" pos:end="123:41">key</name> <operator pos:start="123:43" pos:end="123:43">+</operator> <name pos:start="123:45" pos:end="123:48">nkey</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="125:13" pos:end="127:50"><expr pos:start="125:13" pos:end="127:49"><call pos:start="125:13" pos:end="127:49"><name pos:start="125:13" pos:end="125:31">aes_set_decrypt_key</name><argument_list pos:start="125:32" pos:end="127:49">(<argument pos:start="125:33" pos:end="125:74"><expr pos:start="125:33" pos:end="125:74"><operator pos:start="125:33" pos:end="125:33">&amp;</operator><operator pos:start="125:34" pos:end="125:34">(</operator><operator pos:start="125:35" pos:end="125:35">(</operator><name pos:start="125:36" pos:end="125:51">QCryptoNettleAES</name> <operator pos:start="125:53" pos:end="125:53">*</operator><operator pos:start="125:54" pos:end="125:54">)</operator><name pos:start="125:55" pos:end="125:68"><name pos:start="125:55" pos:end="125:57">ctx</name><operator pos:start="125:58" pos:end="125:59">-&gt;</operator><name pos:start="125:60" pos:end="125:68">ctx_tweak</name></name><operator pos:start="125:69" pos:end="125:69">)</operator><operator pos:start="125:70" pos:end="125:71">-&gt;</operator><name pos:start="125:72" pos:end="125:74">dec</name></expr></argument>,

                                <argument pos:start="127:33" pos:end="127:36"><expr pos:start="127:33" pos:end="127:36"><name pos:start="127:33" pos:end="127:36">nkey</name></expr></argument>, <argument pos:start="127:39" pos:end="127:48"><expr pos:start="127:39" pos:end="127:48"><name pos:start="127:39" pos:end="127:41">key</name> <operator pos:start="127:43" pos:end="127:43">+</operator> <name pos:start="127:45" pos:end="127:48">nkey</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></if> <else pos:start="129:11" pos:end="139:9">else <block pos:start="129:16" pos:end="139:9">{<block_content pos:start="131:13" pos:end="137:43">

            <expr_stmt pos:start="131:13" pos:end="133:43"><expr pos:start="131:13" pos:end="133:42"><call pos:start="131:13" pos:end="133:42"><name pos:start="131:13" pos:end="131:31">aes_set_encrypt_key</name><argument_list pos:start="131:32" pos:end="133:42">(<argument pos:start="131:33" pos:end="131:68"><expr pos:start="131:33" pos:end="131:68"><operator pos:start="131:33" pos:end="131:33">&amp;</operator><operator pos:start="131:34" pos:end="131:34">(</operator><operator pos:start="131:35" pos:end="131:35">(</operator><name pos:start="131:36" pos:end="131:51">QCryptoNettleAES</name> <operator pos:start="131:53" pos:end="131:53">*</operator><operator pos:start="131:54" pos:end="131:54">)</operator><name pos:start="131:55" pos:end="131:62"><name pos:start="131:55" pos:end="131:57">ctx</name><operator pos:start="131:58" pos:end="131:59">-&gt;</operator><name pos:start="131:60" pos:end="131:62">ctx</name></name><operator pos:start="131:63" pos:end="131:63">)</operator><operator pos:start="131:64" pos:end="131:65">-&gt;</operator><name pos:start="131:66" pos:end="131:68">enc</name></expr></argument>,

                                <argument pos:start="133:33" pos:end="133:36"><expr pos:start="133:33" pos:end="133:36"><name pos:start="133:33" pos:end="133:36">nkey</name></expr></argument>, <argument pos:start="133:39" pos:end="133:41"><expr pos:start="133:39" pos:end="133:41"><name pos:start="133:39" pos:end="133:41">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="135:13" pos:end="137:43"><expr pos:start="135:13" pos:end="137:42"><call pos:start="135:13" pos:end="137:42"><name pos:start="135:13" pos:end="135:31">aes_set_decrypt_key</name><argument_list pos:start="135:32" pos:end="137:42">(<argument pos:start="135:33" pos:end="135:68"><expr pos:start="135:33" pos:end="135:68"><operator pos:start="135:33" pos:end="135:33">&amp;</operator><operator pos:start="135:34" pos:end="135:34">(</operator><operator pos:start="135:35" pos:end="135:35">(</operator><name pos:start="135:36" pos:end="135:51">QCryptoNettleAES</name> <operator pos:start="135:53" pos:end="135:53">*</operator><operator pos:start="135:54" pos:end="135:54">)</operator><name pos:start="135:55" pos:end="135:62"><name pos:start="135:55" pos:end="135:57">ctx</name><operator pos:start="135:58" pos:end="135:59">-&gt;</operator><name pos:start="135:60" pos:end="135:62">ctx</name></name><operator pos:start="135:63" pos:end="135:63">)</operator><operator pos:start="135:64" pos:end="135:65">-&gt;</operator><name pos:start="135:66" pos:end="135:68">dec</name></expr></argument>,

                                <argument pos:start="137:33" pos:end="137:36"><expr pos:start="137:33" pos:end="137:36"><name pos:start="137:33" pos:end="137:36">nkey</name></expr></argument>, <argument pos:start="137:39" pos:end="137:41"><expr pos:start="137:39" pos:end="137:41"><name pos:start="137:39" pos:end="137:41">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></else></if_stmt>



        <expr_stmt pos:start="143:9" pos:end="143:53"><expr pos:start="143:9" pos:end="143:52"><name pos:start="143:9" pos:end="143:31"><name pos:start="143:9" pos:end="143:11">ctx</name><operator pos:start="143:12" pos:end="143:13">-&gt;</operator><name pos:start="143:14" pos:end="143:31">alg_encrypt_native</name></name> <operator pos:start="143:33" pos:end="143:33">=</operator> <name pos:start="143:35" pos:end="143:52">aes_encrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="145:9" pos:end="145:53"><expr pos:start="145:9" pos:end="145:52"><name pos:start="145:9" pos:end="145:31"><name pos:start="145:9" pos:end="145:11">ctx</name><operator pos:start="145:12" pos:end="145:13">-&gt;</operator><name pos:start="145:14" pos:end="145:31">alg_decrypt_native</name></name> <operator pos:start="145:33" pos:end="145:33">=</operator> <name pos:start="145:35" pos:end="145:52">aes_decrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="147:9" pos:end="147:55"><expr pos:start="147:9" pos:end="147:54"><name pos:start="147:9" pos:end="147:32"><name pos:start="147:9" pos:end="147:11">ctx</name><operator pos:start="147:12" pos:end="147:13">-&gt;</operator><name pos:start="147:14" pos:end="147:32">alg_encrypt_wrapper</name></name> <operator pos:start="147:34" pos:end="147:34">=</operator> <name pos:start="147:36" pos:end="147:54">aes_encrypt_wrapper</name></expr>;</expr_stmt>

        <expr_stmt pos:start="149:9" pos:end="149:55"><expr pos:start="149:9" pos:end="149:54"><name pos:start="149:9" pos:end="149:32"><name pos:start="149:9" pos:end="149:11">ctx</name><operator pos:start="149:12" pos:end="149:13">-&gt;</operator><name pos:start="149:14" pos:end="149:32">alg_decrypt_wrapper</name></name> <operator pos:start="149:34" pos:end="149:34">=</operator> <name pos:start="149:36" pos:end="149:54">aes_decrypt_wrapper</name></expr>;</expr_stmt>



        <expr_stmt pos:start="153:9" pos:end="153:40"><expr pos:start="153:9" pos:end="153:39"><name pos:start="153:9" pos:end="153:22"><name pos:start="153:9" pos:end="153:11">ctx</name><operator pos:start="153:12" pos:end="153:13">-&gt;</operator><name pos:start="153:14" pos:end="153:22">blocksize</name></name> <operator pos:start="153:24" pos:end="153:24">=</operator> <name pos:start="153:26" pos:end="153:39">AES_BLOCK_SIZE</name></expr>;</expr_stmt>

        <break pos:start="155:9" pos:end="155:14">break;</break>



    <case pos:start="159:5" pos:end="159:38">case <expr pos:start="159:10" pos:end="159:37"><name pos:start="159:10" pos:end="159:37">QCRYPTO_CIPHER_ALG_CAST5_128</name></expr>:</case>

        <expr_stmt pos:start="161:9" pos:end="161:49"><expr pos:start="161:9" pos:end="161:48"><name pos:start="161:9" pos:end="161:16"><name pos:start="161:9" pos:end="161:11">ctx</name><operator pos:start="161:12" pos:end="161:13">-&gt;</operator><name pos:start="161:14" pos:end="161:16">ctx</name></name> <operator pos:start="161:18" pos:end="161:18">=</operator> <call pos:start="161:20" pos:end="161:48"><name pos:start="161:20" pos:end="161:25">g_new0</name><argument_list pos:start="161:26" pos:end="161:48">(<argument pos:start="161:27" pos:end="161:44"><expr pos:start="161:27" pos:end="161:44">struct <name pos:start="161:34" pos:end="161:44">cast128_ctx</name></expr></argument>, <argument pos:start="161:47" pos:end="161:47"><expr pos:start="161:47" pos:end="161:47"><literal type="number" pos:start="161:47" pos:end="161:47">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <if_stmt pos:start="165:9" pos:end="181:9"><if pos:start="165:9" pos:end="177:9">if <condition pos:start="165:12" pos:end="165:44">(<expr pos:start="165:13" pos:end="165:43"><name pos:start="165:13" pos:end="165:16">mode</name> <operator pos:start="165:18" pos:end="165:19">==</operator> <name pos:start="165:21" pos:end="165:43">QCRYPTO_CIPHER_MODE_XTS</name></expr>)</condition> <block pos:start="165:46" pos:end="177:9">{<block_content pos:start="167:13" pos:end="175:60">

            <expr_stmt pos:start="167:13" pos:end="167:59"><expr pos:start="167:13" pos:end="167:58"><name pos:start="167:13" pos:end="167:26"><name pos:start="167:13" pos:end="167:15">ctx</name><operator pos:start="167:16" pos:end="167:17">-&gt;</operator><name pos:start="167:18" pos:end="167:26">ctx_tweak</name></name> <operator pos:start="167:28" pos:end="167:28">=</operator> <call pos:start="167:30" pos:end="167:58"><name pos:start="167:30" pos:end="167:35">g_new0</name><argument_list pos:start="167:36" pos:end="167:58">(<argument pos:start="167:37" pos:end="167:54"><expr pos:start="167:37" pos:end="167:54">struct <name pos:start="167:44" pos:end="167:54">cast128_ctx</name></expr></argument>, <argument pos:start="167:57" pos:end="167:57"><expr pos:start="167:57" pos:end="167:57"><literal type="number" pos:start="167:57" pos:end="167:57">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



            <expr_stmt pos:start="171:13" pos:end="171:22"><expr pos:start="171:13" pos:end="171:21"><name pos:start="171:13" pos:end="171:16">nkey</name> <operator pos:start="171:18" pos:end="171:19">/=</operator> <literal type="number" pos:start="171:21" pos:end="171:21">2</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="173:13" pos:end="173:47"><expr pos:start="173:13" pos:end="173:46"><call pos:start="173:13" pos:end="173:46"><name pos:start="173:13" pos:end="173:25">cast5_set_key</name><argument_list pos:start="173:26" pos:end="173:46">(<argument pos:start="173:27" pos:end="173:34"><expr pos:start="173:27" pos:end="173:34"><name pos:start="173:27" pos:end="173:34"><name pos:start="173:27" pos:end="173:29">ctx</name><operator pos:start="173:30" pos:end="173:31">-&gt;</operator><name pos:start="173:32" pos:end="173:34">ctx</name></name></expr></argument>, <argument pos:start="173:37" pos:end="173:40"><expr pos:start="173:37" pos:end="173:40"><name pos:start="173:37" pos:end="173:40">nkey</name></expr></argument>, <argument pos:start="173:43" pos:end="173:45"><expr pos:start="173:43" pos:end="173:45"><name pos:start="173:43" pos:end="173:45">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="175:13" pos:end="175:60"><expr pos:start="175:13" pos:end="175:59"><call pos:start="175:13" pos:end="175:59"><name pos:start="175:13" pos:end="175:25">cast5_set_key</name><argument_list pos:start="175:26" pos:end="175:59">(<argument pos:start="175:27" pos:end="175:40"><expr pos:start="175:27" pos:end="175:40"><name pos:start="175:27" pos:end="175:40"><name pos:start="175:27" pos:end="175:29">ctx</name><operator pos:start="175:30" pos:end="175:31">-&gt;</operator><name pos:start="175:32" pos:end="175:40">ctx_tweak</name></name></expr></argument>, <argument pos:start="175:43" pos:end="175:46"><expr pos:start="175:43" pos:end="175:46"><name pos:start="175:43" pos:end="175:46">nkey</name></expr></argument>, <argument pos:start="175:49" pos:end="175:58"><expr pos:start="175:49" pos:end="175:58"><name pos:start="175:49" pos:end="175:51">key</name> <operator pos:start="175:53" pos:end="175:53">+</operator> <name pos:start="175:55" pos:end="175:58">nkey</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></if> <else pos:start="177:11" pos:end="181:9">else <block pos:start="177:16" pos:end="181:9">{<block_content pos:start="179:13" pos:end="179:47">

            <expr_stmt pos:start="179:13" pos:end="179:47"><expr pos:start="179:13" pos:end="179:46"><call pos:start="179:13" pos:end="179:46"><name pos:start="179:13" pos:end="179:25">cast5_set_key</name><argument_list pos:start="179:26" pos:end="179:46">(<argument pos:start="179:27" pos:end="179:34"><expr pos:start="179:27" pos:end="179:34"><name pos:start="179:27" pos:end="179:34"><name pos:start="179:27" pos:end="179:29">ctx</name><operator pos:start="179:30" pos:end="179:31">-&gt;</operator><name pos:start="179:32" pos:end="179:34">ctx</name></name></expr></argument>, <argument pos:start="179:37" pos:end="179:40"><expr pos:start="179:37" pos:end="179:40"><name pos:start="179:37" pos:end="179:40">nkey</name></expr></argument>, <argument pos:start="179:43" pos:end="179:45"><expr pos:start="179:43" pos:end="179:45"><name pos:start="179:43" pos:end="179:45">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></else></if_stmt>



        <expr_stmt pos:start="185:9" pos:end="185:57"><expr pos:start="185:9" pos:end="185:56"><name pos:start="185:9" pos:end="185:31"><name pos:start="185:9" pos:end="185:11">ctx</name><operator pos:start="185:12" pos:end="185:13">-&gt;</operator><name pos:start="185:14" pos:end="185:31">alg_encrypt_native</name></name> <operator pos:start="185:33" pos:end="185:33">=</operator> <name pos:start="185:35" pos:end="185:56">cast128_encrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="187:9" pos:end="187:57"><expr pos:start="187:9" pos:end="187:56"><name pos:start="187:9" pos:end="187:31"><name pos:start="187:9" pos:end="187:11">ctx</name><operator pos:start="187:12" pos:end="187:13">-&gt;</operator><name pos:start="187:14" pos:end="187:31">alg_decrypt_native</name></name> <operator pos:start="187:33" pos:end="187:33">=</operator> <name pos:start="187:35" pos:end="187:56">cast128_decrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="189:9" pos:end="189:59"><expr pos:start="189:9" pos:end="189:58"><name pos:start="189:9" pos:end="189:32"><name pos:start="189:9" pos:end="189:11">ctx</name><operator pos:start="189:12" pos:end="189:13">-&gt;</operator><name pos:start="189:14" pos:end="189:32">alg_encrypt_wrapper</name></name> <operator pos:start="189:34" pos:end="189:34">=</operator> <name pos:start="189:36" pos:end="189:58">cast128_encrypt_wrapper</name></expr>;</expr_stmt>

        <expr_stmt pos:start="191:9" pos:end="191:59"><expr pos:start="191:9" pos:end="191:58"><name pos:start="191:9" pos:end="191:32"><name pos:start="191:9" pos:end="191:11">ctx</name><operator pos:start="191:12" pos:end="191:13">-&gt;</operator><name pos:start="191:14" pos:end="191:32">alg_decrypt_wrapper</name></name> <operator pos:start="191:34" pos:end="191:34">=</operator> <name pos:start="191:36" pos:end="191:58">cast128_decrypt_wrapper</name></expr>;</expr_stmt>



        <expr_stmt pos:start="195:9" pos:end="195:44"><expr pos:start="195:9" pos:end="195:43"><name pos:start="195:9" pos:end="195:22"><name pos:start="195:9" pos:end="195:11">ctx</name><operator pos:start="195:12" pos:end="195:13">-&gt;</operator><name pos:start="195:14" pos:end="195:22">blocksize</name></name> <operator pos:start="195:24" pos:end="195:24">=</operator> <name pos:start="195:26" pos:end="195:43">CAST128_BLOCK_SIZE</name></expr>;</expr_stmt>

        <break pos:start="197:9" pos:end="197:14">break;</break>



    <case pos:start="201:5" pos:end="201:40">case <expr pos:start="201:10" pos:end="201:39"><name pos:start="201:10" pos:end="201:39">QCRYPTO_CIPHER_ALG_SERPENT_128</name></expr>:</case>

    <case pos:start="203:5" pos:end="203:40">case <expr pos:start="203:10" pos:end="203:39"><name pos:start="203:10" pos:end="203:39">QCRYPTO_CIPHER_ALG_SERPENT_192</name></expr>:</case>

    <case pos:start="205:5" pos:end="205:40">case <expr pos:start="205:10" pos:end="205:39"><name pos:start="205:10" pos:end="205:39">QCRYPTO_CIPHER_ALG_SERPENT_256</name></expr>:</case>

        <expr_stmt pos:start="207:9" pos:end="207:49"><expr pos:start="207:9" pos:end="207:48"><name pos:start="207:9" pos:end="207:16"><name pos:start="207:9" pos:end="207:11">ctx</name><operator pos:start="207:12" pos:end="207:13">-&gt;</operator><name pos:start="207:14" pos:end="207:16">ctx</name></name> <operator pos:start="207:18" pos:end="207:18">=</operator> <call pos:start="207:20" pos:end="207:48"><name pos:start="207:20" pos:end="207:25">g_new0</name><argument_list pos:start="207:26" pos:end="207:48">(<argument pos:start="207:27" pos:end="207:44"><expr pos:start="207:27" pos:end="207:44">struct <name pos:start="207:34" pos:end="207:44">serpent_ctx</name></expr></argument>, <argument pos:start="207:47" pos:end="207:47"><expr pos:start="207:47" pos:end="207:47"><literal type="number" pos:start="207:47" pos:end="207:47">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <if_stmt pos:start="211:9" pos:end="227:9"><if pos:start="211:9" pos:end="223:9">if <condition pos:start="211:12" pos:end="211:44">(<expr pos:start="211:13" pos:end="211:43"><name pos:start="211:13" pos:end="211:16">mode</name> <operator pos:start="211:18" pos:end="211:19">==</operator> <name pos:start="211:21" pos:end="211:43">QCRYPTO_CIPHER_MODE_XTS</name></expr>)</condition> <block pos:start="211:46" pos:end="223:9">{<block_content pos:start="213:13" pos:end="221:62">

            <expr_stmt pos:start="213:13" pos:end="213:59"><expr pos:start="213:13" pos:end="213:58"><name pos:start="213:13" pos:end="213:26"><name pos:start="213:13" pos:end="213:15">ctx</name><operator pos:start="213:16" pos:end="213:17">-&gt;</operator><name pos:start="213:18" pos:end="213:26">ctx_tweak</name></name> <operator pos:start="213:28" pos:end="213:28">=</operator> <call pos:start="213:30" pos:end="213:58"><name pos:start="213:30" pos:end="213:35">g_new0</name><argument_list pos:start="213:36" pos:end="213:58">(<argument pos:start="213:37" pos:end="213:54"><expr pos:start="213:37" pos:end="213:54">struct <name pos:start="213:44" pos:end="213:54">serpent_ctx</name></expr></argument>, <argument pos:start="213:57" pos:end="213:57"><expr pos:start="213:57" pos:end="213:57"><literal type="number" pos:start="213:57" pos:end="213:57">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



            <expr_stmt pos:start="217:13" pos:end="217:22"><expr pos:start="217:13" pos:end="217:21"><name pos:start="217:13" pos:end="217:16">nkey</name> <operator pos:start="217:18" pos:end="217:19">/=</operator> <literal type="number" pos:start="217:21" pos:end="217:21">2</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="219:13" pos:end="219:49"><expr pos:start="219:13" pos:end="219:48"><call pos:start="219:13" pos:end="219:48"><name pos:start="219:13" pos:end="219:27">serpent_set_key</name><argument_list pos:start="219:28" pos:end="219:48">(<argument pos:start="219:29" pos:end="219:36"><expr pos:start="219:29" pos:end="219:36"><name pos:start="219:29" pos:end="219:36"><name pos:start="219:29" pos:end="219:31">ctx</name><operator pos:start="219:32" pos:end="219:33">-&gt;</operator><name pos:start="219:34" pos:end="219:36">ctx</name></name></expr></argument>, <argument pos:start="219:39" pos:end="219:42"><expr pos:start="219:39" pos:end="219:42"><name pos:start="219:39" pos:end="219:42">nkey</name></expr></argument>, <argument pos:start="219:45" pos:end="219:47"><expr pos:start="219:45" pos:end="219:47"><name pos:start="219:45" pos:end="219:47">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="221:13" pos:end="221:62"><expr pos:start="221:13" pos:end="221:61"><call pos:start="221:13" pos:end="221:61"><name pos:start="221:13" pos:end="221:27">serpent_set_key</name><argument_list pos:start="221:28" pos:end="221:61">(<argument pos:start="221:29" pos:end="221:42"><expr pos:start="221:29" pos:end="221:42"><name pos:start="221:29" pos:end="221:42"><name pos:start="221:29" pos:end="221:31">ctx</name><operator pos:start="221:32" pos:end="221:33">-&gt;</operator><name pos:start="221:34" pos:end="221:42">ctx_tweak</name></name></expr></argument>, <argument pos:start="221:45" pos:end="221:48"><expr pos:start="221:45" pos:end="221:48"><name pos:start="221:45" pos:end="221:48">nkey</name></expr></argument>, <argument pos:start="221:51" pos:end="221:60"><expr pos:start="221:51" pos:end="221:60"><name pos:start="221:51" pos:end="221:53">key</name> <operator pos:start="221:55" pos:end="221:55">+</operator> <name pos:start="221:57" pos:end="221:60">nkey</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></if> <else pos:start="223:11" pos:end="227:9">else <block pos:start="223:16" pos:end="227:9">{<block_content pos:start="225:13" pos:end="225:49">

            <expr_stmt pos:start="225:13" pos:end="225:49"><expr pos:start="225:13" pos:end="225:48"><call pos:start="225:13" pos:end="225:48"><name pos:start="225:13" pos:end="225:27">serpent_set_key</name><argument_list pos:start="225:28" pos:end="225:48">(<argument pos:start="225:29" pos:end="225:36"><expr pos:start="225:29" pos:end="225:36"><name pos:start="225:29" pos:end="225:36"><name pos:start="225:29" pos:end="225:31">ctx</name><operator pos:start="225:32" pos:end="225:33">-&gt;</operator><name pos:start="225:34" pos:end="225:36">ctx</name></name></expr></argument>, <argument pos:start="225:39" pos:end="225:42"><expr pos:start="225:39" pos:end="225:42"><name pos:start="225:39" pos:end="225:42">nkey</name></expr></argument>, <argument pos:start="225:45" pos:end="225:47"><expr pos:start="225:45" pos:end="225:47"><name pos:start="225:45" pos:end="225:47">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></else></if_stmt>



        <expr_stmt pos:start="231:9" pos:end="231:57"><expr pos:start="231:9" pos:end="231:56"><name pos:start="231:9" pos:end="231:31"><name pos:start="231:9" pos:end="231:11">ctx</name><operator pos:start="231:12" pos:end="231:13">-&gt;</operator><name pos:start="231:14" pos:end="231:31">alg_encrypt_native</name></name> <operator pos:start="231:33" pos:end="231:33">=</operator> <name pos:start="231:35" pos:end="231:56">serpent_encrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="233:9" pos:end="233:57"><expr pos:start="233:9" pos:end="233:56"><name pos:start="233:9" pos:end="233:31"><name pos:start="233:9" pos:end="233:11">ctx</name><operator pos:start="233:12" pos:end="233:13">-&gt;</operator><name pos:start="233:14" pos:end="233:31">alg_decrypt_native</name></name> <operator pos:start="233:33" pos:end="233:33">=</operator> <name pos:start="233:35" pos:end="233:56">serpent_decrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="235:9" pos:end="235:59"><expr pos:start="235:9" pos:end="235:58"><name pos:start="235:9" pos:end="235:32"><name pos:start="235:9" pos:end="235:11">ctx</name><operator pos:start="235:12" pos:end="235:13">-&gt;</operator><name pos:start="235:14" pos:end="235:32">alg_encrypt_wrapper</name></name> <operator pos:start="235:34" pos:end="235:34">=</operator> <name pos:start="235:36" pos:end="235:58">serpent_encrypt_wrapper</name></expr>;</expr_stmt>

        <expr_stmt pos:start="237:9" pos:end="237:59"><expr pos:start="237:9" pos:end="237:58"><name pos:start="237:9" pos:end="237:32"><name pos:start="237:9" pos:end="237:11">ctx</name><operator pos:start="237:12" pos:end="237:13">-&gt;</operator><name pos:start="237:14" pos:end="237:32">alg_decrypt_wrapper</name></name> <operator pos:start="237:34" pos:end="237:34">=</operator> <name pos:start="237:36" pos:end="237:58">serpent_decrypt_wrapper</name></expr>;</expr_stmt>



        <expr_stmt pos:start="241:9" pos:end="241:44"><expr pos:start="241:9" pos:end="241:43"><name pos:start="241:9" pos:end="241:22"><name pos:start="241:9" pos:end="241:11">ctx</name><operator pos:start="241:12" pos:end="241:13">-&gt;</operator><name pos:start="241:14" pos:end="241:22">blocksize</name></name> <operator pos:start="241:24" pos:end="241:24">=</operator> <name pos:start="241:26" pos:end="241:43">SERPENT_BLOCK_SIZE</name></expr>;</expr_stmt>

        <break pos:start="243:9" pos:end="243:14">break;</break>



    <case pos:start="247:5" pos:end="247:40">case <expr pos:start="247:10" pos:end="247:39"><name pos:start="247:10" pos:end="247:39">QCRYPTO_CIPHER_ALG_TWOFISH_128</name></expr>:</case>

    <case pos:start="249:5" pos:end="249:40">case <expr pos:start="249:10" pos:end="249:39"><name pos:start="249:10" pos:end="249:39">QCRYPTO_CIPHER_ALG_TWOFISH_192</name></expr>:</case>

    <case pos:start="251:5" pos:end="251:40">case <expr pos:start="251:10" pos:end="251:39"><name pos:start="251:10" pos:end="251:39">QCRYPTO_CIPHER_ALG_TWOFISH_256</name></expr>:</case>

        <expr_stmt pos:start="253:9" pos:end="253:49"><expr pos:start="253:9" pos:end="253:48"><name pos:start="253:9" pos:end="253:16"><name pos:start="253:9" pos:end="253:11">ctx</name><operator pos:start="253:12" pos:end="253:13">-&gt;</operator><name pos:start="253:14" pos:end="253:16">ctx</name></name> <operator pos:start="253:18" pos:end="253:18">=</operator> <call pos:start="253:20" pos:end="253:48"><name pos:start="253:20" pos:end="253:25">g_new0</name><argument_list pos:start="253:26" pos:end="253:48">(<argument pos:start="253:27" pos:end="253:44"><expr pos:start="253:27" pos:end="253:44">struct <name pos:start="253:34" pos:end="253:44">twofish_ctx</name></expr></argument>, <argument pos:start="253:47" pos:end="253:47"><expr pos:start="253:47" pos:end="253:47"><literal type="number" pos:start="253:47" pos:end="253:47">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <if_stmt pos:start="257:9" pos:end="273:9"><if pos:start="257:9" pos:end="269:9">if <condition pos:start="257:12" pos:end="257:44">(<expr pos:start="257:13" pos:end="257:43"><name pos:start="257:13" pos:end="257:16">mode</name> <operator pos:start="257:18" pos:end="257:19">==</operator> <name pos:start="257:21" pos:end="257:43">QCRYPTO_CIPHER_MODE_XTS</name></expr>)</condition> <block pos:start="257:46" pos:end="269:9">{<block_content pos:start="259:13" pos:end="267:62">

            <expr_stmt pos:start="259:13" pos:end="259:59"><expr pos:start="259:13" pos:end="259:58"><name pos:start="259:13" pos:end="259:26"><name pos:start="259:13" pos:end="259:15">ctx</name><operator pos:start="259:16" pos:end="259:17">-&gt;</operator><name pos:start="259:18" pos:end="259:26">ctx_tweak</name></name> <operator pos:start="259:28" pos:end="259:28">=</operator> <call pos:start="259:30" pos:end="259:58"><name pos:start="259:30" pos:end="259:35">g_new0</name><argument_list pos:start="259:36" pos:end="259:58">(<argument pos:start="259:37" pos:end="259:54"><expr pos:start="259:37" pos:end="259:54">struct <name pos:start="259:44" pos:end="259:54">twofish_ctx</name></expr></argument>, <argument pos:start="259:57" pos:end="259:57"><expr pos:start="259:57" pos:end="259:57"><literal type="number" pos:start="259:57" pos:end="259:57">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



            <expr_stmt pos:start="263:13" pos:end="263:22"><expr pos:start="263:13" pos:end="263:21"><name pos:start="263:13" pos:end="263:16">nkey</name> <operator pos:start="263:18" pos:end="263:19">/=</operator> <literal type="number" pos:start="263:21" pos:end="263:21">2</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="265:13" pos:end="265:49"><expr pos:start="265:13" pos:end="265:48"><call pos:start="265:13" pos:end="265:48"><name pos:start="265:13" pos:end="265:27">twofish_set_key</name><argument_list pos:start="265:28" pos:end="265:48">(<argument pos:start="265:29" pos:end="265:36"><expr pos:start="265:29" pos:end="265:36"><name pos:start="265:29" pos:end="265:36"><name pos:start="265:29" pos:end="265:31">ctx</name><operator pos:start="265:32" pos:end="265:33">-&gt;</operator><name pos:start="265:34" pos:end="265:36">ctx</name></name></expr></argument>, <argument pos:start="265:39" pos:end="265:42"><expr pos:start="265:39" pos:end="265:42"><name pos:start="265:39" pos:end="265:42">nkey</name></expr></argument>, <argument pos:start="265:45" pos:end="265:47"><expr pos:start="265:45" pos:end="265:47"><name pos:start="265:45" pos:end="265:47">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="267:13" pos:end="267:62"><expr pos:start="267:13" pos:end="267:61"><call pos:start="267:13" pos:end="267:61"><name pos:start="267:13" pos:end="267:27">twofish_set_key</name><argument_list pos:start="267:28" pos:end="267:61">(<argument pos:start="267:29" pos:end="267:42"><expr pos:start="267:29" pos:end="267:42"><name pos:start="267:29" pos:end="267:42"><name pos:start="267:29" pos:end="267:31">ctx</name><operator pos:start="267:32" pos:end="267:33">-&gt;</operator><name pos:start="267:34" pos:end="267:42">ctx_tweak</name></name></expr></argument>, <argument pos:start="267:45" pos:end="267:48"><expr pos:start="267:45" pos:end="267:48"><name pos:start="267:45" pos:end="267:48">nkey</name></expr></argument>, <argument pos:start="267:51" pos:end="267:60"><expr pos:start="267:51" pos:end="267:60"><name pos:start="267:51" pos:end="267:53">key</name> <operator pos:start="267:55" pos:end="267:55">+</operator> <name pos:start="267:57" pos:end="267:60">nkey</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></if> <else pos:start="269:11" pos:end="273:9">else <block pos:start="269:16" pos:end="273:9">{<block_content pos:start="271:13" pos:end="271:49">

            <expr_stmt pos:start="271:13" pos:end="271:49"><expr pos:start="271:13" pos:end="271:48"><call pos:start="271:13" pos:end="271:48"><name pos:start="271:13" pos:end="271:27">twofish_set_key</name><argument_list pos:start="271:28" pos:end="271:48">(<argument pos:start="271:29" pos:end="271:36"><expr pos:start="271:29" pos:end="271:36"><name pos:start="271:29" pos:end="271:36"><name pos:start="271:29" pos:end="271:31">ctx</name><operator pos:start="271:32" pos:end="271:33">-&gt;</operator><name pos:start="271:34" pos:end="271:36">ctx</name></name></expr></argument>, <argument pos:start="271:39" pos:end="271:42"><expr pos:start="271:39" pos:end="271:42"><name pos:start="271:39" pos:end="271:42">nkey</name></expr></argument>, <argument pos:start="271:45" pos:end="271:47"><expr pos:start="271:45" pos:end="271:47"><name pos:start="271:45" pos:end="271:47">key</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></else></if_stmt>



        <expr_stmt pos:start="277:9" pos:end="277:57"><expr pos:start="277:9" pos:end="277:56"><name pos:start="277:9" pos:end="277:31"><name pos:start="277:9" pos:end="277:11">ctx</name><operator pos:start="277:12" pos:end="277:13">-&gt;</operator><name pos:start="277:14" pos:end="277:31">alg_encrypt_native</name></name> <operator pos:start="277:33" pos:end="277:33">=</operator> <name pos:start="277:35" pos:end="277:56">twofish_encrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="279:9" pos:end="279:57"><expr pos:start="279:9" pos:end="279:56"><name pos:start="279:9" pos:end="279:31"><name pos:start="279:9" pos:end="279:11">ctx</name><operator pos:start="279:12" pos:end="279:13">-&gt;</operator><name pos:start="279:14" pos:end="279:31">alg_decrypt_native</name></name> <operator pos:start="279:33" pos:end="279:33">=</operator> <name pos:start="279:35" pos:end="279:56">twofish_decrypt_native</name></expr>;</expr_stmt>

        <expr_stmt pos:start="281:9" pos:end="281:59"><expr pos:start="281:9" pos:end="281:58"><name pos:start="281:9" pos:end="281:32"><name pos:start="281:9" pos:end="281:11">ctx</name><operator pos:start="281:12" pos:end="281:13">-&gt;</operator><name pos:start="281:14" pos:end="281:32">alg_encrypt_wrapper</name></name> <operator pos:start="281:34" pos:end="281:34">=</operator> <name pos:start="281:36" pos:end="281:58">twofish_encrypt_wrapper</name></expr>;</expr_stmt>

        <expr_stmt pos:start="283:9" pos:end="283:59"><expr pos:start="283:9" pos:end="283:58"><name pos:start="283:9" pos:end="283:32"><name pos:start="283:9" pos:end="283:11">ctx</name><operator pos:start="283:12" pos:end="283:13">-&gt;</operator><name pos:start="283:14" pos:end="283:32">alg_decrypt_wrapper</name></name> <operator pos:start="283:34" pos:end="283:34">=</operator> <name pos:start="283:36" pos:end="283:58">twofish_decrypt_wrapper</name></expr>;</expr_stmt>



        <expr_stmt pos:start="287:9" pos:end="287:44"><expr pos:start="287:9" pos:end="287:43"><name pos:start="287:9" pos:end="287:22"><name pos:start="287:9" pos:end="287:11">ctx</name><operator pos:start="287:12" pos:end="287:13">-&gt;</operator><name pos:start="287:14" pos:end="287:22">blocksize</name></name> <operator pos:start="287:24" pos:end="287:24">=</operator> <name pos:start="287:26" pos:end="287:43">TWOFISH_BLOCK_SIZE</name></expr>;</expr_stmt>

        <break pos:start="289:9" pos:end="289:14">break;</break>



    <default pos:start="293:5" pos:end="293:12">default:</default>

        <expr_stmt pos:start="295:9" pos:end="297:55"><expr pos:start="295:9" pos:end="297:54"><call pos:start="295:9" pos:end="297:54"><name pos:start="295:9" pos:end="295:18">error_setg</name><argument_list pos:start="295:19" pos:end="297:54">(<argument pos:start="295:20" pos:end="295:23"><expr pos:start="295:20" pos:end="295:23"><name pos:start="295:20" pos:end="295:23">errp</name></expr></argument>, <argument pos:start="295:26" pos:end="295:58"><expr pos:start="295:26" pos:end="295:58"><literal type="string" pos:start="295:26" pos:end="295:58">"Unsupported cipher algorithm %s"</literal></expr></argument>,

                   <argument pos:start="297:20" pos:end="297:53"><expr pos:start="297:20" pos:end="297:53"><name pos:start="297:20" pos:end="297:53"><name pos:start="297:20" pos:end="297:48">QCryptoCipherAlgorithm_lookup</name><index pos:start="297:49" pos:end="297:53">[<expr pos:start="297:50" pos:end="297:52"><name pos:start="297:50" pos:end="297:52">alg</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <goto pos:start="299:9" pos:end="299:19">goto <name pos:start="299:14" pos:end="299:18">error</name>;</goto>

    </block_content>}</block></switch>



    <if_stmt pos:start="305:5" pos:end="315:5"><if pos:start="305:5" pos:end="315:5">if <condition pos:start="305:8" pos:end="307:41">(<expr pos:start="305:9" pos:end="307:40"><name pos:start="305:9" pos:end="305:12">mode</name> <operator pos:start="305:14" pos:end="305:15">==</operator> <name pos:start="305:17" pos:end="305:39">QCRYPTO_CIPHER_MODE_XTS</name> <operator pos:start="305:41" pos:end="305:42">&amp;&amp;</operator>

        <name pos:start="307:9" pos:end="307:22"><name pos:start="307:9" pos:end="307:11">ctx</name><operator pos:start="307:12" pos:end="307:13">-&gt;</operator><name pos:start="307:14" pos:end="307:22">blocksize</name></name> <operator pos:start="307:24" pos:end="307:25">!=</operator> <name pos:start="307:27" pos:end="307:40">XTS_BLOCK_SIZE</name></expr>)</condition> <block pos:start="307:43" pos:end="315:5">{<block_content pos:start="309:9" pos:end="313:19">

        <expr_stmt pos:start="309:9" pos:end="311:51"><expr pos:start="309:9" pos:end="311:50"><call pos:start="309:9" pos:end="311:50"><name pos:start="309:9" pos:end="309:18">error_setg</name><argument_list pos:start="309:19" pos:end="311:50">(<argument pos:start="309:20" pos:end="309:23"><expr pos:start="309:20" pos:end="309:23"><name pos:start="309:20" pos:end="309:23">errp</name></expr></argument>, <argument pos:start="309:26" pos:end="309:77"><expr pos:start="309:26" pos:end="309:77"><literal type="string" pos:start="309:26" pos:end="309:77">"Cipher block size %zu must equal XTS block size %d"</literal></expr></argument>,

                   <argument pos:start="311:20" pos:end="311:33"><expr pos:start="311:20" pos:end="311:33"><name pos:start="311:20" pos:end="311:33"><name pos:start="311:20" pos:end="311:22">ctx</name><operator pos:start="311:23" pos:end="311:24">-&gt;</operator><name pos:start="311:25" pos:end="311:33">blocksize</name></name></expr></argument>, <argument pos:start="311:36" pos:end="311:49"><expr pos:start="311:36" pos:end="311:49"><name pos:start="311:36" pos:end="311:49">XTS_BLOCK_SIZE</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <goto pos:start="313:9" pos:end="313:19">goto <name pos:start="313:14" pos:end="313:18">error</name>;</goto>

    </block_content>}</block></if></if_stmt>



    <expr_stmt pos:start="319:5" pos:end="319:46"><expr pos:start="319:5" pos:end="319:45"><name pos:start="319:5" pos:end="319:11"><name pos:start="319:5" pos:end="319:7">ctx</name><operator pos:start="319:8" pos:end="319:9">-&gt;</operator><name pos:start="319:10" pos:end="319:11">iv</name></name> <operator pos:start="319:13" pos:end="319:13">=</operator> <call pos:start="319:15" pos:end="319:45"><name pos:start="319:15" pos:end="319:20">g_new0</name><argument_list pos:start="319:21" pos:end="319:45">(<argument pos:start="319:22" pos:end="319:28"><expr pos:start="319:22" pos:end="319:28"><name pos:start="319:22" pos:end="319:28">uint8_t</name></expr></argument>, <argument pos:start="319:31" pos:end="319:44"><expr pos:start="319:31" pos:end="319:44"><name pos:start="319:31" pos:end="319:44"><name pos:start="319:31" pos:end="319:33">ctx</name><operator pos:start="319:34" pos:end="319:35">-&gt;</operator><name pos:start="319:36" pos:end="319:44">blocksize</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="321:5" pos:end="321:25"><expr pos:start="321:5" pos:end="321:24"><name pos:start="321:5" pos:end="321:18"><name pos:start="321:5" pos:end="321:10">cipher</name><operator pos:start="321:11" pos:end="321:12">-&gt;</operator><name pos:start="321:13" pos:end="321:18">opaque</name></name> <operator pos:start="321:20" pos:end="321:20">=</operator> <name pos:start="321:22" pos:end="321:24">ctx</name></expr>;</expr_stmt>



    <return pos:start="325:5" pos:end="325:18">return <expr pos:start="325:12" pos:end="325:17"><name pos:start="325:12" pos:end="325:17">cipher</name></expr>;</return>



 <label pos:start="329:2" pos:end="329:7"><name pos:start="329:2" pos:end="329:6">error</name>:</label>

    <expr_stmt pos:start="331:5" pos:end="331:19"><expr pos:start="331:5" pos:end="331:18"><call pos:start="331:5" pos:end="331:18"><name pos:start="331:5" pos:end="331:10">g_free</name><argument_list pos:start="331:11" pos:end="331:18">(<argument pos:start="331:12" pos:end="331:17"><expr pos:start="331:12" pos:end="331:17"><name pos:start="331:12" pos:end="331:17">cipher</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="333:5" pos:end="333:16"><expr pos:start="333:5" pos:end="333:15"><call pos:start="333:5" pos:end="333:15"><name pos:start="333:5" pos:end="333:10">g_free</name><argument_list pos:start="333:11" pos:end="333:15">(<argument pos:start="333:12" pos:end="333:14"><expr pos:start="333:12" pos:end="333:14"><name pos:start="333:12" pos:end="333:14">ctx</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <return pos:start="335:5" pos:end="335:16">return <expr pos:start="335:12" pos:end="335:15"><name pos:start="335:12" pos:end="335:15">NULL</name></expr>;</return>

</block_content>}</block></function>
</unit>
