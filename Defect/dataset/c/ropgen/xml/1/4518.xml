<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/1/4518.c" pos:tabs="8"><function pos:start="1:1" pos:end="42:26"><type pos:start="1:1" pos:end="1:4"><name pos:start="1:1" pos:end="1:4">void</name></type> <name pos:start="1:6" pos:end="1:26">helper_booke206_tlbwe</name><parameter_list pos:start="1:27" pos:end="1:32">(<parameter pos:start="1:28" pos:end="1:31"><decl pos:start="1:28" pos:end="1:31"><type pos:start="1:28" pos:end="1:31"><name pos:start="1:28" pos:end="1:31">void</name></type></decl></parameter>)</parameter_list>
<block pos:start="2:1" pos:end="42:26">{<block_content pos:start="3:5" pos:end="42:26">
    <decl_stmt pos:start="3:5" pos:end="3:27"><decl pos:start="3:5" pos:end="3:20"><type pos:start="3:5" pos:end="3:12"><name pos:start="3:5" pos:end="3:12">uint32_t</name></type> <name pos:start="3:14" pos:end="3:20">tlbncfg</name></decl>, <decl pos:start="3:23" pos:end="3:26"><type ref="prev" pos:start="3:5" pos:end="3:12"/><name pos:start="3:23" pos:end="3:26">tlbn</name></decl>;</decl_stmt>
    <decl_stmt pos:start="4:5" pos:end="4:22"><decl pos:start="4:5" pos:end="4:21"><type pos:start="4:5" pos:end="4:18"><name pos:start="4:5" pos:end="4:16">ppcmas_tlb_t</name> <modifier pos:start="4:18" pos:end="4:18">*</modifier></type><name pos:start="4:19" pos:end="4:21">tlb</name></decl>;</decl_stmt>
    <decl_stmt pos:start="5:5" pos:end="5:31"><decl pos:start="5:5" pos:end="5:21"><type pos:start="5:5" pos:end="5:12"><name pos:start="5:5" pos:end="5:12">uint32_t</name></type> <name pos:start="5:14" pos:end="5:21">size_tlb</name></decl>, <decl pos:start="5:24" pos:end="5:30"><type ref="prev" pos:start="5:5" pos:end="5:12"/><name pos:start="5:24" pos:end="5:30">size_ps</name></decl>;</decl_stmt>
    <switch pos:start="6:5" pos:end="42:26">switch <condition pos:start="6:12" pos:end="6:52">(<expr pos:start="6:13" pos:end="6:51"><name pos:start="6:13" pos:end="6:36"><name pos:start="6:13" pos:end="6:15">env</name><operator pos:start="6:16" pos:end="6:17">-&gt;</operator><name pos:start="6:18" pos:end="6:20">spr</name><index pos:start="6:21" pos:end="6:36">[<expr pos:start="6:22" pos:end="6:35"><name pos:start="6:22" pos:end="6:35">SPR_BOOKE_MAS0</name></expr>]</index></name> <operator pos:start="6:38" pos:end="6:38">&amp;</operator> <name pos:start="6:40" pos:end="6:51">MAS0_WQ_MASK</name></expr>)</condition> <block pos:start="6:54" pos:end="42:26">{<block_content pos:start="7:5" pos:end="42:26">
    <case pos:start="7:5" pos:end="7:24">case <expr pos:start="7:10" pos:end="7:23"><name pos:start="7:10" pos:end="7:23">MAS0_WQ_ALWAYS</name></expr>:</case>
        <comment type="block" pos:start="8:9" pos:end="8:42">/* good to go, write that entry */</comment>
        <break pos:start="9:9" pos:end="9:14">break;</break>
    <case pos:start="10:5" pos:end="10:22">case <expr pos:start="10:10" pos:end="10:21"><name pos:start="10:10" pos:end="10:21">MAS0_WQ_COND</name></expr>:</case>
        <comment type="block" pos:start="11:9" pos:end="11:35">/* XXX check if reserved */</comment>
        <if_stmt pos:start="12:9" pos:end="42:26"><if pos:start="12:9" pos:end="42:26">if <condition pos:start="12:12" pos:end="12:14">(<expr pos:start="12:13" pos:end="12:13"><literal type="number" pos:start="12:13" pos:end="12:13">0</literal></expr>)</condition> <block pos:start="12:16" pos:end="42:26">{<block_content pos:start="13:13" pos:end="42:26">
            <return pos:start="13:13" pos:end="13:19">return;</return>
        <break pos:start="14:9" pos:end="14:14">break;</break>
    <case pos:start="15:5" pos:end="15:26">case <expr pos:start="15:10" pos:end="15:25"><name pos:start="15:10" pos:end="15:25">MAS0_WQ_CLR_RSRV</name></expr>:</case>
        <comment type="block" pos:start="16:9" pos:end="16:29">/* XXX clear entry */</comment>
        <return pos:start="17:9" pos:end="17:15">return;</return>
    <default pos:start="18:5" pos:end="18:12">default:</default>
        <comment type="block" pos:start="19:9" pos:end="19:32">/* no idea what to do */</comment>
        <return pos:start="20:9" pos:end="20:15">return;</return>
    <if_stmt pos:start="21:5" pos:end="42:26"><if pos:start="21:5" pos:end="42:26">if <condition pos:start="21:8" pos:end="22:17">(<expr pos:start="21:9" pos:end="22:16"><operator pos:start="21:9" pos:end="21:9">(</operator><operator pos:start="21:10" pos:end="21:10">(</operator><name pos:start="21:11" pos:end="21:34"><name pos:start="21:11" pos:end="21:13">env</name><operator pos:start="21:14" pos:end="21:15">-&gt;</operator><name pos:start="21:16" pos:end="21:18">spr</name><index pos:start="21:19" pos:end="21:34">[<expr pos:start="21:20" pos:end="21:33"><name pos:start="21:20" pos:end="21:33">SPR_BOOKE_MAS0</name></expr>]</index></name> <operator pos:start="21:36" pos:end="21:36">&amp;</operator> <name pos:start="21:38" pos:end="21:47">MAS0_ATSEL</name><operator pos:start="21:48" pos:end="21:48">)</operator> <operator pos:start="21:50" pos:end="21:51">==</operator> <name pos:start="21:53" pos:end="21:67">MAS0_ATSEL_LRAT</name><operator pos:start="21:68" pos:end="21:68">)</operator> <operator pos:start="21:70" pos:end="21:71">&amp;&amp;</operator>
         <operator pos:start="22:10" pos:end="22:10">!</operator><name pos:start="22:11" pos:end="22:16">msr_gs</name></expr>)</condition> <block pos:start="22:19" pos:end="42:26">{<block_content pos:start="24:9" pos:end="42:26">
        <comment type="block" pos:start="23:9" pos:end="23:58">/* XXX we don't support direct LRAT setting yet */</comment>
        <expr_stmt pos:start="24:9" pos:end="24:65"><expr pos:start="24:9" pos:end="24:64"><call pos:start="24:9" pos:end="24:64"><name pos:start="24:9" pos:end="24:15">fprintf</name><argument_list pos:start="24:16" pos:end="24:64">(<argument pos:start="24:17" pos:end="24:22"><expr pos:start="24:17" pos:end="24:22"><name pos:start="24:17" pos:end="24:22">stderr</name></expr></argument>, <argument pos:start="24:25" pos:end="24:63"><expr pos:start="24:25" pos:end="24:63"><literal type="string" pos:start="24:25" pos:end="24:63">"cpu: don't support LRAT setting yet\n"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
        <return pos:start="25:9" pos:end="25:15">return;</return>
    <expr_stmt pos:start="26:5" pos:end="26:78"><expr pos:start="26:5" pos:end="26:77"><name pos:start="26:5" pos:end="26:8">tlbn</name> <operator pos:start="26:10" pos:end="26:10">=</operator> <operator pos:start="26:12" pos:end="26:12">(</operator><name pos:start="26:13" pos:end="26:36"><name pos:start="26:13" pos:end="26:15">env</name><operator pos:start="26:16" pos:end="26:17">-&gt;</operator><name pos:start="26:18" pos:end="26:20">spr</name><index pos:start="26:21" pos:end="26:36">[<expr pos:start="26:22" pos:end="26:35"><name pos:start="26:22" pos:end="26:35">SPR_BOOKE_MAS0</name></expr>]</index></name> <operator pos:start="26:38" pos:end="26:38">&amp;</operator> <name pos:start="26:40" pos:end="26:55">MAS0_TLBSEL_MASK</name><operator pos:start="26:56" pos:end="26:56">)</operator> <operator pos:start="26:58" pos:end="26:59">&gt;&gt;</operator> <name pos:start="26:61" pos:end="26:77">MAS0_TLBSEL_SHIFT</name></expr>;</expr_stmt>
    <expr_stmt pos:start="27:5" pos:end="27:49"><expr pos:start="27:5" pos:end="27:48"><name pos:start="27:5" pos:end="27:11">tlbncfg</name> <operator pos:start="27:13" pos:end="27:13">=</operator> <name pos:start="27:15" pos:end="27:48"><name pos:start="27:15" pos:end="27:17">env</name><operator pos:start="27:18" pos:end="27:19">-&gt;</operator><name pos:start="27:20" pos:end="27:22">spr</name><index pos:start="27:23" pos:end="27:48">[<expr pos:start="27:24" pos:end="27:47"><name pos:start="27:24" pos:end="27:40">SPR_BOOKE_TLB0CFG</name> <operator pos:start="27:42" pos:end="27:42">+</operator> <name pos:start="27:44" pos:end="27:47">tlbn</name></expr>]</index></name></expr>;</expr_stmt>
    <expr_stmt pos:start="28:5" pos:end="28:32"><expr pos:start="28:5" pos:end="28:31"><name pos:start="28:5" pos:end="28:7">tlb</name> <operator pos:start="28:9" pos:end="28:9">=</operator> <call pos:start="28:11" pos:end="28:31"><name pos:start="28:11" pos:end="28:26">booke206_cur_tlb</name><argument_list pos:start="28:27" pos:end="28:31">(<argument pos:start="28:28" pos:end="28:30"><expr pos:start="28:28" pos:end="28:30"><name pos:start="28:28" pos:end="28:30">env</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <if_stmt pos:start="29:5" pos:end="42:26"><if pos:start="29:5" pos:end="42:26">if <condition pos:start="29:8" pos:end="29:15">(<expr pos:start="29:9" pos:end="29:14"><name pos:start="29:9" pos:end="29:14">msr_gs</name></expr>)</condition> <block pos:start="29:17" pos:end="42:26">{<block_content pos:start="30:9" pos:end="42:26">
        <expr_stmt pos:start="30:9" pos:end="30:54"><expr pos:start="30:9" pos:end="30:53"><call pos:start="30:9" pos:end="30:53"><name pos:start="30:9" pos:end="30:17">cpu_abort</name><argument_list pos:start="30:18" pos:end="30:53">(<argument pos:start="30:19" pos:end="30:21"><expr pos:start="30:19" pos:end="30:21"><name pos:start="30:19" pos:end="30:21">env</name></expr></argument>, <argument pos:start="30:24" pos:end="30:52"><expr pos:start="30:24" pos:end="30:52"><literal type="string" pos:start="30:24" pos:end="30:52">"missing HV implementation\n"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <expr_stmt pos:start="31:5" pos:end="32:43"><expr pos:start="31:5" pos:end="32:42"><name pos:start="31:5" pos:end="31:15"><name pos:start="31:5" pos:end="31:7">tlb</name><operator pos:start="31:8" pos:end="31:9">-&gt;</operator><name pos:start="31:10" pos:end="31:15">mas7_3</name></name> <operator pos:start="31:17" pos:end="31:17">=</operator> <operator pos:start="31:19" pos:end="31:19">(</operator><operator pos:start="31:20" pos:end="31:20">(</operator><name pos:start="31:21" pos:end="31:28">uint64_t</name><operator pos:start="31:29" pos:end="31:29">)</operator><name pos:start="31:30" pos:end="31:53"><name pos:start="31:30" pos:end="31:32">env</name><operator pos:start="31:33" pos:end="31:34">-&gt;</operator><name pos:start="31:35" pos:end="31:37">spr</name><index pos:start="31:38" pos:end="31:53">[<expr pos:start="31:39" pos:end="31:52"><name pos:start="31:39" pos:end="31:52">SPR_BOOKE_MAS7</name></expr>]</index></name> <operator pos:start="31:55" pos:end="31:56">&lt;&lt;</operator> <literal type="number" pos:start="31:58" pos:end="31:59">32</literal><operator pos:start="31:60" pos:end="31:60">)</operator> <operator pos:start="31:62" pos:end="31:62">|</operator>
                  <name pos:start="32:19" pos:end="32:42"><name pos:start="32:19" pos:end="32:21">env</name><operator pos:start="32:22" pos:end="32:23">-&gt;</operator><name pos:start="32:24" pos:end="32:26">spr</name><index pos:start="32:27" pos:end="32:42">[<expr pos:start="32:28" pos:end="32:41"><name pos:start="32:28" pos:end="32:41">SPR_BOOKE_MAS3</name></expr>]</index></name></expr>;</expr_stmt>
    <expr_stmt pos:start="33:5" pos:end="33:41"><expr pos:start="33:5" pos:end="33:40"><name pos:start="33:5" pos:end="33:13"><name pos:start="33:5" pos:end="33:7">tlb</name><operator pos:start="33:8" pos:end="33:9">-&gt;</operator><name pos:start="33:10" pos:end="33:13">mas1</name></name> <operator pos:start="33:15" pos:end="33:15">=</operator> <name pos:start="33:17" pos:end="33:40"><name pos:start="33:17" pos:end="33:19">env</name><operator pos:start="33:20" pos:end="33:21">-&gt;</operator><name pos:start="33:22" pos:end="33:24">spr</name><index pos:start="33:25" pos:end="33:40">[<expr pos:start="33:26" pos:end="33:39"><name pos:start="33:26" pos:end="33:39">SPR_BOOKE_MAS1</name></expr>]</index></name></expr>;</expr_stmt>
    <comment type="block" pos:start="34:5" pos:end="34:57">/* XXX needs to change when supporting 64-bit e500 */</comment>
    <expr_stmt pos:start="35:5" pos:end="35:54"><expr pos:start="35:5" pos:end="35:53"><name pos:start="35:5" pos:end="35:13"><name pos:start="35:5" pos:end="35:7">tlb</name><operator pos:start="35:8" pos:end="35:9">-&gt;</operator><name pos:start="35:10" pos:end="35:13">mas2</name></name> <operator pos:start="35:15" pos:end="35:15">=</operator> <name pos:start="35:17" pos:end="35:40"><name pos:start="35:17" pos:end="35:19">env</name><operator pos:start="35:20" pos:end="35:21">-&gt;</operator><name pos:start="35:22" pos:end="35:24">spr</name><index pos:start="35:25" pos:end="35:40">[<expr pos:start="35:26" pos:end="35:39"><name pos:start="35:26" pos:end="35:39">SPR_BOOKE_MAS2</name></expr>]</index></name> <operator pos:start="35:42" pos:end="35:42">&amp;</operator> <literal type="number" pos:start="35:44" pos:end="35:53">0xffffffff</literal></expr>;</expr_stmt>
    <if_stmt pos:start="36:5" pos:end="42:26"><if pos:start="36:5" pos:end="42:26">if <condition pos:start="36:8" pos:end="36:35">(<expr pos:start="36:9" pos:end="36:34"><operator pos:start="36:9" pos:end="36:9">!</operator><operator pos:start="36:10" pos:end="36:10">(</operator><name pos:start="36:11" pos:end="36:17">tlbncfg</name> <operator pos:start="36:19" pos:end="36:19">&amp;</operator> <name pos:start="36:21" pos:end="36:33">TLBnCFG_IPROT</name><operator pos:start="36:34" pos:end="36:34">)</operator></expr>)</condition> <block pos:start="36:37" pos:end="42:26">{<block_content pos:start="38:9" pos:end="42:26">
        <comment type="block" pos:start="37:9" pos:end="37:39">/* no IPROT supported by TLB */</comment>
        <expr_stmt pos:start="38:9" pos:end="38:33"><expr pos:start="38:9" pos:end="38:32"><name pos:start="38:9" pos:end="38:17"><name pos:start="38:9" pos:end="38:11">tlb</name><operator pos:start="38:12" pos:end="38:13">-&gt;</operator><name pos:start="38:14" pos:end="38:17">mas1</name></name> <operator pos:start="38:19" pos:end="38:20">&amp;=</operator> <operator pos:start="38:22" pos:end="38:22">~</operator><name pos:start="38:23" pos:end="38:32">MAS1_IPROT</name></expr>;</expr_stmt>
    <if_stmt pos:start="39:5" pos:end="42:26"><if pos:start="39:5" pos:end="41:5">if <condition pos:start="39:8" pos:end="39:64">(<expr pos:start="39:9" pos:end="39:63"><call pos:start="39:9" pos:end="39:43"><name pos:start="39:9" pos:end="39:33">booke206_tlb_to_page_size</name><argument_list pos:start="39:34" pos:end="39:43">(<argument pos:start="39:35" pos:end="39:37"><expr pos:start="39:35" pos:end="39:37"><name pos:start="39:35" pos:end="39:37">env</name></expr></argument>, <argument pos:start="39:40" pos:end="39:42"><expr pos:start="39:40" pos:end="39:42"><name pos:start="39:40" pos:end="39:42">tlb</name></expr></argument>)</argument_list></call> <operator pos:start="39:45" pos:end="39:46">==</operator> <name pos:start="39:48" pos:end="39:63">TARGET_PAGE_SIZE</name></expr>)</condition> <block pos:start="39:66" pos:end="41:5">{<block_content pos:start="40:9" pos:end="40:55">
        <expr_stmt pos:start="40:9" pos:end="40:55"><expr pos:start="40:9" pos:end="40:54"><call pos:start="40:9" pos:end="40:54"><name pos:start="40:9" pos:end="40:22">tlb_flush_page</name><argument_list pos:start="40:23" pos:end="40:54">(<argument pos:start="40:24" pos:end="40:26"><expr pos:start="40:24" pos:end="40:26"><name pos:start="40:24" pos:end="40:26">env</name></expr></argument>, <argument pos:start="40:29" pos:end="40:53"><expr pos:start="40:29" pos:end="40:53"><name pos:start="40:29" pos:end="40:37"><name pos:start="40:29" pos:end="40:31">tlb</name><operator pos:start="40:32" pos:end="40:33">-&gt;</operator><name pos:start="40:34" pos:end="40:37">mas2</name></name> <operator pos:start="40:39" pos:end="40:39">&amp;</operator> <name pos:start="40:41" pos:end="40:53">MAS2_EPN_MASK</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    </block_content>}</block></if> <else pos:start="41:7" pos:end="42:26">else <block pos:start="41:12" pos:end="42:26">{<block_content pos:start="42:9" pos:end="42:26">
        <expr_stmt pos:start="42:9" pos:end="42:26"><expr pos:start="42:9" pos:end="42:25"><call pos:start="42:9" pos:end="42:25"><name pos:start="42:9" pos:end="42:17">tlb_flush</name><argument_list pos:start="42:18" pos:end="42:25">(<argument pos:start="42:19" pos:end="42:21"><expr pos:start="42:19" pos:end="42:21"><name pos:start="42:19" pos:end="42:21">env</name></expr></argument>, <argument pos:start="42:24" pos:end="42:24"><expr pos:start="42:24" pos:end="42:24"><literal type="number" pos:start="42:24" pos:end="42:24">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></else></if_stmt></block_content></block></if></if_stmt></block_content></block></if></if_stmt></block_content></block></if></if_stmt></block_content></block></if></if_stmt></block_content></block></switch></block_content></block></function></unit>
