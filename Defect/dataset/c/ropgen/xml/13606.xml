<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/1/13606.c" pos:tabs="8"><macro pos:start="1:1" pos:end="5:37"><name pos:start="1:1" pos:end="1:20">net_rx_pkt_pull_data</name><argument_list pos:start="1:21" pos:end="5:37">(<argument pos:start="1:22" pos:end="1:41">struct NetRxPkt *pkt</argument>,

                        <argument pos:start="3:25" pos:end="3:47">const struct iovec *iov</argument>, <argument pos:start="3:50" pos:end="3:59">int iovcnt</argument>,

                        <argument pos:start="5:25" pos:end="5:36">size_t ploff</argument>)</argument_list></macro>

<block pos:start="7:1" pos:end="61:1">{<block_content pos:start="9:5" pos:end="59:76">

    <if_stmt pos:start="9:5" pos:end="43:5"><if pos:start="9:5" pos:end="31:5">if <condition pos:start="9:8" pos:end="9:27">(<expr pos:start="9:9" pos:end="9:26"><name pos:start="9:9" pos:end="9:26"><name pos:start="9:9" pos:end="9:11">pkt</name><operator pos:start="9:12" pos:end="9:13">-&gt;</operator><name pos:start="9:14" pos:end="9:26">vlan_stripped</name></name></expr>)</condition> <block pos:start="9:29" pos:end="31:5">{<block_content pos:start="11:9" pos:end="29:66">

        <expr_stmt pos:start="11:9" pos:end="11:50"><expr pos:start="11:9" pos:end="11:49"><call pos:start="11:9" pos:end="11:49"><name pos:start="11:9" pos:end="11:32">net_rx_pkt_iovec_realloc</name><argument_list pos:start="11:33" pos:end="11:49">(<argument pos:start="11:34" pos:end="11:36"><expr pos:start="11:34" pos:end="11:36"><name pos:start="11:34" pos:end="11:36">pkt</name></expr></argument>, <argument pos:start="11:39" pos:end="11:48"><expr pos:start="11:39" pos:end="11:48"><name pos:start="11:39" pos:end="11:44">iovcnt</name> <operator pos:start="11:46" pos:end="11:46">+</operator> <literal type="number" pos:start="11:48" pos:end="11:48">1</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <expr_stmt pos:start="15:9" pos:end="15:45"><expr pos:start="15:9" pos:end="15:44"><name pos:start="15:9" pos:end="15:19"><name pos:start="15:9" pos:end="15:11">pkt</name><operator pos:start="15:12" pos:end="15:13">-&gt;</operator><name pos:start="15:14" pos:end="15:16">vec</name><index pos:start="15:17" pos:end="15:19">[<expr pos:start="15:18" pos:end="15:18"><literal type="number" pos:start="15:18" pos:end="15:18">0</literal></expr>]</index></name><operator pos:start="15:20" pos:end="15:20">.</operator><name pos:start="15:21" pos:end="15:28">iov_base</name> <operator pos:start="15:30" pos:end="15:30">=</operator> <name pos:start="15:32" pos:end="15:44"><name pos:start="15:32" pos:end="15:34">pkt</name><operator pos:start="15:35" pos:end="15:36">-&gt;</operator><name pos:start="15:37" pos:end="15:44">ehdr_buf</name></name></expr>;</expr_stmt>

        <expr_stmt pos:start="17:9" pos:end="17:52"><expr pos:start="17:9" pos:end="17:51"><name pos:start="17:9" pos:end="17:19"><name pos:start="17:9" pos:end="17:11">pkt</name><operator pos:start="17:12" pos:end="17:13">-&gt;</operator><name pos:start="17:14" pos:end="17:16">vec</name><index pos:start="17:17" pos:end="17:19">[<expr pos:start="17:18" pos:end="17:18"><literal type="number" pos:start="17:18" pos:end="17:18">0</literal></expr>]</index></name><operator pos:start="17:20" pos:end="17:20">.</operator><name pos:start="17:21" pos:end="17:27">iov_len</name> <operator pos:start="17:29" pos:end="17:29">=</operator> <sizeof pos:start="17:31" pos:end="17:51">sizeof<argument_list pos:start="17:37" pos:end="17:51">(<argument pos:start="17:38" pos:end="17:50"><expr pos:start="17:38" pos:end="17:50"><name pos:start="17:38" pos:end="17:50"><name pos:start="17:38" pos:end="17:40">pkt</name><operator pos:start="17:41" pos:end="17:42">-&gt;</operator><name pos:start="17:43" pos:end="17:50">ehdr_buf</name></name></expr></argument>)</argument_list></sizeof></expr>;</expr_stmt>



        <expr_stmt pos:start="21:9" pos:end="23:70"><expr pos:start="21:9" pos:end="23:69"><name pos:start="21:9" pos:end="21:20"><name pos:start="21:9" pos:end="21:11">pkt</name><operator pos:start="21:12" pos:end="21:13">-&gt;</operator><name pos:start="21:14" pos:end="21:20">tot_len</name></name> <operator pos:start="21:22" pos:end="21:22">=</operator>

            <call pos:start="23:13" pos:end="23:33"><name pos:start="23:13" pos:end="23:20">iov_size</name><argument_list pos:start="23:21" pos:end="23:33">(<argument pos:start="23:22" pos:end="23:24"><expr pos:start="23:22" pos:end="23:24"><name pos:start="23:22" pos:end="23:24">iov</name></expr></argument>, <argument pos:start="23:27" pos:end="23:32"><expr pos:start="23:27" pos:end="23:32"><name pos:start="23:27" pos:end="23:32">iovcnt</name></expr></argument>)</argument_list></call> <operator pos:start="23:35" pos:end="23:35">-</operator> <name pos:start="23:37" pos:end="23:41">ploff</name> <operator pos:start="23:43" pos:end="23:43">+</operator> <sizeof pos:start="23:45" pos:end="23:69">sizeof<argument_list pos:start="23:51" pos:end="23:69">(<argument pos:start="23:52" pos:end="23:68"><expr pos:start="23:52" pos:end="23:68">struct <name pos:start="23:59" pos:end="23:68">eth_header</name></expr></argument>)</argument_list></sizeof></expr>;</expr_stmt>



        <expr_stmt pos:start="27:9" pos:end="29:66"><expr pos:start="27:9" pos:end="29:65"><name pos:start="27:9" pos:end="27:20"><name pos:start="27:9" pos:end="27:11">pkt</name><operator pos:start="27:12" pos:end="27:13">-&gt;</operator><name pos:start="27:14" pos:end="27:20">vec_len</name></name> <operator pos:start="27:22" pos:end="27:22">=</operator> <call pos:start="27:24" pos:end="29:65"><name pos:start="27:24" pos:end="27:31">iov_copy</name><argument_list pos:start="27:32" pos:end="29:65">(<argument pos:start="27:33" pos:end="27:44"><expr pos:start="27:33" pos:end="27:44"><name pos:start="27:33" pos:end="27:40"><name pos:start="27:33" pos:end="27:35">pkt</name><operator pos:start="27:36" pos:end="27:37">-&gt;</operator><name pos:start="27:38" pos:end="27:40">vec</name></name> <operator pos:start="27:42" pos:end="27:42">+</operator> <literal type="number" pos:start="27:44" pos:end="27:44">1</literal></expr></argument>, <argument pos:start="27:47" pos:end="27:68"><expr pos:start="27:47" pos:end="27:68"><name pos:start="27:47" pos:end="27:64"><name pos:start="27:47" pos:end="27:49">pkt</name><operator pos:start="27:50" pos:end="27:51">-&gt;</operator><name pos:start="27:52" pos:end="27:64">vec_len_total</name></name> <operator pos:start="27:66" pos:end="27:66">-</operator> <literal type="number" pos:start="27:68" pos:end="27:68">1</literal></expr></argument>,

                                <argument pos:start="29:33" pos:end="29:35"><expr pos:start="29:33" pos:end="29:35"><name pos:start="29:33" pos:end="29:35">iov</name></expr></argument>, <argument pos:start="29:38" pos:end="29:43"><expr pos:start="29:38" pos:end="29:43"><name pos:start="29:38" pos:end="29:43">iovcnt</name></expr></argument>, <argument pos:start="29:46" pos:end="29:50"><expr pos:start="29:46" pos:end="29:50"><name pos:start="29:46" pos:end="29:50">ploff</name></expr></argument>, <argument pos:start="29:53" pos:end="29:64"><expr pos:start="29:53" pos:end="29:64"><name pos:start="29:53" pos:end="29:64"><name pos:start="29:53" pos:end="29:55">pkt</name><operator pos:start="29:56" pos:end="29:57">-&gt;</operator><name pos:start="29:58" pos:end="29:64">tot_len</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if> <else pos:start="31:7" pos:end="43:5">else <block pos:start="31:12" pos:end="43:5">{<block_content pos:start="33:9" pos:end="41:66">

        <expr_stmt pos:start="33:9" pos:end="33:46"><expr pos:start="33:9" pos:end="33:45"><call pos:start="33:9" pos:end="33:45"><name pos:start="33:9" pos:end="33:32">net_rx_pkt_iovec_realloc</name><argument_list pos:start="33:33" pos:end="33:45">(<argument pos:start="33:34" pos:end="33:36"><expr pos:start="33:34" pos:end="33:36"><name pos:start="33:34" pos:end="33:36">pkt</name></expr></argument>, <argument pos:start="33:39" pos:end="33:44"><expr pos:start="33:39" pos:end="33:44"><name pos:start="33:39" pos:end="33:44">iovcnt</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <expr_stmt pos:start="37:9" pos:end="37:53"><expr pos:start="37:9" pos:end="37:52"><name pos:start="37:9" pos:end="37:20"><name pos:start="37:9" pos:end="37:11">pkt</name><operator pos:start="37:12" pos:end="37:13">-&gt;</operator><name pos:start="37:14" pos:end="37:20">tot_len</name></name> <operator pos:start="37:22" pos:end="37:22">=</operator> <call pos:start="37:24" pos:end="37:44"><name pos:start="37:24" pos:end="37:31">iov_size</name><argument_list pos:start="37:32" pos:end="37:44">(<argument pos:start="37:33" pos:end="37:35"><expr pos:start="37:33" pos:end="37:35"><name pos:start="37:33" pos:end="37:35">iov</name></expr></argument>, <argument pos:start="37:38" pos:end="37:43"><expr pos:start="37:38" pos:end="37:43"><name pos:start="37:38" pos:end="37:43">iovcnt</name></expr></argument>)</argument_list></call> <operator pos:start="37:46" pos:end="37:46">-</operator> <name pos:start="37:48" pos:end="37:52">ploff</name></expr>;</expr_stmt>

        <expr_stmt pos:start="39:9" pos:end="41:66"><expr pos:start="39:9" pos:end="41:65"><name pos:start="39:9" pos:end="39:20"><name pos:start="39:9" pos:end="39:11">pkt</name><operator pos:start="39:12" pos:end="39:13">-&gt;</operator><name pos:start="39:14" pos:end="39:20">vec_len</name></name> <operator pos:start="39:22" pos:end="39:22">=</operator> <call pos:start="39:24" pos:end="41:65"><name pos:start="39:24" pos:end="39:31">iov_copy</name><argument_list pos:start="39:32" pos:end="41:65">(<argument pos:start="39:33" pos:end="39:40"><expr pos:start="39:33" pos:end="39:40"><name pos:start="39:33" pos:end="39:40"><name pos:start="39:33" pos:end="39:35">pkt</name><operator pos:start="39:36" pos:end="39:37">-&gt;</operator><name pos:start="39:38" pos:end="39:40">vec</name></name></expr></argument>, <argument pos:start="39:43" pos:end="39:60"><expr pos:start="39:43" pos:end="39:60"><name pos:start="39:43" pos:end="39:60"><name pos:start="39:43" pos:end="39:45">pkt</name><operator pos:start="39:46" pos:end="39:47">-&gt;</operator><name pos:start="39:48" pos:end="39:60">vec_len_total</name></name></expr></argument>,

                                <argument pos:start="41:33" pos:end="41:35"><expr pos:start="41:33" pos:end="41:35"><name pos:start="41:33" pos:end="41:35">iov</name></expr></argument>, <argument pos:start="41:38" pos:end="41:43"><expr pos:start="41:38" pos:end="41:43"><name pos:start="41:38" pos:end="41:43">iovcnt</name></expr></argument>, <argument pos:start="41:46" pos:end="41:50"><expr pos:start="41:46" pos:end="41:50"><name pos:start="41:46" pos:end="41:50">ploff</name></expr></argument>, <argument pos:start="41:53" pos:end="41:64"><expr pos:start="41:53" pos:end="41:64"><name pos:start="41:53" pos:end="41:64"><name pos:start="41:53" pos:end="41:55">pkt</name><operator pos:start="41:56" pos:end="41:57">-&gt;</operator><name pos:start="41:58" pos:end="41:64">tot_len</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></else></if_stmt>



    <expr_stmt pos:start="47:5" pos:end="53:78"><expr pos:start="47:5" pos:end="53:77"><call pos:start="47:5" pos:end="53:77"><name pos:start="47:5" pos:end="47:21">eth_get_protocols</name><argument_list pos:start="47:22" pos:end="53:77">(<argument pos:start="47:23" pos:end="47:30"><expr pos:start="47:23" pos:end="47:30"><name pos:start="47:23" pos:end="47:30"><name pos:start="47:23" pos:end="47:25">pkt</name><operator pos:start="47:26" pos:end="47:27">-&gt;</operator><name pos:start="47:28" pos:end="47:30">vec</name></name></expr></argument>, <argument pos:start="47:33" pos:end="47:44"><expr pos:start="47:33" pos:end="47:44"><name pos:start="47:33" pos:end="47:44"><name pos:start="47:33" pos:end="47:35">pkt</name><operator pos:start="47:36" pos:end="47:37">-&gt;</operator><name pos:start="47:38" pos:end="47:44">vec_len</name></name></expr></argument>, <argument pos:start="47:47" pos:end="47:57"><expr pos:start="47:47" pos:end="47:57"><operator pos:start="47:47" pos:end="47:47">&amp;</operator><name pos:start="47:48" pos:end="47:57"><name pos:start="47:48" pos:end="47:50">pkt</name><operator pos:start="47:51" pos:end="47:52">-&gt;</operator><name pos:start="47:53" pos:end="47:57">isip4</name></name></expr></argument>, <argument pos:start="47:60" pos:end="47:70"><expr pos:start="47:60" pos:end="47:70"><operator pos:start="47:60" pos:end="47:60">&amp;</operator><name pos:start="47:61" pos:end="47:70"><name pos:start="47:61" pos:end="47:63">pkt</name><operator pos:start="47:64" pos:end="47:65">-&gt;</operator><name pos:start="47:66" pos:end="47:70">isip6</name></name></expr></argument>,

                      <argument pos:start="49:23" pos:end="49:33"><expr pos:start="49:23" pos:end="49:33"><operator pos:start="49:23" pos:end="49:23">&amp;</operator><name pos:start="49:24" pos:end="49:33"><name pos:start="49:24" pos:end="49:26">pkt</name><operator pos:start="49:27" pos:end="49:28">-&gt;</operator><name pos:start="49:29" pos:end="49:33">isudp</name></name></expr></argument>, <argument pos:start="49:36" pos:end="49:46"><expr pos:start="49:36" pos:end="49:46"><operator pos:start="49:36" pos:end="49:36">&amp;</operator><name pos:start="49:37" pos:end="49:46"><name pos:start="49:37" pos:end="49:39">pkt</name><operator pos:start="49:40" pos:end="49:41">-&gt;</operator><name pos:start="49:42" pos:end="49:46">istcp</name></name></expr></argument>,

                      <argument pos:start="51:23" pos:end="51:37"><expr pos:start="51:23" pos:end="51:37"><operator pos:start="51:23" pos:end="51:23">&amp;</operator><name pos:start="51:24" pos:end="51:37"><name pos:start="51:24" pos:end="51:26">pkt</name><operator pos:start="51:27" pos:end="51:28">-&gt;</operator><name pos:start="51:29" pos:end="51:37">l3hdr_off</name></name></expr></argument>, <argument pos:start="51:40" pos:end="51:54"><expr pos:start="51:40" pos:end="51:54"><operator pos:start="51:40" pos:end="51:40">&amp;</operator><name pos:start="51:41" pos:end="51:54"><name pos:start="51:41" pos:end="51:43">pkt</name><operator pos:start="51:44" pos:end="51:45">-&gt;</operator><name pos:start="51:46" pos:end="51:54">l4hdr_off</name></name></expr></argument>, <argument pos:start="51:57" pos:end="51:71"><expr pos:start="51:57" pos:end="51:71"><operator pos:start="51:57" pos:end="51:57">&amp;</operator><name pos:start="51:58" pos:end="51:71"><name pos:start="51:58" pos:end="51:60">pkt</name><operator pos:start="51:61" pos:end="51:62">-&gt;</operator><name pos:start="51:63" pos:end="51:71">l5hdr_off</name></name></expr></argument>,

                      <argument pos:start="53:23" pos:end="53:39"><expr pos:start="53:23" pos:end="53:39"><operator pos:start="53:23" pos:end="53:23">&amp;</operator><name pos:start="53:24" pos:end="53:39"><name pos:start="53:24" pos:end="53:26">pkt</name><operator pos:start="53:27" pos:end="53:28">-&gt;</operator><name pos:start="53:29" pos:end="53:39">ip6hdr_info</name></name></expr></argument>, <argument pos:start="53:42" pos:end="53:58"><expr pos:start="53:42" pos:end="53:58"><operator pos:start="53:42" pos:end="53:42">&amp;</operator><name pos:start="53:43" pos:end="53:58"><name pos:start="53:43" pos:end="53:45">pkt</name><operator pos:start="53:46" pos:end="53:47">-&gt;</operator><name pos:start="53:48" pos:end="53:58">ip4hdr_info</name></name></expr></argument>, <argument pos:start="53:61" pos:end="53:76"><expr pos:start="53:61" pos:end="53:76"><operator pos:start="53:61" pos:end="53:61">&amp;</operator><name pos:start="53:62" pos:end="53:76"><name pos:start="53:62" pos:end="53:64">pkt</name><operator pos:start="53:65" pos:end="53:66">-&gt;</operator><name pos:start="53:67" pos:end="53:76">l4hdr_info</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <expr_stmt pos:start="57:5" pos:end="59:76"><expr pos:start="57:5" pos:end="59:75"><call pos:start="57:5" pos:end="59:75"><name pos:start="57:5" pos:end="57:27">trace_net_rx_pkt_parsed</name><argument_list pos:start="57:28" pos:end="59:75">(<argument pos:start="57:29" pos:end="57:38"><expr pos:start="57:29" pos:end="57:38"><name pos:start="57:29" pos:end="57:38"><name pos:start="57:29" pos:end="57:31">pkt</name><operator pos:start="57:32" pos:end="57:33">-&gt;</operator><name pos:start="57:34" pos:end="57:38">isip4</name></name></expr></argument>, <argument pos:start="57:41" pos:end="57:50"><expr pos:start="57:41" pos:end="57:50"><name pos:start="57:41" pos:end="57:50"><name pos:start="57:41" pos:end="57:43">pkt</name><operator pos:start="57:44" pos:end="57:45">-&gt;</operator><name pos:start="57:46" pos:end="57:50">isip6</name></name></expr></argument>, <argument pos:start="57:53" pos:end="57:62"><expr pos:start="57:53" pos:end="57:62"><name pos:start="57:53" pos:end="57:62"><name pos:start="57:53" pos:end="57:55">pkt</name><operator pos:start="57:56" pos:end="57:57">-&gt;</operator><name pos:start="57:58" pos:end="57:62">isudp</name></name></expr></argument>, <argument pos:start="57:65" pos:end="57:74"><expr pos:start="57:65" pos:end="57:74"><name pos:start="57:65" pos:end="57:74"><name pos:start="57:65" pos:end="57:67">pkt</name><operator pos:start="57:68" pos:end="57:69">-&gt;</operator><name pos:start="57:70" pos:end="57:74">istcp</name></name></expr></argument>,

                            <argument pos:start="59:29" pos:end="59:42"><expr pos:start="59:29" pos:end="59:42"><name pos:start="59:29" pos:end="59:42"><name pos:start="59:29" pos:end="59:31">pkt</name><operator pos:start="59:32" pos:end="59:33">-&gt;</operator><name pos:start="59:34" pos:end="59:42">l3hdr_off</name></name></expr></argument>, <argument pos:start="59:45" pos:end="59:58"><expr pos:start="59:45" pos:end="59:58"><name pos:start="59:45" pos:end="59:58"><name pos:start="59:45" pos:end="59:47">pkt</name><operator pos:start="59:48" pos:end="59:49">-&gt;</operator><name pos:start="59:50" pos:end="59:58">l4hdr_off</name></name></expr></argument>, <argument pos:start="59:61" pos:end="59:74"><expr pos:start="59:61" pos:end="59:74"><name pos:start="59:61" pos:end="59:74"><name pos:start="59:61" pos:end="59:63">pkt</name><operator pos:start="59:64" pos:end="59:65">-&gt;</operator><name pos:start="59:66" pos:end="59:74">l5hdr_off</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

</block_content>}</block>
</unit>
