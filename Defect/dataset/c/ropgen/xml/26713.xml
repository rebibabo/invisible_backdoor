<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/26713.c" pos:tabs="8"><function pos:start="1:1" pos:end="53:1"><type pos:start="1:1" pos:end="1:10"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:10">int</name></type> <name pos:start="1:12" pos:end="1:36">usbredir_handle_bulk_data</name><parameter_list pos:start="1:37" pos:end="3:49">(<parameter pos:start="1:38" pos:end="1:56"><decl pos:start="1:38" pos:end="1:56"><type pos:start="1:38" pos:end="1:56"><name pos:start="1:38" pos:end="1:51">USBRedirDevice</name> <modifier pos:start="1:53" pos:end="1:53">*</modifier></type><name pos:start="1:54" pos:end="1:56">dev</name></decl></parameter>, <parameter pos:start="1:59" pos:end="1:70"><decl pos:start="1:59" pos:end="1:70"><type pos:start="1:59" pos:end="1:70"><name pos:start="1:59" pos:end="1:67">USBPacket</name> <modifier pos:start="1:69" pos:end="1:69">*</modifier></type><name pos:start="1:70" pos:end="1:70">p</name></decl></parameter>,

                                      <parameter pos:start="3:39" pos:end="3:48"><decl pos:start="3:39" pos:end="3:48"><type pos:start="3:39" pos:end="3:48"><name pos:start="3:39" pos:end="3:45">uint8_t</name></type> <name pos:start="3:47" pos:end="3:48">ep</name></decl></parameter>)</parameter_list>

<block pos:start="5:1" pos:end="53:1">{<block_content pos:start="7:5" pos:end="51:25">

    <decl_stmt pos:start="7:5" pos:end="7:41"><decl pos:start="7:5" pos:end="7:40"><type pos:start="7:5" pos:end="7:14"><name pos:start="7:5" pos:end="7:12">AsyncURB</name> <modifier pos:start="7:14" pos:end="7:14">*</modifier></type><name pos:start="7:15" pos:end="7:18">aurb</name> <init pos:start="7:20" pos:end="7:40">= <expr pos:start="7:22" pos:end="7:40"><call pos:start="7:22" pos:end="7:40"><name pos:start="7:22" pos:end="7:32">async_alloc</name><argument_list pos:start="7:33" pos:end="7:40">(<argument pos:start="7:34" pos:end="7:36"><expr pos:start="7:34" pos:end="7:36"><name pos:start="7:34" pos:end="7:36">dev</name></expr></argument>, <argument pos:start="7:39" pos:end="7:39"><expr pos:start="7:39" pos:end="7:39"><name pos:start="7:39" pos:end="7:39">p</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="9:5" pos:end="9:52"><decl pos:start="9:5" pos:end="9:51"><type pos:start="9:5" pos:end="9:39"><name pos:start="9:5" pos:end="9:39"><name pos:start="9:5" pos:end="9:10">struct</name> <name pos:start="9:12" pos:end="9:39">usb_redir_bulk_packet_header</name></name></type> <name pos:start="9:41" pos:end="9:51">bulk_packet</name></decl>;</decl_stmt>



    <expr_stmt pos:start="13:5" pos:end="15:42"><expr pos:start="13:5" pos:end="15:41"><call pos:start="13:5" pos:end="15:41"><name pos:start="13:5" pos:end="13:11">DPRINTF</name><argument_list pos:start="13:12" pos:end="15:41">(<argument pos:start="13:13" pos:end="13:46"><expr pos:start="13:13" pos:end="13:46"><literal type="string" pos:start="13:13" pos:end="13:46">"bulk-out ep %02X len %zd id %u\n"</literal></expr></argument>, <argument pos:start="13:49" pos:end="13:50"><expr pos:start="13:49" pos:end="13:50"><name pos:start="13:49" pos:end="13:50">ep</name></expr></argument>,

            <argument pos:start="15:13" pos:end="15:23"><expr pos:start="15:13" pos:end="15:23"><name pos:start="15:13" pos:end="15:23"><name pos:start="15:13" pos:end="15:13">p</name><operator pos:start="15:14" pos:end="15:15">-&gt;</operator><name pos:start="15:16" pos:end="15:18">iov</name><operator pos:start="15:19" pos:end="15:19">.</operator><name pos:start="15:20" pos:end="15:23">size</name></name></expr></argument>, <argument pos:start="15:26" pos:end="15:40"><expr pos:start="15:26" pos:end="15:40"><name pos:start="15:26" pos:end="15:40"><name pos:start="15:26" pos:end="15:29">aurb</name><operator pos:start="15:30" pos:end="15:31">-&gt;</operator><name pos:start="15:32" pos:end="15:40">packet_id</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <expr_stmt pos:start="19:5" pos:end="19:31"><expr pos:start="19:5" pos:end="19:30"><name pos:start="19:5" pos:end="19:24"><name pos:start="19:5" pos:end="19:15">bulk_packet</name><operator pos:start="19:16" pos:end="19:16">.</operator><name pos:start="19:17" pos:end="19:24">endpoint</name></name>  <operator pos:start="19:27" pos:end="19:27">=</operator> <name pos:start="19:29" pos:end="19:30">ep</name></expr>;</expr_stmt>

    <expr_stmt pos:start="21:5" pos:end="21:40"><expr pos:start="21:5" pos:end="21:39"><name pos:start="21:5" pos:end="21:22"><name pos:start="21:5" pos:end="21:15">bulk_packet</name><operator pos:start="21:16" pos:end="21:16">.</operator><name pos:start="21:17" pos:end="21:22">length</name></name>    <operator pos:start="21:27" pos:end="21:27">=</operator> <name pos:start="21:29" pos:end="21:39"><name pos:start="21:29" pos:end="21:29">p</name><operator pos:start="21:30" pos:end="21:31">-&gt;</operator><name pos:start="21:32" pos:end="21:34">iov</name><operator pos:start="21:35" pos:end="21:35">.</operator><name pos:start="21:36" pos:end="21:39">size</name></name></expr>;</expr_stmt>

    <expr_stmt pos:start="23:5" pos:end="23:30"><expr pos:start="23:5" pos:end="23:29"><name pos:start="23:5" pos:end="23:25"><name pos:start="23:5" pos:end="23:15">bulk_packet</name><operator pos:start="23:16" pos:end="23:16">.</operator><name pos:start="23:17" pos:end="23:25">stream_id</name></name> <operator pos:start="23:27" pos:end="23:27">=</operator> <literal type="number" pos:start="23:29" pos:end="23:29">0</literal></expr>;</expr_stmt>

    <expr_stmt pos:start="25:5" pos:end="25:36"><expr pos:start="25:5" pos:end="25:35"><name pos:start="25:5" pos:end="25:21"><name pos:start="25:5" pos:end="25:8">aurb</name><operator pos:start="25:9" pos:end="25:10">-&gt;</operator><name pos:start="25:11" pos:end="25:21">bulk_packet</name></name> <operator pos:start="25:23" pos:end="25:23">=</operator> <name pos:start="25:25" pos:end="25:35">bulk_packet</name></expr>;</expr_stmt>



    <if_stmt pos:start="29:5" pos:end="47:5"><if pos:start="29:5" pos:end="35:5">if <condition pos:start="29:8" pos:end="29:24">(<expr pos:start="29:9" pos:end="29:23"><name pos:start="29:9" pos:end="29:10">ep</name> <operator pos:start="29:12" pos:end="29:12">&amp;</operator> <name pos:start="29:14" pos:end="29:23">USB_DIR_IN</name></expr>)</condition> <block pos:start="29:26" pos:end="35:5">{<block_content pos:start="31:9" pos:end="33:63">

        <expr_stmt pos:start="31:9" pos:end="33:63"><expr pos:start="31:9" pos:end="33:62"><call pos:start="31:9" pos:end="33:62"><name pos:start="31:9" pos:end="31:39">usbredirparser_send_bulk_packet</name><argument_list pos:start="31:40" pos:end="33:62">(<argument pos:start="31:41" pos:end="31:51"><expr pos:start="31:41" pos:end="31:51"><name pos:start="31:41" pos:end="31:51"><name pos:start="31:41" pos:end="31:43">dev</name><operator pos:start="31:44" pos:end="31:45">-&gt;</operator><name pos:start="31:46" pos:end="31:51">parser</name></name></expr></argument>, <argument pos:start="31:54" pos:end="31:68"><expr pos:start="31:54" pos:end="31:68"><name pos:start="31:54" pos:end="31:68"><name pos:start="31:54" pos:end="31:57">aurb</name><operator pos:start="31:58" pos:end="31:59">-&gt;</operator><name pos:start="31:60" pos:end="31:68">packet_id</name></name></expr></argument>,

                                        <argument pos:start="33:41" pos:end="33:52"><expr pos:start="33:41" pos:end="33:52"><operator pos:start="33:41" pos:end="33:41">&amp;</operator><name pos:start="33:42" pos:end="33:52">bulk_packet</name></expr></argument>, <argument pos:start="33:55" pos:end="33:58"><expr pos:start="33:55" pos:end="33:58"><name pos:start="33:55" pos:end="33:58">NULL</name></expr></argument>, <argument pos:start="33:61" pos:end="33:61"><expr pos:start="33:61" pos:end="33:61"><literal type="number" pos:start="33:61" pos:end="33:61">0</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if> <else pos:start="35:7" pos:end="47:5">else <block pos:start="35:12" pos:end="47:5">{<block_content pos:start="37:9" pos:end="45:72">

        <decl_stmt pos:start="37:9" pos:end="37:33"><decl pos:start="37:9" pos:end="37:32"><type pos:start="37:9" pos:end="37:15"><name pos:start="37:9" pos:end="37:15">uint8_t</name></type> <name pos:start="37:17" pos:end="37:32"><name pos:start="37:17" pos:end="37:19">buf</name><index pos:start="37:20" pos:end="37:32">[<expr pos:start="37:21" pos:end="37:31"><name pos:start="37:21" pos:end="37:31"><name pos:start="37:21" pos:end="37:21">p</name><operator pos:start="37:22" pos:end="37:23">-&gt;</operator><name pos:start="37:24" pos:end="37:26">iov</name><operator pos:start="37:27" pos:end="37:27">.</operator><name pos:start="37:28" pos:end="37:31">size</name></name></expr>]</index></name></decl>;</decl_stmt>

        <expr_stmt pos:start="39:9" pos:end="39:45"><expr pos:start="39:9" pos:end="39:44"><call pos:start="39:9" pos:end="39:44"><name pos:start="39:9" pos:end="39:23">usb_packet_copy</name><argument_list pos:start="39:24" pos:end="39:44">(<argument pos:start="39:25" pos:end="39:25"><expr pos:start="39:25" pos:end="39:25"><name pos:start="39:25" pos:end="39:25">p</name></expr></argument>, <argument pos:start="39:28" pos:end="39:30"><expr pos:start="39:28" pos:end="39:30"><name pos:start="39:28" pos:end="39:30">buf</name></expr></argument>, <argument pos:start="39:33" pos:end="39:43"><expr pos:start="39:33" pos:end="39:43"><name pos:start="39:33" pos:end="39:43"><name pos:start="39:33" pos:end="39:33">p</name><operator pos:start="39:34" pos:end="39:35">-&gt;</operator><name pos:start="39:36" pos:end="39:38">iov</name><operator pos:start="39:39" pos:end="39:39">.</operator><name pos:start="39:40" pos:end="39:43">size</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="41:9" pos:end="41:67"><expr pos:start="41:9" pos:end="41:66"><call pos:start="41:9" pos:end="41:66"><name pos:start="41:9" pos:end="41:25">usbredir_log_data</name><argument_list pos:start="41:26" pos:end="41:66">(<argument pos:start="41:27" pos:end="41:29"><expr pos:start="41:27" pos:end="41:29"><name pos:start="41:27" pos:end="41:29">dev</name></expr></argument>, <argument pos:start="41:32" pos:end="41:47"><expr pos:start="41:32" pos:end="41:47"><literal type="string" pos:start="41:32" pos:end="41:47">"bulk data out:"</literal></expr></argument>, <argument pos:start="41:50" pos:end="41:52"><expr pos:start="41:50" pos:end="41:52"><name pos:start="41:50" pos:end="41:52">buf</name></expr></argument>, <argument pos:start="41:55" pos:end="41:65"><expr pos:start="41:55" pos:end="41:65"><name pos:start="41:55" pos:end="41:65"><name pos:start="41:55" pos:end="41:55">p</name><operator pos:start="41:56" pos:end="41:57">-&gt;</operator><name pos:start="41:58" pos:end="41:60">iov</name><operator pos:start="41:61" pos:end="41:61">.</operator><name pos:start="41:62" pos:end="41:65">size</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="43:9" pos:end="45:72"><expr pos:start="43:9" pos:end="45:71"><call pos:start="43:9" pos:end="45:71"><name pos:start="43:9" pos:end="43:39">usbredirparser_send_bulk_packet</name><argument_list pos:start="43:40" pos:end="45:71">(<argument pos:start="43:41" pos:end="43:51"><expr pos:start="43:41" pos:end="43:51"><name pos:start="43:41" pos:end="43:51"><name pos:start="43:41" pos:end="43:43">dev</name><operator pos:start="43:44" pos:end="43:45">-&gt;</operator><name pos:start="43:46" pos:end="43:51">parser</name></name></expr></argument>, <argument pos:start="43:54" pos:end="43:68"><expr pos:start="43:54" pos:end="43:68"><name pos:start="43:54" pos:end="43:68"><name pos:start="43:54" pos:end="43:57">aurb</name><operator pos:start="43:58" pos:end="43:59">-&gt;</operator><name pos:start="43:60" pos:end="43:68">packet_id</name></name></expr></argument>,

                                        <argument pos:start="45:41" pos:end="45:52"><expr pos:start="45:41" pos:end="45:52"><operator pos:start="45:41" pos:end="45:41">&amp;</operator><name pos:start="45:42" pos:end="45:52">bulk_packet</name></expr></argument>, <argument pos:start="45:55" pos:end="45:57"><expr pos:start="45:55" pos:end="45:57"><name pos:start="45:55" pos:end="45:57">buf</name></expr></argument>, <argument pos:start="45:60" pos:end="45:70"><expr pos:start="45:60" pos:end="45:70"><name pos:start="45:60" pos:end="45:70"><name pos:start="45:60" pos:end="45:60">p</name><operator pos:start="45:61" pos:end="45:62">-&gt;</operator><name pos:start="45:63" pos:end="45:65">iov</name><operator pos:start="45:66" pos:end="45:66">.</operator><name pos:start="45:67" pos:end="45:70">size</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></else></if_stmt>

    <expr_stmt pos:start="49:5" pos:end="49:41"><expr pos:start="49:5" pos:end="49:40"><call pos:start="49:5" pos:end="49:40"><name pos:start="49:5" pos:end="49:27">usbredirparser_do_write</name><argument_list pos:start="49:28" pos:end="49:40">(<argument pos:start="49:29" pos:end="49:39"><expr pos:start="49:29" pos:end="49:39"><name pos:start="49:29" pos:end="49:39"><name pos:start="49:29" pos:end="49:31">dev</name><operator pos:start="49:32" pos:end="49:33">-&gt;</operator><name pos:start="49:34" pos:end="49:39">parser</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <return pos:start="51:5" pos:end="51:25">return <expr pos:start="51:12" pos:end="51:24"><name pos:start="51:12" pos:end="51:24">USB_RET_ASYNC</name></expr>;</return>

</block_content>}</block></function>
</unit>
