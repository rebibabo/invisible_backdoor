<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/16522.c" pos:tabs="8"><function pos:start="1:1" pos:end="83:1"><type pos:start="1:1" pos:end="1:3"><name pos:start="1:1" pos:end="1:3">int</name></type> <name pos:start="1:5" pos:end="1:24">kvm_irqchip_send_msi</name><parameter_list pos:start="1:25" pos:end="1:53">(<parameter pos:start="1:26" pos:end="1:36"><decl pos:start="1:26" pos:end="1:36"><type pos:start="1:26" pos:end="1:36"><name pos:start="1:26" pos:end="1:33">KVMState</name> <modifier pos:start="1:35" pos:end="1:35">*</modifier></type><name pos:start="1:36" pos:end="1:36">s</name></decl></parameter>, <parameter pos:start="1:39" pos:end="1:52"><decl pos:start="1:39" pos:end="1:52"><type pos:start="1:39" pos:end="1:52"><name pos:start="1:39" pos:end="1:48">MSIMessage</name></type> <name pos:start="1:50" pos:end="1:52">msg</name></decl></parameter>)</parameter_list>

<block pos:start="3:1" pos:end="83:1">{<block_content pos:start="5:5" pos:end="81:48">

    <decl_stmt pos:start="5:5" pos:end="5:23"><decl pos:start="5:5" pos:end="5:22"><type pos:start="5:5" pos:end="5:18"><name pos:start="5:5" pos:end="5:18"><name pos:start="5:5" pos:end="5:10">struct</name> <name pos:start="5:12" pos:end="5:18">kvm_msi</name></name></type> <name pos:start="5:20" pos:end="5:22">msi</name></decl>;</decl_stmt>

    <decl_stmt pos:start="7:5" pos:end="7:23"><decl pos:start="7:5" pos:end="7:22"><type pos:start="7:5" pos:end="7:17"><name pos:start="7:5" pos:end="7:15">KVMMSIRoute</name> <modifier pos:start="7:17" pos:end="7:17">*</modifier></type><name pos:start="7:18" pos:end="7:22">route</name></decl>;</decl_stmt>



    <if_stmt pos:start="11:5" pos:end="27:5"><if pos:start="11:5" pos:end="27:5">if <condition pos:start="11:8" pos:end="11:22">(<expr pos:start="11:9" pos:end="11:21"><name pos:start="11:9" pos:end="11:21"><name pos:start="11:9" pos:end="11:9">s</name><operator pos:start="11:10" pos:end="11:11">-&gt;</operator><name pos:start="11:12" pos:end="11:21">direct_msi</name></name></expr>)</condition> <block pos:start="11:24" pos:end="27:5">{<block_content pos:start="13:9" pos:end="25:53">

        <expr_stmt pos:start="13:9" pos:end="13:47"><expr pos:start="13:9" pos:end="13:46"><name pos:start="13:9" pos:end="13:22"><name pos:start="13:9" pos:end="13:11">msi</name><operator pos:start="13:12" pos:end="13:12">.</operator><name pos:start="13:13" pos:end="13:22">address_lo</name></name> <operator pos:start="13:24" pos:end="13:24">=</operator> <operator pos:start="13:26" pos:end="13:26">(</operator><name pos:start="13:27" pos:end="13:34">uint32_t</name><operator pos:start="13:35" pos:end="13:35">)</operator><name pos:start="13:36" pos:end="13:46"><name pos:start="13:36" pos:end="13:38">msg</name><operator pos:start="13:39" pos:end="13:39">.</operator><name pos:start="13:40" pos:end="13:46">address</name></name></expr>;</expr_stmt>

        <expr_stmt pos:start="15:9" pos:end="15:43"><expr pos:start="15:9" pos:end="15:42"><name pos:start="15:9" pos:end="15:22"><name pos:start="15:9" pos:end="15:11">msi</name><operator pos:start="15:12" pos:end="15:12">.</operator><name pos:start="15:13" pos:end="15:22">address_hi</name></name> <operator pos:start="15:24" pos:end="15:24">=</operator> <name pos:start="15:26" pos:end="15:36"><name pos:start="15:26" pos:end="15:28">msg</name><operator pos:start="15:29" pos:end="15:29">.</operator><name pos:start="15:30" pos:end="15:36">address</name></name> <operator pos:start="15:38" pos:end="15:39">&gt;&gt;</operator> <literal type="number" pos:start="15:41" pos:end="15:42">32</literal></expr>;</expr_stmt>

        <expr_stmt pos:start="17:9" pos:end="17:28"><expr pos:start="17:9" pos:end="17:27"><name pos:start="17:9" pos:end="17:16"><name pos:start="17:9" pos:end="17:11">msi</name><operator pos:start="17:12" pos:end="17:12">.</operator><name pos:start="17:13" pos:end="17:16">data</name></name> <operator pos:start="17:18" pos:end="17:18">=</operator> <name pos:start="17:20" pos:end="17:27"><name pos:start="17:20" pos:end="17:22">msg</name><operator pos:start="17:23" pos:end="17:23">.</operator><name pos:start="17:24" pos:end="17:27">data</name></name></expr>;</expr_stmt>

        <expr_stmt pos:start="19:9" pos:end="19:22"><expr pos:start="19:9" pos:end="19:21"><name pos:start="19:9" pos:end="19:17"><name pos:start="19:9" pos:end="19:11">msi</name><operator pos:start="19:12" pos:end="19:12">.</operator><name pos:start="19:13" pos:end="19:17">flags</name></name> <operator pos:start="19:19" pos:end="19:19">=</operator> <literal type="number" pos:start="19:21" pos:end="19:21">0</literal></expr>;</expr_stmt>

        <expr_stmt pos:start="21:9" pos:end="21:44"><expr pos:start="21:9" pos:end="21:43"><call pos:start="21:9" pos:end="21:43"><name pos:start="21:9" pos:end="21:14">memset</name><argument_list pos:start="21:15" pos:end="21:43">(<argument pos:start="21:16" pos:end="21:22"><expr pos:start="21:16" pos:end="21:22"><name pos:start="21:16" pos:end="21:22"><name pos:start="21:16" pos:end="21:18">msi</name><operator pos:start="21:19" pos:end="21:19">.</operator><name pos:start="21:20" pos:end="21:22">pad</name></name></expr></argument>, <argument pos:start="21:25" pos:end="21:25"><expr pos:start="21:25" pos:end="21:25"><literal type="number" pos:start="21:25" pos:end="21:25">0</literal></expr></argument>, <argument pos:start="21:28" pos:end="21:42"><expr pos:start="21:28" pos:end="21:42"><sizeof pos:start="21:28" pos:end="21:42">sizeof<argument_list pos:start="21:34" pos:end="21:42">(<argument pos:start="21:35" pos:end="21:41"><expr pos:start="21:35" pos:end="21:41"><name pos:start="21:35" pos:end="21:41"><name pos:start="21:35" pos:end="21:37">msi</name><operator pos:start="21:38" pos:end="21:38">.</operator><name pos:start="21:39" pos:end="21:41">pad</name></name></expr></argument>)</argument_list></sizeof></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <return pos:start="25:9" pos:end="25:53">return <expr pos:start="25:16" pos:end="25:52"><call pos:start="25:16" pos:end="25:52"><name pos:start="25:16" pos:end="25:27">kvm_vm_ioctl</name><argument_list pos:start="25:28" pos:end="25:52">(<argument pos:start="25:29" pos:end="25:29"><expr pos:start="25:29" pos:end="25:29"><name pos:start="25:29" pos:end="25:29">s</name></expr></argument>, <argument pos:start="25:32" pos:end="25:45"><expr pos:start="25:32" pos:end="25:45"><name pos:start="25:32" pos:end="25:45">KVM_SIGNAL_MSI</name></expr></argument>, <argument pos:start="25:48" pos:end="25:51"><expr pos:start="25:48" pos:end="25:51"><operator pos:start="25:48" pos:end="25:48">&amp;</operator><name pos:start="25:49" pos:end="25:51">msi</name></expr></argument>)</argument_list></call></expr>;</return>

    </block_content>}</block></if></if_stmt>



    <expr_stmt pos:start="31:5" pos:end="31:41"><expr pos:start="31:5" pos:end="31:40"><name pos:start="31:5" pos:end="31:9">route</name> <operator pos:start="31:11" pos:end="31:11">=</operator> <call pos:start="31:13" pos:end="31:40"><name pos:start="31:13" pos:end="31:32">kvm_lookup_msi_route</name><argument_list pos:start="31:33" pos:end="31:40">(<argument pos:start="31:34" pos:end="31:34"><expr pos:start="31:34" pos:end="31:34"><name pos:start="31:34" pos:end="31:34">s</name></expr></argument>, <argument pos:start="31:37" pos:end="31:39"><expr pos:start="31:37" pos:end="31:39"><name pos:start="31:37" pos:end="31:39">msg</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <if_stmt pos:start="33:5" pos:end="73:5"><if pos:start="33:5" pos:end="73:5">if <condition pos:start="33:8" pos:end="33:15">(<expr pos:start="33:9" pos:end="33:14"><operator pos:start="33:9" pos:end="33:9">!</operator><name pos:start="33:10" pos:end="33:14">route</name></expr>)</condition> <block pos:start="33:17" pos:end="73:5">{<block_content pos:start="35:9" pos:end="71:34">

        <decl_stmt pos:start="35:9" pos:end="35:17"><decl pos:start="35:9" pos:end="35:16"><type pos:start="35:9" pos:end="35:11"><name pos:start="35:9" pos:end="35:11">int</name></type> <name pos:start="35:13" pos:end="35:16">virq</name></decl>;</decl_stmt>



        <expr_stmt pos:start="39:9" pos:end="39:39"><expr pos:start="39:9" pos:end="39:38"><name pos:start="39:9" pos:end="39:12">virq</name> <operator pos:start="39:14" pos:end="39:14">=</operator> <call pos:start="39:16" pos:end="39:38"><name pos:start="39:16" pos:end="39:35">kvm_irqchip_get_virq</name><argument_list pos:start="39:36" pos:end="39:38">(<argument pos:start="39:37" pos:end="39:37"><expr pos:start="39:37" pos:end="39:37"><name pos:start="39:37" pos:end="39:37">s</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="41:9" pos:end="45:9"><if pos:start="41:9" pos:end="45:9">if <condition pos:start="41:12" pos:end="41:21">(<expr pos:start="41:13" pos:end="41:20"><name pos:start="41:13" pos:end="41:16">virq</name> <operator pos:start="41:18" pos:end="41:18">&lt;</operator> <literal type="number" pos:start="41:20" pos:end="41:20">0</literal></expr>)</condition> <block pos:start="41:23" pos:end="45:9">{<block_content pos:start="43:13" pos:end="43:24">

            <return pos:start="43:13" pos:end="43:24">return <expr pos:start="43:20" pos:end="43:23"><name pos:start="43:20" pos:end="43:23">virq</name></expr>;</return>

        </block_content>}</block></if></if_stmt>



        <expr_stmt pos:start="49:9" pos:end="49:46"><expr pos:start="49:9" pos:end="49:45"><name pos:start="49:9" pos:end="49:13">route</name> <operator pos:start="49:15" pos:end="49:15">=</operator> <call pos:start="49:17" pos:end="49:45"><name pos:start="49:17" pos:end="49:24">g_malloc</name><argument_list pos:start="49:25" pos:end="49:45">(<argument pos:start="49:26" pos:end="49:44"><expr pos:start="49:26" pos:end="49:44"><sizeof pos:start="49:26" pos:end="49:44">sizeof<argument_list pos:start="49:32" pos:end="49:44">(<argument pos:start="49:33" pos:end="49:43"><expr pos:start="49:33" pos:end="49:43"><name pos:start="49:33" pos:end="49:43">KVMMSIRoute</name></expr></argument>)</argument_list></sizeof></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <expr_stmt pos:start="51:9" pos:end="51:33"><expr pos:start="51:9" pos:end="51:32"><name pos:start="51:9" pos:end="51:25"><name pos:start="51:9" pos:end="51:13">route</name><operator pos:start="51:14" pos:end="51:15">-&gt;</operator><name pos:start="51:16" pos:end="51:21">kroute</name><operator pos:start="51:22" pos:end="51:22">.</operator><name pos:start="51:23" pos:end="51:25">gsi</name></name> <operator pos:start="51:27" pos:end="51:27">=</operator> <name pos:start="51:29" pos:end="51:32">virq</name></expr>;</expr_stmt>

        <expr_stmt pos:start="53:9" pos:end="53:49"><expr pos:start="53:9" pos:end="53:48"><name pos:start="53:9" pos:end="53:26"><name pos:start="53:9" pos:end="53:13">route</name><operator pos:start="53:14" pos:end="53:15">-&gt;</operator><name pos:start="53:16" pos:end="53:21">kroute</name><operator pos:start="53:22" pos:end="53:22">.</operator><name pos:start="53:23" pos:end="53:26">type</name></name> <operator pos:start="53:28" pos:end="53:28">=</operator> <name pos:start="53:30" pos:end="53:48">KVM_IRQ_ROUTING_MSI</name></expr>;</expr_stmt>

        <expr_stmt pos:start="55:9" pos:end="55:32"><expr pos:start="55:9" pos:end="55:31"><name pos:start="55:9" pos:end="55:27"><name pos:start="55:9" pos:end="55:13">route</name><operator pos:start="55:14" pos:end="55:15">-&gt;</operator><name pos:start="55:16" pos:end="55:21">kroute</name><operator pos:start="55:22" pos:end="55:22">.</operator><name pos:start="55:23" pos:end="55:27">flags</name></name> <operator pos:start="55:29" pos:end="55:29">=</operator> <literal type="number" pos:start="55:31" pos:end="55:31">0</literal></expr>;</expr_stmt>

        <expr_stmt pos:start="57:9" pos:end="57:63"><expr pos:start="57:9" pos:end="57:62"><name pos:start="57:9" pos:end="57:38"><name pos:start="57:9" pos:end="57:13">route</name><operator pos:start="57:14" pos:end="57:15">-&gt;</operator><name pos:start="57:16" pos:end="57:21">kroute</name><operator pos:start="57:22" pos:end="57:22">.</operator><name pos:start="57:23" pos:end="57:23">u</name><operator pos:start="57:24" pos:end="57:24">.</operator><name pos:start="57:25" pos:end="57:27">msi</name><operator pos:start="57:28" pos:end="57:28">.</operator><name pos:start="57:29" pos:end="57:38">address_lo</name></name> <operator pos:start="57:40" pos:end="57:40">=</operator> <operator pos:start="57:42" pos:end="57:42">(</operator><name pos:start="57:43" pos:end="57:50">uint32_t</name><operator pos:start="57:51" pos:end="57:51">)</operator><name pos:start="57:52" pos:end="57:62"><name pos:start="57:52" pos:end="57:54">msg</name><operator pos:start="57:55" pos:end="57:55">.</operator><name pos:start="57:56" pos:end="57:62">address</name></name></expr>;</expr_stmt>

        <expr_stmt pos:start="59:9" pos:end="59:59"><expr pos:start="59:9" pos:end="59:58"><name pos:start="59:9" pos:end="59:38"><name pos:start="59:9" pos:end="59:13">route</name><operator pos:start="59:14" pos:end="59:15">-&gt;</operator><name pos:start="59:16" pos:end="59:21">kroute</name><operator pos:start="59:22" pos:end="59:22">.</operator><name pos:start="59:23" pos:end="59:23">u</name><operator pos:start="59:24" pos:end="59:24">.</operator><name pos:start="59:25" pos:end="59:27">msi</name><operator pos:start="59:28" pos:end="59:28">.</operator><name pos:start="59:29" pos:end="59:38">address_hi</name></name> <operator pos:start="59:40" pos:end="59:40">=</operator> <name pos:start="59:42" pos:end="59:52"><name pos:start="59:42" pos:end="59:44">msg</name><operator pos:start="59:45" pos:end="59:45">.</operator><name pos:start="59:46" pos:end="59:52">address</name></name> <operator pos:start="59:54" pos:end="59:55">&gt;&gt;</operator> <literal type="number" pos:start="59:57" pos:end="59:58">32</literal></expr>;</expr_stmt>

        <expr_stmt pos:start="61:9" pos:end="61:44"><expr pos:start="61:9" pos:end="61:43"><name pos:start="61:9" pos:end="61:32"><name pos:start="61:9" pos:end="61:13">route</name><operator pos:start="61:14" pos:end="61:15">-&gt;</operator><name pos:start="61:16" pos:end="61:21">kroute</name><operator pos:start="61:22" pos:end="61:22">.</operator><name pos:start="61:23" pos:end="61:23">u</name><operator pos:start="61:24" pos:end="61:24">.</operator><name pos:start="61:25" pos:end="61:27">msi</name><operator pos:start="61:28" pos:end="61:28">.</operator><name pos:start="61:29" pos:end="61:32">data</name></name> <operator pos:start="61:34" pos:end="61:34">=</operator> <name pos:start="61:36" pos:end="61:43"><name pos:start="61:36" pos:end="61:38">msg</name><operator pos:start="61:39" pos:end="61:39">.</operator><name pos:start="61:40" pos:end="61:43">data</name></name></expr>;</expr_stmt>



        <expr_stmt pos:start="65:9" pos:end="65:49"><expr pos:start="65:9" pos:end="65:48"><call pos:start="65:9" pos:end="65:48"><name pos:start="65:9" pos:end="65:29">kvm_add_routing_entry</name><argument_list pos:start="65:30" pos:end="65:48">(<argument pos:start="65:31" pos:end="65:31"><expr pos:start="65:31" pos:end="65:31"><name pos:start="65:31" pos:end="65:31">s</name></expr></argument>, <argument pos:start="65:34" pos:end="65:47"><expr pos:start="65:34" pos:end="65:47"><operator pos:start="65:34" pos:end="65:34">&amp;</operator><name pos:start="65:35" pos:end="65:47"><name pos:start="65:35" pos:end="65:39">route</name><operator pos:start="65:40" pos:end="65:41">-&gt;</operator><name pos:start="65:42" pos:end="65:47">kroute</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <expr_stmt pos:start="69:9" pos:end="71:34"><expr pos:start="69:9" pos:end="71:33"><call pos:start="69:9" pos:end="71:33"><name pos:start="69:9" pos:end="69:26">QTAILQ_INSERT_TAIL</name><argument_list pos:start="69:27" pos:end="71:33">(<argument pos:start="69:28" pos:end="69:66"><expr pos:start="69:28" pos:end="69:66"><operator pos:start="69:28" pos:end="69:28">&amp;</operator><name pos:start="69:29" pos:end="69:66"><name pos:start="69:29" pos:end="69:29">s</name><operator pos:start="69:30" pos:end="69:31">-&gt;</operator><name pos:start="69:32" pos:end="69:42">msi_hashtab</name><index pos:start="69:43" pos:end="69:66">[<expr pos:start="69:44" pos:end="69:65"><call pos:start="69:44" pos:end="69:65"><name pos:start="69:44" pos:end="69:55">kvm_hash_msi</name><argument_list pos:start="69:56" pos:end="69:65">(<argument pos:start="69:57" pos:end="69:64"><expr pos:start="69:57" pos:end="69:64"><name pos:start="69:57" pos:end="69:64"><name pos:start="69:57" pos:end="69:59">msg</name><operator pos:start="69:60" pos:end="69:60">.</operator><name pos:start="69:61" pos:end="69:64">data</name></name></expr></argument>)</argument_list></call></expr>]</index></name></expr></argument>, <argument pos:start="69:69" pos:end="69:73"><expr pos:start="69:69" pos:end="69:73"><name pos:start="69:69" pos:end="69:73">route</name></expr></argument>,

                           <argument pos:start="71:28" pos:end="71:32"><expr pos:start="71:28" pos:end="71:32"><name pos:start="71:28" pos:end="71:32">entry</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if></if_stmt>



    <expr_stmt pos:start="77:5" pos:end="77:54"><expr pos:start="77:5" pos:end="77:53"><call pos:start="77:5" pos:end="77:53"><name pos:start="77:5" pos:end="77:10">assert</name><argument_list pos:start="77:11" pos:end="77:53">(<argument pos:start="77:12" pos:end="77:52"><expr pos:start="77:12" pos:end="77:52"><name pos:start="77:12" pos:end="77:29"><name pos:start="77:12" pos:end="77:16">route</name><operator pos:start="77:17" pos:end="77:18">-&gt;</operator><name pos:start="77:19" pos:end="77:24">kroute</name><operator pos:start="77:25" pos:end="77:25">.</operator><name pos:start="77:26" pos:end="77:29">type</name></name> <operator pos:start="77:31" pos:end="77:32">==</operator> <name pos:start="77:34" pos:end="77:52">KVM_IRQ_ROUTING_MSI</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <return pos:start="81:5" pos:end="81:48">return <expr pos:start="81:12" pos:end="81:47"><call pos:start="81:12" pos:end="81:47"><name pos:start="81:12" pos:end="81:22">kvm_set_irq</name><argument_list pos:start="81:23" pos:end="81:47">(<argument pos:start="81:24" pos:end="81:24"><expr pos:start="81:24" pos:end="81:24"><name pos:start="81:24" pos:end="81:24">s</name></expr></argument>, <argument pos:start="81:27" pos:end="81:43"><expr pos:start="81:27" pos:end="81:43"><name pos:start="81:27" pos:end="81:43"><name pos:start="81:27" pos:end="81:31">route</name><operator pos:start="81:32" pos:end="81:33">-&gt;</operator><name pos:start="81:34" pos:end="81:39">kroute</name><operator pos:start="81:40" pos:end="81:40">.</operator><name pos:start="81:41" pos:end="81:43">gsi</name></name></expr></argument>, <argument pos:start="81:46" pos:end="81:46"><expr pos:start="81:46" pos:end="81:46"><literal type="number" pos:start="81:46" pos:end="81:46">1</literal></expr></argument>)</argument_list></call></expr>;</return>

</block_content>}</block></function>
</unit>
