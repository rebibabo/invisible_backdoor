<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/23824.c" pos:tabs="8"><function pos:start="1:1" pos:end="49:1"><type pos:start="1:1" pos:end="1:14"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:14">ssize_t</name></type> <name pos:start="1:16" pos:end="1:29">local_readlink</name><parameter_list pos:start="1:30" pos:end="3:54">(<parameter pos:start="1:31" pos:end="1:47"><decl pos:start="1:31" pos:end="1:47"><type pos:start="1:31" pos:end="1:47"><name pos:start="1:31" pos:end="1:39">FsContext</name> <modifier pos:start="1:41" pos:end="1:41">*</modifier></type><name pos:start="1:42" pos:end="1:47">fs_ctx</name></decl></parameter>, <parameter pos:start="1:50" pos:end="1:66"><decl pos:start="1:50" pos:end="1:66"><type pos:start="1:50" pos:end="1:66"><name pos:start="1:50" pos:end="1:57">V9fsPath</name> <modifier pos:start="1:59" pos:end="1:59">*</modifier></type><name pos:start="1:60" pos:end="1:66">fs_path</name></decl></parameter>,

                              <parameter pos:start="3:31" pos:end="3:39"><decl pos:start="3:31" pos:end="3:39"><type pos:start="3:31" pos:end="3:39"><name pos:start="3:31" pos:end="3:34">char</name> <modifier pos:start="3:36" pos:end="3:36">*</modifier></type><name pos:start="3:37" pos:end="3:39">buf</name></decl></parameter>, <parameter pos:start="3:42" pos:end="3:53"><decl pos:start="3:42" pos:end="3:53"><type pos:start="3:42" pos:end="3:53"><name pos:start="3:42" pos:end="3:47">size_t</name></type> <name pos:start="3:49" pos:end="3:53">bufsz</name></decl></parameter>)</parameter_list>

<block pos:start="5:1" pos:end="49:1">{<block_content pos:start="7:5" pos:end="47:17">

    <decl_stmt pos:start="7:5" pos:end="7:23"><decl pos:start="7:5" pos:end="7:22"><type pos:start="7:5" pos:end="7:11"><name pos:start="7:5" pos:end="7:11">ssize_t</name></type> <name pos:start="7:13" pos:end="7:17">tsize</name> <init pos:start="7:19" pos:end="7:22">= <expr pos:start="7:21" pos:end="7:22"><operator pos:start="7:21" pos:end="7:21">-</operator><literal type="number" pos:start="7:22" pos:end="7:22">1</literal></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="9:5" pos:end="9:26"><decl pos:start="9:5" pos:end="9:25"><type pos:start="9:5" pos:end="9:8"><name pos:start="9:5" pos:end="9:8">char</name></type> <name pos:start="9:10" pos:end="9:25"><name pos:start="9:10" pos:end="9:15">buffer</name><index pos:start="9:16" pos:end="9:25">[<expr pos:start="9:17" pos:end="9:24"><name pos:start="9:17" pos:end="9:24">PATH_MAX</name></expr>]</index></name></decl>;</decl_stmt>

    <decl_stmt pos:start="11:5" pos:end="11:31"><decl pos:start="11:5" pos:end="11:30"><type pos:start="11:5" pos:end="11:10"><name pos:start="11:5" pos:end="11:8">char</name> <modifier pos:start="11:10" pos:end="11:10">*</modifier></type><name pos:start="11:11" pos:end="11:14">path</name> <init pos:start="11:16" pos:end="11:30">= <expr pos:start="11:18" pos:end="11:30"><name pos:start="11:18" pos:end="11:30"><name pos:start="11:18" pos:end="11:24">fs_path</name><operator pos:start="11:25" pos:end="11:26">-&gt;</operator><name pos:start="11:27" pos:end="11:30">data</name></name></expr></init></decl>;</decl_stmt>



    <if_stmt pos:start="15:5" pos:end="45:5"><if pos:start="15:5" pos:end="39:5">if <condition pos:start="15:8" pos:end="17:53">(<expr pos:start="15:9" pos:end="17:52"><operator pos:start="15:9" pos:end="15:9">(</operator><name pos:start="15:10" pos:end="15:29"><name pos:start="15:10" pos:end="15:15">fs_ctx</name><operator pos:start="15:16" pos:end="15:17">-&gt;</operator><name pos:start="15:18" pos:end="15:29">export_flags</name></name> <operator pos:start="15:31" pos:end="15:31">&amp;</operator> <name pos:start="15:33" pos:end="15:46">V9FS_SM_MAPPED</name><operator pos:start="15:47" pos:end="15:47">)</operator> <operator pos:start="15:49" pos:end="15:50">||</operator>

        <operator pos:start="17:9" pos:end="17:9">(</operator><name pos:start="17:10" pos:end="17:29"><name pos:start="17:10" pos:end="17:15">fs_ctx</name><operator pos:start="17:16" pos:end="17:17">-&gt;</operator><name pos:start="17:18" pos:end="17:29">export_flags</name></name> <operator pos:start="17:31" pos:end="17:31">&amp;</operator> <name pos:start="17:33" pos:end="17:51">V9FS_SM_MAPPED_FILE</name><operator pos:start="17:52" pos:end="17:52">)</operator></expr>)</condition> <block pos:start="17:55" pos:end="39:5">{<block_content pos:start="19:9" pos:end="37:21">

        <decl_stmt pos:start="19:9" pos:end="19:15"><decl pos:start="19:9" pos:end="19:14"><type pos:start="19:9" pos:end="19:11"><name pos:start="19:9" pos:end="19:11">int</name></type> <name pos:start="19:13" pos:end="19:14">fd</name></decl>;</decl_stmt>

        <expr_stmt pos:start="21:9" pos:end="21:70"><expr pos:start="21:9" pos:end="21:69"><name pos:start="21:9" pos:end="21:10">fd</name> <operator pos:start="21:12" pos:end="21:12">=</operator> <call pos:start="21:14" pos:end="21:69"><name pos:start="21:14" pos:end="21:17">open</name><argument_list pos:start="21:18" pos:end="21:69">(<argument pos:start="21:19" pos:end="21:45"><expr pos:start="21:19" pos:end="21:45"><call pos:start="21:19" pos:end="21:45"><name pos:start="21:19" pos:end="21:23">rpath</name><argument_list pos:start="21:24" pos:end="21:45">(<argument pos:start="21:25" pos:end="21:30"><expr pos:start="21:25" pos:end="21:30"><name pos:start="21:25" pos:end="21:30">fs_ctx</name></expr></argument>, <argument pos:start="21:33" pos:end="21:36"><expr pos:start="21:33" pos:end="21:36"><name pos:start="21:33" pos:end="21:36">path</name></expr></argument>, <argument pos:start="21:39" pos:end="21:44"><expr pos:start="21:39" pos:end="21:44"><name pos:start="21:39" pos:end="21:44">buffer</name></expr></argument>)</argument_list></call></expr></argument>, <argument pos:start="21:48" pos:end="21:68"><expr pos:start="21:48" pos:end="21:68"><name pos:start="21:48" pos:end="21:55">O_RDONLY</name> <operator pos:start="21:57" pos:end="21:57">|</operator> <name pos:start="21:59" pos:end="21:68">O_NOFOLLOW</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="23:9" pos:end="27:9"><if pos:start="23:9" pos:end="27:9">if <condition pos:start="23:12" pos:end="23:21">(<expr pos:start="23:13" pos:end="23:20"><name pos:start="23:13" pos:end="23:14">fd</name> <operator pos:start="23:16" pos:end="23:17">==</operator> <operator pos:start="23:19" pos:end="23:19">-</operator><literal type="number" pos:start="23:20" pos:end="23:20">1</literal></expr>)</condition> <block pos:start="23:23" pos:end="27:9">{<block_content pos:start="25:13" pos:end="25:22">

            <return pos:start="25:13" pos:end="25:22">return <expr pos:start="25:20" pos:end="25:21"><operator pos:start="25:20" pos:end="25:20">-</operator><literal type="number" pos:start="25:21" pos:end="25:21">1</literal></expr>;</return>

        </block_content>}</block></if></if_stmt>

        <do pos:start="29:9" pos:end="33:48">do <block pos:start="29:12" pos:end="33:9">{<block_content pos:start="31:13" pos:end="31:49">

            <expr_stmt pos:start="31:13" pos:end="31:49"><expr pos:start="31:13" pos:end="31:48"><name pos:start="31:13" pos:end="31:17">tsize</name> <operator pos:start="31:19" pos:end="31:19">=</operator> <call pos:start="31:21" pos:end="31:48"><name pos:start="31:21" pos:end="31:24">read</name><argument_list pos:start="31:25" pos:end="31:48">(<argument pos:start="31:26" pos:end="31:27"><expr pos:start="31:26" pos:end="31:27"><name pos:start="31:26" pos:end="31:27">fd</name></expr></argument>, <argument pos:start="31:30" pos:end="31:40"><expr pos:start="31:30" pos:end="31:40"><operator pos:start="31:30" pos:end="31:30">(</operator><name pos:start="31:31" pos:end="31:34">void</name> <operator pos:start="31:36" pos:end="31:36">*</operator><operator pos:start="31:37" pos:end="31:37">)</operator><name pos:start="31:38" pos:end="31:40">buf</name></expr></argument>, <argument pos:start="31:43" pos:end="31:47"><expr pos:start="31:43" pos:end="31:47"><name pos:start="31:43" pos:end="31:47">bufsz</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block> while <condition pos:start="33:17" pos:end="33:47">(<expr pos:start="33:18" pos:end="33:46"><name pos:start="33:18" pos:end="33:22">tsize</name> <operator pos:start="33:24" pos:end="33:25">==</operator> <operator pos:start="33:27" pos:end="33:27">-</operator><literal type="number" pos:start="33:28" pos:end="33:28">1</literal> <operator pos:start="33:30" pos:end="33:31">&amp;&amp;</operator> <name pos:start="33:33" pos:end="33:37">errno</name> <operator pos:start="33:39" pos:end="33:40">==</operator> <name pos:start="33:42" pos:end="33:46">EINTR</name></expr>)</condition>;</do>

        <expr_stmt pos:start="35:9" pos:end="35:18"><expr pos:start="35:9" pos:end="35:17"><call pos:start="35:9" pos:end="35:17"><name pos:start="35:9" pos:end="35:13">close</name><argument_list pos:start="35:14" pos:end="35:17">(<argument pos:start="35:15" pos:end="35:16"><expr pos:start="35:15" pos:end="35:16"><name pos:start="35:15" pos:end="35:16">fd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <return pos:start="37:9" pos:end="37:21">return <expr pos:start="37:16" pos:end="37:20"><name pos:start="37:16" pos:end="37:20">tsize</name></expr>;</return>

    </block_content>}</block></if> <if type="elseif" pos:start="39:7" pos:end="45:5">else if <condition pos:start="39:15" pos:end="41:53">(<expr pos:start="39:16" pos:end="41:52"><operator pos:start="39:16" pos:end="39:16">(</operator><name pos:start="39:17" pos:end="39:36"><name pos:start="39:17" pos:end="39:22">fs_ctx</name><operator pos:start="39:23" pos:end="39:24">-&gt;</operator><name pos:start="39:25" pos:end="39:36">export_flags</name></name> <operator pos:start="39:38" pos:end="39:38">&amp;</operator> <name pos:start="39:40" pos:end="39:58">V9FS_SM_PASSTHROUGH</name><operator pos:start="39:59" pos:end="39:59">)</operator> <operator pos:start="39:61" pos:end="39:62">||</operator>

               <operator pos:start="41:16" pos:end="41:16">(</operator><name pos:start="41:17" pos:end="41:36"><name pos:start="41:17" pos:end="41:22">fs_ctx</name><operator pos:start="41:23" pos:end="41:24">-&gt;</operator><name pos:start="41:25" pos:end="41:36">export_flags</name></name> <operator pos:start="41:38" pos:end="41:38">&amp;</operator> <name pos:start="41:40" pos:end="41:51">V9FS_SM_NONE</name><operator pos:start="41:52" pos:end="41:52">)</operator></expr>)</condition> <block pos:start="41:55" pos:end="45:5">{<block_content pos:start="43:9" pos:end="43:66">

        <expr_stmt pos:start="43:9" pos:end="43:66"><expr pos:start="43:9" pos:end="43:65"><name pos:start="43:9" pos:end="43:13">tsize</name> <operator pos:start="43:15" pos:end="43:15">=</operator> <call pos:start="43:17" pos:end="43:65"><name pos:start="43:17" pos:end="43:24">readlink</name><argument_list pos:start="43:25" pos:end="43:65">(<argument pos:start="43:26" pos:end="43:52"><expr pos:start="43:26" pos:end="43:52"><call pos:start="43:26" pos:end="43:52"><name pos:start="43:26" pos:end="43:30">rpath</name><argument_list pos:start="43:31" pos:end="43:52">(<argument pos:start="43:32" pos:end="43:37"><expr pos:start="43:32" pos:end="43:37"><name pos:start="43:32" pos:end="43:37">fs_ctx</name></expr></argument>, <argument pos:start="43:40" pos:end="43:43"><expr pos:start="43:40" pos:end="43:43"><name pos:start="43:40" pos:end="43:43">path</name></expr></argument>, <argument pos:start="43:46" pos:end="43:51"><expr pos:start="43:46" pos:end="43:51"><name pos:start="43:46" pos:end="43:51">buffer</name></expr></argument>)</argument_list></call></expr></argument>, <argument pos:start="43:55" pos:end="43:57"><expr pos:start="43:55" pos:end="43:57"><name pos:start="43:55" pos:end="43:57">buf</name></expr></argument>, <argument pos:start="43:60" pos:end="43:64"><expr pos:start="43:60" pos:end="43:64"><name pos:start="43:60" pos:end="43:64">bufsz</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if></if_stmt>

    <return pos:start="47:5" pos:end="47:17">return <expr pos:start="47:12" pos:end="47:16"><name pos:start="47:12" pos:end="47:16">tsize</name></expr>;</return>

</block_content>}</block></function>
</unit>
