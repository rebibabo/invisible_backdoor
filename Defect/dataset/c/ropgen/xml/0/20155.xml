<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/20155.c" pos:tabs="8"><function pos:start="1:1" pos:end="131:1"><type pos:start="1:1" pos:end="1:11"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:11">void</name></type> <name pos:start="1:13" pos:end="1:28">net_init_tap_one</name><parameter_list pos:start="1:29" pos:end="9:64">(<parameter pos:start="1:30" pos:end="1:56"><decl pos:start="1:30" pos:end="1:56"><type pos:start="1:30" pos:end="1:56"><specifier pos:start="1:30" pos:end="1:34">const</specifier> <name pos:start="1:36" pos:end="1:51">NetdevTapOptions</name> <modifier pos:start="1:53" pos:end="1:53">*</modifier></type><name pos:start="1:54" pos:end="1:56">tap</name></decl></parameter>, <parameter pos:start="1:59" pos:end="1:78"><decl pos:start="1:59" pos:end="1:78"><type pos:start="1:59" pos:end="1:78"><name pos:start="1:59" pos:end="1:72">NetClientState</name> <modifier pos:start="1:74" pos:end="1:74">*</modifier></type><name pos:start="1:75" pos:end="1:78">peer</name></decl></parameter>,

                             <parameter pos:start="3:30" pos:end="3:46"><decl pos:start="3:30" pos:end="3:46"><type pos:start="3:30" pos:end="3:46"><specifier pos:start="3:30" pos:end="3:34">const</specifier> <name pos:start="3:36" pos:end="3:39">char</name> <modifier pos:start="3:41" pos:end="3:41">*</modifier></type><name pos:start="3:42" pos:end="3:46">model</name></decl></parameter>, <parameter pos:start="3:49" pos:end="3:64"><decl pos:start="3:49" pos:end="3:64"><type pos:start="3:49" pos:end="3:64"><specifier pos:start="3:49" pos:end="3:53">const</specifier> <name pos:start="3:55" pos:end="3:58">char</name> <modifier pos:start="3:60" pos:end="3:60">*</modifier></type><name pos:start="3:61" pos:end="3:64">name</name></decl></parameter>,

                             <parameter pos:start="5:30" pos:end="5:47"><decl pos:start="5:30" pos:end="5:47"><type pos:start="5:30" pos:end="5:47"><specifier pos:start="5:30" pos:end="5:34">const</specifier> <name pos:start="5:36" pos:end="5:39">char</name> <modifier pos:start="5:41" pos:end="5:41">*</modifier></type><name pos:start="5:42" pos:end="5:47">ifname</name></decl></parameter>, <parameter pos:start="5:50" pos:end="5:67"><decl pos:start="5:50" pos:end="5:67"><type pos:start="5:50" pos:end="5:67"><specifier pos:start="5:50" pos:end="5:54">const</specifier> <name pos:start="5:56" pos:end="5:59">char</name> <modifier pos:start="5:61" pos:end="5:61">*</modifier></type><name pos:start="5:62" pos:end="5:67">script</name></decl></parameter>,

                             <parameter pos:start="7:30" pos:end="7:51"><decl pos:start="7:30" pos:end="7:51"><type pos:start="7:30" pos:end="7:51"><specifier pos:start="7:30" pos:end="7:34">const</specifier> <name pos:start="7:36" pos:end="7:39">char</name> <modifier pos:start="7:41" pos:end="7:41">*</modifier></type><name pos:start="7:42" pos:end="7:51">downscript</name></decl></parameter>, <parameter pos:start="7:54" pos:end="7:76"><decl pos:start="7:54" pos:end="7:76"><type pos:start="7:54" pos:end="7:76"><specifier pos:start="7:54" pos:end="7:58">const</specifier> <name pos:start="7:60" pos:end="7:63">char</name> <modifier pos:start="7:65" pos:end="7:65">*</modifier></type><name pos:start="7:66" pos:end="7:76">vhostfdname</name></decl></parameter>,

                             <parameter pos:start="9:30" pos:end="9:41"><decl pos:start="9:30" pos:end="9:41"><type pos:start="9:30" pos:end="9:41"><name pos:start="9:30" pos:end="9:32">int</name></type> <name pos:start="9:34" pos:end="9:41">vnet_hdr</name></decl></parameter>, <parameter pos:start="9:44" pos:end="9:49"><decl pos:start="9:44" pos:end="9:49"><type pos:start="9:44" pos:end="9:49"><name pos:start="9:44" pos:end="9:46">int</name></type> <name pos:start="9:48" pos:end="9:49">fd</name></decl></parameter>, <parameter pos:start="9:52" pos:end="9:63"><decl pos:start="9:52" pos:end="9:63"><type pos:start="9:52" pos:end="9:63"><name pos:start="9:52" pos:end="9:56">Error</name> <modifier pos:start="9:58" pos:end="9:58">*</modifier><modifier pos:start="9:59" pos:end="9:59">*</modifier></type><name pos:start="9:60" pos:end="9:63">errp</name></decl></parameter>)</parameter_list>

<block pos:start="11:1" pos:end="131:1">{<block_content pos:start="13:5" pos:end="129:5">

    <decl_stmt pos:start="13:5" pos:end="13:22"><decl pos:start="13:5" pos:end="13:21"><type pos:start="13:5" pos:end="13:11"><name pos:start="13:5" pos:end="13:9">Error</name> <modifier pos:start="13:11" pos:end="13:11">*</modifier></type><name pos:start="13:12" pos:end="13:14">err</name> <init pos:start="13:16" pos:end="13:21">= <expr pos:start="13:18" pos:end="13:21"><name pos:start="13:18" pos:end="13:21">NULL</name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="15:5" pos:end="15:67"><decl pos:start="15:5" pos:end="15:66"><type pos:start="15:5" pos:end="15:14"><name pos:start="15:5" pos:end="15:12">TAPState</name> <modifier pos:start="15:14" pos:end="15:14">*</modifier></type><name pos:start="15:15" pos:end="15:15">s</name> <init pos:start="15:17" pos:end="15:66">= <expr pos:start="15:19" pos:end="15:66"><call pos:start="15:19" pos:end="15:66"><name pos:start="15:19" pos:end="15:33">net_tap_fd_init</name><argument_list pos:start="15:34" pos:end="15:66">(<argument pos:start="15:35" pos:end="15:38"><expr pos:start="15:35" pos:end="15:38"><name pos:start="15:35" pos:end="15:38">peer</name></expr></argument>, <argument pos:start="15:41" pos:end="15:45"><expr pos:start="15:41" pos:end="15:45"><name pos:start="15:41" pos:end="15:45">model</name></expr></argument>, <argument pos:start="15:48" pos:end="15:51"><expr pos:start="15:48" pos:end="15:51"><name pos:start="15:48" pos:end="15:51">name</name></expr></argument>, <argument pos:start="15:54" pos:end="15:55"><expr pos:start="15:54" pos:end="15:55"><name pos:start="15:54" pos:end="15:55">fd</name></expr></argument>, <argument pos:start="15:58" pos:end="15:65"><expr pos:start="15:58" pos:end="15:65"><name pos:start="15:58" pos:end="15:65">vnet_hdr</name></expr></argument>)</argument_list></call></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="17:5" pos:end="17:16"><decl pos:start="17:5" pos:end="17:15"><type pos:start="17:5" pos:end="17:7"><name pos:start="17:5" pos:end="17:7">int</name></type> <name pos:start="17:9" pos:end="17:15">vhostfd</name></decl>;</decl_stmt>



    <expr_stmt pos:start="21:5" pos:end="21:37"><expr pos:start="21:5" pos:end="21:36"><call pos:start="21:5" pos:end="21:36"><name pos:start="21:5" pos:end="21:18">tap_set_sndbuf</name><argument_list pos:start="21:19" pos:end="21:36">(<argument pos:start="21:20" pos:end="21:24"><expr pos:start="21:20" pos:end="21:24"><name pos:start="21:20" pos:end="21:24"><name pos:start="21:20" pos:end="21:20">s</name><operator pos:start="21:21" pos:end="21:22">-&gt;</operator><name pos:start="21:23" pos:end="21:24">fd</name></name></expr></argument>, <argument pos:start="21:27" pos:end="21:29"><expr pos:start="21:27" pos:end="21:29"><name pos:start="21:27" pos:end="21:29">tap</name></expr></argument>, <argument pos:start="21:32" pos:end="21:35"><expr pos:start="21:32" pos:end="21:35"><operator pos:start="21:32" pos:end="21:32">&amp;</operator><name pos:start="21:33" pos:end="21:35">err</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <if_stmt pos:start="23:5" pos:end="29:5"><if pos:start="23:5" pos:end="29:5">if <condition pos:start="23:8" pos:end="23:12">(<expr pos:start="23:9" pos:end="23:11"><name pos:start="23:9" pos:end="23:11">err</name></expr>)</condition> <block pos:start="23:14" pos:end="29:5">{<block_content pos:start="25:9" pos:end="27:15">

        <expr_stmt pos:start="25:9" pos:end="25:35"><expr pos:start="25:9" pos:end="25:34"><call pos:start="25:9" pos:end="25:34"><name pos:start="25:9" pos:end="25:23">error_propagate</name><argument_list pos:start="25:24" pos:end="25:34">(<argument pos:start="25:25" pos:end="25:28"><expr pos:start="25:25" pos:end="25:28"><name pos:start="25:25" pos:end="25:28">errp</name></expr></argument>, <argument pos:start="25:31" pos:end="25:33"><expr pos:start="25:31" pos:end="25:33"><name pos:start="25:31" pos:end="25:33">err</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <return pos:start="27:9" pos:end="27:15">return;</return>

    </block_content>}</block></if></if_stmt>



    <if_stmt pos:start="33:5" pos:end="63:5"><if pos:start="33:5" pos:end="37:5">if <condition pos:start="33:8" pos:end="33:36">(<expr pos:start="33:9" pos:end="33:35"><name pos:start="33:9" pos:end="33:19"><name pos:start="33:9" pos:end="33:11">tap</name><operator pos:start="33:12" pos:end="33:13">-&gt;</operator><name pos:start="33:14" pos:end="33:19">has_fd</name></name> <operator pos:start="33:21" pos:end="33:22">||</operator> <name pos:start="33:24" pos:end="33:35"><name pos:start="33:24" pos:end="33:26">tap</name><operator pos:start="33:27" pos:end="33:28">-&gt;</operator><name pos:start="33:29" pos:end="33:35">has_fds</name></name></expr>)</condition> <block pos:start="33:38" pos:end="37:5">{<block_content pos:start="35:9" pos:end="35:70">

        <expr_stmt pos:start="35:9" pos:end="35:70"><expr pos:start="35:9" pos:end="35:69"><call pos:start="35:9" pos:end="35:69"><name pos:start="35:9" pos:end="35:16">snprintf</name><argument_list pos:start="35:17" pos:end="35:69">(<argument pos:start="35:18" pos:end="35:31"><expr pos:start="35:18" pos:end="35:31"><name pos:start="35:18" pos:end="35:31"><name pos:start="35:18" pos:end="35:18">s</name><operator pos:start="35:19" pos:end="35:20">-&gt;</operator><name pos:start="35:21" pos:end="35:22">nc</name><operator pos:start="35:23" pos:end="35:23">.</operator><name pos:start="35:24" pos:end="35:31">info_str</name></name></expr></argument>, <argument pos:start="35:34" pos:end="35:55"><expr pos:start="35:34" pos:end="35:55"><sizeof pos:start="35:34" pos:end="35:55">sizeof<argument_list pos:start="35:40" pos:end="35:55">(<argument pos:start="35:41" pos:end="35:54"><expr pos:start="35:41" pos:end="35:54"><name pos:start="35:41" pos:end="35:54"><name pos:start="35:41" pos:end="35:41">s</name><operator pos:start="35:42" pos:end="35:43">-&gt;</operator><name pos:start="35:44" pos:end="35:45">nc</name><operator pos:start="35:46" pos:end="35:46">.</operator><name pos:start="35:47" pos:end="35:54">info_str</name></name></expr></argument>)</argument_list></sizeof></expr></argument>, <argument pos:start="35:58" pos:end="35:64"><expr pos:start="35:58" pos:end="35:64"><literal type="string" pos:start="35:58" pos:end="35:64">"fd=%d"</literal></expr></argument>, <argument pos:start="35:67" pos:end="35:68"><expr pos:start="35:67" pos:end="35:68"><name pos:start="35:67" pos:end="35:68">fd</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if> <if type="elseif" pos:start="37:7" pos:end="43:5">else if <condition pos:start="37:15" pos:end="37:31">(<expr pos:start="37:16" pos:end="37:30"><name pos:start="37:16" pos:end="37:30"><name pos:start="37:16" pos:end="37:18">tap</name><operator pos:start="37:19" pos:end="37:20">-&gt;</operator><name pos:start="37:21" pos:end="37:30">has_helper</name></name></expr>)</condition> <block pos:start="37:33" pos:end="43:5">{<block_content pos:start="39:9" pos:end="41:30">

        <expr_stmt pos:start="39:9" pos:end="41:30"><expr pos:start="39:9" pos:end="41:29"><call pos:start="39:9" pos:end="41:29"><name pos:start="39:9" pos:end="39:16">snprintf</name><argument_list pos:start="39:17" pos:end="41:29">(<argument pos:start="39:18" pos:end="39:31"><expr pos:start="39:18" pos:end="39:31"><name pos:start="39:18" pos:end="39:31"><name pos:start="39:18" pos:end="39:18">s</name><operator pos:start="39:19" pos:end="39:20">-&gt;</operator><name pos:start="39:21" pos:end="39:22">nc</name><operator pos:start="39:23" pos:end="39:23">.</operator><name pos:start="39:24" pos:end="39:31">info_str</name></name></expr></argument>, <argument pos:start="39:34" pos:end="39:55"><expr pos:start="39:34" pos:end="39:55"><sizeof pos:start="39:34" pos:end="39:55">sizeof<argument_list pos:start="39:40" pos:end="39:55">(<argument pos:start="39:41" pos:end="39:54"><expr pos:start="39:41" pos:end="39:54"><name pos:start="39:41" pos:end="39:54"><name pos:start="39:41" pos:end="39:41">s</name><operator pos:start="39:42" pos:end="39:43">-&gt;</operator><name pos:start="39:44" pos:end="39:45">nc</name><operator pos:start="39:46" pos:end="39:46">.</operator><name pos:start="39:47" pos:end="39:54">info_str</name></name></expr></argument>)</argument_list></sizeof></expr></argument>, <argument pos:start="39:58" pos:end="39:68"><expr pos:start="39:58" pos:end="39:68"><literal type="string" pos:start="39:58" pos:end="39:68">"helper=%s"</literal></expr></argument>,

                 <argument pos:start="41:18" pos:end="41:28"><expr pos:start="41:18" pos:end="41:28"><name pos:start="41:18" pos:end="41:28"><name pos:start="41:18" pos:end="41:20">tap</name><operator pos:start="41:21" pos:end="41:22">-&gt;</operator><name pos:start="41:23" pos:end="41:28">helper</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if> <else pos:start="43:7" pos:end="63:5">else <block pos:start="43:12" pos:end="63:5">{<block_content pos:start="45:9" pos:end="61:9">

        <expr_stmt pos:start="45:9" pos:end="49:29"><expr pos:start="45:9" pos:end="49:28"><call pos:start="45:9" pos:end="49:28"><name pos:start="45:9" pos:end="45:16">snprintf</name><argument_list pos:start="45:17" pos:end="49:28">(<argument pos:start="45:18" pos:end="45:31"><expr pos:start="45:18" pos:end="45:31"><name pos:start="45:18" pos:end="45:31"><name pos:start="45:18" pos:end="45:18">s</name><operator pos:start="45:19" pos:end="45:20">-&gt;</operator><name pos:start="45:21" pos:end="45:22">nc</name><operator pos:start="45:23" pos:end="45:23">.</operator><name pos:start="45:24" pos:end="45:31">info_str</name></name></expr></argument>, <argument pos:start="45:34" pos:end="45:55"><expr pos:start="45:34" pos:end="45:55"><sizeof pos:start="45:34" pos:end="45:55">sizeof<argument_list pos:start="45:40" pos:end="45:55">(<argument pos:start="45:41" pos:end="45:54"><expr pos:start="45:41" pos:end="45:54"><name pos:start="45:41" pos:end="45:54"><name pos:start="45:41" pos:end="45:41">s</name><operator pos:start="45:42" pos:end="45:43">-&gt;</operator><name pos:start="45:44" pos:end="45:45">nc</name><operator pos:start="45:46" pos:end="45:46">.</operator><name pos:start="45:47" pos:end="45:54">info_str</name></name></expr></argument>)</argument_list></sizeof></expr></argument>,

                 <argument pos:start="47:18" pos:end="47:52"><expr pos:start="47:18" pos:end="47:52"><literal type="string" pos:start="47:18" pos:end="47:52">"ifname=%s,script=%s,downscript=%s"</literal></expr></argument>, <argument pos:start="47:55" pos:end="47:60"><expr pos:start="47:55" pos:end="47:60"><name pos:start="47:55" pos:end="47:60">ifname</name></expr></argument>, <argument pos:start="47:63" pos:end="47:68"><expr pos:start="47:63" pos:end="47:68"><name pos:start="47:63" pos:end="47:68">script</name></expr></argument>,

                 <argument pos:start="49:18" pos:end="49:27"><expr pos:start="49:18" pos:end="49:27"><name pos:start="49:18" pos:end="49:27">downscript</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



        <if_stmt pos:start="53:9" pos:end="61:9"><if pos:start="53:9" pos:end="61:9">if <condition pos:start="53:12" pos:end="53:42">(<expr pos:start="53:13" pos:end="53:41"><call pos:start="53:13" pos:end="53:36"><name pos:start="53:13" pos:end="53:18">strcmp</name><argument_list pos:start="53:19" pos:end="53:36">(<argument pos:start="53:20" pos:end="53:29"><expr pos:start="53:20" pos:end="53:29"><name pos:start="53:20" pos:end="53:29">downscript</name></expr></argument>, <argument pos:start="53:32" pos:end="53:35"><expr pos:start="53:32" pos:end="53:35"><literal type="string" pos:start="53:32" pos:end="53:35">"no"</literal></expr></argument>)</argument_list></call> <operator pos:start="53:38" pos:end="53:39">!=</operator> <literal type="number" pos:start="53:41" pos:end="53:41">0</literal></expr>)</condition> <block pos:start="53:44" pos:end="61:9">{<block_content pos:start="55:13" pos:end="59:35">

            <expr_stmt pos:start="55:13" pos:end="55:79"><expr pos:start="55:13" pos:end="55:78"><call pos:start="55:13" pos:end="55:78"><name pos:start="55:13" pos:end="55:20">snprintf</name><argument_list pos:start="55:21" pos:end="55:78">(<argument pos:start="55:22" pos:end="55:35"><expr pos:start="55:22" pos:end="55:35"><name pos:start="55:22" pos:end="55:35"><name pos:start="55:22" pos:end="55:22">s</name><operator pos:start="55:23" pos:end="55:24">-&gt;</operator><name pos:start="55:25" pos:end="55:35">down_script</name></name></expr></argument>, <argument pos:start="55:38" pos:end="55:59"><expr pos:start="55:38" pos:end="55:59"><sizeof pos:start="55:38" pos:end="55:59">sizeof<argument_list pos:start="55:44" pos:end="55:59">(<argument pos:start="55:45" pos:end="55:58"><expr pos:start="55:45" pos:end="55:58"><name pos:start="55:45" pos:end="55:58"><name pos:start="55:45" pos:end="55:45">s</name><operator pos:start="55:46" pos:end="55:47">-&gt;</operator><name pos:start="55:48" pos:end="55:58">down_script</name></name></expr></argument>)</argument_list></sizeof></expr></argument>, <argument pos:start="55:62" pos:end="55:65"><expr pos:start="55:62" pos:end="55:65"><literal type="string" pos:start="55:62" pos:end="55:65">"%s"</literal></expr></argument>, <argument pos:start="55:68" pos:end="55:77"><expr pos:start="55:68" pos:end="55:77"><name pos:start="55:68" pos:end="55:77">downscript</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="57:13" pos:end="59:35"><expr pos:start="57:13" pos:end="59:34"><call pos:start="57:13" pos:end="59:34"><name pos:start="57:13" pos:end="57:20">snprintf</name><argument_list pos:start="57:21" pos:end="59:34">(<argument pos:start="57:22" pos:end="57:39"><expr pos:start="57:22" pos:end="57:39"><name pos:start="57:22" pos:end="57:39"><name pos:start="57:22" pos:end="57:22">s</name><operator pos:start="57:23" pos:end="57:24">-&gt;</operator><name pos:start="57:25" pos:end="57:39">down_script_arg</name></name></expr></argument>, <argument pos:start="57:42" pos:end="57:67"><expr pos:start="57:42" pos:end="57:67"><sizeof pos:start="57:42" pos:end="57:67">sizeof<argument_list pos:start="57:48" pos:end="57:67">(<argument pos:start="57:49" pos:end="57:66"><expr pos:start="57:49" pos:end="57:66"><name pos:start="57:49" pos:end="57:66"><name pos:start="57:49" pos:end="57:49">s</name><operator pos:start="57:50" pos:end="57:51">-&gt;</operator><name pos:start="57:52" pos:end="57:66">down_script_arg</name></name></expr></argument>)</argument_list></sizeof></expr></argument>,

                     <argument pos:start="59:22" pos:end="59:25"><expr pos:start="59:22" pos:end="59:25"><literal type="string" pos:start="59:22" pos:end="59:25">"%s"</literal></expr></argument>, <argument pos:start="59:28" pos:end="59:33"><expr pos:start="59:28" pos:end="59:33"><name pos:start="59:28" pos:end="59:33">ifname</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></if></if_stmt>

    </block_content>}</block></else></if_stmt>



    <if_stmt pos:start="67:5" pos:end="129:5"><if pos:start="67:5" pos:end="125:5">if <condition pos:start="67:8" pos:end="69:64">(<expr pos:start="67:9" pos:end="69:63"><ternary pos:start="67:9" pos:end="69:63"><condition pos:start="67:9" pos:end="67:24"><expr pos:start="67:9" pos:end="67:22"><name pos:start="67:9" pos:end="67:22"><name pos:start="67:9" pos:end="67:11">tap</name><operator pos:start="67:12" pos:end="67:13">-&gt;</operator><name pos:start="67:14" pos:end="67:22">has_vhost</name></name></expr> ?</condition><then pos:start="67:26" pos:end="67:35"> <expr pos:start="67:26" pos:end="67:35"><name pos:start="67:26" pos:end="67:35"><name pos:start="67:26" pos:end="67:28">tap</name><operator pos:start="67:29" pos:end="67:30">-&gt;</operator><name pos:start="67:31" pos:end="67:35">vhost</name></name></expr> </then><else pos:start="67:37" pos:end="69:63">:

        <expr pos:start="69:9" pos:end="69:63"><name pos:start="69:9" pos:end="69:19">vhostfdname</name> <operator pos:start="69:21" pos:end="69:22">||</operator> <operator pos:start="69:24" pos:end="69:24">(</operator><name pos:start="69:25" pos:end="69:43"><name pos:start="69:25" pos:end="69:27">tap</name><operator pos:start="69:28" pos:end="69:29">-&gt;</operator><name pos:start="69:30" pos:end="69:43">has_vhostforce</name></name> <operator pos:start="69:45" pos:end="69:46">&amp;&amp;</operator> <name pos:start="69:48" pos:end="69:62"><name pos:start="69:48" pos:end="69:50">tap</name><operator pos:start="69:51" pos:end="69:52">-&gt;</operator><name pos:start="69:53" pos:end="69:62">vhostforce</name></name><operator pos:start="69:63" pos:end="69:63">)</operator></expr></else></ternary></expr>)</condition> <block pos:start="69:66" pos:end="125:5">{<block_content pos:start="71:9" pos:end="123:9">

        <decl_stmt pos:start="71:9" pos:end="71:32"><decl pos:start="71:9" pos:end="71:31"><type pos:start="71:9" pos:end="71:23"><name pos:start="71:9" pos:end="71:23">VhostNetOptions</name></type> <name pos:start="71:25" pos:end="71:31">options</name></decl>;</decl_stmt>



        <expr_stmt pos:start="75:9" pos:end="75:57"><expr pos:start="75:9" pos:end="75:56"><name pos:start="75:9" pos:end="75:28"><name pos:start="75:9" pos:end="75:15">options</name><operator pos:start="75:16" pos:end="75:16">.</operator><name pos:start="75:17" pos:end="75:28">backend_type</name></name> <operator pos:start="75:30" pos:end="75:30">=</operator> <name pos:start="75:32" pos:end="75:56">VHOST_BACKEND_TYPE_KERNEL</name></expr>;</expr_stmt>

        <expr_stmt pos:start="77:9" pos:end="77:37"><expr pos:start="77:9" pos:end="77:36"><name pos:start="77:9" pos:end="77:27"><name pos:start="77:9" pos:end="77:15">options</name><operator pos:start="77:16" pos:end="77:16">.</operator><name pos:start="77:17" pos:end="77:27">net_backend</name></name> <operator pos:start="77:29" pos:end="77:29">=</operator> <operator pos:start="77:31" pos:end="77:31">&amp;</operator><name pos:start="77:32" pos:end="77:36"><name pos:start="77:32" pos:end="77:32">s</name><operator pos:start="77:33" pos:end="77:34">-&gt;</operator><name pos:start="77:35" pos:end="77:36">nc</name></name></expr>;</expr_stmt>



        <if_stmt pos:start="81:9" pos:end="107:9"><if pos:start="81:9" pos:end="93:9">if <condition pos:start="81:12" pos:end="81:50">(<expr pos:start="81:13" pos:end="81:49"><name pos:start="81:13" pos:end="81:28"><name pos:start="81:13" pos:end="81:15">tap</name><operator pos:start="81:16" pos:end="81:17">-&gt;</operator><name pos:start="81:18" pos:end="81:28">has_vhostfd</name></name> <operator pos:start="81:30" pos:end="81:31">||</operator> <name pos:start="81:33" pos:end="81:49"><name pos:start="81:33" pos:end="81:35">tap</name><operator pos:start="81:36" pos:end="81:37">-&gt;</operator><name pos:start="81:38" pos:end="81:49">has_vhostfds</name></name></expr>)</condition> <block pos:start="81:52" pos:end="93:9">{<block_content pos:start="83:13" pos:end="91:13">

            <expr_stmt pos:start="83:13" pos:end="83:67"><expr pos:start="83:13" pos:end="83:66"><name pos:start="83:13" pos:end="83:19">vhostfd</name> <operator pos:start="83:21" pos:end="83:21">=</operator> <call pos:start="83:23" pos:end="83:66"><name pos:start="83:23" pos:end="83:38">monitor_fd_param</name><argument_list pos:start="83:39" pos:end="83:66">(<argument pos:start="83:40" pos:end="83:46"><expr pos:start="83:40" pos:end="83:46"><name pos:start="83:40" pos:end="83:46">cur_mon</name></expr></argument>, <argument pos:start="83:49" pos:end="83:59"><expr pos:start="83:49" pos:end="83:59"><name pos:start="83:49" pos:end="83:59">vhostfdname</name></expr></argument>, <argument pos:start="83:62" pos:end="83:65"><expr pos:start="83:62" pos:end="83:65"><operator pos:start="83:62" pos:end="83:62">&amp;</operator><name pos:start="83:63" pos:end="83:65">err</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <if_stmt pos:start="85:13" pos:end="91:13"><if pos:start="85:13" pos:end="91:13">if <condition pos:start="85:16" pos:end="85:30">(<expr pos:start="85:17" pos:end="85:29"><name pos:start="85:17" pos:end="85:23">vhostfd</name> <operator pos:start="85:25" pos:end="85:26">==</operator> <operator pos:start="85:28" pos:end="85:28">-</operator><literal type="number" pos:start="85:29" pos:end="85:29">1</literal></expr>)</condition> <block pos:start="85:32" pos:end="91:13">{<block_content pos:start="87:17" pos:end="89:23">

                <expr_stmt pos:start="87:17" pos:end="87:43"><expr pos:start="87:17" pos:end="87:42"><call pos:start="87:17" pos:end="87:42"><name pos:start="87:17" pos:end="87:31">error_propagate</name><argument_list pos:start="87:32" pos:end="87:42">(<argument pos:start="87:33" pos:end="87:36"><expr pos:start="87:33" pos:end="87:36"><name pos:start="87:33" pos:end="87:36">errp</name></expr></argument>, <argument pos:start="87:39" pos:end="87:41"><expr pos:start="87:39" pos:end="87:41"><name pos:start="87:39" pos:end="87:41">err</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

                <return pos:start="89:17" pos:end="89:23">return;</return>

            </block_content>}</block></if></if_stmt>

        </block_content>}</block></if> <else pos:start="93:11" pos:end="107:9">else <block pos:start="93:16" pos:end="107:9">{<block_content pos:start="95:13" pos:end="105:13">

            <expr_stmt pos:start="95:13" pos:end="95:53"><expr pos:start="95:13" pos:end="95:52"><name pos:start="95:13" pos:end="95:19">vhostfd</name> <operator pos:start="95:21" pos:end="95:21">=</operator> <call pos:start="95:23" pos:end="95:52"><name pos:start="95:23" pos:end="95:26">open</name><argument_list pos:start="95:27" pos:end="95:52">(<argument pos:start="95:28" pos:end="95:43"><expr pos:start="95:28" pos:end="95:43"><literal type="string" pos:start="95:28" pos:end="95:43">"/dev/vhost-net"</literal></expr></argument>, <argument pos:start="95:46" pos:end="95:51"><expr pos:start="95:46" pos:end="95:51"><name pos:start="95:46" pos:end="95:51">O_RDWR</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <if_stmt pos:start="97:13" pos:end="105:13"><if pos:start="97:13" pos:end="105:13">if <condition pos:start="97:16" pos:end="97:28">(<expr pos:start="97:17" pos:end="97:27"><name pos:start="97:17" pos:end="97:23">vhostfd</name> <operator pos:start="97:25" pos:end="97:25">&lt;</operator> <literal type="number" pos:start="97:27" pos:end="97:27">0</literal></expr>)</condition> <block pos:start="97:30" pos:end="105:13">{<block_content pos:start="99:17" pos:end="103:23">

                <expr_stmt pos:start="99:17" pos:end="101:71"><expr pos:start="99:17" pos:end="101:70"><call pos:start="99:17" pos:end="101:70"><name pos:start="99:17" pos:end="99:32">error_setg_errno</name><argument_list pos:start="99:33" pos:end="101:70">(<argument pos:start="99:34" pos:end="99:37"><expr pos:start="99:34" pos:end="99:37"><name pos:start="99:34" pos:end="99:37">errp</name></expr></argument>, <argument pos:start="99:40" pos:end="99:44"><expr pos:start="99:40" pos:end="99:44"><name pos:start="99:40" pos:end="99:44">errno</name></expr></argument>,

                                 <argument pos:start="101:34" pos:end="101:69"><expr pos:start="101:34" pos:end="101:69"><literal type="string" pos:start="101:34" pos:end="101:69">"tap: open vhost char device failed"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

                <return pos:start="103:17" pos:end="103:23">return;</return>

            </block_content>}</block></if></if_stmt>

        </block_content>}</block></else></if_stmt>

        <expr_stmt pos:start="109:9" pos:end="109:52"><expr pos:start="109:9" pos:end="109:51"><name pos:start="109:9" pos:end="109:22"><name pos:start="109:9" pos:end="109:15">options</name><operator pos:start="109:16" pos:end="109:16">.</operator><name pos:start="109:17" pos:end="109:22">opaque</name></name> <operator pos:start="109:24" pos:end="109:24">=</operator> <operator pos:start="109:26" pos:end="109:26">(</operator><name pos:start="109:27" pos:end="109:30">void</name> <operator pos:start="109:32" pos:end="109:32">*</operator><operator pos:start="109:33" pos:end="109:33">)</operator><operator pos:start="109:34" pos:end="109:34">(</operator><name pos:start="109:35" pos:end="109:43">uintptr_t</name><operator pos:start="109:44" pos:end="109:44">)</operator><name pos:start="109:45" pos:end="109:51">vhostfd</name></expr>;</expr_stmt>



        <expr_stmt pos:start="113:9" pos:end="113:48"><expr pos:start="113:9" pos:end="113:47"><name pos:start="113:9" pos:end="113:20"><name pos:start="113:9" pos:end="113:9">s</name><operator pos:start="113:10" pos:end="113:11">-&gt;</operator><name pos:start="113:12" pos:end="113:20">vhost_net</name></name> <operator pos:start="113:22" pos:end="113:22">=</operator> <call pos:start="113:24" pos:end="113:47"><name pos:start="113:24" pos:end="113:37">vhost_net_init</name><argument_list pos:start="113:38" pos:end="113:47">(<argument pos:start="113:39" pos:end="113:46"><expr pos:start="113:39" pos:end="113:46"><operator pos:start="113:39" pos:end="113:39">&amp;</operator><name pos:start="113:40" pos:end="113:46">options</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        <if_stmt pos:start="115:9" pos:end="123:9"><if pos:start="115:9" pos:end="123:9">if <condition pos:start="115:12" pos:end="115:26">(<expr pos:start="115:13" pos:end="115:25"><operator pos:start="115:13" pos:end="115:13">!</operator><name pos:start="115:14" pos:end="115:25"><name pos:start="115:14" pos:end="115:14">s</name><operator pos:start="115:15" pos:end="115:16">-&gt;</operator><name pos:start="115:17" pos:end="115:25">vhost_net</name></name></expr>)</condition> <block pos:start="115:28" pos:end="123:9">{<block_content pos:start="117:13" pos:end="121:19">

            <expr_stmt pos:start="117:13" pos:end="119:75"><expr pos:start="117:13" pos:end="119:74"><call pos:start="117:13" pos:end="119:74"><name pos:start="117:13" pos:end="117:22">error_setg</name><argument_list pos:start="117:23" pos:end="119:74">(<argument pos:start="117:24" pos:end="117:27"><expr pos:start="117:24" pos:end="117:27"><name pos:start="117:24" pos:end="117:27">errp</name></expr></argument>,

                       <argument pos:start="119:24" pos:end="119:73"><expr pos:start="119:24" pos:end="119:73"><literal type="string" pos:start="119:24" pos:end="119:73">"vhost-net requested but could not be initialized"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <return pos:start="121:13" pos:end="121:19">return;</return>

        </block_content>}</block></if></if_stmt>

    </block_content>}</block></if> <if type="elseif" pos:start="125:7" pos:end="129:5">else if <condition pos:start="125:15" pos:end="125:53">(<expr pos:start="125:16" pos:end="125:52"><name pos:start="125:16" pos:end="125:31"><name pos:start="125:16" pos:end="125:18">tap</name><operator pos:start="125:19" pos:end="125:20">-&gt;</operator><name pos:start="125:21" pos:end="125:31">has_vhostfd</name></name> <operator pos:start="125:33" pos:end="125:34">||</operator> <name pos:start="125:36" pos:end="125:52"><name pos:start="125:36" pos:end="125:38">tap</name><operator pos:start="125:39" pos:end="125:40">-&gt;</operator><name pos:start="125:41" pos:end="125:52">has_vhostfds</name></name></expr>)</condition> <block pos:start="125:55" pos:end="129:5">{<block_content pos:start="127:9" pos:end="127:64">

        <expr_stmt pos:start="127:9" pos:end="127:64"><expr pos:start="127:9" pos:end="127:63"><call pos:start="127:9" pos:end="127:63"><name pos:start="127:9" pos:end="127:18">error_setg</name><argument_list pos:start="127:19" pos:end="127:63">(<argument pos:start="127:20" pos:end="127:23"><expr pos:start="127:20" pos:end="127:23"><name pos:start="127:20" pos:end="127:23">errp</name></expr></argument>, <argument pos:start="127:26" pos:end="127:62"><expr pos:start="127:26" pos:end="127:62"><literal type="string" pos:start="127:26" pos:end="127:62">"vhostfd= is not valid without vhost"</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    </block_content>}</block></if></if_stmt>

</block_content>}</block></function>
</unit>
