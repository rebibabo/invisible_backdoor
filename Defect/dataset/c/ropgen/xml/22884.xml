<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.srcML.org/srcML/src" xmlns:pos="http://www.srcML.org/srcML/position" revision="1.0.0" language="C" filename="dataset/ropgen/aug/0/22884.c" pos:tabs="8"><function pos:start="1:1" pos:end="335:1"><type pos:start="1:1" pos:end="1:11"><specifier pos:start="1:1" pos:end="1:6">static</specifier> <name pos:start="1:8" pos:end="1:11">void</name></type> <name pos:start="1:13" pos:end="1:36">psy_3gpp_analyze_channel</name><parameter_list pos:start="1:37" pos:end="3:83">(<parameter pos:start="1:38" pos:end="1:54"><decl pos:start="1:38" pos:end="1:54"><type pos:start="1:38" pos:end="1:54"><name pos:start="1:38" pos:end="1:49">FFPsyContext</name> <modifier pos:start="1:51" pos:end="1:51">*</modifier></type><name pos:start="1:52" pos:end="1:54">ctx</name></decl></parameter>, <parameter pos:start="1:57" pos:end="1:67"><decl pos:start="1:57" pos:end="1:67"><type pos:start="1:57" pos:end="1:67"><name pos:start="1:57" pos:end="1:59">int</name></type> <name pos:start="1:61" pos:end="1:67">channel</name></decl></parameter>,

                                     <parameter pos:start="3:38" pos:end="3:55"><decl pos:start="3:38" pos:end="3:55"><type pos:start="3:38" pos:end="3:55"><specifier pos:start="3:38" pos:end="3:42">const</specifier> <name pos:start="3:44" pos:end="3:48">float</name> <modifier pos:start="3:50" pos:end="3:50">*</modifier></type><name pos:start="3:51" pos:end="3:55">coefs</name></decl></parameter>, <parameter pos:start="3:58" pos:end="3:82"><decl pos:start="3:58" pos:end="3:82"><type pos:start="3:58" pos:end="3:82"><specifier pos:start="3:58" pos:end="3:62">const</specifier> <name pos:start="3:64" pos:end="3:78">FFPsyWindowInfo</name> <modifier pos:start="3:80" pos:end="3:80">*</modifier></type><name pos:start="3:81" pos:end="3:82">wi</name></decl></parameter>)</parameter_list>

<block pos:start="5:1" pos:end="335:1">{<block_content pos:start="7:5" pos:end="333:57">

    <decl_stmt pos:start="7:5" pos:end="7:64"><decl pos:start="7:5" pos:end="7:63"><type pos:start="7:5" pos:end="7:19"><name pos:start="7:5" pos:end="7:17">AacPsyContext</name> <modifier pos:start="7:19" pos:end="7:19">*</modifier></type><name pos:start="7:20" pos:end="7:23">pctx</name> <init pos:start="7:25" pos:end="7:63">= <expr pos:start="7:27" pos:end="7:63"><operator pos:start="7:27" pos:end="7:27">(</operator><name pos:start="7:28" pos:end="7:40">AacPsyContext</name><operator pos:start="7:41" pos:end="7:41">*</operator><operator pos:start="7:42" pos:end="7:42">)</operator> <name pos:start="7:44" pos:end="7:63"><name pos:start="7:44" pos:end="7:46">ctx</name><operator pos:start="7:47" pos:end="7:48">-&gt;</operator><name pos:start="7:49" pos:end="7:63">model_priv_data</name></name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="9:5" pos:end="9:45"><decl pos:start="9:5" pos:end="9:44"><type pos:start="9:5" pos:end="9:19"><name pos:start="9:5" pos:end="9:17">AacPsyChannel</name> <modifier pos:start="9:19" pos:end="9:19">*</modifier></type><name pos:start="9:20" pos:end="9:22">pch</name>  <init pos:start="9:25" pos:end="9:44">= <expr pos:start="9:27" pos:end="9:44"><operator pos:start="9:27" pos:end="9:27">&amp;</operator><name pos:start="9:28" pos:end="9:44"><name pos:start="9:28" pos:end="9:31">pctx</name><operator pos:start="9:32" pos:end="9:33">-&gt;</operator><name pos:start="9:34" pos:end="9:35">ch</name><index pos:start="9:36" pos:end="9:44">[<expr pos:start="9:37" pos:end="9:43"><name pos:start="9:37" pos:end="9:43">channel</name></expr>]</index></name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="11:5" pos:end="11:16"><decl pos:start="11:5" pos:end="11:9"><type pos:start="11:5" pos:end="11:7"><name pos:start="11:5" pos:end="11:7">int</name></type> <name pos:start="11:9" pos:end="11:9">i</name></decl>, <decl pos:start="11:12" pos:end="11:12"><type ref="prev" pos:start="11:5" pos:end="11:7"/><name pos:start="11:12" pos:end="11:12">w</name></decl>, <decl pos:start="11:15" pos:end="11:15"><type ref="prev" pos:start="11:5" pos:end="11:7"/><name pos:start="11:15" pos:end="11:15">g</name></decl>;</decl_stmt>

    <decl_stmt pos:start="13:5" pos:end="13:83"><decl pos:start="13:5" pos:end="13:22"><type pos:start="13:5" pos:end="13:9"><name pos:start="13:5" pos:end="13:9">float</name></type> <name pos:start="13:11" pos:end="13:22">desired_bits</name></decl>, <decl pos:start="13:25" pos:end="13:34"><type ref="prev" pos:start="13:5" pos:end="13:9"/><name pos:start="13:25" pos:end="13:34">desired_pe</name></decl>, <decl pos:start="13:37" pos:end="13:44"><type ref="prev" pos:start="13:5" pos:end="13:9"/><name pos:start="13:37" pos:end="13:44">delta_pe</name></decl>, <decl pos:start="13:47" pos:end="13:60"><type ref="prev" pos:start="13:5" pos:end="13:9"/><name pos:start="13:47" pos:end="13:55">reduction</name><init pos:start="13:56" pos:end="13:60">= <expr pos:start="13:58" pos:end="13:60"><name pos:start="13:58" pos:end="13:60">NAN</name></expr></init></decl>, <decl pos:start="13:63" pos:end="13:82"><type ref="prev" pos:start="13:5" pos:end="13:9"/><name pos:start="13:63" pos:end="13:76"><name pos:start="13:63" pos:end="13:71">spread_en</name><index pos:start="13:72" pos:end="13:76">[<expr pos:start="13:73" pos:end="13:75"><literal type="number" pos:start="13:73" pos:end="13:75">128</literal></expr>]</index></name> <init pos:start="13:78" pos:end="13:82">= <expr pos:start="13:80" pos:end="13:82"><block pos:start="13:80" pos:end="13:82">{<expr pos:start="13:81" pos:end="13:81"><literal type="number" pos:start="13:81" pos:end="13:81">0</literal></expr>}</block></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="15:5" pos:end="15:57"><decl pos:start="15:5" pos:end="15:18"><type pos:start="15:5" pos:end="15:9"><name pos:start="15:5" pos:end="15:9">float</name></type> <name pos:start="15:11" pos:end="15:11">a</name> <init pos:start="15:13" pos:end="15:18">= <expr pos:start="15:15" pos:end="15:18"><literal type="number" pos:start="15:15" pos:end="15:18">0.0f</literal></expr></init></decl>, <decl pos:start="15:21" pos:end="15:39"><type ref="prev" pos:start="15:5" pos:end="15:9"/><name pos:start="15:21" pos:end="15:32">active_lines</name> <init pos:start="15:34" pos:end="15:39">= <expr pos:start="15:36" pos:end="15:39"><literal type="number" pos:start="15:36" pos:end="15:39">0.0f</literal></expr></init></decl>, <decl pos:start="15:42" pos:end="15:56"><type ref="prev" pos:start="15:5" pos:end="15:9"/><name pos:start="15:42" pos:end="15:49">norm_fac</name> <init pos:start="15:51" pos:end="15:56">= <expr pos:start="15:53" pos:end="15:56"><literal type="number" pos:start="15:53" pos:end="15:56">0.0f</literal></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="17:5" pos:end="17:113"><decl pos:start="17:5" pos:end="17:112"><type pos:start="17:5" pos:end="17:9"><name pos:start="17:5" pos:end="17:9">float</name></type> <name pos:start="17:11" pos:end="17:12">pe</name> <init pos:start="17:14" pos:end="17:112">= <expr pos:start="17:16" pos:end="17:112"><ternary pos:start="17:16" pos:end="17:112"><condition pos:start="17:16" pos:end="17:43"><expr pos:start="17:16" pos:end="17:41"><name pos:start="17:16" pos:end="17:33"><name pos:start="17:16" pos:end="17:19">pctx</name><operator pos:start="17:20" pos:end="17:21">-&gt;</operator><name pos:start="17:22" pos:end="17:33">chan_bitrate</name></name> <operator pos:start="17:35" pos:end="17:35">&gt;</operator> <literal type="number" pos:start="17:37" pos:end="17:41">32000</literal></expr> ?</condition><then pos:start="17:45" pos:end="17:48"> <expr pos:start="17:45" pos:end="17:48"><literal type="number" pos:start="17:45" pos:end="17:48">0.0f</literal></expr> </then><else pos:start="17:50" pos:end="17:112">: <expr pos:start="17:52" pos:end="17:112"><call pos:start="17:52" pos:end="17:112"><name pos:start="17:52" pos:end="17:56">FFMAX</name><argument_list pos:start="17:57" pos:end="17:112">(<argument pos:start="17:58" pos:end="17:62"><expr pos:start="17:58" pos:end="17:62"><literal type="number" pos:start="17:58" pos:end="17:62">50.0f</literal></expr></argument>, <argument pos:start="17:65" pos:end="17:111"><expr pos:start="17:65" pos:end="17:111"><literal type="number" pos:start="17:65" pos:end="17:72">100.0f</literal> <operator pos:start="17:72" pos:end="17:72">-</operator> <name pos:start="17:74" pos:end="17:91"><name pos:start="17:74" pos:end="17:77">pctx</name><operator pos:start="17:78" pos:end="17:79">-&gt;</operator><name pos:start="17:80" pos:end="17:91">chan_bitrate</name></name> <operator pos:start="17:93" pos:end="17:93">*</operator> <literal type="number" pos:start="17:95" pos:end="17:100">100.0f</literal> <operator pos:start="17:102" pos:end="17:102">/</operator> <literal type="number" pos:start="17:104" pos:end="17:111">32000.0f</literal></expr></argument>)</argument_list></call></expr></else></ternary></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="19:5" pos:end="19:70"><decl pos:start="19:5" pos:end="19:69"><type pos:start="19:5" pos:end="19:13"><specifier pos:start="19:5" pos:end="19:9">const</specifier> <name pos:start="19:11" pos:end="19:13">int</name></type>      <name pos:start="19:20" pos:end="19:28">num_bands</name>   <init pos:start="19:32" pos:end="19:69">= <expr pos:start="19:34" pos:end="19:69"><name pos:start="19:34" pos:end="19:69"><name pos:start="19:34" pos:end="19:36">ctx</name><operator pos:start="19:37" pos:end="19:38">-&gt;</operator><name pos:start="19:39" pos:end="19:47">num_bands</name><index pos:start="19:48" pos:end="19:69">[<expr pos:start="19:49" pos:end="19:68"><name pos:start="19:49" pos:end="19:63"><name pos:start="19:49" pos:end="19:50">wi</name><operator pos:start="19:51" pos:end="19:52">-&gt;</operator><name pos:start="19:53" pos:end="19:63">num_windows</name></name> <operator pos:start="19:65" pos:end="19:66">==</operator> <literal type="number" pos:start="19:68" pos:end="19:68">8</literal></expr>]</index></name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="21:5" pos:end="21:66"><decl pos:start="21:5" pos:end="21:65"><type pos:start="21:5" pos:end="21:19"><specifier pos:start="21:5" pos:end="21:9">const</specifier> <name pos:start="21:11" pos:end="21:17">uint8_t</name> <modifier pos:start="21:19" pos:end="21:19">*</modifier></type><name pos:start="21:20" pos:end="21:29">band_sizes</name>  <init pos:start="21:32" pos:end="21:65">= <expr pos:start="21:34" pos:end="21:65"><name pos:start="21:34" pos:end="21:65"><name pos:start="21:34" pos:end="21:36">ctx</name><operator pos:start="21:37" pos:end="21:38">-&gt;</operator><name pos:start="21:39" pos:end="21:43">bands</name><index pos:start="21:44" pos:end="21:65">[<expr pos:start="21:45" pos:end="21:64"><name pos:start="21:45" pos:end="21:59"><name pos:start="21:45" pos:end="21:46">wi</name><operator pos:start="21:47" pos:end="21:48">-&gt;</operator><name pos:start="21:49" pos:end="21:59">num_windows</name></name> <operator pos:start="21:61" pos:end="21:62">==</operator> <literal type="number" pos:start="21:64" pos:end="21:64">8</literal></expr>]</index></name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="23:5" pos:end="23:70"><decl pos:start="23:5" pos:end="23:69"><type pos:start="23:5" pos:end="23:19"><name pos:start="23:5" pos:end="23:16">AacPsyCoeffs</name>  <modifier pos:start="23:19" pos:end="23:19">*</modifier></type><name pos:start="23:20" pos:end="23:25">coeffs</name>      <init pos:start="23:32" pos:end="23:69">= <expr pos:start="23:34" pos:end="23:69"><name pos:start="23:34" pos:end="23:69"><name pos:start="23:34" pos:end="23:37">pctx</name><operator pos:start="23:38" pos:end="23:39">-&gt;</operator><name pos:start="23:40" pos:end="23:47">psy_coef</name><index pos:start="23:48" pos:end="23:69">[<expr pos:start="23:49" pos:end="23:68"><name pos:start="23:49" pos:end="23:63"><name pos:start="23:49" pos:end="23:50">wi</name><operator pos:start="23:51" pos:end="23:52">-&gt;</operator><name pos:start="23:53" pos:end="23:63">num_windows</name></name> <operator pos:start="23:65" pos:end="23:66">==</operator> <literal type="number" pos:start="23:68" pos:end="23:68">8</literal></expr>]</index></name></expr></init></decl>;</decl_stmt>

    <decl_stmt pos:start="25:5" pos:end="25:101"><decl pos:start="25:5" pos:end="25:100"><type pos:start="25:5" pos:end="25:15"><specifier pos:start="25:5" pos:end="25:9">const</specifier> <name pos:start="25:11" pos:end="25:15">float</name></type> <name pos:start="25:17" pos:end="25:30">avoid_hole_thr</name> <init pos:start="25:32" pos:end="25:100">= <expr pos:start="25:34" pos:end="25:100"><ternary pos:start="25:34" pos:end="25:100"><condition pos:start="25:34" pos:end="25:55"><expr pos:start="25:34" pos:end="25:53"><name pos:start="25:34" pos:end="25:48"><name pos:start="25:34" pos:end="25:35">wi</name><operator pos:start="25:36" pos:end="25:37">-&gt;</operator><name pos:start="25:38" pos:end="25:48">num_windows</name></name> <operator pos:start="25:50" pos:end="25:51">==</operator> <literal type="number" pos:start="25:53" pos:end="25:53">8</literal></expr> ?</condition><then pos:start="25:57" pos:end="25:77"> <expr pos:start="25:57" pos:end="25:77"><name pos:start="25:57" pos:end="25:77">PSY_3GPP_AH_THR_SHORT</name></expr> </then><else pos:start="25:79" pos:end="25:100">: <expr pos:start="25:81" pos:end="25:100"><name pos:start="25:81" pos:end="25:100">PSY_3GPP_AH_THR_LONG</name></expr></else></ternary></expr></init></decl>;</decl_stmt>



    <comment type="line" pos:start="29:5" pos:end="29:95">//calculate energies, initial thresholds and related values - 5.4.2 "Threshold Calculation"</comment>

    <expr_stmt pos:start="31:5" pos:end="31:57"><expr pos:start="31:5" pos:end="31:56"><call pos:start="31:5" pos:end="31:56"><name pos:start="31:5" pos:end="31:17">calc_thr_3gpp</name><argument_list pos:start="31:18" pos:end="31:56">(<argument pos:start="31:19" pos:end="31:20"><expr pos:start="31:19" pos:end="31:20"><name pos:start="31:19" pos:end="31:20">wi</name></expr></argument>, <argument pos:start="31:23" pos:end="31:31"><expr pos:start="31:23" pos:end="31:31"><name pos:start="31:23" pos:end="31:31">num_bands</name></expr></argument>, <argument pos:start="31:34" pos:end="31:36"><expr pos:start="31:34" pos:end="31:36"><name pos:start="31:34" pos:end="31:36">pch</name></expr></argument>, <argument pos:start="31:39" pos:end="31:48"><expr pos:start="31:39" pos:end="31:48"><name pos:start="31:39" pos:end="31:48">band_sizes</name></expr></argument>, <argument pos:start="31:51" pos:end="31:55"><expr pos:start="31:51" pos:end="31:55"><name pos:start="31:51" pos:end="31:55">coefs</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <comment type="line" pos:start="35:5" pos:end="35:83">//modify thresholds and energies - spread, threshold in quiet, pre-echo control</comment>

    <for pos:start="37:5" pos:end="105:5">for <control pos:start="37:9" pos:end="37:48">(<init pos:start="37:10" pos:end="37:15"><expr pos:start="37:10" pos:end="37:14"><name pos:start="37:10" pos:end="37:10">w</name> <operator pos:start="37:12" pos:end="37:12">=</operator> <literal type="number" pos:start="37:14" pos:end="37:14">0</literal></expr>;</init> <condition pos:start="37:17" pos:end="37:39"><expr pos:start="37:17" pos:end="37:38"><name pos:start="37:17" pos:end="37:17">w</name> <operator pos:start="37:19" pos:end="37:19">&lt;</operator> <name pos:start="37:21" pos:end="37:35"><name pos:start="37:21" pos:end="37:22">wi</name><operator pos:start="37:23" pos:end="37:24">-&gt;</operator><name pos:start="37:25" pos:end="37:35">num_windows</name></name><operator pos:start="37:36" pos:end="37:36">*</operator><literal type="number" pos:start="37:37" pos:end="37:38">16</literal></expr>;</condition> <incr pos:start="37:41" pos:end="37:47"><expr pos:start="37:41" pos:end="37:47"><name pos:start="37:41" pos:end="37:41">w</name> <operator pos:start="37:43" pos:end="37:44">+=</operator> <literal type="number" pos:start="37:46" pos:end="37:47">16</literal></expr></incr>)</control> <block pos:start="37:50" pos:end="105:5">{<block_content pos:start="39:9" pos:end="103:9">

        <decl_stmt pos:start="39:9" pos:end="39:42"><decl pos:start="39:9" pos:end="39:41"><type pos:start="39:9" pos:end="39:20"><name pos:start="39:9" pos:end="39:18">AacPsyBand</name> <modifier pos:start="39:20" pos:end="39:20">*</modifier></type><name pos:start="39:21" pos:end="39:25">bands</name> <init pos:start="39:27" pos:end="39:41">= <expr pos:start="39:29" pos:end="39:41"><operator pos:start="39:29" pos:end="39:29">&amp;</operator><name pos:start="39:30" pos:end="39:41"><name pos:start="39:30" pos:end="39:32">pch</name><operator pos:start="39:33" pos:end="39:34">-&gt;</operator><name pos:start="39:35" pos:end="39:38">band</name><index pos:start="39:39" pos:end="39:41">[<expr pos:start="39:40" pos:end="39:40"><name pos:start="39:40" pos:end="39:40">w</name></expr>]</index></name></expr></init></decl>;</decl_stmt>



        <comment type="block" pos:start="43:9" pos:end="43:69">/* 5.4.2.3 "Spreading" &amp; 5.4.3 "Spread Energy Calculation" */</comment>

        <expr_stmt pos:start="45:9" pos:end="45:39"><expr pos:start="45:9" pos:end="45:38"><name pos:start="45:9" pos:end="45:20"><name pos:start="45:9" pos:end="45:17">spread_en</name><index pos:start="45:18" pos:end="45:20">[<expr pos:start="45:19" pos:end="45:19"><literal type="number" pos:start="45:19" pos:end="45:19">0</literal></expr>]</index></name> <operator pos:start="45:22" pos:end="45:22">=</operator> <name pos:start="45:24" pos:end="45:31"><name pos:start="45:24" pos:end="45:28">bands</name><index pos:start="45:29" pos:end="45:31">[<expr pos:start="45:30" pos:end="45:30"><literal type="number" pos:start="45:30" pos:end="45:30">0</literal></expr>]</index></name><operator pos:start="45:32" pos:end="45:32">.</operator><name pos:start="45:33" pos:end="45:38">energy</name></expr>;</expr_stmt>

        <for pos:start="47:9" pos:end="53:9">for <control pos:start="47:13" pos:end="47:39">(<init pos:start="47:14" pos:end="47:19"><expr pos:start="47:14" pos:end="47:18"><name pos:start="47:14" pos:end="47:14">g</name> <operator pos:start="47:16" pos:end="47:16">=</operator> <literal type="number" pos:start="47:18" pos:end="47:18">1</literal></expr>;</init> <condition pos:start="47:21" pos:end="47:34"><expr pos:start="47:21" pos:end="47:33"><name pos:start="47:21" pos:end="47:21">g</name> <operator pos:start="47:23" pos:end="47:23">&lt;</operator> <name pos:start="47:25" pos:end="47:33">num_bands</name></expr>;</condition> <incr pos:start="47:36" pos:end="47:38"><expr pos:start="47:36" pos:end="47:38"><name pos:start="47:36" pos:end="47:36">g</name><operator pos:start="47:37" pos:end="47:38">++</operator></expr></incr>)</control> <block pos:start="47:41" pos:end="53:9">{<block_content pos:start="49:13" pos:end="51:95">

            <expr_stmt pos:start="49:13" pos:end="49:93"><expr pos:start="49:13" pos:end="49:92"><name pos:start="49:13" pos:end="49:20"><name pos:start="49:13" pos:end="49:17">bands</name><index pos:start="49:18" pos:end="49:20">[<expr pos:start="49:19" pos:end="49:19"><name pos:start="49:19" pos:end="49:19">g</name></expr>]</index></name><operator pos:start="49:21" pos:end="49:21">.</operator><name pos:start="49:22" pos:end="49:24">thr</name>   <operator pos:start="49:28" pos:end="49:28">=</operator> <call pos:start="49:30" pos:end="49:92"><name pos:start="49:30" pos:end="49:34">FFMAX</name><argument_list pos:start="49:35" pos:end="49:92">(<argument pos:start="49:36" pos:end="49:47"><expr pos:start="49:36" pos:end="49:47"><name pos:start="49:36" pos:end="49:43"><name pos:start="49:36" pos:end="49:40">bands</name><index pos:start="49:41" pos:end="49:43">[<expr pos:start="49:42" pos:end="49:42"><name pos:start="49:42" pos:end="49:42">g</name></expr>]</index></name><operator pos:start="49:44" pos:end="49:44">.</operator><name pos:start="49:45" pos:end="49:47">thr</name></expr></argument>,    <argument pos:start="49:53" pos:end="49:91"><expr pos:start="49:53" pos:end="49:91"><name pos:start="49:53" pos:end="49:62"><name pos:start="49:53" pos:end="49:57">bands</name><index pos:start="49:58" pos:end="49:62">[<expr pos:start="49:59" pos:end="49:61"><name pos:start="49:59" pos:end="49:59">g</name><operator pos:start="49:60" pos:end="49:60">-</operator><literal type="number" pos:start="49:61" pos:end="49:61">1</literal></expr>]</index></name><operator pos:start="49:63" pos:end="49:63">.</operator><name pos:start="49:64" pos:end="49:66">thr</name> <operator pos:start="49:68" pos:end="49:68">*</operator> <name pos:start="49:70" pos:end="49:78"><name pos:start="49:70" pos:end="49:75">coeffs</name><index pos:start="49:76" pos:end="49:78">[<expr pos:start="49:77" pos:end="49:77"><name pos:start="49:77" pos:end="49:77">g</name></expr>]</index></name><operator pos:start="49:79" pos:end="49:79">.</operator><name pos:start="49:80" pos:end="49:91"><name pos:start="49:80" pos:end="49:88">spread_hi</name><index pos:start="49:89" pos:end="49:91">[<expr pos:start="49:90" pos:end="49:90"><literal type="number" pos:start="49:90" pos:end="49:90">0</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="51:13" pos:end="51:95"><expr pos:start="51:13" pos:end="51:94"><name pos:start="51:13" pos:end="51:26"><name pos:start="51:13" pos:end="51:21">spread_en</name><index pos:start="51:22" pos:end="51:26">[<expr pos:start="51:23" pos:end="51:25"><name pos:start="51:23" pos:end="51:23">w</name><operator pos:start="51:24" pos:end="51:24">+</operator><name pos:start="51:25" pos:end="51:25">g</name></expr>]</index></name> <operator pos:start="51:28" pos:end="51:28">=</operator> <call pos:start="51:30" pos:end="51:94"><name pos:start="51:30" pos:end="51:34">FFMAX</name><argument_list pos:start="51:35" pos:end="51:94">(<argument pos:start="51:36" pos:end="51:50"><expr pos:start="51:36" pos:end="51:50"><name pos:start="51:36" pos:end="51:43"><name pos:start="51:36" pos:end="51:40">bands</name><index pos:start="51:41" pos:end="51:43">[<expr pos:start="51:42" pos:end="51:42"><name pos:start="51:42" pos:end="51:42">g</name></expr>]</index></name><operator pos:start="51:44" pos:end="51:44">.</operator><name pos:start="51:45" pos:end="51:50">energy</name></expr></argument>, <argument pos:start="51:53" pos:end="51:93"><expr pos:start="51:53" pos:end="51:93"><name pos:start="51:53" pos:end="51:68"><name pos:start="51:53" pos:end="51:61">spread_en</name><index pos:start="51:62" pos:end="51:68">[<expr pos:start="51:63" pos:end="51:67"><name pos:start="51:63" pos:end="51:63">w</name><operator pos:start="51:64" pos:end="51:64">+</operator><name pos:start="51:65" pos:end="51:65">g</name><operator pos:start="51:66" pos:end="51:66">-</operator><literal type="number" pos:start="51:67" pos:end="51:67">1</literal></expr>]</index></name> <operator pos:start="51:70" pos:end="51:70">*</operator> <name pos:start="51:72" pos:end="51:80"><name pos:start="51:72" pos:end="51:77">coeffs</name><index pos:start="51:78" pos:end="51:80">[<expr pos:start="51:79" pos:end="51:79"><name pos:start="51:79" pos:end="51:79">g</name></expr>]</index></name><operator pos:start="51:81" pos:end="51:81">.</operator><name pos:start="51:82" pos:end="51:93"><name pos:start="51:82" pos:end="51:90">spread_hi</name><index pos:start="51:91" pos:end="51:93">[<expr pos:start="51:92" pos:end="51:92"><literal type="number" pos:start="51:92" pos:end="51:92">1</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></for>

        <for pos:start="55:9" pos:end="61:9">for <control pos:start="55:13" pos:end="55:44">(<init pos:start="55:14" pos:end="55:31"><expr pos:start="55:14" pos:end="55:30"><name pos:start="55:14" pos:end="55:14">g</name> <operator pos:start="55:16" pos:end="55:16">=</operator> <name pos:start="55:18" pos:end="55:26">num_bands</name> <operator pos:start="55:28" pos:end="55:28">-</operator> <literal type="number" pos:start="55:30" pos:end="55:30">2</literal></expr>;</init> <condition pos:start="55:33" pos:end="55:39"><expr pos:start="55:33" pos:end="55:38"><name pos:start="55:33" pos:end="55:33">g</name> <operator pos:start="55:35" pos:end="55:36">&gt;=</operator> <literal type="number" pos:start="55:38" pos:end="55:38">0</literal></expr>;</condition> <incr pos:start="55:41" pos:end="55:43"><expr pos:start="55:41" pos:end="55:43"><name pos:start="55:41" pos:end="55:41">g</name><operator pos:start="55:42" pos:end="55:43">--</operator></expr></incr>)</control> <block pos:start="55:46" pos:end="61:9">{<block_content pos:start="57:13" pos:end="59:95">

            <expr_stmt pos:start="57:13" pos:end="57:93"><expr pos:start="57:13" pos:end="57:92"><name pos:start="57:13" pos:end="57:20"><name pos:start="57:13" pos:end="57:17">bands</name><index pos:start="57:18" pos:end="57:20">[<expr pos:start="57:19" pos:end="57:19"><name pos:start="57:19" pos:end="57:19">g</name></expr>]</index></name><operator pos:start="57:21" pos:end="57:21">.</operator><name pos:start="57:22" pos:end="57:24">thr</name>   <operator pos:start="57:28" pos:end="57:28">=</operator> <call pos:start="57:30" pos:end="57:92"><name pos:start="57:30" pos:end="57:34">FFMAX</name><argument_list pos:start="57:35" pos:end="57:92">(<argument pos:start="57:36" pos:end="57:47"><expr pos:start="57:36" pos:end="57:47"><name pos:start="57:36" pos:end="57:43"><name pos:start="57:36" pos:end="57:40">bands</name><index pos:start="57:41" pos:end="57:43">[<expr pos:start="57:42" pos:end="57:42"><name pos:start="57:42" pos:end="57:42">g</name></expr>]</index></name><operator pos:start="57:44" pos:end="57:44">.</operator><name pos:start="57:45" pos:end="57:47">thr</name></expr></argument>,   <argument pos:start="57:52" pos:end="57:91"><expr pos:start="57:52" pos:end="57:91"><name pos:start="57:52" pos:end="57:61"><name pos:start="57:52" pos:end="57:56">bands</name><index pos:start="57:57" pos:end="57:61">[<expr pos:start="57:58" pos:end="57:60"><name pos:start="57:58" pos:end="57:58">g</name><operator pos:start="57:59" pos:end="57:59">+</operator><literal type="number" pos:start="57:60" pos:end="57:60">1</literal></expr>]</index></name><operator pos:start="57:62" pos:end="57:62">.</operator><name pos:start="57:63" pos:end="57:65">thr</name> <operator pos:start="57:67" pos:end="57:67">*</operator> <name pos:start="57:69" pos:end="57:77"><name pos:start="57:69" pos:end="57:74">coeffs</name><index pos:start="57:75" pos:end="57:77">[<expr pos:start="57:76" pos:end="57:76"><name pos:start="57:76" pos:end="57:76">g</name></expr>]</index></name><operator pos:start="57:78" pos:end="57:78">.</operator><name pos:start="57:79" pos:end="57:91"><name pos:start="57:79" pos:end="57:88">spread_low</name><index pos:start="57:89" pos:end="57:91">[<expr pos:start="57:90" pos:end="57:90"><literal type="number" pos:start="57:90" pos:end="57:90">0</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="59:13" pos:end="59:95"><expr pos:start="59:13" pos:end="59:94"><name pos:start="59:13" pos:end="59:26"><name pos:start="59:13" pos:end="59:21">spread_en</name><index pos:start="59:22" pos:end="59:26">[<expr pos:start="59:23" pos:end="59:25"><name pos:start="59:23" pos:end="59:23">w</name><operator pos:start="59:24" pos:end="59:24">+</operator><name pos:start="59:25" pos:end="59:25">g</name></expr>]</index></name> <operator pos:start="59:28" pos:end="59:28">=</operator> <call pos:start="59:30" pos:end="59:94"><name pos:start="59:30" pos:end="59:34">FFMAX</name><argument_list pos:start="59:35" pos:end="59:94">(<argument pos:start="59:36" pos:end="59:49"><expr pos:start="59:36" pos:end="59:49"><name pos:start="59:36" pos:end="59:49"><name pos:start="59:36" pos:end="59:44">spread_en</name><index pos:start="59:45" pos:end="59:49">[<expr pos:start="59:46" pos:end="59:48"><name pos:start="59:46" pos:end="59:46">w</name><operator pos:start="59:47" pos:end="59:47">+</operator><name pos:start="59:48" pos:end="59:48">g</name></expr>]</index></name></expr></argument>, <argument pos:start="59:52" pos:end="59:93"><expr pos:start="59:52" pos:end="59:93"><name pos:start="59:52" pos:end="59:67"><name pos:start="59:52" pos:end="59:60">spread_en</name><index pos:start="59:61" pos:end="59:67">[<expr pos:start="59:62" pos:end="59:66"><name pos:start="59:62" pos:end="59:62">w</name><operator pos:start="59:63" pos:end="59:63">+</operator><name pos:start="59:64" pos:end="59:64">g</name><operator pos:start="59:65" pos:end="59:65">+</operator><literal type="number" pos:start="59:66" pos:end="59:66">1</literal></expr>]</index></name> <operator pos:start="59:69" pos:end="59:69">*</operator> <name pos:start="59:71" pos:end="59:79"><name pos:start="59:71" pos:end="59:76">coeffs</name><index pos:start="59:77" pos:end="59:79">[<expr pos:start="59:78" pos:end="59:78"><name pos:start="59:78" pos:end="59:78">g</name></expr>]</index></name><operator pos:start="59:80" pos:end="59:80">.</operator><name pos:start="59:81" pos:end="59:93"><name pos:start="59:81" pos:end="59:90">spread_low</name><index pos:start="59:91" pos:end="59:93">[<expr pos:start="59:92" pos:end="59:92"><literal type="number" pos:start="59:92" pos:end="59:92">1</literal></expr>]</index></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

        </block_content>}</block></for>

        <comment type="line" pos:start="63:9" pos:end="63:38">//5.4.2.4 "Threshold in quiet"</comment>

        <for pos:start="65:9" pos:end="103:9">for <control pos:start="65:13" pos:end="65:39">(<init pos:start="65:14" pos:end="65:19"><expr pos:start="65:14" pos:end="65:18"><name pos:start="65:14" pos:end="65:14">g</name> <operator pos:start="65:16" pos:end="65:16">=</operator> <literal type="number" pos:start="65:18" pos:end="65:18">0</literal></expr>;</init> <condition pos:start="65:21" pos:end="65:34"><expr pos:start="65:21" pos:end="65:33"><name pos:start="65:21" pos:end="65:21">g</name> <operator pos:start="65:23" pos:end="65:23">&lt;</operator> <name pos:start="65:25" pos:end="65:33">num_bands</name></expr>;</condition> <incr pos:start="65:36" pos:end="65:38"><expr pos:start="65:36" pos:end="65:38"><name pos:start="65:36" pos:end="65:36">g</name><operator pos:start="65:37" pos:end="65:38">++</operator></expr></incr>)</control> <block pos:start="65:41" pos:end="103:9">{<block_content pos:start="67:13" pos:end="101:57">

            <decl_stmt pos:start="67:13" pos:end="67:41"><decl pos:start="67:13" pos:end="67:40"><type pos:start="67:13" pos:end="67:24"><name pos:start="67:13" pos:end="67:22">AacPsyBand</name> <modifier pos:start="67:24" pos:end="67:24">*</modifier></type><name pos:start="67:25" pos:end="67:28">band</name> <init pos:start="67:30" pos:end="67:40">= <expr pos:start="67:32" pos:end="67:40"><operator pos:start="67:32" pos:end="67:32">&amp;</operator><name pos:start="67:33" pos:end="67:40"><name pos:start="67:33" pos:end="67:37">bands</name><index pos:start="67:38" pos:end="67:40">[<expr pos:start="67:39" pos:end="67:39"><name pos:start="67:39" pos:end="67:39">g</name></expr>]</index></name></expr></init></decl>;</decl_stmt>



            <expr_stmt pos:start="71:13" pos:end="71:74"><expr pos:start="71:13" pos:end="71:73"><name pos:start="71:13" pos:end="71:27"><name pos:start="71:13" pos:end="71:16">band</name><operator pos:start="71:17" pos:end="71:18">-&gt;</operator><name pos:start="71:19" pos:end="71:27">thr_quiet</name></name> <operator pos:start="71:29" pos:end="71:29">=</operator> <name pos:start="71:31" pos:end="71:39"><name pos:start="71:31" pos:end="71:34">band</name><operator pos:start="71:35" pos:end="71:36">-&gt;</operator><name pos:start="71:37" pos:end="71:39">thr</name></name> <operator pos:start="71:41" pos:end="71:41">=</operator> <call pos:start="71:43" pos:end="71:73"><name pos:start="71:43" pos:end="71:47">FFMAX</name><argument_list pos:start="71:48" pos:end="71:73">(<argument pos:start="71:49" pos:end="71:57"><expr pos:start="71:49" pos:end="71:57"><name pos:start="71:49" pos:end="71:57"><name pos:start="71:49" pos:end="71:52">band</name><operator pos:start="71:53" pos:end="71:54">-&gt;</operator><name pos:start="71:55" pos:end="71:57">thr</name></name></expr></argument>, <argument pos:start="71:60" pos:end="71:72"><expr pos:start="71:60" pos:end="71:72"><name pos:start="71:60" pos:end="71:68"><name pos:start="71:60" pos:end="71:65">coeffs</name><index pos:start="71:66" pos:end="71:68">[<expr pos:start="71:67" pos:end="71:67"><name pos:start="71:67" pos:end="71:67">g</name></expr>]</index></name><operator pos:start="71:69" pos:end="71:69">.</operator><name pos:start="71:70" pos:end="71:72">ath</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <comment type="line" pos:start="73:13" pos:end="73:40">//5.4.2.5 "Pre-echo control"</comment>

            <if_stmt pos:start="75:13" pos:end="79:82"><if pos:start="75:13" pos:end="79:82">if <condition pos:start="75:16" pos:end="75:113">(<expr pos:start="75:17" pos:end="75:112"><operator pos:start="75:17" pos:end="75:17">!</operator><operator pos:start="75:18" pos:end="75:18">(</operator><name pos:start="75:19" pos:end="75:36"><name pos:start="75:19" pos:end="75:20">wi</name><operator pos:start="75:21" pos:end="75:22">-&gt;</operator><name pos:start="75:23" pos:end="75:33">window_type</name><index pos:start="75:34" pos:end="75:36">[<expr pos:start="75:35" pos:end="75:35"><literal type="number" pos:start="75:35" pos:end="75:35">0</literal></expr>]</index></name> <operator pos:start="75:38" pos:end="75:39">==</operator> <name pos:start="75:41" pos:end="75:58">LONG_STOP_SEQUENCE</name> <operator pos:start="75:60" pos:end="75:61">||</operator> <operator pos:start="75:63" pos:end="75:63">(</operator><name pos:start="75:64" pos:end="75:81"><name pos:start="75:64" pos:end="75:65">wi</name><operator pos:start="75:66" pos:end="75:67">-&gt;</operator><name pos:start="75:68" pos:end="75:78">window_type</name><index pos:start="75:79" pos:end="75:81">[<expr pos:start="75:80" pos:end="75:80"><literal type="number" pos:start="75:80" pos:end="75:80">1</literal></expr>]</index></name> <operator pos:start="75:83" pos:end="75:84">==</operator> <name pos:start="75:86" pos:end="75:104">LONG_START_SEQUENCE</name> <operator pos:start="75:106" pos:end="75:107">&amp;&amp;</operator> <operator pos:start="75:109" pos:end="75:109">!</operator><name pos:start="75:110" pos:end="75:110">w</name><operator pos:start="75:111" pos:end="75:111">)</operator><operator pos:start="75:112" pos:end="75:112">)</operator></expr>)</condition><block type="pseudo" pos:start="77:17" pos:end="79:82"><block_content pos:start="77:17" pos:end="79:82">

                <expr_stmt pos:start="77:17" pos:end="79:82"><expr pos:start="77:17" pos:end="79:81"><name pos:start="77:17" pos:end="77:25"><name pos:start="77:17" pos:end="77:20">band</name><operator pos:start="77:21" pos:end="77:22">-&gt;</operator><name pos:start="77:23" pos:end="77:25">thr</name></name> <operator pos:start="77:27" pos:end="77:27">=</operator> <call pos:start="77:29" pos:end="79:81"><name pos:start="77:29" pos:end="77:33">FFMAX</name><argument_list pos:start="77:34" pos:end="79:81">(<argument pos:start="77:35" pos:end="77:59"><expr pos:start="77:35" pos:end="77:59"><name pos:start="77:35" pos:end="77:49">PSY_3GPP_RPEMIN</name><operator pos:start="77:50" pos:end="77:50">*</operator><name pos:start="77:51" pos:end="77:59"><name pos:start="77:51" pos:end="77:54">band</name><operator pos:start="77:55" pos:end="77:56">-&gt;</operator><name pos:start="77:57" pos:end="77:59">thr</name></name></expr></argument>, <argument pos:start="77:62" pos:end="79:80"><expr pos:start="77:62" pos:end="79:80"><call pos:start="77:62" pos:end="79:80"><name pos:start="77:62" pos:end="77:66">FFMIN</name><argument_list pos:start="77:67" pos:end="79:80">(<argument pos:start="77:68" pos:end="77:76"><expr pos:start="77:68" pos:end="77:76"><name pos:start="77:68" pos:end="77:76"><name pos:start="77:68" pos:end="77:71">band</name><operator pos:start="77:72" pos:end="77:73">-&gt;</operator><name pos:start="77:74" pos:end="77:76">thr</name></name></expr></argument>,

                                  <argument pos:start="79:35" pos:end="79:79"><expr pos:start="79:35" pos:end="79:79"><name pos:start="79:35" pos:end="79:49">PSY_3GPP_RPELEV</name><operator pos:start="79:50" pos:end="79:50">*</operator><name pos:start="79:51" pos:end="79:69"><name pos:start="79:51" pos:end="79:53">pch</name><operator pos:start="79:54" pos:end="79:55">-&gt;</operator><name pos:start="79:56" pos:end="79:64">prev_band</name><index pos:start="79:65" pos:end="79:69">[<expr pos:start="79:66" pos:end="79:68"><name pos:start="79:66" pos:end="79:66">w</name><operator pos:start="79:67" pos:end="79:67">+</operator><name pos:start="79:68" pos:end="79:68">g</name></expr>]</index></name><operator pos:start="79:70" pos:end="79:70">.</operator><name pos:start="79:71" pos:end="79:79">thr_quiet</name></expr></argument>)</argument_list></call></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>



            <comment type="block" pos:start="83:13" pos:end="83:85">/* 5.6.1.3.1 "Preparatory steps of the perceptual entropy calculation" */</comment>

            <expr_stmt pos:start="85:13" pos:end="85:37"><expr pos:start="85:13" pos:end="85:36"><name pos:start="85:13" pos:end="85:14">pe</name> <operator pos:start="85:16" pos:end="85:17">+=</operator> <call pos:start="85:19" pos:end="85:36"><name pos:start="85:19" pos:end="85:30">calc_pe_3gpp</name><argument_list pos:start="85:31" pos:end="85:36">(<argument pos:start="85:32" pos:end="85:35"><expr pos:start="85:32" pos:end="85:35"><name pos:start="85:32" pos:end="85:35">band</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="87:13" pos:end="87:33"><expr pos:start="87:13" pos:end="87:32"><name pos:start="87:13" pos:end="87:13">a</name>  <operator pos:start="87:16" pos:end="87:17">+=</operator> <name pos:start="87:19" pos:end="87:32"><name pos:start="87:19" pos:end="87:22">band</name><operator pos:start="87:23" pos:end="87:24">-&gt;</operator><name pos:start="87:25" pos:end="87:32">pe_const</name></name></expr>;</expr_stmt>

            <expr_stmt pos:start="89:13" pos:end="89:47"><expr pos:start="89:13" pos:end="89:46"><name pos:start="89:13" pos:end="89:24">active_lines</name> <operator pos:start="89:26" pos:end="89:27">+=</operator> <name pos:start="89:29" pos:end="89:46"><name pos:start="89:29" pos:end="89:32">band</name><operator pos:start="89:33" pos:end="89:34">-&gt;</operator><name pos:start="89:35" pos:end="89:46">active_lines</name></name></expr>;</expr_stmt>



            <comment type="block" pos:start="93:13" pos:end="93:75">/* 5.6.1.3.3 "Selection of the bands for avoidance of holes" */</comment>

            <if_stmt pos:start="95:13" pos:end="101:57"><if pos:start="95:13" pos:end="97:53">if <condition pos:start="95:16" pos:end="95:91">(<expr pos:start="95:17" pos:end="95:90"><name pos:start="95:17" pos:end="95:30"><name pos:start="95:17" pos:end="95:25">spread_en</name><index pos:start="95:26" pos:end="95:30">[<expr pos:start="95:27" pos:end="95:29"><name pos:start="95:27" pos:end="95:27">w</name><operator pos:start="95:28" pos:end="95:28">+</operator><name pos:start="95:29" pos:end="95:29">g</name></expr>]</index></name> <operator pos:start="95:32" pos:end="95:32">*</operator> <name pos:start="95:34" pos:end="95:47">avoid_hole_thr</name> <operator pos:start="95:49" pos:end="95:49">&gt;</operator> <name pos:start="95:51" pos:end="95:62"><name pos:start="95:51" pos:end="95:54">band</name><operator pos:start="95:55" pos:end="95:56">-&gt;</operator><name pos:start="95:57" pos:end="95:62">energy</name></name> <operator pos:start="95:64" pos:end="95:65">||</operator> <name pos:start="95:67" pos:end="95:75"><name pos:start="95:67" pos:end="95:72">coeffs</name><index pos:start="95:73" pos:end="95:75">[<expr pos:start="95:74" pos:end="95:74"><name pos:start="95:74" pos:end="95:74">g</name></expr>]</index></name><operator pos:start="95:76" pos:end="95:76">.</operator><name pos:start="95:77" pos:end="95:83">min_snr</name> <operator pos:start="95:85" pos:end="95:85">&gt;</operator> <literal type="number" pos:start="95:87" pos:end="95:90">1.0f</literal></expr>)</condition><block type="pseudo" pos:start="97:17" pos:end="97:53"><block_content pos:start="97:17" pos:end="97:53">

                <expr_stmt pos:start="97:17" pos:end="97:53"><expr pos:start="97:17" pos:end="97:52"><name pos:start="97:17" pos:end="97:33"><name pos:start="97:17" pos:end="97:20">band</name><operator pos:start="97:21" pos:end="97:22">-&gt;</operator><name pos:start="97:23" pos:end="97:33">avoid_holes</name></name> <operator pos:start="97:35" pos:end="97:35">=</operator> <name pos:start="97:37" pos:end="97:52">PSY_3GPP_AH_NONE</name></expr>;</expr_stmt></block_content></block></if>

            <else pos:start="99:13" pos:end="101:57">else<block type="pseudo" pos:start="101:17" pos:end="101:57"><block_content pos:start="101:17" pos:end="101:57">

                <expr_stmt pos:start="101:17" pos:end="101:57"><expr pos:start="101:17" pos:end="101:56"><name pos:start="101:17" pos:end="101:33"><name pos:start="101:17" pos:end="101:20">band</name><operator pos:start="101:21" pos:end="101:22">-&gt;</operator><name pos:start="101:23" pos:end="101:33">avoid_holes</name></name> <operator pos:start="101:35" pos:end="101:35">=</operator> <name pos:start="101:37" pos:end="101:56">PSY_3GPP_AH_INACTIVE</name></expr>;</expr_stmt></block_content></block></else></if_stmt>

        </block_content>}</block></for>

    </block_content>}</block></for>



    <comment type="block" pos:start="109:5" pos:end="109:67">/* 5.6.1.3.2 "Calculation of the desired perceptual entropy" */</comment>

    <expr_stmt pos:start="111:5" pos:end="111:34"><expr pos:start="111:5" pos:end="111:33"><name pos:start="111:5" pos:end="111:20"><name pos:start="111:5" pos:end="111:7">ctx</name><operator pos:start="111:8" pos:end="111:9">-&gt;</operator><name pos:start="111:10" pos:end="111:11">ch</name><index pos:start="111:12" pos:end="111:20">[<expr pos:start="111:13" pos:end="111:19"><name pos:start="111:13" pos:end="111:19">channel</name></expr>]</index></name><operator pos:start="111:21" pos:end="111:21">.</operator><name pos:start="111:22" pos:end="111:28">entropy</name> <operator pos:start="111:30" pos:end="111:30">=</operator> <name pos:start="111:32" pos:end="111:33">pe</name></expr>;</expr_stmt>

    <expr_stmt pos:start="113:5" pos:end="113:103"><expr pos:start="113:5" pos:end="113:102"><name pos:start="113:5" pos:end="113:16">desired_bits</name> <operator pos:start="113:18" pos:end="113:18">=</operator> <call pos:start="113:20" pos:end="113:102"><name pos:start="113:20" pos:end="113:34">calc_bit_demand</name><argument_list pos:start="113:35" pos:end="113:102">(<argument pos:start="113:36" pos:end="113:39"><expr pos:start="113:36" pos:end="113:39"><name pos:start="113:36" pos:end="113:39">pctx</name></expr></argument>, <argument pos:start="113:42" pos:end="113:43"><expr pos:start="113:42" pos:end="113:43"><name pos:start="113:42" pos:end="113:43">pe</name></expr></argument>, <argument pos:start="113:46" pos:end="113:61"><expr pos:start="113:46" pos:end="113:61"><name pos:start="113:46" pos:end="113:61"><name pos:start="113:46" pos:end="113:48">ctx</name><operator pos:start="113:49" pos:end="113:50">-&gt;</operator><name pos:start="113:51" pos:end="113:56">bitres</name><operator pos:start="113:57" pos:end="113:57">.</operator><name pos:start="113:58" pos:end="113:61">bits</name></name></expr></argument>, <argument pos:start="113:64" pos:end="113:79"><expr pos:start="113:64" pos:end="113:79"><name pos:start="113:64" pos:end="113:79"><name pos:start="113:64" pos:end="113:66">ctx</name><operator pos:start="113:67" pos:end="113:68">-&gt;</operator><name pos:start="113:69" pos:end="113:74">bitres</name><operator pos:start="113:75" pos:end="113:75">.</operator><name pos:start="113:76" pos:end="113:79">size</name></name></expr></argument>, <argument pos:start="113:82" pos:end="113:101"><expr pos:start="113:82" pos:end="113:101"><name pos:start="113:82" pos:end="113:96"><name pos:start="113:82" pos:end="113:83">wi</name><operator pos:start="113:84" pos:end="113:85">-&gt;</operator><name pos:start="113:86" pos:end="113:96">num_windows</name></name> <operator pos:start="113:98" pos:end="113:99">==</operator> <literal type="number" pos:start="113:101" pos:end="113:101">8</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <expr_stmt pos:start="115:5" pos:end="115:51"><expr pos:start="115:5" pos:end="115:50"><name pos:start="115:5" pos:end="115:14">desired_pe</name> <operator pos:start="115:16" pos:end="115:16">=</operator> <call pos:start="115:18" pos:end="115:50"><name pos:start="115:18" pos:end="115:36">PSY_3GPP_BITS_TO_PE</name><argument_list pos:start="115:37" pos:end="115:50">(<argument pos:start="115:38" pos:end="115:49"><expr pos:start="115:38" pos:end="115:49"><name pos:start="115:38" pos:end="115:49">desired_bits</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

    <comment type="block" pos:start="117:5" pos:end="123:7">/* NOTE: PE correction is kept simple. During initial testing it had very

     *       little effect on the final bitrate. Probably a good idea to come

     *       back and do more testing later.

     */</comment>

    <if_stmt pos:start="125:5" pos:end="129:45"><if pos:start="125:5" pos:end="129:45">if <condition pos:start="125:8" pos:end="125:29">(<expr pos:start="125:9" pos:end="125:28"><name pos:start="125:9" pos:end="125:24"><name pos:start="125:9" pos:end="125:11">ctx</name><operator pos:start="125:12" pos:end="125:13">-&gt;</operator><name pos:start="125:14" pos:end="125:19">bitres</name><operator pos:start="125:20" pos:end="125:20">.</operator><name pos:start="125:21" pos:end="125:24">bits</name></name> <operator pos:start="125:26" pos:end="125:26">&gt;</operator> <literal type="number" pos:start="125:28" pos:end="125:28">0</literal></expr>)</condition><block type="pseudo" pos:start="127:9" pos:end="129:45"><block_content pos:start="127:9" pos:end="129:45">

        <expr_stmt pos:start="127:9" pos:end="129:45"><expr pos:start="127:9" pos:end="129:44"><name pos:start="127:9" pos:end="127:18">desired_pe</name> <operator pos:start="127:20" pos:end="127:21">*=</operator> <call pos:start="127:23" pos:end="129:44"><name pos:start="127:23" pos:end="127:30">av_clipf</name><argument_list pos:start="127:31" pos:end="129:44">(<argument pos:start="127:32" pos:end="127:88"><expr pos:start="127:32" pos:end="127:88"><name pos:start="127:32" pos:end="127:48"><name pos:start="127:32" pos:end="127:35">pctx</name><operator pos:start="127:36" pos:end="127:37">-&gt;</operator><name pos:start="127:38" pos:end="127:39">pe</name><operator pos:start="127:40" pos:end="127:40">.</operator><name pos:start="127:41" pos:end="127:48">previous</name></name> <operator pos:start="127:50" pos:end="127:50">/</operator> <call pos:start="127:52" pos:end="127:88"><name pos:start="127:52" pos:end="127:70">PSY_3GPP_BITS_TO_PE</name><argument_list pos:start="127:71" pos:end="127:88">(<argument pos:start="127:72" pos:end="127:87"><expr pos:start="127:72" pos:end="127:87"><name pos:start="127:72" pos:end="127:87"><name pos:start="127:72" pos:end="127:74">ctx</name><operator pos:start="127:75" pos:end="127:76">-&gt;</operator><name pos:start="127:77" pos:end="127:82">bitres</name><operator pos:start="127:83" pos:end="127:83">.</operator><name pos:start="127:84" pos:end="127:87">bits</name></name></expr></argument>)</argument_list></call></expr></argument>,

                               <argument pos:start="129:32" pos:end="129:36"><expr pos:start="129:32" pos:end="129:36"><literal type="number" pos:start="129:32" pos:end="129:36">0.85f</literal></expr></argument>, <argument pos:start="129:39" pos:end="129:43"><expr pos:start="129:39" pos:end="129:43"><literal type="number" pos:start="129:39" pos:end="129:43">1.15f</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>

    <expr_stmt pos:start="131:5" pos:end="131:58"><expr pos:start="131:5" pos:end="131:57"><name pos:start="131:5" pos:end="131:21"><name pos:start="131:5" pos:end="131:8">pctx</name><operator pos:start="131:9" pos:end="131:10">-&gt;</operator><name pos:start="131:11" pos:end="131:12">pe</name><operator pos:start="131:13" pos:end="131:13">.</operator><name pos:start="131:14" pos:end="131:21">previous</name></name> <operator pos:start="131:23" pos:end="131:23">=</operator> <call pos:start="131:25" pos:end="131:57"><name pos:start="131:25" pos:end="131:43">PSY_3GPP_BITS_TO_PE</name><argument_list pos:start="131:44" pos:end="131:57">(<argument pos:start="131:45" pos:end="131:56"><expr pos:start="131:45" pos:end="131:56"><name pos:start="131:45" pos:end="131:56">desired_bits</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>



    <if_stmt pos:start="135:5" pos:end="309:5"><if pos:start="135:5" pos:end="309:5">if <condition pos:start="135:8" pos:end="135:24">(<expr pos:start="135:9" pos:end="135:23"><name pos:start="135:9" pos:end="135:18">desired_pe</name> <operator pos:start="135:20" pos:end="135:20">&lt;</operator> <name pos:start="135:22" pos:end="135:23">pe</name></expr>)</condition> <block pos:start="135:26" pos:end="309:5">{<block_content pos:start="139:9" pos:end="307:9">

        <comment type="block" pos:start="137:9" pos:end="137:65">/* 5.6.1.3.4 "First Estimation of the reduction value" */</comment>

        <for pos:start="139:9" pos:end="167:9">for <control pos:start="139:13" pos:end="139:52">(<init pos:start="139:14" pos:end="139:19"><expr pos:start="139:14" pos:end="139:18"><name pos:start="139:14" pos:end="139:14">w</name> <operator pos:start="139:16" pos:end="139:16">=</operator> <literal type="number" pos:start="139:18" pos:end="139:18">0</literal></expr>;</init> <condition pos:start="139:21" pos:end="139:43"><expr pos:start="139:21" pos:end="139:42"><name pos:start="139:21" pos:end="139:21">w</name> <operator pos:start="139:23" pos:end="139:23">&lt;</operator> <name pos:start="139:25" pos:end="139:39"><name pos:start="139:25" pos:end="139:26">wi</name><operator pos:start="139:27" pos:end="139:28">-&gt;</operator><name pos:start="139:29" pos:end="139:39">num_windows</name></name><operator pos:start="139:40" pos:end="139:40">*</operator><literal type="number" pos:start="139:41" pos:end="139:42">16</literal></expr>;</condition> <incr pos:start="139:45" pos:end="139:51"><expr pos:start="139:45" pos:end="139:51"><name pos:start="139:45" pos:end="139:45">w</name> <operator pos:start="139:47" pos:end="139:48">+=</operator> <literal type="number" pos:start="139:50" pos:end="139:51">16</literal></expr></incr>)</control> <block pos:start="139:54" pos:end="167:9">{<block_content pos:start="141:13" pos:end="165:13">

            <expr_stmt pos:start="141:13" pos:end="141:77"><expr pos:start="141:13" pos:end="141:76"><name pos:start="141:13" pos:end="141:21">reduction</name> <operator pos:start="141:23" pos:end="141:23">=</operator> <call pos:start="141:25" pos:end="141:76"><name pos:start="141:25" pos:end="141:43">calc_reduction_3gpp</name><argument_list pos:start="141:44" pos:end="141:76">(<argument pos:start="141:45" pos:end="141:45"><expr pos:start="141:45" pos:end="141:45"><name pos:start="141:45" pos:end="141:45">a</name></expr></argument>, <argument pos:start="141:48" pos:end="141:57"><expr pos:start="141:48" pos:end="141:57"><name pos:start="141:48" pos:end="141:57">desired_pe</name></expr></argument>, <argument pos:start="141:60" pos:end="141:61"><expr pos:start="141:60" pos:end="141:61"><name pos:start="141:60" pos:end="141:61">pe</name></expr></argument>, <argument pos:start="141:64" pos:end="141:75"><expr pos:start="141:64" pos:end="141:75"><name pos:start="141:64" pos:end="141:75">active_lines</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <expr_stmt pos:start="143:13" pos:end="143:22"><expr pos:start="143:13" pos:end="143:21"><name pos:start="143:13" pos:end="143:14">pe</name> <operator pos:start="143:16" pos:end="143:16">=</operator> <literal type="number" pos:start="143:18" pos:end="143:21">0.0f</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="145:13" pos:end="145:22"><expr pos:start="145:13" pos:end="145:21"><name pos:start="145:13" pos:end="145:13">a</name>  <operator pos:start="145:16" pos:end="145:16">=</operator> <literal type="number" pos:start="145:18" pos:end="145:21">0.0f</literal></expr>;</expr_stmt>

            <expr_stmt pos:start="147:13" pos:end="147:32"><expr pos:start="147:13" pos:end="147:31"><name pos:start="147:13" pos:end="147:24">active_lines</name> <operator pos:start="147:26" pos:end="147:26">=</operator> <literal type="number" pos:start="147:28" pos:end="147:31">0.0f</literal></expr>;</expr_stmt>

            <for pos:start="149:13" pos:end="165:13">for <control pos:start="149:17" pos:end="149:43">(<init pos:start="149:18" pos:end="149:23"><expr pos:start="149:18" pos:end="149:22"><name pos:start="149:18" pos:end="149:18">g</name> <operator pos:start="149:20" pos:end="149:20">=</operator> <literal type="number" pos:start="149:22" pos:end="149:22">0</literal></expr>;</init> <condition pos:start="149:25" pos:end="149:38"><expr pos:start="149:25" pos:end="149:37"><name pos:start="149:25" pos:end="149:25">g</name> <operator pos:start="149:27" pos:end="149:27">&lt;</operator> <name pos:start="149:29" pos:end="149:37">num_bands</name></expr>;</condition> <incr pos:start="149:40" pos:end="149:42"><expr pos:start="149:40" pos:end="149:42"><name pos:start="149:40" pos:end="149:40">g</name><operator pos:start="149:41" pos:end="149:42">++</operator></expr></incr>)</control> <block pos:start="149:45" pos:end="165:13">{<block_content pos:start="151:17" pos:end="163:51">

                <decl_stmt pos:start="151:17" pos:end="151:51"><decl pos:start="151:17" pos:end="151:50"><type pos:start="151:17" pos:end="151:28"><name pos:start="151:17" pos:end="151:26">AacPsyBand</name> <modifier pos:start="151:28" pos:end="151:28">*</modifier></type><name pos:start="151:29" pos:end="151:32">band</name> <init pos:start="151:34" pos:end="151:50">= <expr pos:start="151:36" pos:end="151:50"><operator pos:start="151:36" pos:end="151:36">&amp;</operator><name pos:start="151:37" pos:end="151:50"><name pos:start="151:37" pos:end="151:39">pch</name><operator pos:start="151:40" pos:end="151:41">-&gt;</operator><name pos:start="151:42" pos:end="151:45">band</name><index pos:start="151:46" pos:end="151:50">[<expr pos:start="151:47" pos:end="151:49"><name pos:start="151:47" pos:end="151:47">w</name><operator pos:start="151:48" pos:end="151:48">+</operator><name pos:start="151:49" pos:end="151:49">g</name></expr>]</index></name></expr></init></decl>;</decl_stmt>



                <expr_stmt pos:start="155:17" pos:end="155:86"><expr pos:start="155:17" pos:end="155:85"><name pos:start="155:17" pos:end="155:25"><name pos:start="155:17" pos:end="155:20">band</name><operator pos:start="155:21" pos:end="155:22">-&gt;</operator><name pos:start="155:23" pos:end="155:25">thr</name></name> <operator pos:start="155:27" pos:end="155:27">=</operator> <call pos:start="155:29" pos:end="155:85"><name pos:start="155:29" pos:end="155:49">calc_reduced_thr_3gpp</name><argument_list pos:start="155:50" pos:end="155:85">(<argument pos:start="155:51" pos:end="155:54"><expr pos:start="155:51" pos:end="155:54"><name pos:start="155:51" pos:end="155:54">band</name></expr></argument>, <argument pos:start="155:57" pos:end="155:73"><expr pos:start="155:57" pos:end="155:73"><name pos:start="155:57" pos:end="155:65"><name pos:start="155:57" pos:end="155:62">coeffs</name><index pos:start="155:63" pos:end="155:65">[<expr pos:start="155:64" pos:end="155:64"><name pos:start="155:64" pos:end="155:64">g</name></expr>]</index></name><operator pos:start="155:66" pos:end="155:66">.</operator><name pos:start="155:67" pos:end="155:73">min_snr</name></expr></argument>, <argument pos:start="155:76" pos:end="155:84"><expr pos:start="155:76" pos:end="155:84"><name pos:start="155:76" pos:end="155:84">reduction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

                <comment type="block" pos:start="157:17" pos:end="157:36">/* recalculate PE */</comment>

                <expr_stmt pos:start="159:17" pos:end="159:41"><expr pos:start="159:17" pos:end="159:40"><name pos:start="159:17" pos:end="159:18">pe</name> <operator pos:start="159:20" pos:end="159:21">+=</operator> <call pos:start="159:23" pos:end="159:40"><name pos:start="159:23" pos:end="159:34">calc_pe_3gpp</name><argument_list pos:start="159:35" pos:end="159:40">(<argument pos:start="159:36" pos:end="159:39"><expr pos:start="159:36" pos:end="159:39"><name pos:start="159:36" pos:end="159:39">band</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

                <expr_stmt pos:start="161:17" pos:end="161:37"><expr pos:start="161:17" pos:end="161:36"><name pos:start="161:17" pos:end="161:17">a</name>  <operator pos:start="161:20" pos:end="161:21">+=</operator> <name pos:start="161:23" pos:end="161:36"><name pos:start="161:23" pos:end="161:26">band</name><operator pos:start="161:27" pos:end="161:28">-&gt;</operator><name pos:start="161:29" pos:end="161:36">pe_const</name></name></expr>;</expr_stmt>

                <expr_stmt pos:start="163:17" pos:end="163:51"><expr pos:start="163:17" pos:end="163:50"><name pos:start="163:17" pos:end="163:28">active_lines</name> <operator pos:start="163:30" pos:end="163:31">+=</operator> <name pos:start="163:33" pos:end="163:50"><name pos:start="163:33" pos:end="163:36">band</name><operator pos:start="163:37" pos:end="163:38">-&gt;</operator><name pos:start="163:39" pos:end="163:50">active_lines</name></name></expr>;</expr_stmt>

            </block_content>}</block></for>

        </block_content>}</block></for>



        <comment type="block" pos:start="171:9" pos:end="171:66">/* 5.6.1.3.5 "Second Estimation of the reduction value" */</comment>

        <for pos:start="173:9" pos:end="239:9">for <control pos:start="173:13" pos:end="173:31">(<init pos:start="173:14" pos:end="173:19"><expr pos:start="173:14" pos:end="173:18"><name pos:start="173:14" pos:end="173:14">i</name> <operator pos:start="173:16" pos:end="173:16">=</operator> <literal type="number" pos:start="173:18" pos:end="173:18">0</literal></expr>;</init> <condition pos:start="173:21" pos:end="173:26"><expr pos:start="173:21" pos:end="173:25"><name pos:start="173:21" pos:end="173:21">i</name> <operator pos:start="173:23" pos:end="173:23">&lt;</operator> <literal type="number" pos:start="173:25" pos:end="173:25">2</literal></expr>;</condition> <incr pos:start="173:28" pos:end="173:30"><expr pos:start="173:28" pos:end="173:30"><name pos:start="173:28" pos:end="173:28">i</name><operator pos:start="173:29" pos:end="173:30">++</operator></expr></incr>)</control> <block pos:start="173:33" pos:end="239:9">{<block_content pos:start="175:13" pos:end="237:22">

            <decl_stmt pos:start="175:13" pos:end="175:52"><decl pos:start="175:13" pos:end="175:33"><type pos:start="175:13" pos:end="175:17"><name pos:start="175:13" pos:end="175:17">float</name></type> <name pos:start="175:19" pos:end="175:26">pe_no_ah</name> <init pos:start="175:28" pos:end="175:33">= <expr pos:start="175:30" pos:end="175:33"><literal type="number" pos:start="175:30" pos:end="175:33">0.0f</literal></expr></init></decl>, <decl pos:start="175:36" pos:end="175:51"><type ref="prev" pos:start="175:13" pos:end="175:17"/><name pos:start="175:36" pos:end="175:51">desired_pe_no_ah</name></decl>;</decl_stmt>

            <expr_stmt pos:start="177:13" pos:end="177:36"><expr pos:start="177:13" pos:end="177:35"><name pos:start="177:13" pos:end="177:24">active_lines</name> <operator pos:start="177:26" pos:end="177:26">=</operator> <name pos:start="177:28" pos:end="177:28">a</name> <operator pos:start="177:30" pos:end="177:30">=</operator> <literal type="number" pos:start="177:32" pos:end="177:35">0.0f</literal></expr>;</expr_stmt>

            <for pos:start="179:13" pos:end="199:13">for <control pos:start="179:17" pos:end="179:56">(<init pos:start="179:18" pos:end="179:23"><expr pos:start="179:18" pos:end="179:22"><name pos:start="179:18" pos:end="179:18">w</name> <operator pos:start="179:20" pos:end="179:20">=</operator> <literal type="number" pos:start="179:22" pos:end="179:22">0</literal></expr>;</init> <condition pos:start="179:25" pos:end="179:47"><expr pos:start="179:25" pos:end="179:46"><name pos:start="179:25" pos:end="179:25">w</name> <operator pos:start="179:27" pos:end="179:27">&lt;</operator> <name pos:start="179:29" pos:end="179:43"><name pos:start="179:29" pos:end="179:30">wi</name><operator pos:start="179:31" pos:end="179:32">-&gt;</operator><name pos:start="179:33" pos:end="179:43">num_windows</name></name><operator pos:start="179:44" pos:end="179:44">*</operator><literal type="number" pos:start="179:45" pos:end="179:46">16</literal></expr>;</condition> <incr pos:start="179:49" pos:end="179:55"><expr pos:start="179:49" pos:end="179:55"><name pos:start="179:49" pos:end="179:49">w</name> <operator pos:start="179:51" pos:end="179:52">+=</operator> <literal type="number" pos:start="179:54" pos:end="179:55">16</literal></expr></incr>)</control> <block pos:start="179:58" pos:end="199:13">{<block_content pos:start="181:17" pos:end="197:17">

                <for pos:start="181:17" pos:end="197:17">for <control pos:start="181:21" pos:end="181:47">(<init pos:start="181:22" pos:end="181:27"><expr pos:start="181:22" pos:end="181:26"><name pos:start="181:22" pos:end="181:22">g</name> <operator pos:start="181:24" pos:end="181:24">=</operator> <literal type="number" pos:start="181:26" pos:end="181:26">0</literal></expr>;</init> <condition pos:start="181:29" pos:end="181:42"><expr pos:start="181:29" pos:end="181:41"><name pos:start="181:29" pos:end="181:29">g</name> <operator pos:start="181:31" pos:end="181:31">&lt;</operator> <name pos:start="181:33" pos:end="181:41">num_bands</name></expr>;</condition> <incr pos:start="181:44" pos:end="181:46"><expr pos:start="181:44" pos:end="181:46"><name pos:start="181:44" pos:end="181:44">g</name><operator pos:start="181:45" pos:end="181:46">++</operator></expr></incr>)</control> <block pos:start="181:49" pos:end="197:17">{<block_content pos:start="183:21" pos:end="195:21">

                    <decl_stmt pos:start="183:21" pos:end="183:55"><decl pos:start="183:21" pos:end="183:54"><type pos:start="183:21" pos:end="183:32"><name pos:start="183:21" pos:end="183:30">AacPsyBand</name> <modifier pos:start="183:32" pos:end="183:32">*</modifier></type><name pos:start="183:33" pos:end="183:36">band</name> <init pos:start="183:38" pos:end="183:54">= <expr pos:start="183:40" pos:end="183:54"><operator pos:start="183:40" pos:end="183:40">&amp;</operator><name pos:start="183:41" pos:end="183:54"><name pos:start="183:41" pos:end="183:43">pch</name><operator pos:start="183:44" pos:end="183:45">-&gt;</operator><name pos:start="183:46" pos:end="183:49">band</name><index pos:start="183:50" pos:end="183:54">[<expr pos:start="183:51" pos:end="183:53"><name pos:start="183:51" pos:end="183:51">w</name><operator pos:start="183:52" pos:end="183:52">+</operator><name pos:start="183:53" pos:end="183:53">g</name></expr>]</index></name></expr></init></decl>;</decl_stmt>



                    <if_stmt pos:start="187:21" pos:end="195:21"><if pos:start="187:21" pos:end="195:21">if <condition pos:start="187:24" pos:end="187:64">(<expr pos:start="187:25" pos:end="187:63"><name pos:start="187:25" pos:end="187:41"><name pos:start="187:25" pos:end="187:28">band</name><operator pos:start="187:29" pos:end="187:30">-&gt;</operator><name pos:start="187:31" pos:end="187:41">avoid_holes</name></name> <operator pos:start="187:43" pos:end="187:44">!=</operator> <name pos:start="187:46" pos:end="187:63">PSY_3GPP_AH_ACTIVE</name></expr>)</condition> <block pos:start="187:66" pos:end="195:21">{<block_content pos:start="189:25" pos:end="193:59">

                        <expr_stmt pos:start="189:25" pos:end="189:45"><expr pos:start="189:25" pos:end="189:44"><name pos:start="189:25" pos:end="189:32">pe_no_ah</name> <operator pos:start="189:34" pos:end="189:35">+=</operator> <name pos:start="189:37" pos:end="189:44"><name pos:start="189:37" pos:end="189:40">band</name><operator pos:start="189:41" pos:end="189:42">-&gt;</operator><name pos:start="189:43" pos:end="189:44">pe</name></name></expr>;</expr_stmt>

                        <expr_stmt pos:start="191:25" pos:end="191:51"><expr pos:start="191:25" pos:end="191:50"><name pos:start="191:25" pos:end="191:25">a</name>        <operator pos:start="191:34" pos:end="191:35">+=</operator> <name pos:start="191:37" pos:end="191:50"><name pos:start="191:37" pos:end="191:40">band</name><operator pos:start="191:41" pos:end="191:42">-&gt;</operator><name pos:start="191:43" pos:end="191:50">pe_const</name></name></expr>;</expr_stmt>

                        <expr_stmt pos:start="193:25" pos:end="193:59"><expr pos:start="193:25" pos:end="193:58"><name pos:start="193:25" pos:end="193:36">active_lines</name> <operator pos:start="193:38" pos:end="193:39">+=</operator> <name pos:start="193:41" pos:end="193:58"><name pos:start="193:41" pos:end="193:44">band</name><operator pos:start="193:45" pos:end="193:46">-&gt;</operator><name pos:start="193:47" pos:end="193:58">active_lines</name></name></expr>;</expr_stmt>

                    </block_content>}</block></if></if_stmt>

                </block_content>}</block></for>

            </block_content>}</block></for>

            <expr_stmt pos:start="201:13" pos:end="201:73"><expr pos:start="201:13" pos:end="201:72"><name pos:start="201:13" pos:end="201:28">desired_pe_no_ah</name> <operator pos:start="201:30" pos:end="201:30">=</operator> <call pos:start="201:32" pos:end="201:72"><name pos:start="201:32" pos:end="201:36">FFMAX</name><argument_list pos:start="201:37" pos:end="201:72">(<argument pos:start="201:38" pos:end="201:65"><expr pos:start="201:38" pos:end="201:65"><name pos:start="201:38" pos:end="201:47">desired_pe</name> <operator pos:start="201:49" pos:end="201:49">-</operator> <operator pos:start="201:51" pos:end="201:51">(</operator><name pos:start="201:52" pos:end="201:53">pe</name> <operator pos:start="201:55" pos:end="201:55">-</operator> <name pos:start="201:57" pos:end="201:64">pe_no_ah</name><operator pos:start="201:65" pos:end="201:65">)</operator></expr></argument>, <argument pos:start="201:68" pos:end="201:71"><expr pos:start="201:68" pos:end="201:71"><literal type="number" pos:start="201:68" pos:end="201:71">0.0f</literal></expr></argument>)</argument_list></call></expr>;</expr_stmt>

            <if_stmt pos:start="203:13" pos:end="205:94"><if pos:start="203:13" pos:end="205:94">if <condition pos:start="203:16" pos:end="203:36">(<expr pos:start="203:17" pos:end="203:35"><name pos:start="203:17" pos:end="203:28">active_lines</name> <operator pos:start="203:30" pos:end="203:30">&gt;</operator> <literal type="number" pos:start="203:32" pos:end="203:35">0.0f</literal></expr>)</condition><block type="pseudo" pos:start="205:17" pos:end="205:94"><block_content pos:start="205:17" pos:end="205:94">

                <expr_stmt pos:start="205:17" pos:end="205:94"><expr pos:start="205:17" pos:end="205:93"><name pos:start="205:17" pos:end="205:25">reduction</name> <operator pos:start="205:27" pos:end="205:28">+=</operator> <call pos:start="205:30" pos:end="205:93"><name pos:start="205:30" pos:end="205:48">calc_reduction_3gpp</name><argument_list pos:start="205:49" pos:end="205:93">(<argument pos:start="205:50" pos:end="205:50"><expr pos:start="205:50" pos:end="205:50"><name pos:start="205:50" pos:end="205:50">a</name></expr></argument>, <argument pos:start="205:53" pos:end="205:68"><expr pos:start="205:53" pos:end="205:68"><name pos:start="205:53" pos:end="205:68">desired_pe_no_ah</name></expr></argument>, <argument pos:start="205:71" pos:end="205:78"><expr pos:start="205:71" pos:end="205:78"><name pos:start="205:71" pos:end="205:78">pe_no_ah</name></expr></argument>, <argument pos:start="205:81" pos:end="205:92"><expr pos:start="205:81" pos:end="205:92"><name pos:start="205:81" pos:end="205:92">active_lines</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>



            <expr_stmt pos:start="209:13" pos:end="209:22"><expr pos:start="209:13" pos:end="209:21"><name pos:start="209:13" pos:end="209:14">pe</name> <operator pos:start="209:16" pos:end="209:16">=</operator> <literal type="number" pos:start="209:18" pos:end="209:21">0.0f</literal></expr>;</expr_stmt>

            <for pos:start="211:13" pos:end="231:13">for <control pos:start="211:17" pos:end="211:56">(<init pos:start="211:18" pos:end="211:23"><expr pos:start="211:18" pos:end="211:22"><name pos:start="211:18" pos:end="211:18">w</name> <operator pos:start="211:20" pos:end="211:20">=</operator> <literal type="number" pos:start="211:22" pos:end="211:22">0</literal></expr>;</init> <condition pos:start="211:25" pos:end="211:47"><expr pos:start="211:25" pos:end="211:46"><name pos:start="211:25" pos:end="211:25">w</name> <operator pos:start="211:27" pos:end="211:27">&lt;</operator> <name pos:start="211:29" pos:end="211:43"><name pos:start="211:29" pos:end="211:30">wi</name><operator pos:start="211:31" pos:end="211:32">-&gt;</operator><name pos:start="211:33" pos:end="211:43">num_windows</name></name><operator pos:start="211:44" pos:end="211:44">*</operator><literal type="number" pos:start="211:45" pos:end="211:46">16</literal></expr>;</condition> <incr pos:start="211:49" pos:end="211:55"><expr pos:start="211:49" pos:end="211:55"><name pos:start="211:49" pos:end="211:49">w</name> <operator pos:start="211:51" pos:end="211:52">+=</operator> <literal type="number" pos:start="211:54" pos:end="211:55">16</literal></expr></incr>)</control> <block pos:start="211:58" pos:end="231:13">{<block_content pos:start="213:17" pos:end="229:17">

                <for pos:start="213:17" pos:end="229:17">for <control pos:start="213:21" pos:end="213:47">(<init pos:start="213:22" pos:end="213:27"><expr pos:start="213:22" pos:end="213:26"><name pos:start="213:22" pos:end="213:22">g</name> <operator pos:start="213:24" pos:end="213:24">=</operator> <literal type="number" pos:start="213:26" pos:end="213:26">0</literal></expr>;</init> <condition pos:start="213:29" pos:end="213:42"><expr pos:start="213:29" pos:end="213:41"><name pos:start="213:29" pos:end="213:29">g</name> <operator pos:start="213:31" pos:end="213:31">&lt;</operator> <name pos:start="213:33" pos:end="213:41">num_bands</name></expr>;</condition> <incr pos:start="213:44" pos:end="213:46"><expr pos:start="213:44" pos:end="213:46"><name pos:start="213:44" pos:end="213:44">g</name><operator pos:start="213:45" pos:end="213:46">++</operator></expr></incr>)</control> <block pos:start="213:49" pos:end="229:17">{<block_content pos:start="215:21" pos:end="227:47">

                    <decl_stmt pos:start="215:21" pos:end="215:55"><decl pos:start="215:21" pos:end="215:54"><type pos:start="215:21" pos:end="215:32"><name pos:start="215:21" pos:end="215:30">AacPsyBand</name> <modifier pos:start="215:32" pos:end="215:32">*</modifier></type><name pos:start="215:33" pos:end="215:36">band</name> <init pos:start="215:38" pos:end="215:54">= <expr pos:start="215:40" pos:end="215:54"><operator pos:start="215:40" pos:end="215:40">&amp;</operator><name pos:start="215:41" pos:end="215:54"><name pos:start="215:41" pos:end="215:43">pch</name><operator pos:start="215:44" pos:end="215:45">-&gt;</operator><name pos:start="215:46" pos:end="215:49">band</name><index pos:start="215:50" pos:end="215:54">[<expr pos:start="215:51" pos:end="215:53"><name pos:start="215:51" pos:end="215:51">w</name><operator pos:start="215:52" pos:end="215:52">+</operator><name pos:start="215:53" pos:end="215:53">g</name></expr>]</index></name></expr></init></decl>;</decl_stmt>



                    <if_stmt pos:start="219:21" pos:end="221:94"><if pos:start="219:21" pos:end="221:94">if <condition pos:start="219:24" pos:end="219:44">(<expr pos:start="219:25" pos:end="219:43"><name pos:start="219:25" pos:end="219:36">active_lines</name> <operator pos:start="219:38" pos:end="219:38">&gt;</operator> <literal type="number" pos:start="219:40" pos:end="219:43">0.0f</literal></expr>)</condition><block type="pseudo" pos:start="221:25" pos:end="221:94"><block_content pos:start="221:25" pos:end="221:94">

                        <expr_stmt pos:start="221:25" pos:end="221:94"><expr pos:start="221:25" pos:end="221:93"><name pos:start="221:25" pos:end="221:33"><name pos:start="221:25" pos:end="221:28">band</name><operator pos:start="221:29" pos:end="221:30">-&gt;</operator><name pos:start="221:31" pos:end="221:33">thr</name></name> <operator pos:start="221:35" pos:end="221:35">=</operator> <call pos:start="221:37" pos:end="221:93"><name pos:start="221:37" pos:end="221:57">calc_reduced_thr_3gpp</name><argument_list pos:start="221:58" pos:end="221:93">(<argument pos:start="221:59" pos:end="221:62"><expr pos:start="221:59" pos:end="221:62"><name pos:start="221:59" pos:end="221:62">band</name></expr></argument>, <argument pos:start="221:65" pos:end="221:81"><expr pos:start="221:65" pos:end="221:81"><name pos:start="221:65" pos:end="221:73"><name pos:start="221:65" pos:end="221:70">coeffs</name><index pos:start="221:71" pos:end="221:73">[<expr pos:start="221:72" pos:end="221:72"><name pos:start="221:72" pos:end="221:72">g</name></expr>]</index></name><operator pos:start="221:74" pos:end="221:74">.</operator><name pos:start="221:75" pos:end="221:81">min_snr</name></expr></argument>, <argument pos:start="221:84" pos:end="221:92"><expr pos:start="221:84" pos:end="221:92"><name pos:start="221:84" pos:end="221:92">reduction</name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>

                    <expr_stmt pos:start="223:21" pos:end="223:45"><expr pos:start="223:21" pos:end="223:44"><name pos:start="223:21" pos:end="223:22">pe</name> <operator pos:start="223:24" pos:end="223:25">+=</operator> <call pos:start="223:27" pos:end="223:44"><name pos:start="223:27" pos:end="223:38">calc_pe_3gpp</name><argument_list pos:start="223:39" pos:end="223:44">(<argument pos:start="223:40" pos:end="223:43"><expr pos:start="223:40" pos:end="223:43"><name pos:start="223:40" pos:end="223:43">band</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

                    <expr_stmt pos:start="225:21" pos:end="225:68"><expr pos:start="225:21" pos:end="225:67"><name pos:start="225:21" pos:end="225:34"><name pos:start="225:21" pos:end="225:24">band</name><operator pos:start="225:25" pos:end="225:26">-&gt;</operator><name pos:start="225:27" pos:end="225:34">norm_fac</name></name> <operator pos:start="225:36" pos:end="225:36">=</operator> <name pos:start="225:38" pos:end="225:55"><name pos:start="225:38" pos:end="225:41">band</name><operator pos:start="225:42" pos:end="225:43">-&gt;</operator><name pos:start="225:44" pos:end="225:55">active_lines</name></name> <operator pos:start="225:57" pos:end="225:57">/</operator> <name pos:start="225:59" pos:end="225:67"><name pos:start="225:59" pos:end="225:62">band</name><operator pos:start="225:63" pos:end="225:64">-&gt;</operator><name pos:start="225:65" pos:end="225:67">thr</name></name></expr>;</expr_stmt>

                    <expr_stmt pos:start="227:21" pos:end="227:47"><expr pos:start="227:21" pos:end="227:46"><name pos:start="227:21" pos:end="227:28">norm_fac</name> <operator pos:start="227:30" pos:end="227:31">+=</operator> <name pos:start="227:33" pos:end="227:46"><name pos:start="227:33" pos:end="227:36">band</name><operator pos:start="227:37" pos:end="227:38">-&gt;</operator><name pos:start="227:39" pos:end="227:46">norm_fac</name></name></expr>;</expr_stmt>

                </block_content>}</block></for>

            </block_content>}</block></for>

            <expr_stmt pos:start="233:13" pos:end="233:39"><expr pos:start="233:13" pos:end="233:38"><name pos:start="233:13" pos:end="233:20">delta_pe</name> <operator pos:start="233:22" pos:end="233:22">=</operator> <name pos:start="233:24" pos:end="233:33">desired_pe</name> <operator pos:start="233:35" pos:end="233:35">-</operator> <name pos:start="233:37" pos:end="233:38">pe</name></expr>;</expr_stmt>

            <if_stmt pos:start="235:13" pos:end="237:22"><if pos:start="235:13" pos:end="237:22">if <condition pos:start="235:16" pos:end="235:52">(<expr pos:start="235:17" pos:end="235:51"><call pos:start="235:17" pos:end="235:30"><name pos:start="235:17" pos:end="235:20">fabs</name><argument_list pos:start="235:21" pos:end="235:30">(<argument pos:start="235:22" pos:end="235:29"><expr pos:start="235:22" pos:end="235:29"><name pos:start="235:22" pos:end="235:29">delta_pe</name></expr></argument>)</argument_list></call> <operator pos:start="235:32" pos:end="235:32">&gt;</operator> <literal type="number" pos:start="235:34" pos:end="235:38">0.05f</literal> <operator pos:start="235:40" pos:end="235:40">*</operator> <name pos:start="235:42" pos:end="235:51">desired_pe</name></expr>)</condition><block type="pseudo" pos:start="237:17" pos:end="237:22"><block_content pos:start="237:17" pos:end="237:22">

                <break pos:start="237:17" pos:end="237:22">break;</break></block_content></block></if></if_stmt>

        </block_content>}</block></for>



        <if_stmt pos:start="243:9" pos:end="307:9"><if pos:start="243:9" pos:end="279:9">if <condition pos:start="243:12" pos:end="243:36">(<expr pos:start="243:13" pos:end="243:35"><name pos:start="243:13" pos:end="243:14">pe</name> <operator pos:start="243:16" pos:end="243:16">&lt;</operator> <literal type="number" pos:start="243:18" pos:end="243:22">1.15f</literal> <operator pos:start="243:24" pos:end="243:24">*</operator> <name pos:start="243:26" pos:end="243:35">desired_pe</name></expr>)</condition> <block pos:start="243:38" pos:end="279:9">{<block_content pos:start="247:13" pos:end="277:13">

            <comment type="block" pos:start="245:13" pos:end="245:75">/* 6.6.1.3.6 "Final threshold modification by linearization" */</comment>

            <expr_stmt pos:start="247:13" pos:end="247:39"><expr pos:start="247:13" pos:end="247:38"><name pos:start="247:13" pos:end="247:20">norm_fac</name> <operator pos:start="247:22" pos:end="247:22">=</operator> <literal type="number" pos:start="247:24" pos:end="247:27">1.0f</literal> <operator pos:start="247:29" pos:end="247:29">/</operator> <name pos:start="247:31" pos:end="247:38">norm_fac</name></expr>;</expr_stmt>

            <for pos:start="249:13" pos:end="277:13">for <control pos:start="249:17" pos:end="249:56">(<init pos:start="249:18" pos:end="249:23"><expr pos:start="249:18" pos:end="249:22"><name pos:start="249:18" pos:end="249:18">w</name> <operator pos:start="249:20" pos:end="249:20">=</operator> <literal type="number" pos:start="249:22" pos:end="249:22">0</literal></expr>;</init> <condition pos:start="249:25" pos:end="249:47"><expr pos:start="249:25" pos:end="249:46"><name pos:start="249:25" pos:end="249:25">w</name> <operator pos:start="249:27" pos:end="249:27">&lt;</operator> <name pos:start="249:29" pos:end="249:43"><name pos:start="249:29" pos:end="249:30">wi</name><operator pos:start="249:31" pos:end="249:32">-&gt;</operator><name pos:start="249:33" pos:end="249:43">num_windows</name></name><operator pos:start="249:44" pos:end="249:44">*</operator><literal type="number" pos:start="249:45" pos:end="249:46">16</literal></expr>;</condition> <incr pos:start="249:49" pos:end="249:55"><expr pos:start="249:49" pos:end="249:55"><name pos:start="249:49" pos:end="249:49">w</name> <operator pos:start="249:51" pos:end="249:52">+=</operator> <literal type="number" pos:start="249:54" pos:end="249:55">16</literal></expr></incr>)</control> <block pos:start="249:58" pos:end="277:13">{<block_content pos:start="251:17" pos:end="275:17">

                <for pos:start="251:17" pos:end="275:17">for <control pos:start="251:21" pos:end="251:47">(<init pos:start="251:22" pos:end="251:27"><expr pos:start="251:22" pos:end="251:26"><name pos:start="251:22" pos:end="251:22">g</name> <operator pos:start="251:24" pos:end="251:24">=</operator> <literal type="number" pos:start="251:26" pos:end="251:26">0</literal></expr>;</init> <condition pos:start="251:29" pos:end="251:42"><expr pos:start="251:29" pos:end="251:41"><name pos:start="251:29" pos:end="251:29">g</name> <operator pos:start="251:31" pos:end="251:31">&lt;</operator> <name pos:start="251:33" pos:end="251:41">num_bands</name></expr>;</condition> <incr pos:start="251:44" pos:end="251:46"><expr pos:start="251:44" pos:end="251:46"><name pos:start="251:44" pos:end="251:44">g</name><operator pos:start="251:45" pos:end="251:46">++</operator></expr></incr>)</control> <block pos:start="251:49" pos:end="275:17">{<block_content pos:start="253:21" pos:end="273:21">

                    <decl_stmt pos:start="253:21" pos:end="253:55"><decl pos:start="253:21" pos:end="253:54"><type pos:start="253:21" pos:end="253:32"><name pos:start="253:21" pos:end="253:30">AacPsyBand</name> <modifier pos:start="253:32" pos:end="253:32">*</modifier></type><name pos:start="253:33" pos:end="253:36">band</name> <init pos:start="253:38" pos:end="253:54">= <expr pos:start="253:40" pos:end="253:54"><operator pos:start="253:40" pos:end="253:40">&amp;</operator><name pos:start="253:41" pos:end="253:54"><name pos:start="253:41" pos:end="253:43">pch</name><operator pos:start="253:44" pos:end="253:45">-&gt;</operator><name pos:start="253:46" pos:end="253:49">band</name><index pos:start="253:50" pos:end="253:54">[<expr pos:start="253:51" pos:end="253:53"><name pos:start="253:51" pos:end="253:51">w</name><operator pos:start="253:52" pos:end="253:52">+</operator><name pos:start="253:53" pos:end="253:53">g</name></expr>]</index></name></expr></init></decl>;</decl_stmt>



                    <if_stmt pos:start="257:21" pos:end="273:21"><if pos:start="257:21" pos:end="273:21">if <condition pos:start="257:24" pos:end="257:50">(<expr pos:start="257:25" pos:end="257:49"><name pos:start="257:25" pos:end="257:42"><name pos:start="257:25" pos:end="257:28">band</name><operator pos:start="257:29" pos:end="257:30">-&gt;</operator><name pos:start="257:31" pos:end="257:42">active_lines</name></name> <operator pos:start="257:44" pos:end="257:44">&gt;</operator> <literal type="number" pos:start="257:46" pos:end="257:49">0.5f</literal></expr>)</condition> <block pos:start="257:52" pos:end="273:21">{<block_content pos:start="259:25" pos:end="271:40">

                        <decl_stmt pos:start="259:25" pos:end="259:82"><decl pos:start="259:25" pos:end="259:81"><type pos:start="259:25" pos:end="259:29"><name pos:start="259:25" pos:end="259:29">float</name></type> <name pos:start="259:31" pos:end="259:42">delta_sfb_pe</name> <init pos:start="259:44" pos:end="259:81">= <expr pos:start="259:46" pos:end="259:81"><name pos:start="259:46" pos:end="259:59"><name pos:start="259:46" pos:end="259:49">band</name><operator pos:start="259:50" pos:end="259:51">-&gt;</operator><name pos:start="259:52" pos:end="259:59">norm_fac</name></name> <operator pos:start="259:61" pos:end="259:61">*</operator> <name pos:start="259:63" pos:end="259:70">norm_fac</name> <operator pos:start="259:72" pos:end="259:72">*</operator> <name pos:start="259:74" pos:end="259:81">delta_pe</name></expr></init></decl>;</decl_stmt>

                        <decl_stmt pos:start="261:25" pos:end="261:46"><decl pos:start="261:25" pos:end="261:45"><type pos:start="261:25" pos:end="261:29"><name pos:start="261:25" pos:end="261:29">float</name></type> <name pos:start="261:31" pos:end="261:33">thr</name> <init pos:start="261:35" pos:end="261:45">= <expr pos:start="261:37" pos:end="261:45"><name pos:start="261:37" pos:end="261:45"><name pos:start="261:37" pos:end="261:40">band</name><operator pos:start="261:41" pos:end="261:42">-&gt;</operator><name pos:start="261:43" pos:end="261:45">thr</name></name></expr></init></decl>;</decl_stmt>



                        <expr_stmt pos:start="265:25" pos:end="265:72"><expr pos:start="265:25" pos:end="265:71"><name pos:start="265:25" pos:end="265:27">thr</name> <operator pos:start="265:29" pos:end="265:30">*=</operator> <call pos:start="265:32" pos:end="265:71"><name pos:start="265:32" pos:end="265:36">exp2f</name><argument_list pos:start="265:37" pos:end="265:71">(<argument pos:start="265:38" pos:end="265:70"><expr pos:start="265:38" pos:end="265:70"><name pos:start="265:38" pos:end="265:49">delta_sfb_pe</name> <operator pos:start="265:51" pos:end="265:51">/</operator> <name pos:start="265:53" pos:end="265:70"><name pos:start="265:53" pos:end="265:56">band</name><operator pos:start="265:57" pos:end="265:58">-&gt;</operator><name pos:start="265:59" pos:end="265:70">active_lines</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt>

                        <if_stmt pos:start="267:25" pos:end="269:85"><if pos:start="267:25" pos:end="269:85">if <condition pos:start="267:28" pos:end="267:112">(<expr pos:start="267:29" pos:end="267:111"><name pos:start="267:29" pos:end="267:31">thr</name> <operator pos:start="267:33" pos:end="267:33">&gt;</operator> <name pos:start="267:35" pos:end="267:43"><name pos:start="267:35" pos:end="267:40">coeffs</name><index pos:start="267:41" pos:end="267:43">[<expr pos:start="267:42" pos:end="267:42"><name pos:start="267:42" pos:end="267:42">g</name></expr>]</index></name><operator pos:start="267:44" pos:end="267:44">.</operator><name pos:start="267:45" pos:end="267:51">min_snr</name> <operator pos:start="267:53" pos:end="267:53">*</operator> <name pos:start="267:55" pos:end="267:66"><name pos:start="267:55" pos:end="267:58">band</name><operator pos:start="267:59" pos:end="267:60">-&gt;</operator><name pos:start="267:61" pos:end="267:66">energy</name></name> <operator pos:start="267:68" pos:end="267:69">&amp;&amp;</operator> <name pos:start="267:71" pos:end="267:87"><name pos:start="267:71" pos:end="267:74">band</name><operator pos:start="267:75" pos:end="267:76">-&gt;</operator><name pos:start="267:77" pos:end="267:87">avoid_holes</name></name> <operator pos:start="267:89" pos:end="267:90">==</operator> <name pos:start="267:92" pos:end="267:111">PSY_3GPP_AH_INACTIVE</name></expr>)</condition><block type="pseudo" pos:start="269:29" pos:end="269:85"><block_content pos:start="269:29" pos:end="269:85">

                            <expr_stmt pos:start="269:29" pos:end="269:85"><expr pos:start="269:29" pos:end="269:84"><name pos:start="269:29" pos:end="269:31">thr</name> <operator pos:start="269:33" pos:end="269:33">=</operator> <call pos:start="269:35" pos:end="269:84"><name pos:start="269:35" pos:end="269:39">FFMAX</name><argument_list pos:start="269:40" pos:end="269:84">(<argument pos:start="269:41" pos:end="269:49"><expr pos:start="269:41" pos:end="269:49"><name pos:start="269:41" pos:end="269:49"><name pos:start="269:41" pos:end="269:44">band</name><operator pos:start="269:45" pos:end="269:46">-&gt;</operator><name pos:start="269:47" pos:end="269:49">thr</name></name></expr></argument>, <argument pos:start="269:52" pos:end="269:83"><expr pos:start="269:52" pos:end="269:83"><name pos:start="269:52" pos:end="269:60"><name pos:start="269:52" pos:end="269:57">coeffs</name><index pos:start="269:58" pos:end="269:60">[<expr pos:start="269:59" pos:end="269:59"><name pos:start="269:59" pos:end="269:59">g</name></expr>]</index></name><operator pos:start="269:61" pos:end="269:61">.</operator><name pos:start="269:62" pos:end="269:68">min_snr</name> <operator pos:start="269:70" pos:end="269:70">*</operator> <name pos:start="269:72" pos:end="269:83"><name pos:start="269:72" pos:end="269:75">band</name><operator pos:start="269:76" pos:end="269:77">-&gt;</operator><name pos:start="269:78" pos:end="269:83">energy</name></name></expr></argument>)</argument_list></call></expr>;</expr_stmt></block_content></block></if></if_stmt>

                        <expr_stmt pos:start="271:25" pos:end="271:40"><expr pos:start="271:25" pos:end="271:39"><name pos:start="271:25" pos:end="271:33"><name pos:start="271:25" pos:end="271:28">band</name><operator pos:start="271:29" pos:end="271:30">-&gt;</operator><name pos:start="271:31" pos:end="271:33">thr</name></name> <operator pos:start="271:35" pos:end="271:35">=</operator> <name pos:start="271:37" pos:end="271:39">thr</name></expr>;</expr_stmt>

                    </block_content>}</block></if></if_stmt>

                </block_content>}</block></for>

            </block_content>}</block></for>

        </block_content>}</block></if> <else pos:start="279:11" pos:end="307:9">else <block pos:start="279:16" pos:end="307:9">{<block_content pos:start="283:13" pos:end="303:13">

            <comment type="block" pos:start="281:13" pos:end="281:66">/* 5.6.1.3.7 "Further perceptual entropy reduction" */</comment>

            <expr_stmt pos:start="283:13" pos:end="283:26"><expr pos:start="283:13" pos:end="283:25"><name pos:start="283:13" pos:end="283:13">g</name> <operator pos:start="283:15" pos:end="283:15">=</operator> <name pos:start="283:17" pos:end="283:25">num_bands</name></expr>;</expr_stmt>

            <while pos:start="285:13" pos:end="303:13">while <condition pos:start="285:19" pos:end="285:42">(<expr pos:start="285:20" pos:end="285:41"><name pos:start="285:20" pos:end="285:21">pe</name> <operator pos:start="285:23" pos:end="285:23">&gt;</operator> <name pos:start="285:25" pos:end="285:34">desired_pe</name> <operator pos:start="285:36" pos:end="285:37">&amp;&amp;</operator> <name pos:start="285:39" pos:end="285:39">g</name><operator pos:start="285:40" pos:end="285:41">--</operator></expr>)</condition> <block pos:start="285:44" pos:end="303:13">{<block_content pos:start="287:17" pos:end="301:17">

                <for pos:start="287:17" pos:end="301:17">for <control pos:start="287:21" pos:end="287:59">(<init pos:start="287:22" pos:end="287:27"><expr pos:start="287:22" pos:end="287:26"><name pos:start="287:22" pos:end="287:22">w</name> <operator pos:start="287:24" pos:end="287:24">=</operator> <literal type="number" pos:start="287:26" pos:end="287:26">0</literal></expr>;</init> <condition pos:start="287:29" pos:end="287:51"><expr pos:start="287:29" pos:end="287:50"><name pos:start="287:29" pos:end="287:29">w</name> <operator pos:start="287:31" pos:end="287:31">&lt;</operator> <name pos:start="287:33" pos:end="287:47"><name pos:start="287:33" pos:end="287:34">wi</name><operator pos:start="287:35" pos:end="287:36">-&gt;</operator><name pos:start="287:37" pos:end="287:47">num_windows</name></name><operator pos:start="287:48" pos:end="287:48">*</operator><literal type="number" pos:start="287:49" pos:end="287:50">16</literal></expr>;</condition> <incr pos:start="287:53" pos:end="287:58"><expr pos:start="287:53" pos:end="287:58"><name pos:start="287:53" pos:end="287:53">w</name><operator pos:start="287:54" pos:end="287:55">+=</operator> <literal type="number" pos:start="287:57" pos:end="287:58">16</literal></expr></incr>)</control> <block pos:start="287:61" pos:end="301:17">{<block_content pos:start="289:21" pos:end="299:21">

                    <decl_stmt pos:start="289:21" pos:end="289:55"><decl pos:start="289:21" pos:end="289:54"><type pos:start="289:21" pos:end="289:32"><name pos:start="289:21" pos:end="289:30">AacPsyBand</name> <modifier pos:start="289:32" pos:end="289:32">*</modifier></type><name pos:start="289:33" pos:end="289:36">band</name> <init pos:start="289:38" pos:end="289:54">= <expr pos:start="289:40" pos:end="289:54"><operator pos:start="289:40" pos:end="289:40">&amp;</operator><name pos:start="289:41" pos:end="289:54"><name pos:start="289:41" pos:end="289:43">pch</name><operator pos:start="289:44" pos:end="289:45">-&gt;</operator><name pos:start="289:46" pos:end="289:49">band</name><index pos:start="289:50" pos:end="289:54">[<expr pos:start="289:51" pos:end="289:53"><name pos:start="289:51" pos:end="289:51">w</name><operator pos:start="289:52" pos:end="289:52">+</operator><name pos:start="289:53" pos:end="289:53">g</name></expr>]</index></name></expr></init></decl>;</decl_stmt>

                    <if_stmt pos:start="291:21" pos:end="299:21"><if pos:start="291:21" pos:end="299:21">if <condition pos:start="291:24" pos:end="291:97">(<expr pos:start="291:25" pos:end="291:96"><name pos:start="291:25" pos:end="291:41"><name pos:start="291:25" pos:end="291:28">band</name><operator pos:start="291:29" pos:end="291:30">-&gt;</operator><name pos:start="291:31" pos:end="291:41">avoid_holes</name></name> <operator pos:start="291:43" pos:end="291:44">!=</operator> <name pos:start="291:46" pos:end="291:61">PSY_3GPP_AH_NONE</name> <operator pos:start="291:63" pos:end="291:64">&amp;&amp;</operator> <name pos:start="291:66" pos:end="291:74"><name pos:start="291:66" pos:end="291:71">coeffs</name><index pos:start="291:72" pos:end="291:74">[<expr pos:start="291:73" pos:end="291:73"><name pos:start="291:73" pos:end="291:73">g</name></expr>]</index></name><operator pos:start="291:75" pos:end="291:75">.</operator><name pos:start="291:76" pos:end="291:82">min_snr</name> <operator pos:start="291:84" pos:end="291:84">&lt;</operator> <name pos:start="291:86" pos:end="291:96">PSY_SNR_1DB</name></expr>)</condition> <block pos:start="291:99" pos:end="299:21">{<block_content pos:start="293:25" pos:end="297:67">

                        <expr_stmt pos:start="293:25" pos:end="293:56"><expr pos:start="293:25" pos:end="293:55"><name pos:start="293:25" pos:end="293:33"><name pos:start="293:25" pos:end="293:30">coeffs</name><index pos:start="293:31" pos:end="293:33">[<expr pos:start="293:32" pos:end="293:32"><name pos:start="293:32" pos:end="293:32">g</name></expr>]</index></name><operator pos:start="293:34" pos:end="293:34">.</operator><name pos:start="293:35" pos:end="293:41">min_snr</name> <operator pos:start="293:43" pos:end="293:43">=</operator> <name pos:start="293:45" pos:end="293:55">PSY_SNR_1DB</name></expr>;</expr_stmt>

                        <expr_stmt pos:start="295:25" pos:end="295:63"><expr pos:start="295:25" pos:end="295:62"><name pos:start="295:25" pos:end="295:33"><name pos:start="295:25" pos:end="295:28">band</name><operator pos:start="295:29" pos:end="295:30">-&gt;</operator><name pos:start="295:31" pos:end="295:33">thr</name></name> <operator pos:start="295:35" pos:end="295:35">=</operator> <name pos:start="295:37" pos:end="295:48"><name pos:start="295:37" pos:end="295:40">band</name><operator pos:start="295:41" pos:end="295:42">-&gt;</operator><name pos:start="295:43" pos:end="295:48">energy</name></name> <operator pos:start="295:50" pos:end="295:50">*</operator> <name pos:start="295:52" pos:end="295:62">PSY_SNR_1DB</name></expr>;</expr_stmt>

                        <expr_stmt pos:start="297:25" pos:end="297:67"><expr pos:start="297:25" pos:end="297:66"><name pos:start="297:25" pos:end="297:26">pe</name> <operator pos:start="297:28" pos:end="297:29">+=</operator> <name pos:start="297:31" pos:end="297:48"><name pos:start="297:31" pos:end="297:34">band</name><operator pos:start="297:35" pos:end="297:36">-&gt;</operator><name pos:start="297:37" pos:end="297:48">active_lines</name></name> <operator pos:start="297:50" pos:end="297:50">*</operator> <literal type="number" pos:start="297:52" pos:end="297:57">1.5f</literal> <operator pos:start="297:57" pos:end="297:57">-</operator> <name pos:start="297:59" pos:end="297:66"><name pos:start="297:59" pos:end="297:62">band</name><operator pos:start="297:63" pos:end="297:64">-&gt;</operator><name pos:start="297:65" pos:end="297:66">pe</name></name></expr>;</expr_stmt>

                    </block_content>}</block></if></if_stmt>

                </block_content>}</block></for>

            </block_content>}</block></while>

            <comment type="block" pos:start="305:13" pos:end="305:66">/* TODO: allow more holes (unused without mid/side) */</comment>

        </block_content>}</block></else></if_stmt>

    </block_content>}</block></if></if_stmt>



    <for pos:start="313:5" pos:end="329:5">for <control pos:start="313:9" pos:end="313:48">(<init pos:start="313:10" pos:end="313:15"><expr pos:start="313:10" pos:end="313:14"><name pos:start="313:10" pos:end="313:10">w</name> <operator pos:start="313:12" pos:end="313:12">=</operator> <literal type="number" pos:start="313:14" pos:end="313:14">0</literal></expr>;</init> <condition pos:start="313:17" pos:end="313:39"><expr pos:start="313:17" pos:end="313:38"><name pos:start="313:17" pos:end="313:17">w</name> <operator pos:start="313:19" pos:end="313:19">&lt;</operator> <name pos:start="313:21" pos:end="313:35"><name pos:start="313:21" pos:end="313:22">wi</name><operator pos:start="313:23" pos:end="313:24">-&gt;</operator><name pos:start="313:25" pos:end="313:35">num_windows</name></name><operator pos:start="313:36" pos:end="313:36">*</operator><literal type="number" pos:start="313:37" pos:end="313:38">16</literal></expr>;</condition> <incr pos:start="313:41" pos:end="313:47"><expr pos:start="313:41" pos:end="313:47"><name pos:start="313:41" pos:end="313:41">w</name> <operator pos:start="313:43" pos:end="313:44">+=</operator> <literal type="number" pos:start="313:46" pos:end="313:47">16</literal></expr></incr>)</control> <block pos:start="313:50" pos:end="329:5">{<block_content pos:start="315:9" pos:end="327:9">

        <for pos:start="315:9" pos:end="327:9">for <control pos:start="315:13" pos:end="315:39">(<init pos:start="315:14" pos:end="315:19"><expr pos:start="315:14" pos:end="315:18"><name pos:start="315:14" pos:end="315:14">g</name> <operator pos:start="315:16" pos:end="315:16">=</operator> <literal type="number" pos:start="315:18" pos:end="315:18">0</literal></expr>;</init> <condition pos:start="315:21" pos:end="315:34"><expr pos:start="315:21" pos:end="315:33"><name pos:start="315:21" pos:end="315:21">g</name> <operator pos:start="315:23" pos:end="315:23">&lt;</operator> <name pos:start="315:25" pos:end="315:33">num_bands</name></expr>;</condition> <incr pos:start="315:36" pos:end="315:38"><expr pos:start="315:36" pos:end="315:38"><name pos:start="315:36" pos:end="315:36">g</name><operator pos:start="315:37" pos:end="315:38">++</operator></expr></incr>)</control> <block pos:start="315:41" pos:end="327:9">{<block_content pos:start="317:13" pos:end="325:47">

            <decl_stmt pos:start="317:13" pos:end="317:51"><decl pos:start="317:13" pos:end="317:50"><type pos:start="317:13" pos:end="317:24"><name pos:start="317:13" pos:end="317:22">AacPsyBand</name> <modifier pos:start="317:24" pos:end="317:24">*</modifier></type><name pos:start="317:25" pos:end="317:28">band</name>     <init pos:start="317:34" pos:end="317:50">= <expr pos:start="317:36" pos:end="317:50"><operator pos:start="317:36" pos:end="317:36">&amp;</operator><name pos:start="317:37" pos:end="317:50"><name pos:start="317:37" pos:end="317:39">pch</name><operator pos:start="317:40" pos:end="317:41">-&gt;</operator><name pos:start="317:42" pos:end="317:45">band</name><index pos:start="317:46" pos:end="317:50">[<expr pos:start="317:47" pos:end="317:49"><name pos:start="317:47" pos:end="317:47">w</name><operator pos:start="317:48" pos:end="317:48">+</operator><name pos:start="317:49" pos:end="317:49">g</name></expr>]</index></name></expr></init></decl>;</decl_stmt>

            <decl_stmt pos:start="319:13" pos:end="319:68"><decl pos:start="319:13" pos:end="319:67"><type pos:start="319:13" pos:end="319:24"><name pos:start="319:13" pos:end="319:21">FFPsyBand</name>  <modifier pos:start="319:24" pos:end="319:24">*</modifier></type><name pos:start="319:25" pos:end="319:32">psy_band</name> <init pos:start="319:34" pos:end="319:67">= <expr pos:start="319:36" pos:end="319:67"><operator pos:start="319:36" pos:end="319:36">&amp;</operator><name pos:start="319:37" pos:end="319:52"><name pos:start="319:37" pos:end="319:39">ctx</name><operator pos:start="319:40" pos:end="319:41">-&gt;</operator><name pos:start="319:42" pos:end="319:43">ch</name><index pos:start="319:44" pos:end="319:52">[<expr pos:start="319:45" pos:end="319:51"><name pos:start="319:45" pos:end="319:51">channel</name></expr>]</index></name><operator pos:start="319:53" pos:end="319:53">.</operator><name pos:start="319:54" pos:end="319:67"><name pos:start="319:54" pos:end="319:62">psy_bands</name><index pos:start="319:63" pos:end="319:67">[<expr pos:start="319:64" pos:end="319:66"><name pos:start="319:64" pos:end="319:64">w</name><operator pos:start="319:65" pos:end="319:65">+</operator><name pos:start="319:66" pos:end="319:66">g</name></expr>]</index></name></expr></init></decl>;</decl_stmt>



            <expr_stmt pos:start="323:13" pos:end="323:44"><expr pos:start="323:13" pos:end="323:43"><name pos:start="323:13" pos:end="323:31"><name pos:start="323:13" pos:end="323:20">psy_band</name><operator pos:start="323:21" pos:end="323:22">-&gt;</operator><name pos:start="323:23" pos:end="323:31">threshold</name></name> <operator pos:start="323:33" pos:end="323:33">=</operator> <name pos:start="323:35" pos:end="323:43"><name pos:start="323:35" pos:end="323:38">band</name><operator pos:start="323:39" pos:end="323:40">-&gt;</operator><name pos:start="323:41" pos:end="323:43">thr</name></name></expr>;</expr_stmt>

            <expr_stmt pos:start="325:13" pos:end="325:47"><expr pos:start="325:13" pos:end="325:46"><name pos:start="325:13" pos:end="325:28"><name pos:start="325:13" pos:end="325:20">psy_band</name><operator pos:start="325:21" pos:end="325:22">-&gt;</operator><name pos:start="325:23" pos:end="325:28">energy</name></name>    <operator pos:start="325:33" pos:end="325:33">=</operator> <name pos:start="325:35" pos:end="325:46"><name pos:start="325:35" pos:end="325:38">band</name><operator pos:start="325:39" pos:end="325:40">-&gt;</operator><name pos:start="325:41" pos:end="325:46">energy</name></name></expr>;</expr_stmt>

        </block_content>}</block></for>

    </block_content>}</block></for>



    <expr_stmt pos:start="333:5" pos:end="333:57"><expr pos:start="333:5" pos:end="333:56"><call pos:start="333:5" pos:end="333:56"><name pos:start="333:5" pos:end="333:10">memcpy</name><argument_list pos:start="333:11" pos:end="333:56">(<argument pos:start="333:12" pos:end="333:25"><expr pos:start="333:12" pos:end="333:25"><name pos:start="333:12" pos:end="333:25"><name pos:start="333:12" pos:end="333:14">pch</name><operator pos:start="333:15" pos:end="333:16">-&gt;</operator><name pos:start="333:17" pos:end="333:25">prev_band</name></name></expr></argument>, <argument pos:start="333:28" pos:end="333:36"><expr pos:start="333:28" pos:end="333:36"><name pos:start="333:28" pos:end="333:36"><name pos:start="333:28" pos:end="333:30">pch</name><operator pos:start="333:31" pos:end="333:32">-&gt;</operator><name pos:start="333:33" pos:end="333:36">band</name></name></expr></argument>, <argument pos:start="333:39" pos:end="333:55"><expr pos:start="333:39" pos:end="333:55"><sizeof pos:start="333:39" pos:end="333:55">sizeof<argument_list pos:start="333:45" pos:end="333:55">(<argument pos:start="333:46" pos:end="333:54"><expr pos:start="333:46" pos:end="333:54"><name pos:start="333:46" pos:end="333:54"><name pos:start="333:46" pos:end="333:48">pch</name><operator pos:start="333:49" pos:end="333:50">-&gt;</operator><name pos:start="333:51" pos:end="333:54">band</name></name></expr></argument>)</argument_list></sizeof></expr></argument>)</argument_list></call></expr>;</expr_stmt>

</block_content>}</block></function>
</unit>
